function $parcel$defineInteropFlag(t){Object.defineProperty(t,"__esModule",{value:!0,configurable:!0})}function $parcel$export(t,e,r,i){Object.defineProperty(t,e,{get:r,set:i,enumerable:!0,configurable:!0})}var $parcel$global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},$parcel$modules={},$parcel$inits={},parcelRequire=$parcel$global.parcelRequire3a43;null==parcelRequire&&(parcelRequire=function(t){if(t in $parcel$modules)return $parcel$modules[t].exports;if(t in $parcel$inits){var e=$parcel$inits[t];delete $parcel$inits[t];var r={id:t,exports:{}};return $parcel$modules[t]=r,e.call(r.exports,r,r.exports),r.exports}var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i},parcelRequire.register=function(t,e){$parcel$inits[t]=e},$parcel$global.parcelRequire3a43=parcelRequire);var $658ba0b07a4ec711$exports={};$parcel$defineInteropFlag($658ba0b07a4ec711$exports),$parcel$export($658ba0b07a4ec711$exports,"PointerHandler",(function(){return $658ba0b07a4ec711$export$3e1e281e8d01b44c})),$parcel$export($658ba0b07a4ec711$exports,"Scene",(function(){return $658ba0b07a4ec711$export$df6b198c079ba70b})),$parcel$export($658ba0b07a4ec711$exports,"Grid",(function(){return $658ba0b07a4ec711$export$c0beb0283cd0caa9})),$parcel$export($658ba0b07a4ec711$exports,"Updater",(function(){return $658ba0b07a4ec711$export$f65528cc6a59fcb6})),$parcel$export($658ba0b07a4ec711$exports,"Rect",(function(){return $658ba0b07a4ec711$export$37c6ae4f022bed69})),$parcel$export($658ba0b07a4ec711$exports,"Easing",(function(){return $658ba0b07a4ec711$export$1770dcac1b234222})),$parcel$export($658ba0b07a4ec711$exports,"KeyCodes",(function(){return $658ba0b07a4ec711$export$840ab787eaee4157})),$parcel$export($658ba0b07a4ec711$exports,"Class",(function(){return $658ba0b07a4ec711$export$85a4e7644ad1465d})),$parcel$export($658ba0b07a4ec711$exports,"Log",(function(){return $658ba0b07a4ec711$export$2b5ff101e1b2bb00})),$parcel$export($658ba0b07a4ec711$exports,"Wrappers",(function(){return $658ba0b07a4ec711$export$73b9aaf46ae254c4})),$parcel$export($658ba0b07a4ec711$exports,"Boot",(function(){return $658ba0b07a4ec711$export$6e47fbc78ae048bb})),$parcel$export($658ba0b07a4ec711$exports,"Bounds2",(function(){return $658ba0b07a4ec711$export$d54906fab9190f08})),$parcel$export($658ba0b07a4ec711$exports,"Viewport",(function(){return $658ba0b07a4ec711$export$7f841115a8fce801})),$parcel$export($658ba0b07a4ec711$exports,"Group",(function(){return $658ba0b07a4ec711$export$a145e63780346cea})),$parcel$export($658ba0b07a4ec711$exports,"Stick",(function(){return $658ba0b07a4ec711$export$1ea29c2583ef834e})),$parcel$export($658ba0b07a4ec711$exports,"System",(function(){return $658ba0b07a4ec711$export$f784aa1b07eeac6})),$parcel$export($658ba0b07a4ec711$exports,"Anim",(function(){return $658ba0b07a4ec711$export$b9bf57cbc26e1015})),$parcel$export($658ba0b07a4ec711$exports,"GridElement",(function(){return $658ba0b07a4ec711$export$dde849f16326d204})),$parcel$export($658ba0b07a4ec711$exports,"SimpleContainer",(function(){return $658ba0b07a4ec711$export$ce555014ad1fb2e2})),$parcel$export($658ba0b07a4ec711$exports,"ScreenControls",(function(){return $658ba0b07a4ec711$export$37ae0460fb21e8f7})),$parcel$export($658ba0b07a4ec711$exports,"Matrix",(function(){return $658ba0b07a4ec711$export$98c16e1ff98bb093})),$parcel$export($658ba0b07a4ec711$exports,"Vec2",(function(){return $658ba0b07a4ec711$export$5c2dd915c3178dd5})),$parcel$export($658ba0b07a4ec711$exports,"globals",(function(){return $658ba0b07a4ec711$export$6aaccd98745ad9c8})),$parcel$export($658ba0b07a4ec711$exports,"Point2",(function(){return $658ba0b07a4ec711$export$56ce2844da725845})),$parcel$export($658ba0b07a4ec711$exports,"Button",(function(){return $658ba0b07a4ec711$export$3e142902fa56c5af})),$parcel$export($658ba0b07a4ec711$exports,"Shader",(function(){return $658ba0b07a4ec711$export$2b6a748984e845f3})),$parcel$export($658ba0b07a4ec711$exports,"List",(function(){return $658ba0b07a4ec711$export$67ff6ad4c3221cd5})),$parcel$export($658ba0b07a4ec711$exports,"default",(function(){return $658ba0b07a4ec711$export$9099ad97b570f7c})),$parcel$export($658ba0b07a4ec711$exports,"GridContainer",(function(){return $658ba0b07a4ec711$export$295b31e4521ee09f})),$parcel$export($658ba0b07a4ec711$exports,"Element",(function(){return $658ba0b07a4ec711$export$8f1dff5cc2b79014})),$parcel$export($658ba0b07a4ec711$exports,"Timer",(function(){return $658ba0b07a4ec711$export$4d59e12a1c7697d7})),$parcel$export($658ba0b07a4ec711$exports,"Resources",(function(){return $658ba0b07a4ec711$export$788042a0cc1455ce})),$parcel$export($658ba0b07a4ec711$exports,"KeyboardHandler",(function(){return $658ba0b07a4ec711$export$56dc43da7bb81ccd})),$parcel$export($658ba0b07a4ec711$exports,"Canvas",(function(){return $658ba0b07a4ec711$export$557110b7a952b643})),$parcel$export($658ba0b07a4ec711$exports,"Perf",(function(){return $658ba0b07a4ec711$export$c9cfdf8a66a4d2ca})),$parcel$export($658ba0b07a4ec711$exports,"Random",(function(){return $658ba0b07a4ec711$export$3333a050bfc0ada3})),$parcel$export($658ba0b07a4ec711$exports,"Container",(function(){return $658ba0b07a4ec711$export$84330cc577268f09})),$parcel$export($658ba0b07a4ec711$exports,"Linkable",(function(){return $658ba0b07a4ec711$export$65be554b6c5a5f69})),$parcel$export($658ba0b07a4ec711$exports,"PriorityQueue",(function(){return $658ba0b07a4ec711$export$85f86eb1fd7c7af5})),$parcel$export($658ba0b07a4ec711$exports,"Mask",(function(){return $658ba0b07a4ec711$export$26a09b3cc8d9d2df})),$parcel$export($658ba0b07a4ec711$exports,"TFunction",(function(){return $658ba0b07a4ec711$export$5bd07c235d380351})),$parcel$export($658ba0b07a4ec711$exports,"ShaderProgram",(function(){return $658ba0b07a4ec711$export$d1377b383b9c97b1})),$parcel$export($658ba0b07a4ec711$exports,"Handler",(function(){return $658ba0b07a4ec711$export$9603dc63f4b26676})),$parcel$export($658ba0b07a4ec711$exports,"Recycler",(function(){return $658ba0b07a4ec711$export$407f1fb841a9103c})),$parcel$export($658ba0b07a4ec711$exports,"Framebuffer",(function(){return $658ba0b07a4ec711$export$d803f74f26e64d17})),$parcel$export($658ba0b07a4ec711$exports,"Label",(function(){return $658ba0b07a4ec711$export$f439af0d78941234}));let $f70b3c308bc3df02$var$Rin={};var $f70b3c308bc3df02$export$9099ad97b570f7c=$f70b3c308bc3df02$var$Rin;$f70b3c308bc3df02$var$Rin.invokeLater=function(t){t&&setTimeout((function(){t()}),10)},$f70b3c308bc3df02$var$Rin.wait=function(t){return new Promise((function(e,r){setTimeout(e,t)}))},$f70b3c308bc3df02$var$Rin.typeOf=function(t){return t instanceof Array?"array":null===t?"null":(typeof t).toString().toLowerCase()},$f70b3c308bc3df02$var$Rin.isArrayOrObject=function(t){switch($f70b3c308bc3df02$var$Rin.typeOf(t)){case"array":case"object":return!0}return!1},$f70b3c308bc3df02$var$Rin.clone=function(t){let e=$f70b3c308bc3df02$var$Rin.typeOf(t);if("array"===e){e=[];for(let r=0;r<t.length;r++)e.push($f70b3c308bc3df02$var$Rin.clone(t[r]))}else if("object"===e){if("clone"in t&&"function"==typeof t.clone)return t.clone();e={};for(let r in t)e[r]=$f70b3c308bc3df02$var$Rin.clone(t[r])}else e=t;return e},$f70b3c308bc3df02$var$Rin.merge=function(t,...e){if("array"==$f70b3c308bc3df02$var$Rin.typeOf(t))for(let r=0;r<e.length;r++){let i=e[r];if("array"!=$f70b3c308bc3df02$var$Rin.typeOf(i))t.push(i);else for(let e=0;e<i.length;e++)t.push($f70b3c308bc3df02$var$Rin.clone(i[e]))}else if("object"==$f70b3c308bc3df02$var$Rin.typeOf(t))for(let r=0;r<e.length;r++){let i=e[r];if("object"==$f70b3c308bc3df02$var$Rin.typeOf(i))for(let e in i)$f70b3c308bc3df02$var$Rin.isArrayOrObject(i[e])?e in t?$f70b3c308bc3df02$var$Rin.merge(t[e],i[e]):t[e]=$f70b3c308bc3df02$var$Rin.clone(i[e]):t[e]=i[e]}return t},$f70b3c308bc3df02$var$Rin.override=function(t,...e){for(let r=0;r<e.length;r++)for(let i in e[r])t[i]=e[r][i];return t},$f70b3c308bc3df02$var$Rin.partialCompare=function(t,e){if(null==t||null==e)return!1;if(t===e)return!0;for(var r in e)if(t[r]!=e[r])return!1;return!0},$f70b3c308bc3df02$var$Rin.arrayFind=function(t,e,r){for(var i=0;t&&i<t.length;i++)if(this.partialCompare(t[i],e))return r?t[i]:i;return!!r&&null},$f70b3c308bc3df02$var$Rin.isInstanceOf=function(t,e){return!(!t||!e||"object"!=typeof t)&&(t instanceof e||"isInstanceOf"in t&&t.isInstanceOf(e))},$f70b3c308bc3df02$var$Rin.indexOf=function(t,e,r=!1){if(r){for(let r=0;r<t.length;r++)if(t[r]===e)return r;return-1}for(let r in t)if(t[r]===e)return r;return-1},$f70b3c308bc3df02$var$Rin.escape=function(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},$f70b3c308bc3df02$var$Rin.ensureTypeOf=function(t,e){return!e||!t||e instanceof t||e.isInstanceOf&&t.prototype.className&&e.isInstanceOf(t.prototype.className)?e:new t(e)},$f70b3c308bc3df02$var$Rin.serialize=function(t){return JSON.stringify(t)},$f70b3c308bc3df02$var$Rin.deserialize=function(t){return JSON.parse(t)},$f70b3c308bc3df02$var$Rin.hookAppend=function(t,e,r,i=!0){const a=t[e];return t[e]=i?function(...t){if(!1!==a.apply(this,t))return r.apply(this,t)}:function(...t){return a.apply(this,t),r.apply(this,t)},{unhook:function(){t[e]=a}}},$f70b3c308bc3df02$var$Rin.hookPrepend=function(t,e,r,i=!0){const a=t[e];return t[e]=i?function(...t){if(!1!==r.apply(this,t))return a.apply(this,t)}:function(...t){return r.apply(this,t),a.apply(this,t)},{unhook:function(){t[e]=a}}};let $41f1955d9972a7df$var$Class=function(){};var $41f1955d9972a7df$export$9099ad97b570f7c=$41f1955d9972a7df$var$Class;$41f1955d9972a7df$var$Class._class=$41f1955d9972a7df$var$Class,$41f1955d9972a7df$var$Class._super={},$41f1955d9972a7df$var$Class.prototype.className="Class",$41f1955d9972a7df$var$Class.prototype.__ctor=function(){},$41f1955d9972a7df$var$Class.prototype.__dtor=function(){},$41f1955d9972a7df$var$Class.prototype.isInstanceOf=function(t){return(t="string"===$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(t)?t:t.prototype?t.prototype.className:t.constructor.prototype.className)in this._super||this.className===t},$41f1955d9972a7df$var$Class.prototype._initSuperRefs=function(){let t=this.constructor._super,e={};const r=this;for(let i in t){let a={},n=t[i].prototype;for(let t in n)"function"===$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(n[t])&&(a[t]=function(t){return function(e,i,a,n,s,o,c,l,h,u,f){return t.call(r,e,i,a,n,s,o,c,l,h,u,f)}}(n[t]));e[i]=a}this._super=e},$41f1955d9972a7df$var$Class.inherit=function(t){let e=this._class,r=e._super,i=e._class;if("function"===$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(t)){for(let r in t._class)/^[A-Z]/.test(r)||(e[r]=t._class[r]);$f70b3c308bc3df02$export$9099ad97b570f7c.override(e.prototype,t._class.prototype),$f70b3c308bc3df02$export$9099ad97b570f7c.override(r,t._class._super),t._class.prototype.className&&(r[t._class.prototype.className]=t._class)}else $f70b3c308bc3df02$export$9099ad97b570f7c.override(e.prototype,t);return e._super=r,e._class=i,e},$41f1955d9972a7df$var$Class.prototype._extend=function(t,e){if(0===e.length)return t;const r=function(...t){this._initSuperRefs(),this.__ctor.apply(this,t)};r._class=r,r._super={},$41f1955d9972a7df$var$Class.inherit.call(r,t),delete r.prototype.className;for(let t=0;t<e.length;t++)r.inherit(e[t]);return delete r._super.Class,"classInit"in r.prototype&&r.prototype.classInit(),r.isInstance=function(t){return $f70b3c308bc3df02$export$9099ad97b570f7c.isInstanceOf(t,r)},r},$41f1955d9972a7df$var$Class.extend=function(...t){return this._class.prototype._extend(this,t)},$41f1955d9972a7df$var$Class.create=function(t){return new(this.extend(t))};var $bd56c52937d4e38f$export$9099ad97b570f7c=$41f1955d9972a7df$export$9099ad97b570f7c.extend({className:"Event",source:null,name:null,args:null,_async:!1,list:null,next:null,ret:null,original:null,i:-1,__ctor:function(t,e,r,i,a,n){this.source=t,this.name=r,this.args=i,this.cbHandler=a,this.cbContext=n,this.list=e,this.reset()},reset:function(){return this.next=null,this.ret=[],this._async=!1,this.i=-1,this},setSource:function(t){return this.source=t,this},wait:function(){return this._async=!0,this},resume:function(){for(this._async=!1;!(this._async||++this.i>=this.list.length);)if(!this.list[this.i].silent)if("string"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(this.list[this.i].handler)){if(this.list[this.i].context){if(!this.list[this.i].context[this.list[this.i].handler])continue;if(!1===this.list[this.i].context[this.list[this.i].handler](this,this.args,this.list[this.i].data))break}else if(!1===$parcel$global[this.list[this.i].handler].call(null,this,this.args,this.list[this.i].data))break}else if(!1===this.list[this.i].handler.call(this.list[this.i].context,this,this.args,this.list[this.i].data))break;return this._async||(this.i>=this.list.length&&this.next&&this.next.resume(),this.cbHandler&&this.cbHandler.call(this.cbContext)),this},from:function(t){return this.original=t,this},enqueue:function(t){if(!t)return this;var e;for(e=this;null!=e.next;e=e.next);return e.next=t,t.from(this),this}}),$f5fde1039ebdba85$export$9099ad97b570f7c=$41f1955d9972a7df$export$9099ad97b570f7c.extend({className:"EventDispatcher",listeners:null,namespace:null,__ctor:function(){this.listeners={}},setNamespace:function(t){return this.namespace=t,this},addEventListener:function(t,e,r,i){var a=(t=t.split(":"))[t.length-1],n=t.length>1?t[0]:null;return this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push({ns:n,handler:e,context:r,data:i,silent:0}),this},removeEventListener:function(t,e,r){var i=(t=t.split(":"))[t.length-1],a=t.length>1?t[0]:null;if("*"==i)for(var n in this.listeners)for(var s=this.listeners[n],o=0;o<s.length;o++){var c=!0;e&&(c=c&&s[o].handler===e),r&&(c=c&&s[o].context===r),a&&(c=c&&s[o].ns==a),c&&s.splice(o--,1)}else{if(!this.listeners[i])return this;for(s=this.listeners[i],o=0;o<s.length;o++){c=!0;e&&(c=c&&s[o].handler===e),r&&(c=c&&s[o].context===r),a&&(c=c&&s[o].ns==a),c&&s.splice(o--,1)}}return this},prepareEvent:function(t,e,r,i){var a=[],n=(t=t.split(":"))[t.length-1],s=t.length>1?t[0]:null;this.listeners[n]&&(a=a.concat(this.listeners[n])),this.listeners["*"]&&(a=a.concat(this.listeners["*"]));for(var o=0;o<a.length;o++)a[o].silent&&a.splice(o--,1);if(s)for(o=0;o<a.length;o++)a[o].ns!=s&&a.splice(o--,1);return new $bd56c52937d4e38f$export$9099ad97b570f7c(this,a,n,e,r,i)},silence:function(t,e){var r=(t=t.split(":"))[t.length-1],i=t.length>1?t[0]:null;if(e=!1===e?-1:1,"*"==r)for(var a in this.listeners)for(var n=this.listeners[a],s=0;s<n.length;s++)i&&n[s].ns!=i||(n[s].silent+=e);else{if(!this.listeners[r])return this;for(n=this.listeners[r],s=0;s<n.length;s++)i&&n[s].ns!=i||(n[s].silent+=e)}return this},dispatchEvent:function(t,e,r,i){return this.prepareEvent(this.namespace?this.namespace+":"+t:t,e,r,i).resume()}});parcelRequire.register("heikV",(function(module,exports){$parcel$export(module.exports,"default",(function(){return $c8b1f7b6d285e2db$export$9099ad97b570f7c}));var $chJox=parcelRequire("chJox"),$c8b1f7b6d285e2db$export$9099ad97b570f7c={_getref:function(value,obj){return"string"==typeof value?("#"==value.substr(0,1)?value=obj.get(value.substr(1)):"@"==value.substr(0,1)&&(value=obj[value.substr(1)]),"string"==typeof value?eval(value):value):value},type:function(t,e,r,i){switch(e){case"int":if(i=parseInt(i),isNaN(i))throw new Error(e);break;case"float":if(i=parseFloat(i),isNaN(i))throw new Error(e);break;case"string":i=null==i?"":i.toString();break;case"bit":if(!0===i||!1===i){i=i?1:0;break}if(i=parseInt(i),isNaN(i))throw new Error(e);i=i?1:0;break;case"array":if("array"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(i))break;if(null==i){i=[];break}throw new Error(e);case"bool":if("true"===i||!0===i){i=!0;break}if("false"===i||!1===i){i=!1;break}throw new Error(e)}return i},model:function(t,e,r,i){var a=this._getref(e,t);if(!a)throw new Error(e);return i?a.ensure(i):new a},cls:function(t,e,r,i){var a=this._getref(e,t);return i?$f70b3c308bc3df02$export$9099ad97b570f7c.ensureTypeOf(a,i):new a},arrayof:function(t,e,r,i){var a=this._getref(e,t);if(i||(i=[]),!a||"array"!=$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(i))throw new Error(e);for(var n=0;n<i.length;n++)i[n]=$f70b3c308bc3df02$export$9099ad97b570f7c.ensureTypeOf(a,i[n]);return i},arraynull:function(t,e,r,i){var a=!1;if("object"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(e)&&(e.remove&&(a=e.remove),e=e.value),e)return i;if("array"!=$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(i))throw new Error(e);for(var n=0;n<i.length;n++)if(null==i[n]){if(!a)throw new Error(e);i.splice(n--,1)}return i},arraycompliant:function(t,e,r,i){var a=!1;if("object"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(e)&&(e.remove&&(a=e.remove),e=e.value),!e)return i;if("array"!=$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(i))throw new Error(e);for(var n=0;n<i.length;n++)if(null!=i[n]&&!i[n].isCompliant()){if(!a)throw new Error(e);i.splice(n--,1)}return i},required:function(t,e,r,i){if(null==i)throw new Error(e?"":"null");if("array"===$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(i)){if(0==i.length)throw new Error(e?"":"null")}else if(0==i.toString().length)throw new Error(e?"":"null");return i},minlen:function(t,e,r,i){if(i.toString().length<e)throw new Error(e);return i},maxlen:function(t,e,r,i){if(i.toString().length>e)throw new Error(e);return i},minval:function(t,e,r,i){if(parseFloat(i)<e)throw new Error(e);return i},maxval:function(t,e,r,i){if(parseFloat(i)>e)throw new Error(e);return i},mincount:function(t,e,r,i){if("array"!=$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(i)||i.length<e)throw new Error(e);return i},maxcount:function(t,e,r,i){if("array"!=$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(i)||i.length>e)throw new Error(e);return i},pattern:function(t,e,r,i){if(!$chJox.default[e].test(i.toString()))throw new Error(e);return i},inset:function(t,e,r,i){if("array"!=$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(e)){if(!new RegExp("^("+e.toString()+")$").test(i.toString()))throw new Error(e);return i}if(-1==e.indexOf(i.toString()))throw new Error(e.join("|"));return i},upper:function(t,e,r,i){return e?i.toString().toUpperCase():i},lower:function(t,e,r,i){return e?i.toString().toLowerCase():i}}})),parcelRequire.register("chJox",(function(t,e){$parcel$export(t.exports,"default",(function(){return r}));var r={email:/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)+$/i,url:/^[\w-]+:\/\/[\w-]+(\.\w+)+.*$/,urlNoProt:/^[\w-]+(\.\w+)+.*$/,name:/^[-A-Za-z0-9_.]+$/,uname:/^['\pL\pN ]+$/,text:/^[^&<>{}]*$/,utext:/^([\r\n\pL\pN\pS &!@#$%*\[\]()_+=;',.\/?:"~-]+)$/}}));var $heikV=parcelRequire("heikV");let $63113af07f0cfd15$var$_Model=$f5fde1039ebdba85$export$9099ad97b570f7c.extend({className:"Model",defaults:null,constraints:null,data:null,changedList:null,_silent:0,_level:0,__ctor:function(t,e){if(this._super.EventDispatcher.__ctor(),this.data={},null!=e)this.reset(e,!1);else{let t=null;if(!this.defaults&&this.constraints){t={};for(let e in this.constraints){let r=this.constraints[e];null!==r.def&&void 0!==r.def?"function"==typeof r.def?t[e]=r.def():t[e]=r.def:t[e]=null}}this.reset(t)}this.init(),null!=t&&this.set(t,!0),this.constraints&&this.update(),this.ready()},reset:function(t,e){if(!this.defaults){if(!t||"object"!==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(t)&&"function"!==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(t))return this;this.defaults=t}return"function"===$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(this.defaults)?this.data=this.defaults():this.data=$f70b3c308bc3df02$export$9099ad97b570f7c.clone(this.defaults),!1===e||!1===t?this:this.update(null,!0)},init:function(){},ready:function(){},silent:function(t){return this._silent+=t?1:-1,this},_validate:function(t,e){if(!this.constraints||!this.constraints[t])return e;var r=this.constraints[t],i=e;for(var a in r)if($63113af07f0cfd15$var$_Model.Constraints[a])try{i=$63113af07f0cfd15$var$_Model.Constraints[a](this,r[a],t,i)}catch(e){if("null"==e.message)break;throw new Error(`Constraint [${a}:${r[a]}] failed on property '${t}'.`)}return i},_set:function(t,e){if(!this.constraints||!this.constraints[t])return this.data[t]=e,e;var r=this.constraints[t],i=(this.data[t],e);for(var a in r)if($63113af07f0cfd15$var$_Model.Constraints[a])try{i=$63113af07f0cfd15$var$_Model.Constraints[a](this,r[a],t,i)}catch(r){if("null"==r.message)break;this._silent||this.dispatchEvent("constraintError",{constraint:a,message:r.message,name:t,value:e});break}return this.data[t]=i},_propertyEvent:function(t,e,r,i){var a={name:t,old:e,value:r,level:this._level},n=this.dispatchEvent("propertyChanging",a);i?this.data[t]=a.value:a.value=this._set(t,a.value),null!=n&&n.ret.length&&!1===n.ret[0]||(this.dispatchEvent("propertyChanged."+t,a),this.dispatchEvent("propertyChanged",a),this.changedList.push(t))},set:function(){var t=arguments.length,e=!1,r=!1;if((t>2||2==t&&"object"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(arguments[0]))&&"boolean"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(arguments[t-1])&&!1===(e=arguments[--t])&&(r=!0),0==this._level&&(this.changedList=[]),this._level++,2==t)(this.data[arguments[0]]!=arguments[1]||e)&&(this._silent||r?this._set(arguments[0],arguments[1]):this._propertyEvent(arguments[0],this.data[arguments[0]],this._validate(arguments[0],arguments[1])));else for(var i in arguments[0])(this.data[i]!=arguments[0][i]||e)&&(this._silent||r?this._set(i,arguments[0][i]):this._propertyEvent(i,this.data[i],this._validate(i,arguments[0][i])));return--this._level||!this.changedList.length||r||this._silent||this.dispatchEvent("modelChanged",{fields:this.changedList}),this},has:function(t){return t in this.data},get:function(t,e){return 0==arguments.length||!1===t?this.data:1==arguments.length&&!0===t?this.flatten():2==arguments.length&&void 0===this.data[t]?e:this.data[t]},getInt:function(t,e){return 2==arguments.length&&void 0===this.data[t]?e:parseInt(this.data[t])},getFloat:function(t,e){return 2==arguments.length&&void 0===this.data[t]?e:parseFloat(this.data[t])},getBool:function(t,e){return"true"===(t=2==arguments.length&&void 0===this.data[t]?e:this.data[t])||!0===t||"false"!==t&&!1!==t&&!!parseInt(t)},getReference:function(t){var e=this;return{get:function(){return e.get(t)},set:function(r){e.set(t,r)}}},constraint:function(t,e,r){if(3==arguments.length||2==arguments.length||1==arguments.length&&"object"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(t)){switch(this.constraints===this.constructor.prototype.constraints&&(this.constraints=$f70b3c308bc3df02$export$9099ad97b570f7c.clone(this.constraints)),arguments.length){case 1:$f70b3c308bc3df02$export$9099ad97b570f7c.override(this.constraints,t);break;case 2:$f70b3c308bc3df02$export$9099ad97b570f7c.override(this.constraints[t],e);break;case 3:this.constraints[t][e]=r}return this}return t?this.constraints[t]:this},flatten:function(t,e){if(t)return null==(a=this.flatten(!1,!0))?null:(a.class=this.classPath,a);if(!this.constraints&&!this.defaults)return this.data;if(!this.isCompliant())return{};var r=this.constraints,i=this.defaults?"function"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(this.defaults)?this.defaults():this.defaults:this.constraints,a={};for(var n in this.data)if(n in i){if(r&&r[n]){var s=r[n];if(s.model){a[n]=this.data[n]?this.data[n].flatten(e):null;continue}if(s.arrayof){a[n]=[];for(var o=0;o<this.data[n].length;o++)a[n][o]=this.data[n][o]?this.data[n][o].flatten(e):null;continue}if(s.cls){a[n]=this.data[n]?this.data[n].flatten():null;continue}}a[n]=this.data[n]}return a},remove:function(t,e){if("array"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(t)){for(var r=0;r<t.length;r++)delete this.data[t[r]];!1===e||this._silent||this.dispatchEvent("propertyRemoved",{fields:t})}else delete this.data[t],!1===e||this._silent||this.dispatchEvent("propertyRemoved",{fields:[t]})},update:function(t,e){if(this._silent)return this;if(0==this._level&&(this.changedList=[]),this._level++,t&&"string"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(t))this._propertyEvent(t,this.data[t],this.data[t],e);else if(t&&"array"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(t))for(var r of t)this._propertyEvent(r,this.data[r],this.data[r],e);else for(var r in this.data)this._propertyEvent(r,this.data[r],this.data[r],e);return--this._level||this._silent||0==this.changedList.length&&!0!==t||this.dispatchEvent("modelChanged",{fields:this.changedList}),this},validate:function(t){if(!this.constraints)return this;if(t&&"string"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(t))this._set(t,this.data[t]);else for(var e in this.data)t&&-1==$f70b3c308bc3df02$export$9099ad97b570f7c.indexOf(t,e)||this._set(e,this.data[e]);return this},isCompliant:function(){if(!this.constraints)return!0;try{for(var t in this.data)this._validate(t,this.data[t]);return!0}catch(t){}return!1},observe:function(t,e,r){this.addEventListener("propertyChanged."+t,e,r)},unobserve:function(t,e,r){this.removeEventListener("propertyChanged."+t,e,r)},watch:function(t,e){1==(t=t.split(":")).length&&(t[1]=t[0],t[0]="watch"),this.addEventListener(t[0]+":propertyChanged."+t[1],(function(t,r){e(r.value,r,t)}))},unwatch:function(t){1==(t=t.split(":")).length&&(t[1]=t[0],t[0]="watch"),this.removeEventListener(t[0]+":propertyChanged."+t[1])},toString:function(){return $f70b3c308bc3df02$export$9099ad97b570f7c.serialize(this.get(!0))}});$63113af07f0cfd15$var$_Model.Constraints=$heikV.default;var $63113af07f0cfd15$export$9099ad97b570f7c=$63113af07f0cfd15$var$_Model,$da4ff10c088cd9b3$export$9099ad97b570f7c=$63113af07f0cfd15$export$9099ad97b570f7c.extend({className:"ModelList",itemt:$63113af07f0cfd15$export$9099ad97b570f7c,contents:null,itemId:null,nextId:null,defaults:{contents:null},constraints:{contents:{type:"array",arrayof:"@itemt"}},__ctor:function(...t){this.itemId=[],this.nextId=0,this._super.Model.__ctor(...t)},ready:function(){this._eventGroup="ModelList_"+Date.now()+":modelChanged",this.contents=this.data.contents},_bind:function(t,e){return e&&e.addEventListener&&e.addEventListener(this._eventGroup,this._onItemEvent,this,t),e},_unbind:function(t){return t&&t.removeEventListener&&t.removeEventListener(this._eventGroup),t},_onItemEvent:function(t,e,r){this.prepareEvent("itemChanged",{id:r,item:t.source}).from(t).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume()},length:function(){return this.data.contents.length},clear:function(){for(var t=0;t<this.data.contents;t++)this._unbind(this.data.contents[t]);return this.itemId=[],this.nextId=0,this.contents=this.data.contents=[],this.prepareEvent("itemsCleared").enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),this},setData:function(t){if(this.clear(),!t)return this;for(var e=0;e<t.length;e++){var r=$f70b3c308bc3df02$export$9099ad97b570f7c.ensureTypeOf(this.itemt,t[e]);this.itemId.push(this.nextId++),this.data.contents.push(r),this._bind(this.nextId-1,r)}return this.prepareEvent("itemsChanged").enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),this},getData:function(){return this.data.contents},getAt:function(t){return t<0||t>=this.data.contents.length?null:this.data.contents[t]},removeAt:function(t){if(t<0||t>=this.data.contents.length)return null;let e=this.data.contents.splice(t,1)[0],r=this.itemId.splice(t,1)[0];return this._unbind(e),this.prepareEvent("itemRemoved",{id:r,item:e}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),e},setAt:function(t,e){return!(t<0||t>=this.data.contents.length)&&(e=$f70b3c308bc3df02$export$9099ad97b570f7c.ensureTypeOf(this.itemt,e),this._unbind(this.data.contents[t]),this.data.contents[t]=e,this._bind(this.itemId[t],e),this.prepareEvent("itemChanged",{id:this.itemId[t],item:e}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),!0)},updateAt:function(t){return!(t<0||t>=this.data.contents.length)&&(this.prepareEvent("itemChanged",{id:this.itemId[t],item:this.data.contents[t]}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),!0)},push:function(t){return t&&"object"!=$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(t)?null:(t=$f70b3c308bc3df02$export$9099ad97b570f7c.ensureTypeOf(this.itemt,t),this.itemId.push(this.nextId++),this.data.contents.push(t),this._bind(this.nextId-1,t),this.prepareEvent("itemAdded",{id:this.itemId[this.itemId.length-1],item:t,position:"tail"}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),t)},pop:function(){return this._unbind(this.data.contents.pop())},unshift:function(t){return t&&"object"!=$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(t)?null:(t=$f70b3c308bc3df02$export$9099ad97b570f7c.ensureTypeOf(this.itemt,t),this.itemId.unshift(this.nextId++),this.data.contents.unshift(t),this._bind(this.nextId-1,t),this.prepareEvent("itemAdded",{id:this.itemId[0],item:t,position:"head"}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),t)},shift:function(){return this._unbind(this.data.contents.shift())},find:function(t,e){for(var r=this.data.contents,i=0;i<r.length;i++)if($f70b3c308bc3df02$export$9099ad97b570f7c.partialCompare(r[i].data,t))return e?r[i]:i;return e?null:-1}});let $a30f62347d183f8b$var$Schema={Type:function(t){let e={flatten:function(t,e){return t},unflatten:function(t,e){return t}};return t?$f70b3c308bc3df02$export$9099ad97b570f7c.override(e,t):e},String:function(){return $a30f62347d183f8b$var$Schema.Type({flatten:function(t,e){return null!=t?t.toString():null},unflatten:function(t,e){return null!=t?t.toString():null}})},Integer:function(){return $a30f62347d183f8b$var$Schema.Type({flatten:function(t,e){return~~t},unflatten:function(t,e){return~~t}})},Number:function(t){return $a30f62347d183f8b$var$Schema.Type({_precision:t,_round:!1,precision:function(t){return this._precision=~~t,this},flatten:function(t,e){return t=parseFloat(t),this._precision>0&&(t=~~(t*Math.pow(10,this._precision))/Math.pow(10,this._precision)),t},unflatten:function(t,e){return parseFloat(t)}})},Bool:function(t){return $a30f62347d183f8b$var$Schema.Type({_compact:t,compact:function(t){return this._compact=t,this},flatten:function(t,e){return t=~~t,this._compact?t>0?1:0:t>0},unflatten:function(t,e){return!!~~t}})},SharedString:function(){return $a30f62347d183f8b$var$Schema.Type({flatten:function(t,e){return null==t?0:(t=t.toString(),"strings"in e||(e.strings_map={},e.strings=[]),t in e.strings_map||(e.strings.push(t),e.strings_map[t]=e.strings.length),e.strings_map[t])},unflatten:function(t,e){return null==t||0==t?null:e.strings[~~t-1]}})},Array:function(t){return $a30f62347d183f8b$var$Schema.Type({itemType:t,_debug:!1,debug:function(t){return this._debug=t,this},of:function(t){return this.itemType=t,this},flatten:function(t,e){if(null==t)return null;let r=[];for(let i=0;i<t.length;i++)r.push(this.itemType.flatten(t[i],e));return r},unflatten:async function(t,e){if(null==t)return null;let r=[];for(let i=0;i<t.length;i++)r.push(await this.itemType.unflatten(t[i],e));return r}})},Object:function(){return $a30f62347d183f8b$var$Schema.Type({properties:[],property:function(t,e,r=null){return this.properties.push({name:t,type:e,defvalue:r}),this},flatten:function(t,e){if(null==t)return null;let r;if(!0===e.symbolic){r={};for(let i=0;i<this.properties.length;i++)r[this.properties[i].name]=this.properties[i].type.flatten(t[this.properties[i].name],e)}else{r=[];for(let i=0;i<this.properties.length;i++)r.push(this.properties[i].type.flatten(t[this.properties[i].name],e))}return r},unflatten:async function(t,e){if(null==t)return null;let r={};if(!0===e.symbolic)for(let i=0;i<this.properties.length;i++)r[this.properties[i].name]=await this.properties[i].type.unflatten(this.properties[i].name in t?t[this.properties[i].name]:this.properties[i].defvalue,e);else for(let i=0;i<this.properties.length;i++)r[this.properties[i].name]=await this.properties[i].type.unflatten(i in t?t[i]:this.properties[i].defvalue,e);return r}})},Class:function(t){return $a30f62347d183f8b$var$Schema.Type({_constructor:t,constructor:function(t){return this._constructor=t,this},flatten:function(t,e){return null==t?null:t.flatten(e)},unflatten:async function(t,e){return null==t?null:await(new this._constructor).unflatten(t,e)}})},Property:function(t,e){return $a30f62347d183f8b$var$Schema.Type({property:t,type:e,name:function(t){return this.property=t,this},is:function(t){return this.type=t,this},flatten:function(t,e){if(null==t)return null;let r;return!0===e.symbolic?(r={},r[this.property]=this.type.flatten(t[this.property],e)):r=this.type.flatten(t[this.property],e),r},unflatten:async function(t,e){if(null==t)return null;let r={};return!0===e.symbolic?r[this.property]=await this.type.unflatten(t[this.property],e):r[this.property]=await this.type.unflatten(t,e),r}})},Map:function(){return $a30f62347d183f8b$var$Schema.Type({flatten:function(t,e){if(null==t)return null;if(!0===e.symbolic)return t;let r=[];for(let e in t)r.push(e),r.push(t[e]);return r},unflatten:function(t,e){if(null==t)return null;if(!0===e.symbolic)return t;let r={};for(let e=0;e<t.length;e+=2)r[t[e]]=t[e+1];return r}})}};var $a30f62347d183f8b$export$9099ad97b570f7c=$a30f62347d183f8b$var$Schema,$ee066408d437af8a$export$9099ad97b570f7c=$41f1955d9972a7df$export$9099ad97b570f7c.extend({className:"Flattenable",typeSchema:null,flatten:function(t){return this.typeSchema.flatten(this,t)},unflatten:async function(t,e){return Object.assign(this,await this.typeSchema.unflatten(t,e)),await this.onUnflattened(),this},onUnflattened:async function(){}}),$88f5f771adc8dd76$export$9099ad97b570f7c=$ee066408d437af8a$export$9099ad97b570f7c.extend({className:"Collection",itemTypeSchema:null,items:null,__ctor:function(t){t||(t=this.itemTypeSchema),t&&(this.typeSchema=$a30f62347d183f8b$export$9099ad97b570f7c.Property("items").is($a30f62347d183f8b$export$9099ad97b570f7c.Array().of(t))),this.reset()},onUnflattened:function(){let t=this.items;this.reset();for(let e of t)this.add(e)},reset:function(){return this.items=[],this},clear:function(){var t=this.items;this.reset();for(var e=0;e<t.length;e++)this.onItemRemoved(t[e],0);return this},sort:function(t,e){return"function"!=typeof t?this.items.sort((function(r,i){return(r[t]<=i[t]?-1:1)*(!0===e?-1:1)})):this.items.sort(t),this},findItem:function(t,e){if(!this.items)return null;for(var r=0;r<this.items.length;r++)if((!e||!$f70b3c308bc3df02$export$9099ad97b570f7c.partialCompare(this.items[r],e))&&$f70b3c308bc3df02$export$9099ad97b570f7c.partialCompare(this.items[r],t))return this.items[r];return null},getItems:function(){return this.items},length:function(){return this.items.length},isEmpty:function(){return!this.items.length},indexOf:function(t){return this.items.indexOf(t)},getAt:function(t,e=!1){return t<0&&1==e&&(t+=this.items.length),t>=0&&t<this.items.length?this.items[t]:null},first:function(){return this.getAt(0)},last:function(){return this.getAt(-1,!0)},addAt:function(t,e){if(!e||!this.onBeforeItemAdded(e))return this;if(t<0&&(t=0),t>this.items.length&&(t=this.items.length),0==t)this.items.unshift(e);else if(t==this.items.length)this.items.push(e);else{var r=this.items.splice(0,t);r.push(e),this.items=r.concat(this.items)}return this.onItemAdded(e),this},unshift:function(t){return this.addAt(0,t)},push:function(t){return this.addAt(this.items.length,t)},add:function(t){return this.push(t)},removeAt:function(t,e=!1){if(t<0&&1==e&&(t+=this.items.length),t<0||t>=this.items.length)return null;var r=this.items[t];return this.items.splice(t,1),this.onItemRemoved(r,t),r},pop:function(t){return this.removeAt(-1,!0)},shift:function(t){return this.removeAt(0)},remove:function(t){return this.removeAt(this.indexOf(t))},forEach:function(t){if(this.isEmpty())return this;for(var e=0;e<this.items.length&&!1!==t(this.items[e],e,this);e++);return this},forEachCall:function(t,...e){if(this.isEmpty())return this;for(var r=0;r<this.items.length&&!1!==this.items[r][t](...e);r++);return this},forEachRev:function(t){if(this.isEmpty())return this;for(var e=this.items.length-1;e>=0&&!1!==t(this.items[e],e,this);e--);return this},forEachRevCall:function(t,...e){if(this.isEmpty())return this;for(var r=this.items.length-1;r>=0&&!1!==this.items[r][t](...e);r--);return this},onBeforeItemAdded:function(t){return!0},onItemAdded:function(t){},onItemRemoved:function(t){}});let $f0aa03ebc62e822b$var$Template={strict:!1,parseTemplate:function(t,e,r,i=!1,a=1){let n="string",s=null,o=0,c=0,l="",h=[],u=h,f=!1;function d(t,i){if("template"==t?i=$f0aa03ebc62e822b$var$Template.parseTemplate(i,e,r,!0,0):"parse"==t?(i=$f0aa03ebc62e822b$var$Template.parseTemplate(i,e,r,!1,0),t="base-string","array"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(i)&&(t=i[0].type,i=i[0].data)):"parse-trim-merge"==t?i=$f0aa03ebc62e822b$var$Template.parseTemplate(i.trim().split("\n").map((t=>t.trim())).join("\n"),e,r,!1,0):"parse-merge"==t?i=$f0aa03ebc62e822b$var$Template.parseTemplate(i,e,r,!1,0):"parse-merge-alt"==t&&(i=$f0aa03ebc62e822b$var$Template.parseTemplate(i,"{","}",!1,0)),"parse-merge"==t||"parse-merge-alt"==t||"parse-trim-merge"==t)for(let t=0;t<i.length;t++)h.push(i[t]);else h.push({type:t,data:i});f&&(u.push(h=[]),f=!1)}!0===i&&(t=t.trim(),n="identifier",o=10,u.push(h=[])),t+="\0";for(let i=0;i<t.length;i++)if("\\"!=t[i]){switch(o){case 0:"\0"==t[i]?s="string":t[i]==e&&"<"==t[i+1]?(o=1,c=1,s="string",n="parse-merge"):t[i]==e&&"@"==t[i+1]?(o=1,c=1,s="string",n="parse-trim-merge",i++):t[i]==e&&":"==t[i+1]?(o=12,c=1,s="string",n="string",i++):t[i]==e?(o=1,c=1,s="string",n="template"):l+=t[i];break;case 1:if("\0"==t[i])throw new Error("Parse error: Unexpected end of template");if(t[i]==r){if(c--,c<0)throw new Error("Parse error: Unmatched "+r);if(0==c){o=0,s=n;break}}else t[i]==e&&c++;l+=t[i];break;case 10:if("\0"==t[i]){s=n;break}if("."==t[i]){d(n,l),d("access","."),n="identifier",l="";break}if(null!=t[i].match(/[\t\n\r\f\v ]/)){for(s=n,n="identifier",f=!0;null!=t[i].match(/[\t\n\r\f\v ]/);)i++;i--;break}if(t[i]==e&&"<"==t[i+1]){l&&(s=n),o=11,c=1,n="parse-merge";break}if(t[i]==e&&"@"==t[i+1]){l&&(s=n),o=11,c=1,n="parse-trim-merge",i++;break}if('"'==t[i]){l&&(s=n),o=14,c=1,n="parse-merge";break}if("'"==t[i]){l&&(s=n),o=15,c=1,n="parse-merge";break}if("`"==t[i]){l&&(s=n),o=16,c=1,n="parse-merge-alt";break}if(t[i]==e&&":"==t[i+1]){l&&(s=n),o=13,c=1,n="string",i++;break}if(t[i]==e){l&&d(n,l),o=11,c=1,l="",n="parse",l+=t[i];break}"identifier"!=n&&(d(n,l),l="",n="identifier"),l+=t[i];break;case 11:if("\0"==t[i])throw new Error("Parse error: Unexpected end of template");if(t[i]==r){if(c--,c<0)throw new Error("Parse error: Unmatched "+r);if(0==c&&(o=10,"parse-merge"==n||"parse-merge-alt"==n||"parse-trim-merge"==n))break}else t[i]==e&&c++;l+=t[i];break;case 12:if("\0"==t[i])throw new Error("Parse error: Unexpected end of template");if(t[i]==r){if(c--,c<0)throw new Error("Parse error: Unmatched "+r);if(0==c){0!=l.length&&"<"!=l[0]&&"["!=l[0]&&" "!=l[0]&&(l=e+l+r),o=0,s=n;break}}else t[i]==e&&c++;l+=t[i];break;case 13:if("\0"==t[i])throw new Error("Parse error: Unexpected end of template");if(t[i]==r){if(c--,c<0)throw new Error("Parse error: Unmatched "+r);if(0==c){"<"!=l[0]&&"["!=l[0]&&" "!=l[0]&&(l=e+l+r),o=10;break}}else t[i]==e&&c++;l+=t[i];break;case 14:if("\0"==t[i])throw new Error("Parse error: Unexpected end of template");if('"'==t[i]){if(c--,c<0)throw new Error('Parse error: Unmatched "');if(0==c&&(o=10,"parse-merge"==n||"parse-merge-alt"==n||"parse-trim-merge"==n))break}l+=t[i];break;case 15:if("\0"==t[i])throw new Error("Parse error: Unexpected end of template");if("'"==t[i]){if(c--,c<0)throw new Error("Parse error: Unmatched '");if(0==c&&(o=10,"parse-merge"==n||"parse-merge-alt"==n||"parse-trim-merge"==n))break}l+=t[i];break;case 16:if("\0"==t[i])throw new Error("Parse error: Unexpected end of template");if("`"==t[i]){if(c--,c<0)throw new Error("Parse error: Unmatched `");if(0==c&&(o=10,"parse-merge"==n||"parse-merge-alt"==n||"parse-trim-merge"==n))break}l+=t[i]}s&&(d(s,l),s=l="")}else l+="\\",l+=t[++i];if(!i){let t=0;for(;t<u.length&&"string"==u[t].type&&""==u[t].data;)u.splice(t,1);for(t=u.length-1;t>0&&"string"==u[t].type&&""==u[t].data;)u.splice(t--,1);0==u.length&&u.push({type:"string",data:""})}return a&&function t(e){if("object"==typeof e){if(e instanceof Array)for(let r=0;r<e.length;r++)t(e[r]);else e.data=t(e.data);return e}for(let t=0;t<e.length;t++)if("\\"==e[t]){let r=e[t+1];switch(r){case"n":r="\n";break;case"r":r="\r";break;case"f":r="\f";break;case"v":r="\v";break;case"t":r="\t";break;case"s":r="s";break;case'"':r='"';break;case"'":r="'"}e=e.substr(0,t)+r+e.substr(t+2)}return e}(u),u},parse:function(t){return this.parseTemplate(t.trim(),"[","]",!1)},clean:function(t){for(let e=0;e<t.length;e++)"template"!=t[e].type&&(t.splice(e,1),e--);return t},expand:function(t,e,r="text",i="base-string"){let a=[];if("var"==i){let r=!0,i=!1,n=e,s=null,o=!0,c="";for(let a=0;a<t.length&&null!=e;a++)switch(t[a].type){case"identifier":case"string":c+=t[a].data,s=null;break;case"template":s=this.expand(t[a].data,n,"arg","template"),c+="object"!=typeof s?s:"";break;case"base-string":c+=this.expand(t[a].data,n,"arg","base-string"),s=null;break;case"access":if(s&&"object"==typeof s)e=s;else{for(""==c&&(c="this");;)if("!"==c[0])c=c.substr(1),r=!1;else{if("$"!=c[0])break;c=c.substr(1),i=!0}if("this"!=c&&null!=e){let t=e;null===(e=c in e?e[c]:null)&&o&&c in $f0aa03ebc62e822b$var$Template.functions&&(e=$f0aa03ebc62e822b$var$Template.functions[c](null,null,t)),o=!1}}c=""}for(;""!=c;)if("!"==c[0])c=c.substr(1),r=!1;else{if("$"!=c[0])break;c=c.substr(1),i=!0}if("this"!=c){let r=!1;if(null!=e?c in e?e=e[c]:(r=!0,e=null):r=!0,r&&1==t.length&&1==$f0aa03ebc62e822b$var$Template.strict)throw new Error("Expression function `"+c+"` not found.")}"string"==typeof e&&(r&&(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),i&&(e='"'+e+'"')),a.push(e)}if("varref"==r){let r=e,i=null,a=!0,n="";for(let s=0;s<t.length&&null!=e;s++)switch(t[s].type){case"identifier":case"string":n+=t[s].data,i=null;break;case"template":i=this.expand(t[s].data,r,"arg","template"),n+="object"!=typeof i?i:"";break;case"base-string":n+=this.expand(t[s].data,r,"arg","base-string"),i=null;break;case"access":if(i&&"object"==typeof i)e=i;else{for(""==n&&(n="this");;)if("!"==n[0])n=n.substr(1);else{if("$"!=n[0])break;n=n.substr(1)}if("this"!=n&&null!=e){let t=e;null===(e=n in e?e[n]:null)&&a&&n in $f0aa03ebc62e822b$var$Template.functions&&(e=$f0aa03ebc62e822b$var$Template.functions[n](null,null,t)),a=!1}}n=""}for(;""!=n;)if("!"==n[0])n=n.substr(1);else{if("$"!=n[0])break;n=n.substr(1)}return"this"!=n?[e,n]:null}if("fn"==i){var n=[];if(n.push($f0aa03ebc62e822b$var$Template.expand(t[0],e,"text","base-string")),"_"+n[0]in $f0aa03ebc62e822b$var$Template.functions&&(n[0]="_"+n[0]),!(n[0]in $f0aa03ebc62e822b$var$Template.functions)){if(1==$f0aa03ebc62e822b$var$Template.strict)throw new Error("Expression function `"+n[0]+"` not found.");return`(Unknown: ${n[0]})`}if("_"==n[0][0])return $f0aa03ebc62e822b$var$Template.functions[n[0]](t,e);for(let r=1;r<t.length;r++)n.push($f0aa03ebc62e822b$var$Template.expand(t[r],e,"arg","base-string"));a.push($f0aa03ebc62e822b$var$Template.functions[n[0]](n,t,e))}if("template"==i){if(1==t.length){if(1==t[0].length&&"string"==t[0][0].type)return t[0][0].data;if(1==t[0].length&&"identifier"==t[0][0].type){let i=t[0][0].data;if(i in $f0aa03ebc62e822b$var$Template.functions||"_"+i in $f0aa03ebc62e822b$var$Template.functions)return $f0aa03ebc62e822b$var$Template.expand(t,e,r,"fn")}return $f0aa03ebc62e822b$var$Template.expand(t[0],e,r,"var")}return $f0aa03ebc62e822b$var$Template.expand(t,e,r,"fn")}if("base-string"==i){let i=-1;for(let n of t){let s=null;switch(i++,n.type){case"template":s=$f0aa03ebc62e822b$var$Template.expand(n.data,e,r,"template");break;case"string":case"identifier":s=n.data;break;case"base-string":s=$f0aa03ebc62e822b$var$Template.expand(n.data,e,r,"base-string")}"void"!=r&&("last"==r&&i!=t.length-1||a.push(s))}}if("obj"==r)return a;if("last"==r)return"Rose\\Arry"==typeOf(a)&&(a=a[0]),a;if("void"==r)return null;if("arg"==r)return"array"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(a)?1!=a.length?a.join(""):a[0]:a;if("text"==r&&"array"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(a)){let t=e=>null!=e&&"object"==typeof e?"map"in e?e.map(t).join(""):"join"in e?e.join(""):e.toString():e;a=a.map(t).join("")}return a},compile:function(t){return t=$f0aa03ebc62e822b$var$Template.parse(t),function(e=null,r="text"){return $f0aa03ebc62e822b$var$Template.expand(t,e||{},r)}},eval:function(t,e=null,r="text"){return t=$f0aa03ebc62e822b$var$Template.parse(t),$f0aa03ebc62e822b$var$Template.expand(t,e||{},r)},value:function(t,e=null){return"array"!=$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(t)?t:$f0aa03ebc62e822b$var$Template.expand(t,e||{},"arg")},register:function(t,e){$f0aa03ebc62e822b$var$Template.functions[t]=e},call:function(t,e,r=null){return t in $f0aa03ebc62e822b$var$Template.functions?$f0aa03ebc62e822b$var$Template.functions[t](e,null,r):null},getNamedValues:function(t,e,r=1,i=!0){let a={},n=0;for(;r<t.length;r+=2){let s=$f0aa03ebc62e822b$var$Template.expand(t[r],e,"arg");n||(n=s.startsWith(":")?1:s.endsWith(":")?2:3),1==n?s=s.substr(1):2==n&&(s=s.substr(0,s.length-1)),a[s]=i?$f0aa03ebc62e822b$var$Template.expand(t[r+1],e,"arg"):t[r+1]}return a}};$f0aa03ebc62e822b$var$Template.functions={global:function(t){return globalThis},null:function(t){return null},true:function(t){return!0},false:function(t){return!1},len:function(t){return t[1].toString().length},int:function(t){return~~t[1]},str:function(t){return t[1].toString()},float:function(t){return parseFloat(t[1])},chr:function(t){return String.fromCharCode(t[1])},ord:function(t){return t[1].toString().charCodeAt(0)},not:function(t){return!t[1]},neg:function(t){return-t[1]},abs:function(t){return Math.abs(t[1])},and:function(t){for(let e=1;e<t.length;e++)if(!t[e])return!1;return!0},or:function(t){for(let e=1;e<t.length;e++)if(~~t[e])return!0;return!1},eq:function(t){return t[1]==t[2]},ne:function(t){return t[1]!=t[2]},lt:function(t){return t[1]<t[2]},le:function(t){return t[1]<=t[2]},gt:function(t){return t[1]>t[2]},ge:function(t){return t[1]>=t[2]},isnotnull:function(t){return!!t[1]},isnull:function(t){return!t[1]},iszero:function(t){return 0==parseInt(t[1])},"eq?":function(t){return t[1]==t[2]},"ne?":function(t){return t[1]!=t[2]},"lt?":function(t){return t[1]<t[2]},"le?":function(t){return t[1]<=t[2]},"gt?":function(t){return t[1]>t[2]},"ge?":function(t){return t[1]>=t[2]},"notnull?":function(t){return!!t[1]},"null?":function(t){return!t[1]},"zero?":function(t){return 0==parseInt(t[1])},typeof:function(t){return $f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(t[1])},"*":function(t){let e=t[1];for(let r=2;r<t.length;r++)e*=t[r];return e},"/":function(t){let e=t[1];for(let r=2;r<t.length;r++)e/=t[r];return e},"+":function(t){let e=t[1];for(let r=2;r<t.length;r++)e-=-t[r];return e},"-":function(t){let e=t[1];for(let r=2;r<t.length;r++)e-=t[r];return e},mul:function(t){let e=t[1];for(let r=2;r<t.length;r++)e*=t[r];return e},div:function(t){let e=t[1];for(let r=2;r<t.length;r++)e/=t[r];return e},sum:function(t){let e=t[1];for(let r=2;r<t.length;r++)e-=-t[r];return e},sub:function(t){let e=t[1];for(let r=2;r<t.length;r++)e-=t[r];return e},mod:function(t){let e=t[1];for(let r=2;r<t.length;r++)e%=t[r];return e},pow:function(t){let e=t[1];for(let r=2;r<t.length;r++)e=Math.pow(e,t[r]);return e},dump:function(t){return JSON.stringify(t[1])},_set:function(t,e){for(let r=1;r+1<t.length;r+=2){let i=$f0aa03ebc62e822b$var$Template.value(t[r+1],e);if(t[r].length>1){let a=$f0aa03ebc62e822b$var$Template.expand(t[r],e,"varref");null!=a&&(a[0][a[1]]=i)}else e[$f0aa03ebc62e822b$var$Template.value(t[r],e)]=i}return""},_unset:function(t,e){for(let r=1;r<t.length;r++)if(t[r].length>1){let i=$f0aa03ebc62e822b$var$Template.expand(t[r],e,"varref");null!=i&&delete i[0][i[1]]}else delete e[$f0aa03ebc62e822b$var$Template.value(t[r],e)];return null},trim:function(t){return t[1]?"object"==typeof t[1]?t[1].map((t=>t.trim())):t[1].trim():""},upper:function(t){return t[1]?"object"==typeof t[1]?t[1].map((t=>t.toUpperCase())):t[1].toUpperCase():""},lower:function(t){return t[1]?"object"==typeof t[1]?t[1].map((t=>t.toLowerCase())):t[1].toLowerCase():""},substr:function(t){let e=t[t.length-1].toString(),r=0,i=null;return 4==t.length?(r=~~t[1],i=~~t[2]):(r=~~t[1],i=null),r<0&&(r+=e.length),i<0&&(i+=e.length),null===i&&(i=e.length-r),e.substr(r,i)},replace:function(t){return t[3].split(t[1]).join(t[2])},nl2br:function(t){return t[1]?"object"==typeof t[1]?t[1].map((t=>t.replace(/\n/g,"<br/>"))):t[1].replace(/\n/g,"<br/>"):""},"%":function(t){t.shift();var e=t.shift();let r="";for(let i=0;i<t.length;i++)if("array"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(t[i])){r+=`<${e}>`;for(let e=0;e<t[i].length;e++)r+=t[i][e];r+=`</${e}>`}else r+=`<${e}>${t[i]}</${e}>`;return r},"%%":function(t){t.shift();var e=t.shift();let r="",i="";for(let e=0;e<t.length;e+=2)e+1<t.length?r+=` ${t[e]}="${t[e+1]}"`:i=t[e];return i?`<${e}${r}>${i}</${e}>`:`<${e}${r}/>`},join:function(t){return t[2]&&"array"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(t[2])?t[2].join(t[1]):""},split:function(t){return t[2]&&"string"==typeof t[2]?t[2].split(t[1]):[]},keys:function(t){return t[1]&&"object"==typeof t[1]?Object.keys(t[1]):[]},values:function(t){return t[1]&&"object"==typeof t[1]?Object.values(t[1]):[]},_each:function(t,e){let r=$f0aa03ebc62e822b$var$Template.expand(t[1],e,"arg"),i=$f0aa03ebc62e822b$var$Template.expand(t[2],e,"arg"),a="",n=0;if(!i)return a;for(let s in i)e[r]=i[s],e[r+"##"]=n++,e[r+"#"]=s,a+=$f0aa03ebc62e822b$var$Template.expand(t[3],e,"text");return delete e[r],delete e[r+"##"],delete e[r+"#"],a},_foreach:function(t,e){let r=$f0aa03ebc62e822b$var$Template.expand(t[1],e,"arg"),i=$f0aa03ebc62e822b$var$Template.expand(t[2],e,"arg"),a=0;if(!i)return null;for(let n in i)e[r]=i[n],e[r+"##"]=a++,e[r+"#"]=n,$f0aa03ebc62e822b$var$Template.expand(t[3],e,"text");return delete e[r],delete e[r+"##"],delete e[r+"#"],null},"_?":function(t,e){return $f0aa03ebc62e822b$var$Template.expand(t[1],e,"arg")?$f0aa03ebc62e822b$var$Template.expand(t[2],e,"arg"):t.length>3?$f0aa03ebc62e822b$var$Template.expand(t[3],e,"arg"):""},"_??":function(t,e){let r=$f0aa03ebc62e822b$var$Template.expand(t[1],e,"arg");return r||$f0aa03ebc62e822b$var$Template.expand(t[2],e,"arg")},_if:function(t,e){for(let r=0;r<t.length;r+=3){if("else"==$f0aa03ebc62e822b$var$Template.expand(t[r],e,"arg"))return $f0aa03ebc62e822b$var$Template.expand(t[r+1],e,"text");if($f0aa03ebc62e822b$var$Template.expand(t[r+1],e,"arg"))return $f0aa03ebc62e822b$var$Template.expand(t[r+2],e,"text")}return""},_switch:function(t,e){let r=$f0aa03ebc62e822b$var$Template.expand(t[1],e,"arg");for(let i=2;i<t.length;i+=2){let a=$f0aa03ebc62e822b$var$Template.expand(t[i],e,"arg");if(a==r||"default"==a)return $f0aa03ebc62e822b$var$Template.expand(t[i+1],e,"text")}return""},_break:function(t,e){throw new Error("EXC_BREAK")},_continue:function(t,e){throw new Error("EXC_CONTINUE")},_repeat:function(t,e){if(t.length<3||1!=(1&t.length))return"(`repeat`: Wrong number of parameters)";let r=$f0aa03ebc62e822b$var$Template.value(t[1],e),i=null,a=0,n=null,s=null;for(let r=2;r<t.length-1;r+=2){switch($f0aa03ebc62e822b$var$Template.value(t[r],e).toLowerCase()){case"from":a=parseFloat($f0aa03ebc62e822b$var$Template.value(t[r+1],e));break;case"to":n=parseFloat($f0aa03ebc62e822b$var$Template.value(t[r+1],e));break;case"count":i=parseFloat($f0aa03ebc62e822b$var$Template.value(t[r+1],e));break;case"step":s=parseFloat($f0aa03ebc62e822b$var$Template.value(t[r+1],e))}}let o=t[t.length-1],c=[];if(null!==n)if(null===s&&(s=a>n?-1:1),s<0)for(let t=a;t>=n;t+=s)try{e[r]=t,c.push($f0aa03ebc62e822b$var$Template.value(o,e))}catch(t){let e=t.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw t}else for(let t=a;t<=n;t+=s)try{e[r]=t,c.push($f0aa03ebc62e822b$var$Template.value(o,e))}catch(t){let e=t.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw t}else if(null!==i){null===s&&(s=1);for(let t=a;i>0;i--,t+=s)try{e[r]=t,c.push($f0aa03ebc62e822b$var$Template.value(o,e))}catch(t){let e=t.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw t}}else{null===s&&(s=1);for(let t=a;;t+=s)try{e[r]=t,c.push($f0aa03ebc62e822b$var$Template.value(o,e))}catch(t){let e=t.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw t}}return delete e[r],c},_for:function(t,e){if(t.length<3||1!=(1&t.length))return"(`for`: Wrong number of parameters)";let r=$f0aa03ebc62e822b$var$Template.value(t[1],e),i=null,a=0;to=null;let n=null;for(let r=2;r<t.length-1;r+=2)switch(value=$f0aa03ebc62e822b$var$Template.value(t[r],e),value.toLowerCase()){case"from":a=parseFloat($f0aa03ebc62e822b$var$Template.value(t[r+1],e));break;case"to":to=parseFloat($f0aa03ebc62e822b$var$Template.value(t[r+1],e));break;case"count":i=parseFloat($f0aa03ebc62e822b$var$Template.value(t[r+1],e));break;case"step":n=parseFloat($f0aa03ebc62e822b$var$Template.value(t[r+1],e))}let s=t[t.length-1];if(null!==to)if(null===n&&(n=a>to?-1:1),n<0)for(let t=a;t>=to;t+=n)try{e[r]=t,$f0aa03ebc62e822b$var$Template.value(s,e)}catch(t){let e=t.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw t}else for(let t=a;t<=to;t+=n)try{e[r]=t,$f0aa03ebc62e822b$var$Template.value(s,e)}catch(t){let e=t.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw t}else if(null!==i){null===n&&(n=1);for(let t=a;i>0;i--,t+=n)try{e[r]=t,$f0aa03ebc62e822b$var$Template.value(s,e)}catch(t){let e=t.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw t}}else{null===n&&(n=1);for(let t=a;;t+=n)try{e[r]=t,$f0aa03ebc62e822b$var$Template.value(s,e)}catch(t){let e=t.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw t}}return delete e[r],null},_loop:function(t,e){if(t.length<2)return"(`loop`: Wrong number of parameters)";let r=t[1];for(;;)try{$f0aa03ebc62e822b$var$Template.value(r,e)}catch(t){let e=t.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw t}return null},_echo:function(t,e){let r="";for(let i=1;i<t.length;i++)r+=$f0aa03ebc62e822b$var$Template.expand(t[i],e,"arg");return console.log(r),""},"_#":function(t,e){let r=[];for(let i=1;i<t.length;i++)r.push($f0aa03ebc62e822b$var$Template.expand(t[i],e,"arg"));return r},"_##":function(t,e){let r=[];for(let e=1;e<t.length;e++)r.push(t[e]);return r},"_&":function(t,e){return $f0aa03ebc62e822b$var$Template.getNamedValues(t,e,1,!0)},"_&&":function(t,e){return $f0aa03ebc62e822b$var$Template.getNamedValues(t,e,1,!1)},contains:function(t,e,r){let i=t[1];if("object"!=typeof i)return r.err="Argument is not a Map",!1;let a="";for(let e=2;e<t.length;e++)t[e]in i||(a+=", "+t[e]);return""==a||(r.err=a.substr(1),!1)},has:function(t,e,r){let i=t[2];return"object"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(i)&&t[1]in i},_map:function(t,e){let r=$f0aa03ebc62e822b$var$Template.expand(t[1],e,"arg"),i=$f0aa03ebc62e822b$var$Template.expand(t[2],e,"arg");if(!i)return i;let a="array"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(i),n=a?[]:{},s=0;for(let o in i)e[r]=i[o],e[r+"##"]=s++,e[r+"#"]=o,a?n.push($f0aa03ebc62e822b$var$Template.expand(t[3],e,"arg")):n[o]=$f0aa03ebc62e822b$var$Template.expand(t[3],e,"arg");return delete e[r],delete e[r+"##"],delete e[r+"#"],n},_filter:function(t,e){let r=$f0aa03ebc62e822b$var$Template.expand(t[1],e,"arg"),i=$f0aa03ebc62e822b$var$Template.expand(t[2],e,"arg");if(!i)return i;let a="array"==$f70b3c308bc3df02$export$9099ad97b570f7c.typeOf(i),n=a?[]:{},s=0;for(let o in i)e[r]=i[o],e[r+"##"]=s++,e[r+"#"]=o,~~$f0aa03ebc62e822b$var$Template.expand(t[3],e,"arg")&&(a?n.push(i[o]):n[o]=i[o]);return delete e[r],delete e[r+"##"],delete e[r+"#"],n},expand:function(t,e,r){return $f0aa03ebc62e822b$var$Template.expand($f0aa03ebc62e822b$var$Template.parseTemplate(t[1],"{","}"),3==t.length?t[2]:r)},_call:function(t,e){let r=$f0aa03ebc62e822b$var$Template.expand(t[1],e,"varref");if(!r||"function"!=typeof r[0][r[1]])throw new Error("Expression is not a function: "+$f0aa03ebc62e822b$var$Template.expand(t[1],e,"obj").map((t=>null==t?".":t)).join(""));let i=[];for(let r=2;r<t.length;r++)i.push($f0aa03ebc62e822b$var$Template.value(t[r],e));return r[0][r[1]](...i)}};var $f0aa03ebc62e822b$export$9099ad97b570f7c=$f0aa03ebc62e822b$var$Template;const $02c835380fe912d5$export$2625a93b35cc52e6=$f70b3c308bc3df02$export$9099ad97b570f7c,$02c835380fe912d5$export$85a4e7644ad1465d=$41f1955d9972a7df$export$9099ad97b570f7c,$02c835380fe912d5$export$32c97c23c2b86029=$bd56c52937d4e38f$export$9099ad97b570f7c,$02c835380fe912d5$export$4615b0b33ebec6c8=$f5fde1039ebdba85$export$9099ad97b570f7c,$02c835380fe912d5$export$4d9aa5949e79e4c=$63113af07f0cfd15$export$9099ad97b570f7c,$02c835380fe912d5$export$cb745e65ff887e58=$da4ff10c088cd9b3$export$9099ad97b570f7c,$02c835380fe912d5$export$292766477ad9ab99=$a30f62347d183f8b$export$9099ad97b570f7c,$02c835380fe912d5$export$a78c3d27969365dc=$ee066408d437af8a$export$9099ad97b570f7c,$02c835380fe912d5$export$c2c21ff98542e7e0=$88f5f771adc8dd76$export$9099ad97b570f7c,$02c835380fe912d5$export$93af88fe68eea917=$f0aa03ebc62e822b$export$9099ad97b570f7c,$a4f6dcde8eac4617$var$rol16=function(t,e){return 65535&(t<<e|t>>>16-e&(1<<e)-1)},$a4f6dcde8eac4617$var$ror16=function(t,e){return 65535&(t>>>e|(t&(1<<e)-1)<<16-e)},$a4f6dcde8eac4617$var$add16=function(t,e){return t+e&65535},$a4f6dcde8eac4617$var$sub16=function(t,e){return t-e&65535},$a4f6dcde8eac4617$var$xor16=function(t,e){return 65535&(t^e)},$a4f6dcde8eac4617$var$Random=$02c835380fe912d5$export$85a4e7644ad1465d.extend({seed:0,a:0,b:0,last:0,__ctor:function(t=3672614355){this.setSeed(t)},setSeed:function(t){return this.seed=t,this.a=t>>16&65535,this.b=t>>0&65535,this.last=this.a>>4&255|this.b<<4&65280,this},nextInt16:function(){let t=this.last;return t=$a4f6dcde8eac4617$var$add16(t,this.a),t=$a4f6dcde8eac4617$var$xor16(t,5397),this.a=$a4f6dcde8eac4617$var$xor16(this.a,20897),this.a=$a4f6dcde8eac4617$var$sub16(this.a,this.b),this.b=$a4f6dcde8eac4617$var$xor16(this.b,6677),t=$a4f6dcde8eac4617$var$rol16(t,15&this.b),65535&(this.last=t)},nextInt8:function(){return 255&this.nextInt16()},nextFloat:function(){return this.nextInt16()/65535}});var $a4f6dcde8eac4617$export$9099ad97b570f7c=$a4f6dcde8eac4617$var$Random,$c4eb26169b07d885$export$9099ad97b570f7c={BACKSPACE:8,TAB:9,ENTER:13,ESC:27,SPACE:32,PGUP:33,PGDN:34,END:35,HOME:36,INS:45,DEL:46,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUM_PLUS:107,NUM_MINUS:109,NUM_ASTERISK:106,NUM_SLASH:111,NUM_DOT:110,NUM_0:96,NUM_1:97,NUM_2:98,NUM_3:99,NUM_4:100,NUM_5:101,NUM_6:102,NUM_7:103,NUM_8:104,NUM_9:105,D0:48,D1:49,D2:50,D3:51,D4:52,D5:53,D6:54,D7:55,D8:56,D9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90};const $40681449f8cf34e0$var$recyclingFacilities={},$40681449f8cf34e0$var$Recycler={};var $40681449f8cf34e0$export$9099ad97b570f7c=$40681449f8cf34e0$var$Recycler;$40681449f8cf34e0$var$Recycler.attachTo=function(t,e=8192,r=null){if(!t.prototype.className)throw new Error("Unable to attach recycler methods to an unnamed class.");if(!("__dtor"in t.prototype))throw new Error("Recycler: Class "+t.prototype.className+" requires `__dtor` method.");if(!("init"in t.prototype))throw new Error("Recycler: Class "+t.prototype.className+" requires `init` method.");null===r&&(r=int(.375*e)),$40681449f8cf34e0$var$recyclingFacilities[t.prototype.className]=t,t.recyclerPool=[],t.recyclerPoolMax=e,t.prototype.objectId=0,t.recyclerNextObjectId=0,t.recyclerCreated=0,t.recyclerRecycled=0,t.recyclerMissed=0,t.recyclerLength=0,t.recyclerActive=0;for(let e=0;e<r;e++)t.recyclerPool.push(new t),t.recyclerLength++;t.allocate=function(){let e;return this.recyclerLength?(e=this.recyclerPool[--this.recyclerLength],t.recyclerRecycled++):(e=new t,t.recyclerCreated++),t.recyclerActive++,e.objectId=++this.recyclerNextObjectId,this.recyclerNextObjectId&=2147483647,e},t.alloc=function(e=null,r=null,i=null,a=null,n=null,s=null,o=null,c=null,l=null,h=null){return t.allocate().init(e,r,i,a,n,s,o,c,l,h)},t.prototype.free=function(){return this.objectId<0?this:0==this.objectId?(console.error("ERROR: Already released instance of "+t.prototype.className),this):(this.__dtor(),this.objectId=0,t.recyclerLength>=e?t.recyclerMissed++:t.recyclerPool[t.recyclerLength++]=this,t.recyclerActive--,this)},t.prototype.lockInstance=function(t){return this.objectId=Math.abs(this.objectId),t&&(this.objectId=-this.objectId),this}},$40681449f8cf34e0$var$Recycler.showStats=function(t=null){let e=$40681449f8cf34e0$var$recyclingFacilities;if(!0!==t){if(null!==t){if("string"==typeof t){let e=$40681449f8cf34e0$var$recyclingFacilities[t];return void console.debug(t+": "+(e.recyclerCreated/e.recyclerPoolMax*100).toFixed(1)+"%  =>  overhead="+e.recyclerCreated+", active="+e.recyclerActive+", capacity="+e.recyclerPool.length+", recycled="+e.recyclerRecycled+", in-recycler="+e.recyclerLength+", missed="+e.recyclerMissed+", space="+(e.recyclerPoolMax-e.recyclerLength))}e=t}console.group("Recycling Facilities");for(let t in e){let r=e[t];console.debug(t+": "+(r.recyclerCreated/r.recyclerPoolMax*100).toFixed(1)+"%  =>  overhead="+r.recyclerCreated+", active="+r.recyclerActive+", capacity="+r.recyclerPool.length+", recycled="+r.recyclerRecycled+", in-recycler="+r.recyclerLength+", missed="+r.recyclerMissed+", space="+(r.recyclerPoolMax-r.recyclerLength))}console.groupEnd()}else{console.group("Recycling Facilities");for(let t in e){let r=e[t];r.recyclerCreated&&console.debug(t+": "+(r.recyclerCreated/r.recyclerPoolMax*100).toFixed(1)+"%  =>  overhead="+r.recyclerCreated+", active="+r.recyclerActive+", capacity="+r.recyclerPool.length+", recycled="+r.recyclerRecycled+", in-recycler="+r.recyclerLength+", missed="+r.recyclerMissed+", space="+(r.recyclerPoolMax-r.recyclerLength))}console.groupEnd()}},$40681449f8cf34e0$var$Recycler.createPool=function(t,e=8192,r=null){const i=t.prototype.className;if(!i)throw new Error("Unable to create pool sub-class on an unnamed class.");const a=t.extend({className:t.prototype.className,__ctor:function(){},init:function(t=null,e=null,r=null,a=null,n=null,s=null,o=null,c=null,l=null,h=null){return this._super[i].__ctor(t,e,r,a,n,s,o,c,l,h),this}});return $40681449f8cf34e0$var$Recycler.attachTo(a,e,r),t.Pool=a,t};const $f2fc3aaf8b986d20$var$Linkable=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Linkable",prev:null,next:null,value:null,__ctor:function(t){this.value=t,this.clear()},__dtor:function(){this.unlink()},clear:function(){return this.next=this.prev=null,this},linkAfter:function(t){this.prev=t,this.next=t?t.next:null,t&&(t.next&&(t.next.prev=this),t.next=this)},linkBefore:function(t){this.prev=t?t.prev:null,this.next=t,t&&(t.prev&&(t.prev.next=this),t.prev=this)},unlink:function(){return this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.clear()}});$40681449f8cf34e0$export$9099ad97b570f7c.createPool($f2fc3aaf8b986d20$var$Linkable,16384,6144);var $f2fc3aaf8b986d20$export$9099ad97b570f7c=$f2fc3aaf8b986d20$var$Linkable;const $aa9d485c680b8e6e$var$List=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"List",top:null,bottom:null,length:0,__ctor:function(){this.top=null,this.bottom=null,this.length=0},__dtor:function(){this.reset()},clone:function(){let t=$aa9d485c680b8e6e$var$List.Pool.alloc();for(let e=this.top;e;e=e.next)t.push($02c835380fe912d5$export$2625a93b35cc52e6.clone(e.value));return t},clear:function(){let t,e;for(t=this.top;null!=t;t=e)e=t.next,dispose(t.free().value);return this.top=this.bottom=null,this.length=0,this},reset:function(){let t,e;for(t=this.top;null!=t;t=e)e=t.next,t.free();return this.top=this.bottom=null,this.length=0,this},first:function(){return null!==this.top?this.top.value:null},last:function(){return null!==this.bottom?this.bottom.value:null},getAt:function(t){let e=null;for(e=this.top;e&&t--;e=e.next);return null!=e?e.value:null},getNodeAt:function(t){let e=null;for(e=this.top;e&&t--;e=e.next);return e},sgetNode:function(t){for(let e=this.top;e;e=e.next)if(e.value===t)return e;return null},remove:function(t){return null==t||"isInstanceOf"in t&&t.isInstanceOf($f2fc3aaf8b986d20$export$9099ad97b570f7c)||(t=this.sgetNode(t)),t?(t.prev||(this.top=t.next),t.next||(this.bottom=t.prev),this.length--,t.free().value):null},insertBefore:function(t,e){if(!t)return this;let r=$f2fc3aaf8b986d20$export$9099ad97b570f7c.Pool.alloc(e);return r.linkBefore(t),t==this.top&&(this.top=r),this.length++,e},insertAfter:function(t,e){if(!t)return this;let r=$f2fc3aaf8b986d20$export$9099ad97b570f7c.Pool.alloc(e);return r.linkAfter(t),t==this.bottom&&(this.bottom=r),this.length++,e},unshift:function(t){let e=$f2fc3aaf8b986d20$export$9099ad97b570f7c.Pool.alloc(t);return e.linkBefore(this.top),this.bottom||(this.bottom=e),this.top=e,this.length++,t},shift:function(){let t=this.top;return t?((this.top=t.next)||(this.bottom=null),this.length--,t.free().value):null},push:function(t){let e=$f2fc3aaf8b986d20$export$9099ad97b570f7c.Pool.alloc(t);return e.linkAfter(this.bottom),this.top||(this.top=e),this.bottom=e,this.length++,t},pop:function(){let t=this.bottom;return t?((this.bottom=t.prev)||(this.top=null),this.length--,t.free().value):null},append:function(t){for(let e=t.top;e;e=e.next)this.push(e.value);return this},forEach:function(t,e=null){let r;for(let i=this.top;i;i=r)if(r=i.next,!1===t(i.value,i,this,e))return!1;return!0},forEachRev:function(t,e=null){let r;for(let i=this.bottom;i;i=r)if(r=i.prev,!1===t(i.value,i,this,e))return!1;return!0},find:function(t,e=null){for(let r=this.top;r;r=r.next)if(t(r.value,e))return r.value;return null},filter:function(t,e=null){let r=$aa9d485c680b8e6e$var$List.Pool.alloc();for(let i=this.top;i;i=i.next)t(i.value,e)&&r.push(i.value);return r},toArray:function(){let t=[];for(let e=this.top;e;e=e.next)t.push(e.value);return t}});$40681449f8cf34e0$export$9099ad97b570f7c.createPool($aa9d485c680b8e6e$var$List,16384,6144);var $aa9d485c680b8e6e$export$9099ad97b570f7c=$aa9d485c680b8e6e$var$List;const $b2a8f8940aea7a8f$var$Timer=function(t,e,r){this.callback=r,this.interval=e,this.vsync=t,this.isRunning=!1,this.startTime=0,this.rTime=0,this.sTime=0,this.lTime=0,this.tDelta=0,this._onTimeout=()=>{this.onTimeout()},this._onTimeout_b=()=>{this.runNow()}};$b2a8f8940aea7a8f$var$Timer.prototype.onTimeout=function(){if(!this.isRunning)return;this.rTime=hrnow()-this.startTime;let t=this.rTime-(this.sTime+this.interval);t<0?this.runAfter(-t):(this.sTime+=this.interval*(1+int(t/this.interval)),this.tDelta=t<0?this.interval:this.rTime-this.lTime,this.lTime=this.rTime,this.runAfter(this.sTime+this.interval-(hrnow()-this.startTime)),this.callback(this.tDelta,this))},$b2a8f8940aea7a8f$var$Timer.prototype.onStart=function(){},$b2a8f8940aea7a8f$var$Timer.prototype.start=function(t=!1,e=1){this.startTime=hrnow(),this.isRunning=!0,this.sTime=0,this.lTime=0,this.onStart(),t&&this.callback(0,this),this.runAfter(this.interval*e)},$b2a8f8940aea7a8f$var$Timer.prototype.runAfter=function(t){this.vsync?requestAnimationFrame(this._onTimeout_b):setTimeout(this._onTimeout,0)},$b2a8f8940aea7a8f$var$Timer.prototype.runNow=function(){setTimeout(this._onTimeout,0)},$b2a8f8940aea7a8f$var$Timer.prototype.stop=function(){this.isRunning=!1};var $b2a8f8940aea7a8f$export$9099ad97b570f7c=$b2a8f8940aea7a8f$var$Timer;const $04b906e53587fc1a$var$Vec2=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Vec2",x:0,y:0,__ctor:function(t=null,e=null){return this.set(t,e)},clone:function(){return $04b906e53587fc1a$var$Vec2.Pool.alloc(this)},set:function(t,e=null){if(null===t)t=0,e=0;else if(null===e){let r=t;t=r.x,e=r.y}return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},zero:function(){return this.set(0,0)},isZero:function(){return 0==this.x&&0==this.y},equals:function(t,e=null){if(null===e){let r=t;t=r.x,e=r.y}return this.x==t&&this.y==e},neg:function(){return this.x=-this.x,this.y=-this.y,this},inv:function(){return this.x=1/this.x,this.y=1/this.y,this},abs:function(){return this.x=this.x<0?-this.x:this.x,this.y=this.y<0?-this.y:this.y,this},translate:function(t,e=null){if(null===e){let r=t;t=r.x,e=r.y}return this.x+=t,this.y+=e,this},add:function(t,e=null){if(null===e){let r=t;t=r.x,e=r.y}return this.x+=t,this.y+=e,this},sub:function(t,e){if(null===e){let r=t;t=r.x,e=r.y}return this.x-=t,this.y-=e,this},scale:function(t,e=null){if(null===e)if($04b906e53587fc1a$var$Vec2.isInstance(t)){let r=t;t=r.x,e=r.y}else e=t;return this.x*=t,this.y*=e,this},floor:function(){return this.x=int(this.x),this.y=int(this.y),this},fract:function(){return this.x=this.x-int(this.x),this.y=this.y-int(this.y),this},dot:function(t,e=null){if(null===e){let r=t;t=r.x,e=r.y}return this.x*t+this.y*e},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.isZero()?this:this.scale(1/this.magnitude())},majorAxis:function(){return Math.abs(this.x)>Math.abs(this.y)?this.y=0:this.x=0,this},minorAxis:function(){return Math.abs(this.x)<Math.abs(this.y)?this.y=0:this.x=0,this},sign:function(){return this.x=this.x?this.x<0?-1:1:0,this.y=this.y?this.y<0?-1:1:0,this},toString:function(){return`(${this.x}, ${this.y})`}});$40681449f8cf34e0$export$9099ad97b570f7c.createPool($04b906e53587fc1a$var$Vec2,4096,2048);var $04b906e53587fc1a$export$9099ad97b570f7c=$04b906e53587fc1a$var$Vec2;const $8e088f0009ece130$var$temp=new Float32Array(9).fill(0),$8e088f0009ece130$var$temp2=new Float32Array(9).fill(0),$8e088f0009ece130$var$Matrix=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Matrix",data:null,__ctor:function(t=null){null===this.data&&(this.data=new Float32Array(9)),null!==t?this.set(t):this.identity()},zero:function(){return this.data.fill(0),this},fill:function(t){return this.data.fill(t),this},set:function(t){if($8e088f0009ece130$var$Matrix.isInstance(t))for(let e=0;e<9;e++)this.data[e]=t.data[e];else for(let e=0;e<9;e++)this.data[e]=t[e];return this},identity:function(t=null){return null===t&&(t=this.data),t.fill(0),t[0]=t[4]=t[8]=1,this},scalef:function(t){for(let e=0;e<9;e++)this.data[e]*=t;return this},clone:function(){return $8e088f0009ece130$var$Matrix.Pool.alloc(this)},append:function(t){t instanceof $8e088f0009ece130$var$Matrix&&(t=t.data);for(let t=0;t<9;t++)$8e088f0009ece130$var$temp[t]=this.data[t];return this.data[0]=t[0]*$8e088f0009ece130$var$temp[0]+t[1]*$8e088f0009ece130$var$temp[3]+t[2]*$8e088f0009ece130$var$temp[6],this.data[1]=t[0]*$8e088f0009ece130$var$temp[1]+t[1]*$8e088f0009ece130$var$temp[4]+t[2]*$8e088f0009ece130$var$temp[7],this.data[2]=t[0]*$8e088f0009ece130$var$temp[2]+t[1]*$8e088f0009ece130$var$temp[5]+t[2]*$8e088f0009ece130$var$temp[8],this.data[3]=t[3]*$8e088f0009ece130$var$temp[0]+t[4]*$8e088f0009ece130$var$temp[3]+t[5]*$8e088f0009ece130$var$temp[6],this.data[4]=t[3]*$8e088f0009ece130$var$temp[1]+t[4]*$8e088f0009ece130$var$temp[4]+t[5]*$8e088f0009ece130$var$temp[7],this.data[5]=t[3]*$8e088f0009ece130$var$temp[2]+t[4]*$8e088f0009ece130$var$temp[5]+t[5]*$8e088f0009ece130$var$temp[8],this.data[6]=t[6]*$8e088f0009ece130$var$temp[0]+t[7]*$8e088f0009ece130$var$temp[3]+t[8]*$8e088f0009ece130$var$temp[6],this.data[7]=t[6]*$8e088f0009ece130$var$temp[1]+t[7]*$8e088f0009ece130$var$temp[4]+t[8]*$8e088f0009ece130$var$temp[7],this.data[8]=t[6]*$8e088f0009ece130$var$temp[2]+t[7]*$8e088f0009ece130$var$temp[5]+t[8]*$8e088f0009ece130$var$temp[8],this},translate:function(t,e){if(0==t&&0==e)return this;for(let t=0;t<9;t++)$8e088f0009ece130$var$temp[t]=this.data[t];return this.data[6]=t*$8e088f0009ece130$var$temp[0]+e*$8e088f0009ece130$var$temp[3]+$8e088f0009ece130$var$temp[6],this.data[7]=t*$8e088f0009ece130$var$temp[1]+e*$8e088f0009ece130$var$temp[4]+$8e088f0009ece130$var$temp[7],this.data[8]=t*$8e088f0009ece130$var$temp[2]+e*$8e088f0009ece130$var$temp[5]+$8e088f0009ece130$var$temp[8],this},rotate:function(t){if(0==t)return this;this.identity($8e088f0009ece130$var$temp2);let e=Math.cos(t),r=Math.sin(t);return $8e088f0009ece130$var$temp2[0]=e,$8e088f0009ece130$var$temp2[1]=-r,$8e088f0009ece130$var$temp2[3]=r,$8e088f0009ece130$var$temp2[4]=e,this.append($8e088f0009ece130$var$temp2)},scale:function(t,e){return 1==t&&1==e?this:(this.identity($8e088f0009ece130$var$temp2),$8e088f0009ece130$var$temp2[0]=t,$8e088f0009ece130$var$temp2[4]=e,this.append($8e088f0009ece130$var$temp2))},applyTo:function(t,e=null){if(null===e){const r=t;t=r.x,e=r.y}let r=this.data[0]*t+this.data[3]*e+this.data[6],i=this.data[1]*t+this.data[4]*e+this.data[7];return $04b906e53587fc1a$export$9099ad97b570f7c.Pool.alloc(r,i)},transpose:function(){$8e088f0009ece130$var$temp.fill(0);for(let t=0;t<3;t++)for(let e=0;e<3;e++)$8e088f0009ece130$var$temp[3*t+e]=this.data[3*e+t];for(let t=0;t<9;t++)this.data[t]=$8e088f0009ece130$var$temp[t];return this},det:function(){return this.data[0]*(this.data[4]*this.data[8]-this.data[5]*this.data[7])-this.data[1]*(this.data[3]*this.data[8]-this.data[5]*this.data[6])+this.data[2]*(this.data[3]*this.data[7]-this.data[4]*this.data[6])},adj:function(){throw new Error("NOT IMPLEMENTED")},inverse:function(){let t=this.det();return t?this.adj().scalef(1/t):null},toString:function(){return`[${this.data[0]}, ${this.data[3]}, ${this.data[6]}]\n[${this.data[1]}, ${this.data[4]}, ${this.data[7]}]\n[${this.data[2]}, ${this.data[5]}, ${this.data[8]}]\n`}});$8e088f0009ece130$var$Matrix.loadIdentity=function(t){t.fill(0),t[0]=t[4]=t[8]=1},$40681449f8cf34e0$export$9099ad97b570f7c.createPool($8e088f0009ece130$var$Matrix,4096,1024);var $8e088f0009ece130$export$9099ad97b570f7c=$8e088f0009ece130$var$Matrix;const $591b01159cd21b49$var$Shader=$02c835380fe912d5$export$85a4e7644ad1465d.extend({id:null,type:0,sourceCode:null,shaderId:null,__ctor:function(t,e){this.id=t,this.type=e,this.sourceCode="",this.shaderId=null,$591b01159cd21b49$var$Shader.put(t,this)},__dtor:function(){let t=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl;t&&(t.deleteShader(this.shaderId),$591b01159cd21b49$var$Shader.remove(this.id))},source:function(t){return this.sourceCode+=t,this},compile:function(){let t=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl;t&&(this.shaderId=t.createShader(this.type===$591b01159cd21b49$var$Shader.VERTEX_SHADER?t.VERTEX_SHADER:this.type===$591b01159cd21b49$var$Shader.FRAGMENT_SHADER?t.FRAGMENT_SHADER:t.GEOMETRY_SHADER),t.shaderSource(this.shaderId,this.sourceCode),t.compileShader(this.shaderId))},getError:function(){let t=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl;return t?null===this.shaderId?"Shader has not been compiled.":t.getShaderInfoLog(this.shaderId):""}});$591b01159cd21b49$var$Shader.VERTEX_SHADER=0,$591b01159cd21b49$var$Shader.FRAGMENT_SHADER=1,$591b01159cd21b49$var$Shader.GEOMETRY_SHADER=2,$591b01159cd21b49$var$Shader.shaders={},$591b01159cd21b49$var$Shader.put=function(t,e){this.shaders[t]=e},$591b01159cd21b49$var$Shader.get=function(t){return this.shaders[t]},$591b01159cd21b49$var$Shader.remove=function(t){delete this.shaders[t]};var $591b01159cd21b49$export$9099ad97b570f7c=$591b01159cd21b49$var$Shader;const $1a869689662b0ec8$var$ShaderProgram=$02c835380fe912d5$export$85a4e7644ad1465d.extend({uniform_location_matrix:0,uniform_transform_matrix:0,uniform_texture_matrix:0,uniform_resolution:0,uniform_texture_size:0,uniform_base_color:0,uniform_time:0,uniform_depth:0,uniform_scale:0,uniform_alpha:0,uniform_texture_0:0,attrib_location:0,id:null,shaders:null,programId:null,__ctor:function(t){this.id=t,this.shaders=[],this.programId=null,$1a869689662b0ec8$var$ShaderProgram.put(t,this)},__dtor:function(){let t=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl;if(!t)return this;t.deleteProgram(this.programId),$1a869689662b0ec8$var$ShaderProgram.remove(this.id)},attach:function(t){if("string"==typeof t&&(t=$591b01159cd21b49$export$9099ad97b570f7c.get(t)),!t)throw new Error("Unable to attach shader, invalid argument.");return this.shaders.push(t),this},bindLocations:function(t){t.bindAttribLocation(this.programId,0,"location")},loadLocations:function(t){this.uniform_location_matrix=t.getUniformLocation(this.programId,"m_location"),this.uniform_transform_matrix=t.getUniformLocation(this.programId,"m_transform"),this.uniform_texture_matrix=t.getUniformLocation(this.programId,"m_texture"),this.uniform_resolution=t.getUniformLocation(this.programId,"v_resolution"),this.uniform_texture_size=t.getUniformLocation(this.programId,"v_texture_size"),this.uniform_base_color=t.getUniformLocation(this.programId,"v_base_color"),this.uniform_time=t.getUniformLocation(this.programId,"f_time"),this.uniform_depth=t.getUniformLocation(this.programId,"f_depth"),this.uniform_scale=t.getUniformLocation(this.programId,"f_scale"),this.uniform_alpha=t.getUniformLocation(this.programId,"f_alpha"),this.uniform_texture_0=t.getUniformLocation(this.programId,"texture0"),this.attrib_location=t.getAttribLocation(this.programId,"location")},link:function(){let t=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl;if(!t)return this;this.programId=t.createProgram();for(let e of this.shaders)t.attachShader(this.programId,e.shaderId);return this.bindLocations(t),t.linkProgram(this.programId),this.loadLocations(t),this},use:function(){let t=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl;t&&t.useProgram(this.programId)},getStatus:function(){let t=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl;return!t||t.getProgramParameter(this.programId,t.LINK_STATUS)},getError:function(){let t=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl;return t?null===this.programId?"Program has not been linked.":t.getProgramInfoLog(this.programId):""},getAllErrors:function(){let t=">> PROGRAM:\n"+this.getError();for(let e of this.shaders)t+="\n>> "+(e.type===$591b01159cd21b49$export$9099ad97b570f7c.VERTEX_SHADER?"vertex":"fragment").toUpperCase()+":\n"+e.getError();return t}});$1a869689662b0ec8$var$ShaderProgram.programs={},$1a869689662b0ec8$var$ShaderProgram.put=function(t,e){this.programs[t]=e},$1a869689662b0ec8$var$ShaderProgram.get=function(t){return this.programs[t]},$1a869689662b0ec8$var$ShaderProgram.remove=function(t){delete this.programs[t]};var $1a869689662b0ec8$export$9099ad97b570f7c=$1a869689662b0ec8$var$ShaderProgram;const $8cb3108385e4214b$var$Canvas=function(t=null){let e={elem:null,gl:!1,background:"#000",width:0,height:0,hidden:!0,absolute:!1,antialias:!1,...t};null==e.elem?(this.elem=$parcel$global.document?$parcel$global.document.createElement("canvas"):$02c835380fe912d5$export$2625a93b35cc52e6.clone($8cb3108385e4214b$var$Canvas.passThruCanvas),$parcel$global.document&&1!=e.hidden&&($parcel$global.document.body.appendChild(this.elem),!0===e.absolute&&(this.elem.style.position="absolute",this.elem.style.left="0",this.elem.style.top="0"))):this.elem=elem,this.elem.getContext&&(!0===e.gl?(this.gl=this.elem.getContext("webgl2",{desynchronized:!1,alpha:!1}),this.context=null,$c911639689a6d3da$export$9099ad97b570f7c.write(this.gl.getParameter(this.gl.VERSION)),$c911639689a6d3da$export$9099ad97b570f7c.write(this.gl.getParameter(this.gl.SHADING_LANGUAGE_VERSION)),$f37b9fd5341d0b91$export$9099ad97b570f7c.gl=this.gl):(this.context=this.elem.getContext("2d",{desynchronized:!1}),this.gl=null),this.matrixStack=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),this.alphaStack=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),this.depthFlagStack=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),this.shaderProgramStack=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),this.matr=$8e088f0009ece130$export$9099ad97b570f7c.Pool.alloc(),this.transform=$8e088f0009ece130$export$9099ad97b570f7c.Pool.alloc(),this._globalScale=1,this._alpha=1,this._depthFlag=!0,this.shaderProgram=null,this.updateTransform(),this.strokeStyle("#fff"),this.fillStyle("#fff"),e.width&&e.height&&this.resize(e.width,e.height),!0===e.gl&&this.initGl(),this.antialias=e.antialias,this.setBackground(e.background))};$8cb3108385e4214b$var$Canvas.passThruCanvas={parentNode:null,imageSmoothingEnabled:!0,style:{},width:950,height:540,getContext:function(t){return this},pushClip:function(){},popClip:function(){},scale:function(t,e){},rotate:function(t){},translate:function(t,e){},setTransform:function(t,e,r,i,a,n){},updateTransform:function(){},toDataURL:function(t,e){return""},beginPath:function(){},moveTo:function(t,e){},closePath:function(){},lineTo:function(){},rect:function(t,e,r,i){},fill:function(){},stroke:function(){},fillRect:function(t,e,r,i){},strokeRect:function(t,e,r,i){},clip:function(){},quadraticCurveTo:function(t,e,r,i){},bezierCurveTo:function(t,e,r,i,a,n){},arc:function(t,e,r,i,a,n){},arcTo:function(t,e,r,i,a){},fillText:function(t,e,r,i){},strokeText:function(t,e,r,i){},measureText:function(t){return{width:0}},createImageData:function(t,e){return{width:t,height:e}},getImageData:function(t,e,r,i){return{width:r,height:i,data:[]}},putImageData:function(t,e,r){},drawImage:function(t,e=0,r=0,i=null,a=null,n=null,s=null,o=null,c=null){},getBoundingClientRect:function(){return{left:0,top:0}}},$8cb3108385e4214b$var$Canvas.prototype.initGl=function(){let t=this.gl;if(this.glDefaultProgram=new $1a869689662b0ec8$export$9099ad97b570f7c("def"),new $591b01159cd21b49$export$9099ad97b570f7c("def-vert",$591b01159cd21b49$export$9099ad97b570f7c.VERTEX_SHADER).source("#version 300 es\n\t\tprecision highp float;\n\n\t\tuniform mat3 m_location;\n\t\tuniform mat3 m_transform;\n\t\tuniform mat3 m_texture;\n\n\t\tuniform vec2 v_resolution;\n\t\tuniform vec2 v_texture_size;\n\n\t\tuniform float f_time;\n\t\tuniform float f_depth;\n\n\t\tuniform sampler2D texture0;\n\n\t\tin vec2 location;\n\t\tout vec2 texcoords;\n\n\t\tvoid main()\n\t\t{\n\t\t\tgl_Position = vec4(((vec2(m_transform * m_location * vec3(location, 1.0)) / v_resolution)*2.0 - vec2(1.0, 1.0)) * vec2(1.0, -1.0), f_depth / 16777216.0, 1.0);\n\t\t\ttexcoords = vec2(m_texture * vec3(location, 1.0)) / v_texture_size;\n\t\t}\n\t").compile(),new $591b01159cd21b49$export$9099ad97b570f7c("def-frag",$591b01159cd21b49$export$9099ad97b570f7c.FRAGMENT_SHADER).source("#version 300 es\n\t\tprecision highp float;\n\n\t\tuniform sampler2D texture0;\n\t\tuniform float f_alpha;\n\t\tin vec2 texcoords;\n\n\t\tout vec4 color;\n\n\t\tvoid main()\n\t\t{\n\t\t\tcolor = texture(texture0, texcoords);\n\t\t\tcolor.a *= f_alpha;\n\n\t\t\tif (color.a == 0.0) discard;\n\t\t}\n\t").compile(),this.glBlitProgram=new $1a869689662b0ec8$export$9099ad97b570f7c("blit"),new $591b01159cd21b49$export$9099ad97b570f7c("blit-vert",$591b01159cd21b49$export$9099ad97b570f7c.VERTEX_SHADER).source("#version 300 es\n\t\tprecision highp float;\n\n\t\tuniform mat3 m_location;\n\t\tuniform mat3 m_texture;\n\t\tuniform vec2 v_resolution;\n\t\tuniform vec2 v_texture_size;\n\t\tuniform sampler2D texture0;\n\n\t\tin vec2 location;\n\t\tout vec2 texcoords;\n\n\t\tvoid main()\n\t\t{\n\t\t\tgl_Position = vec4(((vec2(m_location * vec3(location, 1.0)) / v_resolution)*2.0 - vec2(1.0, 1.0)) * vec2(1.0, 1.0), 0.0, 1.0);\n\t\t\ttexcoords = vec2(m_texture * vec3(location, 1.0)) / v_texture_size;\n\t\t}\n\t").compile(),new $591b01159cd21b49$export$9099ad97b570f7c("blit-frag",$591b01159cd21b49$export$9099ad97b570f7c.FRAGMENT_SHADER).source("#version 300 es\n\t\tprecision highp float;\n\n\t\tuniform sampler2D texture0;\n\t\tin vec2 texcoords;\n\n\t\tout vec4 color;\n\n\t\tvoid main()\n\t\t{\n\t\t\tcolor = texture(texture0, texcoords);\n\t\t}\n\t").compile(),this.glDefaultProgram.attach("def-vert"),this.glDefaultProgram.attach("def-frag"),this.glBlitProgram.attach("blit-vert"),this.glBlitProgram.attach("blit-frag"),this.glDefaultProgram.link(),this.glBlitProgram.link(),!this.glDefaultProgram.getStatus())throw new Error(this.glDefaultProgram.getAllErrors());if(!this.glBlitProgram.getStatus())throw new Error(this.glDefaultProgram.getAllErrors());this.setShaderProgram(this.glDefaultProgram);let e=this.attrib_location_buffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),t.STATIC_DRAW),t.enableVertexAttribArray(this.shaderProgram.attrib_location),t.vertexAttribPointer(this.shaderProgram.attrib_location,2,t.FLOAT,t.FALSE,2*Float32Array.BYTES_PER_ELEMENT,0*Float32Array.BYTES_PER_ELEMENT),t.clearColor(0,0,0,1),t.enable(t.DEPTH_TEST),t.clearDepth(0),t.depthFunc(t.GEQUAL),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),this.m_location=new Float32Array(9).fill(0),this.m_texture=new Float32Array(9).fill(0),this.v_texture_size=new Float32Array(2).fill(0),this.v_resolution=new Float32Array(2).fill(0),this.zvalue=0,$8e088f0009ece130$export$9099ad97b570f7c.loadIdentity(this.m_location),$8e088f0009ece130$export$9099ad97b570f7c.loadIdentity(this.m_texture),this.drawImage=function(t,e=0,r=0,i=null,a=null,n=null,s=null,o=null,c=null){if(!t.glTextureReady)return;let l=this.gl,h=this.shaderProgram;if(l.uniform2fv(h.uniform_resolution,this.v_resolution),l.uniform1f(h.uniform_time,$f37b9fd5341d0b91$export$9099ad97b570f7c.time),l.uniform1f(h.uniform_scale,this._globalScale),l.uniform1f(h.uniform_alpha,this._alpha),this.glActiveTextureId===t.glTextureId&&this.glActiveShader===h||(l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,t.glTextureId),l.uniform1i(h.uniform_texture_0,0),this.v_texture_size[0]=t.width,this.v_texture_size[1]=t.height,l.uniform2fv(h.uniform_texture_size,this.v_texture_size),this.glActiveTextureId=t.glTextureId,this.glActiveShader=h),null===i)return this.m_location[0]=t.width,this.m_location[4]=t.height,this.m_location[6]=e,this.m_location[7]=r,this.m_texture[0]=t.width,this.m_texture[4]=t.height,this.m_texture[6]=0,this.m_texture[7]=0,l.uniformMatrix3fv(h.uniform_transform_matrix,!1,this.transform.data),l.uniformMatrix3fv(h.uniform_location_matrix,!1,this.m_location),l.uniformMatrix3fv(h.uniform_texture_matrix,!1,this.m_texture),l.uniform1f(h.uniform_depth,this.zvalue),void l.drawArrays(l.TRIANGLE_STRIP,0,4);null!==n&&(this.m_location[0]=o,this.m_location[4]=c,this.m_location[6]=n,this.m_location[7]=s,this.m_texture[0]=i,this.m_texture[4]=a,this.m_texture[6]=e,this.m_texture[7]=r,l.uniformMatrix3fv(h.uniform_transform_matrix,!1,this.transform.data),l.uniformMatrix3fv(h.uniform_location_matrix,!1,this.m_location),l.uniformMatrix3fv(h.uniform_texture_matrix,!1,this.m_texture),l.uniform1f(h.uniform_depth,this.zvalue),l.drawArrays(l.TRIANGLE_STRIP,0,4))},this.drawRect=function(t,e,r,i){let a=this.gl,n=this.shaderProgram;a.uniform2fv(n.uniform_resolution,this.v_resolution),a.uniform1f(n.uniform_time,$f37b9fd5341d0b91$export$9099ad97b570f7c.time),a.uniform1f(n.uniform_scale,this._globalScale),a.uniform1f(n.uniform_alpha,this._alpha),this.glActiveTextureId=null,this.v_texture_size[0]=r,this.v_texture_size[1]=i,a.uniform2fv(n.uniform_texture_size,this.v_texture_size),this.m_location[0]=r,this.m_location[4]=i,this.m_location[6]=t,this.m_location[7]=e,this.m_texture[0]=r,this.m_texture[4]=i,this.m_texture[6]=0,this.m_texture[7]=0,a.uniformMatrix3fv(n.uniform_transform_matrix,!1,this.transform.data),a.uniformMatrix3fv(n.uniform_location_matrix,!1,this.m_location),a.uniformMatrix3fv(n.uniform_texture_matrix,!1,this.m_texture),a.uniform1f(n.uniform_depth,this.zvalue),a.drawArrays(a.TRIANGLE_STRIP,0,4)}},$8cb3108385e4214b$var$Canvas.prototype.prepareImage=function(t){let e=this.gl;if(null==e)return!1;let r=e.createTexture();return e.bindTexture(e.TEXTURE_2D,r),e.texStorage2D(e.TEXTURE_2D,1,e.RGBA8,t.width,t.height),e.texSubImage2D(e.TEXTURE_2D,0,0,0,t.width,t.height,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t.glTextureId=r,t.glTextureReady=!0,!0},$8cb3108385e4214b$var$Canvas.prototype.applyConfig=function(){0==this.antialias?(null!=this.context&&(this.context.imageSmoothingEnabled=!1),this.elem.style.imageRendering="crisp-edges"):(null!=this.context&&(this.context.imageSmoothingEnabled=!0),this.elem.style.imageRendering="auto")},$8cb3108385e4214b$var$Canvas.prototype.dispose=function(){this.elem.parentNode&&this.elem.parentNode.removeChild(this.elem),this.matrixStack.free(),this.alphaStack.free(),this.depthFlagStack.free(),this.shaderProgramStack.free(),this.matr=null,this.context=null,this.elem=null},$8cb3108385e4214b$var$Canvas.prototype.setBackground=function(t){if(this.elem.style.background=t,this.backgroundColor=t,null!==this.gl){if(7!=t.length)throw new Error("Canvas.setBackground: color parameter should be CSS-style hex-rgb with 6 digits.");let e=parseInt(t.substr(1,2),16)/255,r=parseInt(t.substr(3,2),16)/255,i=parseInt(t.substr(5,2),16)/255;this.gl.clearColor(e,r,i,1)}},$8cb3108385e4214b$var$Canvas.prototype.resize=function(t,e){let r=this.elem.getBoundingClientRect();t||(t=r.width),e||(e=r.height),this.elem.width=t,this.elem.height=e,this.width=this.elem.width,this.height=this.elem.height,this._width=int(this.width/this._globalScale),this._height=int(this.height/this._globalScale);let i=this.gl;return null!=i&&(i.enable(i.SCISSOR_TEST),i.scissor(0,0,this.width,this.height),i.viewport(0,0,this.width,this.height),this.v_resolution&&(this.v_resolution[0]=this.width,this.v_resolution[1]=this.height)),this.applyConfig(),this},$8cb3108385e4214b$var$Canvas.prototype.globalScale=function(t){return this._globalScale=t,this._width=int(this.width/this._globalScale),this._height=int(this.height/this._globalScale),this.loadIdentity(),this.scale(t,t),this},$8cb3108385e4214b$var$Canvas.prototype.flipped=function(t){return t?(this._width=int(this.height/this._globalScale),this._height=int(this.width/this._globalScale)):(this._width=int(this.width/this._globalScale),this._height=int(this.height/this._globalScale)),this.isFlipped=t,this},$8cb3108385e4214b$var$Canvas.prototype.pushClip=function(){return this},$8cb3108385e4214b$var$Canvas.prototype.popClip=function(){return null!=this.gl&&this.gl.scissor(0,0,this.width,this.height),this},$8cb3108385e4214b$var$Canvas.prototype.toDataUrl=function(t="image/png",e=null){return this.elem.toDataURL(t,e)},$8cb3108385e4214b$var$Canvas.prototype.toPng64=function(){return this.elem.toDataURL("image/png").substr(22)},$8cb3108385e4214b$var$Canvas.prototype._contextAttribute=function(t,e=null){if(this.context)return null!==e?(this.context[t]=e,this):this.context[t]},$8cb3108385e4214b$var$Canvas.prototype.fillStyle=function(t){return this._contextAttribute("fillStyle",t)},$8cb3108385e4214b$var$Canvas.prototype.strokeStyle=function(t){return this._contextAttribute("strokeStyle",t)},$8cb3108385e4214b$var$Canvas.prototype.lineCap=function(t){return this._contextAttribute("lineCap",t)},$8cb3108385e4214b$var$Canvas.prototype.lineJoin=function(t){return this._contextAttribute("lineJoin",t)},$8cb3108385e4214b$var$Canvas.prototype.lineWidth=function(t){return this._contextAttribute("lineWidth",t)},$8cb3108385e4214b$var$Canvas.prototype.miterLimit=function(t){return this._contextAttribute("miterLimit",t)},$8cb3108385e4214b$var$Canvas.prototype.shadowColor=function(t){return this._contextAttribute("shadowColor",t)},$8cb3108385e4214b$var$Canvas.prototype.shadowOffsetX=function(t){return this._contextAttribute("shadowOffsetX",t)},$8cb3108385e4214b$var$Canvas.prototype.shadowOffsetY=function(t){return this._contextAttribute("shadowOffsetY",t)},$8cb3108385e4214b$var$Canvas.prototype.shadowBlur=function(t){return this._contextAttribute("shadowBlur",t)},$8cb3108385e4214b$var$Canvas.prototype.font=function(t){return this._contextAttribute("font",t)},$8cb3108385e4214b$var$Canvas.prototype.textAlign=function(t){return this._contextAttribute("textAlign",t)},$8cb3108385e4214b$var$Canvas.prototype.textBaseline=function(t){return this._contextAttribute("textBaseline",t)},$8cb3108385e4214b$var$Canvas.prototype.globalAlpha=function(t=null){return null===t?this._alpha:(this._alpha=t,this.alpha(1))},$8cb3108385e4214b$var$Canvas.prototype.globalCompositeOperation=function(t){return this._contextAttribute("globalCompositeOperation",t)},$8cb3108385e4214b$var$Canvas.prototype.updateTransform=function(){return this.setTransform(this.matr.data[0],this.matr.data[1],this.matr.data[3],this.matr.data[4],this.matr.data[6],this.matr.data[7]),this},$8cb3108385e4214b$var$Canvas.prototype.setTransform=function(t,e,r,i,a,n){return null===this.context?(this.transform.data[0]=t,this.transform.data[1]=e,this.transform.data[2]=0,this.transform.data[3]=r,this.transform.data[4]=i,this.transform.data[5]=0,this.transform.data[6]=int(a),this.transform.data[7]=int(n),this.transform.data[8]=1,this):(this.context.setTransform(t,e,r,i,int(a),int(n)),this)},$8cb3108385e4214b$var$Canvas.prototype.fillRect=function(t,e,r,i){return this.context.fillRect(t,e,r,i),this},$8cb3108385e4214b$var$Canvas.prototype.strokeRect=function(t,e,r,i){return this.context.strokeRect(t,e,r,i),this},$8cb3108385e4214b$var$Canvas.prototype.clearRect=function(t,e,r,i){return this.context.clearRect(t,e,r,i),this},$8cb3108385e4214b$var$Canvas.prototype.beginPath=function(){return this.context.beginPath(),this},$8cb3108385e4214b$var$Canvas.prototype.moveTo=function(t,e){return this.context.moveTo(t,e),this},$8cb3108385e4214b$var$Canvas.prototype.closePath=function(){return this.context.closePath(),this},$8cb3108385e4214b$var$Canvas.prototype.lineTo=function(t,e){return this.context.lineTo(t,e),this},$8cb3108385e4214b$var$Canvas.prototype.rect=function(t,e,r,i){return this.context.rect(t,e,r,i),this},$8cb3108385e4214b$var$Canvas.prototype.fill=function(t=null){return t&&this.fillStyle(t),this.context.fill(),this},$8cb3108385e4214b$var$Canvas.prototype.stroke=function(t=null){return t&&this.strokeStyle(t),this.context.stroke(),this},$8cb3108385e4214b$var$Canvas.prototype.clip=function(t,e,r,i){return null!==this.gl&&(t*=this._globalScale,e*=this._globalScale,r*=this._globalScale,i*=this._globalScale,this.isFlipped?this.gl.scissor(this.width-e-i-1,this.height-t-r-1,i,r):this.gl.scissor(t,this.height-e-i-1,r,i)),this},$8cb3108385e4214b$var$Canvas.prototype.quadraticCurveTo=function(t,e,r,i){return this.context.quadraticCurveTo(t,e,r,i),this},$8cb3108385e4214b$var$Canvas.prototype.bezierCurveTo=function(t,e,r,i,a,n){return this.context.bezierCurveTo(t,e,r,i,a,n),this},$8cb3108385e4214b$var$Canvas.prototype.arc=function(t,e,r,i,a,n){return this.context.arc(t,e,r,i,a,n),this},$8cb3108385e4214b$var$Canvas.prototype.arcTo=function(t,e,r,i,a){return this.context.arcTo(t,e,r,i,a),this},$8cb3108385e4214b$var$Canvas.prototype.fillText=function(t,e,r,i=1e3){return this.context.fillText(t,e,r,i),this},$8cb3108385e4214b$var$Canvas.prototype.strokeText=function(t,e,r,i=1e3){return this.context.strokeText(t,e,r,i),this},$8cb3108385e4214b$var$Canvas.prototype.measureText=function(t){return this.context.measureText(t).width},$8cb3108385e4214b$var$Canvas.prototype.createImageData=function(t,e){return this.context.createImageData(t,e)},$8cb3108385e4214b$var$Canvas.prototype.getImageData=function(t,e,r,i){return this.context.getImageData(t,e,r,i)},$8cb3108385e4214b$var$Canvas.prototype.putImageData=function(t,e,r){return this.context.putImageData(t,e,r),this},$8cb3108385e4214b$var$Canvas.prototype.drawImage=function(t,e=0,r=0,i=null,a=null,n=null,s=null,o=null,c=null){if(null===i)this.context.drawImage(t,int(e),int(r));else if(null===n)this.context.drawImage(t,int(e),int(r),int(i),int(a));else{let l=int(i),h=int(a);if(!l||!h)return this;let u=int(o),f=int(c);if(!u||!f)return this;this.context.drawImage(t,int(e),int(r),l,h,int(n),int(s),u,f)}return this},$8cb3108385e4214b$var$Canvas.prototype.clear=function(t=null){return null!=this.gl?(this.gl.clear(this.gl.DEPTH_BUFFER_BIT|this.gl.COLOR_BUFFER_BIT),this.glActiveTextureId=null,this):(t?this.globalCompositeOperation("source-over").globalAlpha(1).fillStyle(!0!==t?t:this.backgroundColor).fillRect(0,0,this._width,this._height):(this.elem.width=this.width,this.applyConfig()),this.updateTransform(),this)},$8cb3108385e4214b$var$Canvas.prototype.start=function(){},$8cb3108385e4214b$var$Canvas.prototype.end=function(){},$8cb3108385e4214b$var$Canvas.prototype.flush=function(){let t=this.gl;null!==t&&(t.colorMask(!1,!1,!1,!0),t.clear(t.COLOR_BUFFER_BIT),t.colorMask(!0,!0,!0,!0))},$8cb3108385e4214b$var$Canvas.prototype.blit=function(t,e,r,i=null){let a=this.gl;null!==a&&(i=i||this.glBlitProgram,this.setShaderProgram(i),a.disable(a.DEPTH_TEST),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,t),a.uniform1i(i.uniform_texture_0,0),a.uniform2fv(i.uniform_resolution,this.v_resolution),a.uniform1f(i.uniform_time,$f37b9fd5341d0b91$export$9099ad97b570f7c.time),a.uniform1f(i.uniform_scale,this._globalScale),a.uniform1f(i.uniform_alpha,this._alpha),this.v_texture_size[0]=e,this.v_texture_size[1]=r,a.uniform2fv(i.uniform_texture_size,this.v_texture_size),this.m_location[0]=this.width,this.m_location[4]=this.height,this.m_location[6]=0,this.m_location[7]=0,this.m_texture[0]=this.width,this.m_texture[4]=this.height,this.m_texture[6]=0,this.m_texture[7]=0,a.uniformMatrix3fv(i.uniform_location_matrix,!1,this.m_location),a.uniformMatrix3fv(i.uniform_texture_matrix,!1,this.m_texture),a.drawArrays(a.TRIANGLE_STRIP,0,4),this.setShaderProgram(this.glDefaultProgram),a.enable(a.DEPTH_TEST))},$8cb3108385e4214b$var$Canvas.prototype.reset=function(t=!1){return this.fillStyle("#000000").strokeStyle("#000000").lineCap("butt").lineJoin("miter").lineWidth("1").miterLimit("10").shadowColor("#000000").shadowOffsetX("0").shadowOffsetY("0").shadowBlur("0").globalAlpha("1.0").globalCompositeOperation("source-over"),t&&this.beginPath().closePath(),this},$8cb3108385e4214b$var$Canvas.prototype.pushMatrix=function(){return this.matrixStack.push(this.matr),this.matr=this.matr.clone(),this},$8cb3108385e4214b$var$Canvas.prototype.popMatrix=function(){return this.matr.free(),this.matr=this.matrixStack.pop(),this.updateTransform()},$8cb3108385e4214b$var$Canvas.prototype.alpha=function(t){return this._alpha*=t,this.context&&null===this.gl&&(this.context.globalAlpha=this._alpha),this},$8cb3108385e4214b$var$Canvas.prototype.pushAlpha=function(){return this.alphaStack.push(this.globalAlpha()),this},$8cb3108385e4214b$var$Canvas.prototype.popAlpha=function(){return this.globalAlpha(this.alphaStack.pop()),this},$8cb3108385e4214b$var$Canvas.prototype.setDepthFlag=function(t){let e=this.gl;null!==e&&(t?(e.enable(e.DEPTH_TEST),this._depthFlag=!0):(e.disable(e.DEPTH_TEST),this._depthFlag=!1))},$8cb3108385e4214b$var$Canvas.prototype.getDepthFlag=function(){return this._depthFlag},$8cb3108385e4214b$var$Canvas.prototype.pushDepthFlag=function(t=null){if(null!==t)return(t=!!t)!==this._depthFlag&&(this.depthFlagStack.push(this._depthFlag),this.setDepthFlag(t),!0);this.depthFlagStack.push(this._depthFlag)},$8cb3108385e4214b$var$Canvas.prototype.popDepthFlag=function(){this.setDepthFlag(this.depthFlagStack.pop())},$8cb3108385e4214b$var$Canvas.prototype.setShaderProgram=function(t){null!==this.gl&&(this.shaderProgram=t,this.shaderProgram.use())},$8cb3108385e4214b$var$Canvas.prototype.getShaderProgram=function(){return this.shaderProgram},$8cb3108385e4214b$var$Canvas.prototype.pushShaderProgram=function(t=null){if(null!==t)return t!==this.shaderProgram&&(this.shaderProgramStack.push(this.shaderProgram),this.setShaderProgram(t),!0);this.shaderProgramStack.push(this.shaderProgram)},$8cb3108385e4214b$var$Canvas.prototype.popShaderProgram=function(){this.setShaderProgram(this.shaderProgramStack.pop())},$8cb3108385e4214b$var$Canvas.prototype.loadIdentity=function(){return this.matr.identity(),this.updateTransform()},$8cb3108385e4214b$var$Canvas.prototype.loadMatrix=function(t){return this.matr.set(t),this.updateTransform()},$8cb3108385e4214b$var$Canvas.prototype.getMatrix=function(t=!1){return t?this.matr.clone():this.matr},$8cb3108385e4214b$var$Canvas.prototype.appendMatrix=function(t){return this.matr.append(t),this.updateTransform()},$8cb3108385e4214b$var$Canvas.prototype.scale=function(t,e,r){return r?(this.context.scale(t,e),this):(this.matr.scale(t,e),this.updateTransform())},$8cb3108385e4214b$var$Canvas.prototype.rotate=function(t,e){return e?(this.context.rotate(t),this):(this.matr.rotate(t),this.updateTransform())},$8cb3108385e4214b$var$Canvas.prototype.translate=function(t,e,r){return r?(this.context.translate(t,e),this):(this.matr.translate(t,e),this.updateTransform())},$8cb3108385e4214b$var$Canvas.prototype.ellipse=function(t,e,r,i){var a=r/2*.5522848,n=i/2*.5522848,s=t+r-1,o=e+i-1,c=t+r/2,l=e+i/2;return this.beginPath().moveTo(t,l),this.bezierCurveTo(t,l-n,c-a,e,c,e),this.bezierCurveTo(c+a,e,s,l-n,s,l),this.bezierCurveTo(s,l+n,c+a,o,c,o),this.bezierCurveTo(c-a,o,t,l+n,t,l),this.closePath(),this},$8cb3108385e4214b$var$Canvas.prototype.circle=function(t,e,r,i){return this.beginPath(),this.arc(t,e,r,0,2*Math.PI),this.closePath(),i&&this.stroke(i),this},$8cb3108385e4214b$var$Canvas.prototype.line=function(t,e,r,i,a){return this.beginPath(),this.moveTo(t,e),this.lineTo(r,i),this.closePath(),a&&this.stroke(a),this},$8cb3108385e4214b$var$Canvas.prototype.enablePointerEvents=function(){if(this.pointerHandler)return this;this.pointerScale={sx:1,sy:1},this.pointerOffset={x:0,y:0};var t=this,e={action:"",buttons:0,lbuttons:0,x:0,y:0,containedBy:function(t,e,r,i){return this.x>=t&&this.x<=t+r-1&&this.y>=e&&this.y<=e+i-1}};return this.pointerHandlers=[],this.pointerHandler=function(r,i){var a=this.elem.getBoundingClientRect();e.action=r,e.buttons=i.buttons,e.x=e.rx=int(i.clientX-a.left),e.y=e.ry=int(i.clientY-a.top),e.x=(e.x-t.pointerOffset.x-0*t.pointerScale.sx)/t.pointerScale.sx,e.y=(e.y-t.pointerOffset.y-0*t.pointerScale.sy)/t.pointerScale.sy,e.dragging=!1,e.buttons&&!e.lbuttons&&(e.sx=e.x,e.sy=e.y,e.ldx=e.ldy=0),e.buttons&&e.lbuttons&&(e.dragging=!0,e.dx=e.x-e.sx,e.dy=e.y-e.sy,e.ddx=e.dx-e.ldx,e.ddy=e.dy-e.ldy,e.ldx=e.dx,e.ldy=e.dy),e.lbuttons=e.buttons;for(var n=0;n<this.pointerHandlers.length&&!1!==this.pointerHandlers[n][1](e,this.pointerHandlers[n][2]);n++);},this.elem.onmousedown=function(e){t.pointerHandler("DOWN",e)},this.elem.onmouseup=function(e){t.pointerHandler("UP",e)},this.elem.onmousemove=function(e){t.pointerHandler("MOVE",e)},this},$8cb3108385e4214b$var$Canvas.prototype.setPointerScale=function(t,e){return this.pointerScale={sx:t,sy:e},this},$8cb3108385e4214b$var$Canvas.prototype.setPointerOffset=function(t,e){return this.pointerOffset={x:t,y:e},this},$8cb3108385e4214b$var$Canvas.prototype.addPointerHandler=function(t,e){return this.enablePointerEvents(),this.pointerHandlers.push([this.pointerHandlers.length+"_"+int(1e6*Math.random()),t,e]),this.pointerHandlers[this.pointerHandlers.length-1][0]},$8cb3108385e4214b$var$Canvas.prototype.removePointerHandler=function(t){if(this.pointerHandlers)for(var e=0;e<this.pointerHandlers.length;e++)if(this.pointerHandlers[e][0]==t){this.pointerHandlers.splice(e,1);break}},$8cb3108385e4214b$var$Canvas.prototype.drawImageResource=function(t,e=0,r=0,i=null,a=null){return null===i?this.drawImage(t.data,0,0,t.data.width,t.data.height,e,r,t.width,t.height):this.drawImage(t.data,0,0,t.data.width,t.data.height,e,r,i,a)},$8cb3108385e4214b$var$Canvas.renderImage=function(t,e,r,i){let a=new $8cb3108385e4214b$var$Canvas({width:t,height:e});r(a);let n=new Image;n.onload=()=>{$d36cc4eae272df9c$export$9099ad97b570f7c.renderer.prepareImage(n),i(n)},n.src=a.toDataUrl(),a.dispose()};var $8cb3108385e4214b$export$9099ad97b570f7c=$8cb3108385e4214b$var$Canvas;const $d36cc4eae272df9c$var$System={flags:{renderingEnabled:!1,renderingPaused:!1},EVT_KEY_DOWN:1,EVT_KEY_UP:2,EVT_POINTER_DOWN:16,EVT_POINTER_UP:17,EVT_POINTER_MOVE:18,EVT_POINTER_DRAG_START:19,EVT_POINTER_DRAG_MOVE:20,EVT_POINTER_DRAG_STOP:21,DEFAULT:"default",LANDSCAPE:"landscape",PORTRAIT:"portrait",AUTOMATIC:"automatic",defaultOptions:{background:"#000000",gl:!0,overdraw:!1,canvas:null,canvas2:null,canvas3:null,fps:144,minFps:15,vsync:!0,antialias:!0,screenWidth:null,screenHeight:null,orientation:0,extraScaleFactor:1,fullscreen:!1},screenWidth:0,screenHeight:0,orientation:0,offsX:0,offsY:0,devicePixelRatio:1,backingStoreRatio:1,canvasPixelRatio:1,canvasScaleFactor:1,scaleFactor:1,initialMatrix:null,renderer:null,displayBuffer2:null,displayBuffer3:null,tempDisplayBuffer:null,keyState:{time:0,shift:!1,ctrl:!1,alt:!1,keyCode:0},pointerState:{},updateQueue:null,drawQueue:null,timeScale:1,frameInterval:0,fixedFrameInterval:0,maxFrameInterval:0,frameDelta:0,frameTime:0,frameNumber:0,perf:{startTime:0,lastTime:0,numFrames:0,numSamples:0,updateTimeTotal:0,drawTimeTotal:0,extraTimeTotal:0,fps:0,averageFps:0,averageUpdateTime:0,averageDrawTime:0,averageExtraTime:0},init:function(t=null){let e=this,r={...this.defaultOptions,...t};this.options=r,r.screenWidth&&r.screenHeight&&r.orientation==$d36cc4eae272df9c$var$System.DEFAULT&&(r.orientation=r.screenWidth>r.screenHeight?$d36cc4eae272df9c$var$System.LANDSCAPE:$d36cc4eae272df9c$var$System.PORTRAIT),this.orientation=r.orientation,this.updateQueue=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),this.drawQueue=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),this.frameInterval=1e3/r.fps,this.maxFrameInterval=1e3/r.minFps,$parcel$global.onresize=function(){e.onWindowResized()},this.frameTimer=new $b2a8f8940aea7a8f$export$9099ad97b570f7c(r.vsync,this.frameInterval,(t=>this.onFrame(t))),this.renderer=new $8cb3108385e4214b$export$9099ad97b570f7c({gl:r.gl,elem:r.canvas,absolute:!0,hidden:!1,antialias:r.antialias,background:r.background}),this.displayBuffer2=new $8cb3108385e4214b$export$9099ad97b570f7c({gl:!1,elem:r.canvas2,absolute:!0,hidden:!1,antialias:r.antialias,background:"none"}),this.displayBuffer2.elem.style.pointerEvents="none",this.displayBuffer3=new $8cb3108385e4214b$export$9099ad97b570f7c({gl:!1,elem:r.canvas3,absolute:!0,hidden:!1,antialias:r.antialias,background:"none"}),this.displayBuffer3.elem.style.pointerEvents="none",this.tempDisplayBuffer=new $8cb3108385e4214b$export$9099ad97b570f7c({hidden:!0,antialias:r.antialias}).resize(320,240);let i=this.renderer.elem;this.devicePixelRatio=$parcel$global.devicePixelRatio||1,this.backingStoreRatio=1==r.gl?1:this.renderer.context.webkitBackingStorePixelRatio||this.renderer.context.mozBackingStorePixelRatio||this.renderer.context.msBackingStorePixelRatio||this.renderer.context.oBackingStorePixelRatio||this.renderer.context.backingStorePixelRatio||1,this.canvasPixelRatio=this.devicePixelRatio/this.backingStoreRatio,$d36cc4eae272df9c$var$System.onWindowResized(!0),$parcel$global.onkeydown=function(t){if(t.target===$parcel$global.document.body){if(e.keyState[t.keyCode])return!1;switch(e.keyState[t.keyCode]=!0,e.keyState.keyCode=t.keyCode,e.keyState.startTime=hrnow(),t.keyCode){case 16:e.keyState.shift=!0;break;case 17:e.keyState.ctrl=!0;break;case 18:e.keyState.alt=!0}return e.keyState.ctrl&&t.keyCode==$c4eb26169b07d885$export$9099ad97b570f7c.TAB?(e.keyState[t.keyCode]=!1,!0):!1!==e.onKeyboardEvent(e.EVT_KEY_DOWN,t.keyCode,e.keyState)&&void 0}},$parcel$global.onkeyup=function(t){if(t.target===$parcel$global.document.body){if(!e.keyState[t.keyCode])return!1;switch(e.keyState[t.keyCode]=!1,e.keyState.endTime=hrnow(),e.keyState.keyCode=t.keyCode,t.keyCode){case 16:e.keyState.shift=!1;break;case 17:e.keyState.ctrl=!1;break;case 18:e.keyState.alt=!1}return!1!==e.onKeyboardEvent(e.EVT_KEY_UP,t.keyCode,e.keyState)&&void 0}};const a=function(t,e){return $d36cc4eae272df9c$var$System.reverseRender?int($d36cc4eae272df9c$var$System.screenWidth-1-(e-$d36cc4eae272df9c$var$System.offsY)/$d36cc4eae272df9c$var$System.canvasScaleFactor):int((t-$d36cc4eae272df9c$var$System.offsX)/$d36cc4eae272df9c$var$System.canvasScaleFactor)},n=function(t,e){return $d36cc4eae272df9c$var$System.reverseRender?int((t-$d36cc4eae272df9c$var$System.offsX)/$d36cc4eae272df9c$var$System.canvasScaleFactor):int((e-$d36cc4eae272df9c$var$System.offsY)/$d36cc4eae272df9c$var$System.canvasScaleFactor)};"ontouchstart"in $parcel$global?(i.ontouchstart=function(t){t.preventDefault();let e=t.changedTouches;for(let t=0;t<e.length;t++){$d36cc4eae272df9c$var$System.pointerState[e[t].identifier]||($d36cc4eae272df9c$var$System.pointerState[e[t].identifier]={id:e[t].identifier,isActive:!1,isDragging:!1,sx:0,sy:0,x:0,y:0,dx:0,dy:0,button:0});let r=$d36cc4eae272df9c$var$System.pointerState[e[t].identifier];r.isActive=!0,r.isDragging=!1,r.button=1,r.startTime=hrnow(),r.x=r.sx=a(e[t].clientX,e[t].clientY),r.y=r.sy=n(e[t].clientX,e[t].clientY),$d36cc4eae272df9c$var$System.onPointerEvent($d36cc4eae272df9c$var$System.EVT_POINTER_DOWN,r,$d36cc4eae272df9c$var$System.pointerState)}return!1},i.ontouchend=function(t){t.preventDefault();let e=t.changedTouches;for(let t=0;t<e.length;t++){if(!$d36cc4eae272df9c$var$System.pointerState[e[t].identifier])continue;let r=$d36cc4eae272df9c$var$System.pointerState[e[t].identifier];r.endTime=hrnow(),r.deltaTime=r.endTime-r.startTime,r.x=a(e[t].clientX,e[t].clientY),r.y=n(e[t].clientX,e[t].clientY),r.isDragging&&$d36cc4eae272df9c$var$System.onPointerEvent($d36cc4eae272df9c$var$System.EVT_POINTER_DRAG_STOP,r,$d36cc4eae272df9c$var$System.pointerState),$d36cc4eae272df9c$var$System.onPointerEvent($d36cc4eae272df9c$var$System.EVT_POINTER_UP,r,$d36cc4eae272df9c$var$System.pointerState),r.isActive=!1,r.isDragging=!1,r.button=0}return!1},i.ontouchcancel=function(t){t.preventDefault();let e=t.changedTouches;for(let t=0;t<e.length;t++){if(!$d36cc4eae272df9c$var$System.pointerState[e[t].identifier])continue;let r=$d36cc4eae272df9c$var$System.pointerState[e[t].identifier];r.x=a(e[t].clientX,e[t].clientY),r.y=n(e[t].clientX,e[t].clientY),$d36cc4eae272df9c$var$System.onPointerEvent(r.isDragging?$d36cc4eae272df9c$var$System.EVT_POINTER_DRAG_STOP:$d36cc4eae272df9c$var$System.EVT_POINTER_UP,r,$d36cc4eae272df9c$var$System.pointerState),r.isActive=!1,r.isDragging=!1,r.button=0}return!1},i.ontouchmove=function(t){t.preventDefault();let e=t.changedTouches;for(let t=0;t<e.length;t++){if(!$d36cc4eae272df9c$var$System.pointerState[e[t].identifier])continue;let r=$d36cc4eae272df9c$var$System.pointerState[e[t].identifier];r.isActive&&!r.isDragging&&($d36cc4eae272df9c$var$System.onPointerEvent($d36cc4eae272df9c$var$System.EVT_POINTER_DRAG_START,r,$d36cc4eae272df9c$var$System.pointerState),r.isDragging=!0),r.x=a(e[t].clientX,e[t].clientY),r.y=n(e[t].clientX,e[t].clientY),r.dx=r.x-r.sx,r.dy=r.y-r.sy,$d36cc4eae272df9c$var$System.onPointerEvent(r.isDragging?$d36cc4eae272df9c$var$System.EVT_POINTER_DRAG_MOVE:$d36cc4eae272df9c$var$System.EVT_POINTER_MOVE,r,$d36cc4eae272df9c$var$System.pointerState)}return!1}):(i.onmousedown=function(t){t.preventDefault(),$d36cc4eae272df9c$var$System.pointerState[0]||($d36cc4eae272df9c$var$System.pointerState[0]={id:0,isActive:!1,isDragging:!1,button:0,sx:0,sy:0,x:0,y:0,dx:0,dy:0});let e=$d36cc4eae272df9c$var$System.pointerState[0];return e.isActive=!0,e.isDragging=!1,e.button=t.which,e.x=e.sx=a(t.clientX,t.clientY),e.y=e.sy=n(t.clientX,t.clientY),$d36cc4eae272df9c$var$System.onPointerEvent($d36cc4eae272df9c$var$System.EVT_POINTER_DOWN,e,$d36cc4eae272df9c$var$System.pointerState),!1},i.onmouseup=function(t){if(t.preventDefault(),!$d36cc4eae272df9c$var$System.pointerState[0])return!1;let e=$d36cc4eae272df9c$var$System.pointerState[0];e.x=a(t.clientX,t.clientY),e.y=n(t.clientX,t.clientY),e.isDragging&&$d36cc4eae272df9c$var$System.onPointerEvent($d36cc4eae272df9c$var$System.EVT_POINTER_DRAG_STOP,e,$d36cc4eae272df9c$var$System.pointerState),$d36cc4eae272df9c$var$System.onPointerEvent($d36cc4eae272df9c$var$System.EVT_POINTER_UP,e,$d36cc4eae272df9c$var$System.pointerState),e.isActive=!1,e.isDragging=!1,e.button=0},i.onmousemove=function(t){if(t.preventDefault(),!$d36cc4eae272df9c$var$System.pointerState[0])return!1;let e=$d36cc4eae272df9c$var$System.pointerState[0];return e.isActive&&!e.isDragging&&($d36cc4eae272df9c$var$System.onPointerEvent($d36cc4eae272df9c$var$System.EVT_POINTER_DRAG_START,e,$d36cc4eae272df9c$var$System.pointerState),e.isDragging=!0),e.x=a(t.clientX,t.clientY),e.y=n(t.clientX,t.clientY),e.dx=e.x-e.sx,e.dy=e.y-e.sy,$d36cc4eae272df9c$var$System.onPointerEvent(e.isDragging?$d36cc4eae272df9c$var$System.EVT_POINTER_DRAG_MOVE:$d36cc4eae272df9c$var$System.EVT_POINTER_MOVE,e,$d36cc4eae272df9c$var$System.pointerState),!1})},time:function(){return this.frameTime},start:function(){this.onWindowResized(),this.flags.renderingPaused=!1,this.frameTimer.start()},stop:function(){this.flags.renderingPaused=!0,this.frameTimer.stop()},pause:function(){this.flags.renderingPaused=!0},resume:function(){this.flags.renderingPaused=!1,this.resetPerf()},onFrame:function(t){let e,r=hrnow();t>this.maxFrameInterval&&(t=this.maxFrameInterval),0!==this.fixedFrameInterval&&(t=this.fixedFrameInterval),this.flags.renderingEnabled&&!this.flags.renderingPaused?(t*=this.timeScale,this.frameDelta=t/1e3,this.frameTime+=this.frameDelta,$f37b9fd5341d0b91$export$9099ad97b570f7c.time=this.frameTime,this.frameNumber++,e=hrnow(),this.update(this.frameDelta),this.perf.updateTimeTotal+=hrnow()-e,e=hrnow(),this.draw(),this.perf.drawTimeTotal+=hrnow()-e,this.perf.lastTime=r,this.perf.numFrames++,(t=this.perf.lastTime-this.perf.startTime)>1e3&&(this.perf.fps=int(1e3*this.perf.numFrames/t),this.perf.averageFps=int((this.perf.averageFps*this.perf.numSamples+this.perf.fps)/(this.perf.numSamples+1)),this.perf.averageUpdateTime=int((this.perf.averageUpdateTime*this.perf.numSamples+1e3*this.perf.updateTimeTotal/this.perf.numFrames)/(this.perf.numSamples+1)),this.perf.averageDrawTime=int((this.perf.averageDrawTime*this.perf.numSamples+1e3*this.perf.drawTimeTotal/this.perf.numFrames)/(this.perf.numSamples+1)),this.perf.averageExtraTime=int((this.perf.averageExtraTime*this.perf.numSamples+1e3*this.perf.extraTimeTotal/this.perf.numFrames)/(this.perf.numSamples+1)),this.perf.numSamples++,this.perf.startTime=r,this.perf.lastTime=r,this.perf.numFrames=0,this.perf.updateTimeTotal=0,this.perf.drawTimeTotal=0,this.perf.extraTimeTotal=0)):this.draw()},onWindowResized:function(t=!1){if("document"in $parcel$global)this.options.fullscreen?(this._screenWidth=int($parcel$global.screen.width),this._screenHeight=int($parcel$global.screen.height)):(this._screenWidth=$parcel$global.innerWidth,this._screenHeight=$parcel$global.innerHeight);else if(this._screenWidth=this.options.screenWidth,this._screenHeight=this.options.screenHeight,null==this.options.screenWidth&&null==this.options.screenHeight)throw new Error("At least one screen dimension must be specified in headless mode.");this._screenWidth<this._screenHeight&&this.orientation==$d36cc4eae272df9c$var$System.LANDSCAPE||this._screenWidth>this._screenHeight&&this.orientation==$d36cc4eae272df9c$var$System.PORTRAIT?(this.screenWidth=this._screenHeight,this.screenHeight=this._screenWidth,this.reverseRender=!0):(this.screenWidth=this._screenWidth,this.screenHeight=this._screenHeight,this.reverseRender=!1);let e=this.options.screenWidth,r=this.options.screenHeight;null!==e&&null!==r||(null===e&&null===r?(e=this.screenWidth,r=this.screenHeight):null===e?e=int(this.screenWidth*(this.options.screenHeight/this.screenHeight)):null===r&&(r=int(this.screenHeight*(this.options.screenWidth/this.screenWidth))));let i=e,a=r;this.orientation==$d36cc4eae272df9c$var$System.AUTOMATIC&&i&&a&&(i>a&&this.screenWidth<this.screenHeight||i<a&&this.screenWidth>this.screenHeight)&&(i=a,a=e),this.canvasScaleFactor=1,i&&a?this.canvasScaleFactor=Math.min(this.screenWidth/i,this.screenHeight/a):i?this.canvasScaleFactor=this.screenWidth/i:a&&(this.canvasScaleFactor=this.screenHeight/a);let n=this.screenWidth,s=this.screenHeight;if(i&&(this.screenWidth=i),a&&(this.screenHeight=a),this.offsX=int(.5*(n-this.screenWidth*this.canvasScaleFactor)),this.offsY=int(.5*(s-this.screenHeight*this.canvasScaleFactor)),this.reverseRender){let t=this.offsX;this.offsX=this.offsY,this.offsY=t}this.scaleFactor=this.canvasScaleFactor*this.canvasPixelRatio,this.scaleFactor=int(.7+this.scaleFactor),this.flags.renderingEnabled=!1,"document"in $parcel$global&&($parcel$global.document.body.style.backgroundColor=this.renderer.backgroundColor),this.reverseRender?(this.renderer.resize(this.screenHeight*this.scaleFactor,this.screenWidth*this.scaleFactor),this.renderer.elem.style.width=this.screenHeight*this.canvasScaleFactor+"px",this.renderer.elem.style.height=this.screenWidth*this.canvasScaleFactor+"px",this.displayBuffer2.resize(this.screenHeight*this.scaleFactor,this.screenWidth*this.scaleFactor),this.displayBuffer2.elem.style.width=this.screenHeight*this.canvasScaleFactor+"px",this.displayBuffer2.elem.style.height=this.screenWidth*this.canvasScaleFactor+"px",this.displayBuffer3.resize(s,n),this.displayBuffer3.elem.style.width=s+"px",this.displayBuffer3.elem.style.height=n+"px"):(this.renderer.resize(this.screenWidth*this.scaleFactor,this.screenHeight*this.scaleFactor),this.renderer.elem.style.width=this.screenWidth*this.canvasScaleFactor+"px",this.renderer.elem.style.height=this.screenHeight*this.canvasScaleFactor+"px",this.displayBuffer2.resize(this.screenWidth*this.scaleFactor,this.screenHeight*this.scaleFactor),this.displayBuffer2.elem.style.width=this.screenWidth*this.canvasScaleFactor+"px",this.displayBuffer2.elem.style.height=this.screenHeight*this.canvasScaleFactor+"px",this.displayBuffer3.resize(n,s),this.displayBuffer3.elem.style.width=n+"px",this.displayBuffer3.elem.style.height=s+"px"),this.renderer.elem.style.marginLeft=this.offsX+"px",this.renderer.elem.style.marginTop=this.offsY+"px",this.displayBuffer2.elem.style.marginLeft=this.offsX+"px",this.displayBuffer2.elem.style.marginTop=this.offsY+"px",this.renderer.loadIdentity(),this.displayBuffer2.loadIdentity(),this.displayBuffer3.loadIdentity(),1!=this.scaleFactor&&(this.renderer.globalScale(this.scaleFactor),this.displayBuffer2.globalScale(this.scaleFactor)),this.reverseRender?(this.renderer.rotate(Math.PI/2),this.renderer.translate(-this.screenWidth,0),this.renderer.flipped(!0),this.displayBuffer2.rotate(Math.PI/2),this.displayBuffer2.translate(-this.screenWidth,0),this.displayBuffer2.flipped(!0),this.displayBuffer3.rotate(Math.PI/2),this.displayBuffer3.translate(-n,0),this.displayBuffer3.flipped(!0)):(this.renderer.flipped(!1),this.displayBuffer2.flipped(!1),this.displayBuffer3.flipped(!1)),this.scaleFactor*=this.options.extraScaleFactor,this.integerScaleFactor=int(this.scaleFactor+.9),this.resetPerf(),this.initialMatrix&&this.initialMatrix.free(),this.initialMatrix=this.renderer.getMatrix(!0),1!=t&&(this.flags.renderingEnabled=!0,this.onCanvasResized(this.screenWidth,this.screenHeight))},onCanvasResized:function(t,e){},resetPerf:function(){this.perf.startTime=hrnow(),this.perf.lastTime=hrnow(),this.perf.numFrames=0,this.perf.updateTimeTotal=0,this.perf.drawTimeTotal=0,this.perf.extraTimeTotal=0,this.perf.numSamples=0,this.perf.fps=0,this.perf.averageFps=0,this.perf.averageUpdateTime=0,this.perf.averageDrawTime=0,this.perf.averageExtraTime=0},updateQueueAdd:function(t){return this.updateQueue.push(t),this.updateQueue.bottom},updateQueueRemove:function(t){this.updateQueue.remove(t instanceof $f2fc3aaf8b986d20$export$9099ad97b570f7c?t:this.updateQueue.sgetNode(t))},drawQueueAdd:function(t){return this.drawQueue.push(t),this.drawQueue.bottom},drawQueueRemove:function(t){this.drawQueue.remove(t instanceof $f2fc3aaf8b986d20$export$9099ad97b570f7c?t:this.drawQueue.sgetNode(t))},queueAdd:function(t){return this.updateQueue.push(t),this.drawQueue.push(t),t},queueRemove:function(t){this.updateQueue.remove(this.updateQueue.sgetNode(t)),this.drawQueue.remove(this.drawQueue.sgetNode(t))},update:function(t){try{let e;for(let r=this.updateQueue.top;r;r=e)e=r.next,r.value.update(t)}catch(t){throw $d36cc4eae272df9c$var$System.stop(),t}},draw:function(){null!==this.renderer.gl&&this.renderer.start(),this.options.overdraw||(this.renderer.clear(),this.displayBuffer2.clear(),this.displayBuffer3.clear());try{let t;for(let e=this.drawQueue.top;e;e=t)t=e.next,e.value.draw(this.renderer);null!==this.renderer.gl&&(this.renderer.flush(),this.renderer.end())}catch(t){throw $d36cc4eae272df9c$var$System.stop(),t}},interpolate:function(t,e,r,i,a){let n={},s={},o=0;for(let e in t)n[e]=0,s[e]=t[e],o++;let c={update:function(l){for(let a in n){if(n[a]==r[a])continue;n[a]+=l,n[a]>=r[a]&&(n[a]=r[a],o--);let c=i[a](n[a]/r[a]);s[a]=(1-c)*t[a]+c*e[a]}a(s,0==o),0==o&&$d36cc4eae272df9c$var$System.updateQueueRemove(c)}};$d36cc4eae272df9c$var$System.updateQueueAdd(c),c.update(0)},onKeyboardEvent:function(t,e,r){},onPointerEvent:function(t,e,r){}};var $d36cc4eae272df9c$export$9099ad97b570f7c=$d36cc4eae272df9c$var$System;const $c911639689a6d3da$var$Log={activated:!1,paused:!1,data:$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),count:0,maxsize:30,debugEcho:!1,color:"#fff",background:"#cf266a",vars:{},write:function(t){for(this.data.push(t),this.count++;this.data.length>this.maxsize;)this.data.shift();this.debugEcho&&console.debug(this.count+": "+t)},clear:function(){this.data.reset(),this.count=0},enable:function(t,e,r,i,a){if(this.activated)return;this.activated=!0,t||(t=0),e||(e=0),r||(r=9.5),!1===i&&(e-=16);let n=e;$d36cc4eae272df9c$export$9099ad97b570f7c.drawQueueAdd({draw:function(){if($c911639689a6d3da$var$Log.paused)return;let s=hrnow();const o=$d36cc4eae272df9c$export$9099ad97b570f7c.displayBuffer3;o.font("bold "+r+"pt Monospace"),o.textBaseline("top");let c="";e=n,!1!==i&&0!=$d36cc4eae272df9c$export$9099ad97b570f7c.perf.fps&&(c="fps: "+$d36cc4eae272df9c$export$9099ad97b570f7c.perf.fps+"/"+$d36cc4eae272df9c$export$9099ad97b570f7c.perf.averageFps+", update: "+$d36cc4eae272df9c$export$9099ad97b570f7c.perf.averageUpdateTime+", draw: "+$d36cc4eae272df9c$export$9099ad97b570f7c.perf.averageDrawTime+", extra: "+$d36cc4eae272df9c$export$9099ad97b570f7c.perf.averageExtraTime,$c911639689a6d3da$var$Log.background&&(o.fillStyle($c911639689a6d3da$var$Log.background),o.fillRect(t-3,e-1,o.measureText(c)+6,r+5)),o.fillStyle($c911639689a6d3da$var$Log.color),o.fillText(c,t,e)),c="";for(let t in $c911639689a6d3da$var$Log.vars)c+=t+": "+$c911639689a6d3da$var$Log.vars[t]+"  ";""!==c&&(e+=24,$c911639689a6d3da$var$Log.background&&(o.fillStyle($c911639689a6d3da$var$Log.background),o.fillRect(t-3,e-1,o.measureText(c)+6,r+5)),o.fillStyle($c911639689a6d3da$var$Log.color),o.fillText(c,t,e));let l=0;for(let i=$c911639689a6d3da$var$Log.data.top;i;i=i.next,l++)c=(!1!==a?"#"+($c911639689a6d3da$var$Log.count-$c911639689a6d3da$var$Log.data.length+l+1)+": ":"> ")+i.value,$c911639689a6d3da$var$Log.background&&(o.fillStyle($c911639689a6d3da$var$Log.background),o.fillRect(t-3,e-1+7+(r+5)*(l+1)-1,o.measureText(c)+6,r+5)),o.fillStyle($c911639689a6d3da$var$Log.color),o.fillText(c,t,e-1+7+(r+5)*(l+1));s=hrnow()-s,$d36cc4eae272df9c$export$9099ad97b570f7c.perf.drawTimeTotal-=s,$d36cc4eae272df9c$export$9099ad97b570f7c.perf.extraTimeTotal+=s}})},pause:function(){this.paused=!0},resume:function(){this.paused=!1}};var $c911639689a6d3da$export$9099ad97b570f7c=$c911639689a6d3da$var$Log;const $f37b9fd5341d0b91$var$globals={gl:null,time:0,viewport:null,debugBounds:!1,rand0:new $a4f6dcde8eac4617$export$9099ad97b570f7c,rand1:new $a4f6dcde8eac4617$export$9099ad97b570f7c,rand2:new $a4f6dcde8eac4617$export$9099ad97b570f7c};var $f37b9fd5341d0b91$export$9099ad97b570f7c=$f37b9fd5341d0b91$var$globals;$parcel$global.px=function(t){return t*C.SCALE},$parcel$global.dispose=function(t){if(t)return"free"in t?t.free():"dispose"in t?t.dispose():void("__dtor"in t&&t.__dtor())},"AudioContext"in $parcel$global?($parcel$global.audioContext=new AudioContext({latencyHint:"interactive",sampleRate:44100}),$c911639689a6d3da$export$9099ad97b570f7c.write("AudioContext: baseLatency="+$parcel$global.audioContext.baseLatency)):$parcel$global.audioContext=null,$parcel$global.fetchd=function(t,e){return new Promise(((r,i)=>{e||(e={}),"responseType"in e||(e.responseType="arraybuffer");var a=new XMLHttpRequest;a.open("GET",t,!0);for(let t in e)a[t]=e[t];a.onload=function(){r(a.response)},a.onerror=function(){i("Unable to fetch specified resource.")},a.send()}))},$parcel$global.fetchAudioBuffer=function(t){return new Promise(((e,r)=>{$parcel$global.audioContext?fetchd(t).then((t=>audioContext.decodeAudioData(t))).then((t=>e(t))).catch((t=>r(t))):r("AudioContext is not available.")}))},$parcel$global.int=function(t){return t>>0},$parcel$global.bool=function(t){return!0===t||!1===t?t:"true"==t||"false"!=t&&!!t},$parcel$global.float=function(t){return parseFloat(t)},$parcel$global.float2=function(t){return int(100*t)/100},$parcel$global.float3=function(t){return int(1e3*t)/1e3},$parcel$global.float4=function(t){return int(1e4*t)/1e4},$parcel$global.rad=function(t){return t*Math.PI/180},$parcel$global.deg=function(t){return t/Math.PI*180},$parcel$global.rand=function(){return $f37b9fd5341d0b91$var$globals.rand0.nextInt16()},$parcel$global.randf=function(){return $f37b9fd5341d0b91$var$globals.rand0.nextFloat()},$parcel$global.randrf=function(t,e){let r=$f37b9fd5341d0b91$var$globals.rand0.nextFloat();return r*e+(1-r)*t},$parcel$global.randr=function(t,e){let r=$f37b9fd5341d0b91$var$globals.rand0.nextFloat();return Math.round(r*e+(1-r)*t)},$parcel$global.randtf=function(t,e,r){for(var i=[],a=0;a<r;a++)i.push(randrf(t,e));return i},$parcel$global.hrnow=function(){return performance.now()},$parcel$global.randvar=function(t,e){return function(){return randr(t,e)}},$parcel$global.randitem=function(t,e,r){return e||(e=0),r||(r=t.length-1),function(){return t[randr(e,r)]}},$parcel$global.getLineSegmentIntersection=function(t,e,r,i,a,n,s,o){if(t==a&&e==n&&r==s&&i==o)return 0;var c=i-e,l=r-t,h=o-n,u=s-a;if(0==c&&0==h){if(e!=n)return 2;var f=Math.max(t,a);return f>Math.min(r,s)?2:(f-t)/l}if(0==l&&0==u){if(t!=a)return 2;var d=Math.max(e,n);return d>Math.min(i,o)?2:(d-e)/c}if(0==l)return 0>(p=(h*(t-a)+u*(n-e))/(u*c))||p>1||0>($=(t-a)/u)||$>1?2:p;var $,p,b=h*l-u*c;return 0==b||0>($=(c*(a-t)+l*(e-n))/b)||$>1||0>(p=(u*$+a-t)/l)||p>1?2:p},$parcel$global.lineSegmentIntersects=function(t,e,r,i,a,n,s,o){let c=getLineSegmentIntersection(t,e,r,i,a,n,s,o);return c>=0&&c<=1},$parcel$global.rotatePoint=function(t,e,r){return"object"==Rin.typeOf(t)?{x:e*t.x+r*t.y,y:r*t.x-e*t.y}:{x:e*Math.cos(t)+r*Math.sin(t),y:r*Math.cos(t)-e*Math.sin(t)}},$parcel$global.stepValue=function(t,e,r,i){return Math.round(i*(t-e)/(r-e))/i*(r-e)+e},$parcel$global.alignValue=function(t,e){return Math.round(t/e)*e},$parcel$global.FIXED_POINT_BITS=8,$parcel$global.upscale=function(t){return t*(1<<FIXED_POINT_BITS)>>0},$parcel$global.downscale=function(t){return t>>FIXED_POINT_BITS},$parcel$global.downscalef=function(t){return t/(1<<FIXED_POINT_BITS)},$parcel$global.falign=function(t){return downscalef(upscale(t))},$parcel$global.absmin=function(t,e){return Math.abs(t)<Math.abs(e)?t:e},$parcel$global.absmax=function(t,e){return Math.abs(t)>Math.abs(e)?t:e};const $00b1ad65b4c7b9c6$var$Perf=function(t,e){this.data=[],this.accumSize=t,this.expectedValue=e,this.stdSum=0,this.stdCount=0};$00b1ad65b4c7b9c6$var$Perf.SAMPLES=1,$00b1ad65b4c7b9c6$var$Perf.MIN=2,$00b1ad65b4c7b9c6$var$Perf.MAX=4,$00b1ad65b4c7b9c6$var$Perf.AVG=8,$00b1ad65b4c7b9c6$var$Perf.EXPECTED=16,$00b1ad65b4c7b9c6$var$Perf.STDDEV=32,$00b1ad65b4c7b9c6$var$Perf.AVG_STDDEV=64,$00b1ad65b4c7b9c6$var$Perf.ALL=255;var $00b1ad65b4c7b9c6$export$9099ad97b570f7c=$00b1ad65b4c7b9c6$var$Perf;$00b1ad65b4c7b9c6$var$Perf.prototype.begin=function(){this.startTime=performance.now()},$00b1ad65b4c7b9c6$var$Perf.prototype.end=function(){this.feed(performance.now()-this.startTime)},$00b1ad65b4c7b9c6$var$Perf.prototype.feed=function(t){this.data.push(t),this.data.length==this.accumSize&&(this.report(),this.data=[])},$00b1ad65b4c7b9c6$var$Perf.prototype.update=function(){let t=null,e=null,r=0,i=0;for(let i=0;i<this.data.length;i++)t=null===t?this.data[i]:Math.min(t,this.data[i]),e=null===e?this.data[i]:Math.max(e,this.data[i]),r+=this.data[i];r/=this.data.length;let a=void 0!==this.expectedValue?this.expectedValue:r;for(let t=0;t<this.data.length;t++)i+=Math.pow(this.data[t]-a,2);return i=Math.sqrt(i/this.data.length),this.stdSum+=i,this.stdCount++,this.min=t,this.max=e,this.avg=r,this.std=i,this},$00b1ad65b4c7b9c6$var$Perf.prototype.report=function(t=255){let e="";return t&$00b1ad65b4c7b9c6$var$Perf.SAMPLES&&(e+="n: "+this.stdCount),t&$00b1ad65b4c7b9c6$var$Perf.MIN&&(e+=(""!=e?", ":"")+"min: "+this.min),t&$00b1ad65b4c7b9c6$var$Perf.MAX&&(e+=(""!=e?", ":"")+"max: "+this.max),t&$00b1ad65b4c7b9c6$var$Perf.AVG&&(e+=(""!=e?", ":"")+"avg: "+this.avg.toFixed(2)),t&$00b1ad65b4c7b9c6$var$Perf.EXPECTED&&(e+=(""!=e?", ":"")+(void 0!==this.expectedValue?"e: "+this.expectedValue:"")),t&$00b1ad65b4c7b9c6$var$Perf.STDDEV&&(e+=(""!=e?", ":"")+"stddev: "+this.std.toFixed(2)),t&$00b1ad65b4c7b9c6$var$Perf.AVG_STDDEV&&(e+=(""!=e?", ":"")+"avg_stddev: "+(this.stdSum/this.stdCount).toFixed(2)),e};const $90c43dcad69fbbb9$var$Framebuffer=$02c835380fe912d5$export$85a4e7644ad1465d.extend({framebufferId:null,attachments:null,attachmentTypes:null,width:0,height:0,drawBuffers:null,drawBufferIds:null,__ctor:function(t=null,e=null){null!==$f37b9fd5341d0b91$export$9099ad97b570f7c.gl&&(null===$90c43dcad69fbbb9$var$attachmentPointIds[0]&&$90c43dcad69fbbb9$var$initAttachmentPointIds($f37b9fd5341d0b91$export$9099ad97b570f7c.gl),this.framebufferId=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl.createFramebuffer(),this.drawBuffers=[],this.drawBufferIds=[],this.width=t||$d36cc4eae272df9c$export$9099ad97b570f7c.renderer.width,this.height=e||$d36cc4eae272df9c$export$9099ad97b570f7c.renderer.height,this.attachments=new Array($90c43dcad69fbbb9$var$Framebuffer.MAX_ATTACHMENT_POINTS).fill(null),this.attachmentTypes=new Array($90c43dcad69fbbb9$var$Framebuffer.MAX_ATTACHMENT_POINTS).fill(null))},__dtor:function(){let t=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl;if(null!==t){for(let e=0;e<this.attachments.length;e++)null!==this.attachments[e]&&(this.attachmentTypes[e]===$90c43dcad69fbbb9$var$Framebuffer.TEXTURE?t.deleteTexture(this.attachments[e]):t.deleteRenderbuffer(this.attachments[e]));t.deleteFramebuffer(this.frameBufferId)}},attach:function(t,e,r=null){let i=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl;if(null===i)return;null===r&&(r=t<$90c43dcad69fbbb9$var$Framebuffer.DEPTH?$90c43dcad69fbbb9$var$Framebuffer.TEXTURE:$90c43dcad69fbbb9$var$Framebuffer.RENDERBUFFER),this.attachments[t]=e,this.attachmentTypes[t]=r,t<$90c43dcad69fbbb9$var$Framebuffer.DEPTH&&-1===this.drawBuffers.indexOf(t)&&(this.drawBuffers.push(t),this.drawBufferIds.push($90c43dcad69fbbb9$var$attachmentPointIds[t]));let a=i.getParameter(i.FRAMEBUFFER_BINDING);switch(i.bindFramebuffer(i.FRAMEBUFFER,this.framebufferId),r){case $90c43dcad69fbbb9$var$Framebuffer.TEXTURE:i.framebufferTexture2D(i.FRAMEBUFFER,$90c43dcad69fbbb9$var$attachmentPointIds[t],i.TEXTURE_2D,e,0);break;case $90c43dcad69fbbb9$var$Framebuffer.RENDERBUFFER:i.framebufferRenderbuffer(i.FRAMEBUFFER,$90c43dcad69fbbb9$var$attachmentPointIds[t],i.RENDERBUFFER,e)}i.bindFramebuffer(i.FRAMEBUFFER,a)},createColorBuffer:function(t,e=null,r=null){let i=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl;if(null===i)return null;null===e&&(e=this.width),null===r&&(r=this.height);let a=i.createTexture();return i.bindTexture(i.TEXTURE_2D,a),i.texStorage2D(i.TEXTURE_2D,1,i.RGBA8,e,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),this.attach(t,a),a},createDepthBuffer:function(t=null,e=null){let r=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl;if(null===r)return null;null===t&&(t=this.width),null===e&&(e=this.height);let i=r.createRenderbuffer();return r.bindRenderbuffer(r.RENDERBUFFER,i),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT24,t,e),this.attach($90c43dcad69fbbb9$var$Framebuffer.DEPTH,i),i},createStencilBuffer:function(t=null,e=null){let r=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl;if(null===r)return null;null===t&&(t=this.width),null===e&&(e=this.height);let i=r.createTexture();return r.bindTexture(r.TEXTURE_2D,i),r.texStorage2D(r.TEXTURE_2D,1,r.DEPTH_STENCIL,t,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),this.attach($90c43dcad69fbbb9$var$Framebuffer.DEPTH_STENCIL,i),i},getTexture:function(t){return this.attachmentTypes[t]!==$90c43dcad69fbbb9$var$Framebuffer.TEXTURE?null:this.attachments[t]},getRenderBuffer:function(t){return this.attachmentTypes[t]!==$90c43dcad69fbbb9$var$Framebuffer.RENDERBUFFER?null:this.attachments[t]},bind:function(){let t=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl;null!==t&&(t.bindFramebuffer(t.FRAMEBUFFER,this.framebufferId),t.drawBuffers(this.drawBufferIds),t.viewport(0,0,this.width,this.height))},unbind:function(){let t=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl;null!==t&&(t.bindFramebuffer(t.FRAMEBUFFER,null),t.drawBuffers($90c43dcad69fbbb9$var$defaultDrawBuffers),t.viewport(0,0,$d36cc4eae272df9c$export$9099ad97b570f7c.renderer.width,$d36cc4eae272df9c$export$9099ad97b570f7c.renderer.height))},isComplete:function(){let t=$f37b9fd5341d0b91$export$9099ad97b570f7c.gl;if(null===t)return!0;let e=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,this.framebufferId);let r=t.checkFramebufferStatus(t.FRAMEBUFFER);return t.bindFramebuffer(t.FRAMEBUFFER,e),r===t.FRAMEBUFFER_COMPLETE}});$90c43dcad69fbbb9$var$Framebuffer.TEXTURE=1,$90c43dcad69fbbb9$var$Framebuffer.RENDERBUFFER=2,$90c43dcad69fbbb9$var$Framebuffer.COLOR0=0,$90c43dcad69fbbb9$var$Framebuffer.COLOR1=1,$90c43dcad69fbbb9$var$Framebuffer.COLOR2=2,$90c43dcad69fbbb9$var$Framebuffer.COLOR3=3,$90c43dcad69fbbb9$var$Framebuffer.COLOR4=4,$90c43dcad69fbbb9$var$Framebuffer.COLOR5=5,$90c43dcad69fbbb9$var$Framebuffer.COLOR6=6,$90c43dcad69fbbb9$var$Framebuffer.COLOR7=7,$90c43dcad69fbbb9$var$Framebuffer.DEPTH=8,$90c43dcad69fbbb9$var$Framebuffer.STENCIL=9,$90c43dcad69fbbb9$var$Framebuffer.DEPTH_STENCIL=10,$90c43dcad69fbbb9$var$Framebuffer.MAX_ATTACHMENT_POINTS=11;const $90c43dcad69fbbb9$var$attachmentPointIds=new Array($90c43dcad69fbbb9$var$Framebuffer.MAX_ATTACHMENT_POINTS).fill(null),$90c43dcad69fbbb9$var$defaultDrawBuffers=new Array(1).fill(null),$90c43dcad69fbbb9$var$initAttachmentPointIds=function(t){$90c43dcad69fbbb9$var$defaultDrawBuffers[0]=t.BACK,$90c43dcad69fbbb9$var$attachmentPointIds[$90c43dcad69fbbb9$var$Framebuffer.COLOR0]=t.COLOR_ATTACHMENT0,$90c43dcad69fbbb9$var$attachmentPointIds[$90c43dcad69fbbb9$var$Framebuffer.COLOR1]=t.COLOR_ATTACHMENT1,$90c43dcad69fbbb9$var$attachmentPointIds[$90c43dcad69fbbb9$var$Framebuffer.COLOR2]=t.COLOR_ATTACHMENT2,$90c43dcad69fbbb9$var$attachmentPointIds[$90c43dcad69fbbb9$var$Framebuffer.COLOR3]=t.COLOR_ATTACHMENT3,$90c43dcad69fbbb9$var$attachmentPointIds[$90c43dcad69fbbb9$var$Framebuffer.COLOR4]=t.COLOR_ATTACHMENT4,$90c43dcad69fbbb9$var$attachmentPointIds[$90c43dcad69fbbb9$var$Framebuffer.COLOR5]=t.COLOR_ATTACHMENT5,$90c43dcad69fbbb9$var$attachmentPointIds[$90c43dcad69fbbb9$var$Framebuffer.COLOR6]=t.COLOR_ATTACHMENT6,$90c43dcad69fbbb9$var$attachmentPointIds[$90c43dcad69fbbb9$var$Framebuffer.COLOR7]=t.COLOR_ATTACHMENT7,$90c43dcad69fbbb9$var$attachmentPointIds[$90c43dcad69fbbb9$var$Framebuffer.DEPTH]=t.DEPTH_ATTACHMENT,$90c43dcad69fbbb9$var$attachmentPointIds[$90c43dcad69fbbb9$var$Framebuffer.STENCIL]=t.STENCIL_ATTACHMENT,$90c43dcad69fbbb9$var$attachmentPointIds[$90c43dcad69fbbb9$var$Framebuffer.DEPTH_STENCIL]=t.DEPTH_STENCIL_ATTACHMENT};var $90c43dcad69fbbb9$export$9099ad97b570f7c=$90c43dcad69fbbb9$var$Framebuffer,$7dcf116364111cf8$exports={};$parcel$export($7dcf116364111cf8$exports,"SpriteFont",(function(){return $7dcf116364111cf8$export$521a6209cb98e667})),$parcel$export($7dcf116364111cf8$exports,"Sound",(function(){return $7dcf116364111cf8$export$cc977a016eb16241})),$parcel$export($7dcf116364111cf8$exports,"Drawable",(function(){return $7dcf116364111cf8$export$c903b85f19077462})),$parcel$export($7dcf116364111cf8$exports,"Placeholder",(function(){return $7dcf116364111cf8$export$607e81148a39a1eb})),$parcel$export($7dcf116364111cf8$exports,"SpritesheetAnimation",(function(){return $7dcf116364111cf8$export$b6a42bc1a28e9983})),$parcel$export($7dcf116364111cf8$exports,"SoundArray",(function(){return $7dcf116364111cf8$export$35c0ef1940b3d513})),$parcel$export($7dcf116364111cf8$exports,"Spritesheet",(function(){return $7dcf116364111cf8$export$66f5a329fcd4e7f1}));const $10ed0b997def83af$var$Resources={};var $10ed0b997def83af$export$9099ad97b570f7c=$10ed0b997def83af$var$Resources;let $10ed0b997def83af$var$reported=!1;Object.assign($10ed0b997def83af$var$Resources,{integerScaling:!0,pixelated:!1,init:function(t=null){t&&Object.assign(this,t)},load:function(t,e,r,i,a){if(!i){i=Object.keys(t);for(let e in i)"__loaded"in t[i[e]]||(t[i[e]].__clone=$02c835380fe912d5$export$2625a93b35cc52e6.clone(t[i[e]]));a=0}for(;a<i.length&&"__loaded"in t[i[a]];)a++;if(e&&e(a,i.length,a/i.length),a==i.length)return void(r&&r(t));let n=t[i[a]];switch(n.resName=i[a],n.type){case"image":n.data=new Image,n.data.onload=function(){var s=n.data.width/n.data.height;n.scale&&(n.width=int(n.data.width*n.scale),n.height=int(n.data.height*n.scale)),n.width||n.height?n.width&&!n.height?n.height=int(n.width/s):!n.width&&n.height&&(n.width=int(s*n.height)):(n.width=n.data.width,n.height=n.data.height),n.owidth=n.data.width,n.oheight=n.data.height,null!==n.pixelated&&n.hasOwnProperty("pixelated")||(n.pixelated=$10ed0b997def83af$var$Resources.pixelated),(n.data.width!=n.width||n.data.height!=n.height||!0!==n.original&&1!=$d36cc4eae272df9c$export$9099ad97b570f7c.scaleFactor)&&(!0===n.original?n.data=$10ed0b997def83af$var$Resources.resizeImage(n,n.width,n.height,n.pixelated,!0):n.data=$10ed0b997def83af$var$Resources.resizeImage(n,n.width*(n.pixelated?$d36cc4eae272df9c$export$9099ad97b570f7c.integerScaleFactor:$d36cc4eae272df9c$export$9099ad97b570f7c.scaleFactor),n.height*(n.pixelated?$d36cc4eae272df9c$export$9099ad97b570f7c.integerScaleFactor:$d36cc4eae272df9c$export$9099ad97b570f7c.scaleFactor),n.pixelated,!0)),n.rscale=n.data.width/n.width,$d36cc4eae272df9c$export$9099ad97b570f7c.tempDisplayBuffer.drawImage(n.data,0,0),$d36cc4eae272df9c$export$9099ad97b570f7c.renderer.prepareImage(n.data),$10ed0b997def83af$var$Resources.onLoaded(t,i[a]),$10ed0b997def83af$var$Resources.load(t,e,r,i,a+1)},n.data.onerror=function(){console.error("Error: Unable to load: "+n.resName)},n.data.src=n.src+"?r="+Math.random();break;case"images":var s=(c=n.src).indexOf("#"),o=(l=c.lastIndexOf("#"))-s+1;if(-1==s)return void console.error("Unable to load: "+n.resName+"\nError: The 'src' attribute requires one or more '#' marks.");if(!n.count)return void console.error("Unable to load: "+n.resName+"\nError: The 'count' attribute was not found.");n._i=0,n.data=[],(h=function(){if(n._i==n.count)return $10ed0b997def83af$var$Resources.onLoaded(t,i[a]),void $10ed0b997def83af$var$Resources.load(t,e,r,i,a+1);var c={type:"image",width:n.width,height:n.height,scale:n.scale};c.src=n.src.substr(0,s)+(n._i++/Math.pow(10,o)).toFixed(o).substr(2)+n.src.substr(l+1),c.data=new Image,c.resName=n.resName+"#"+(n._i-1),c.data.onload=function(){var t=c.data.width/c.data.height;c.scale&&(c.width=int(c.data.width*c.scale),c.height=int(c.data.height*c.scale)),c.width||c.height?c.width&&!c.height?c.height=int(c.width/t):!c.width&&c.height&&(c.width=int(t*c.height)):(c.width=c.data.width,c.height=c.data.height),1==n._i&&(n.owidth=c.data.width,n.oheight=c.data.height),(c.data.width!=c.width||c.data.height!=c.height||!0!==c.original&&1!=$d36cc4eae272df9c$export$9099ad97b570f7c.scaleFactor)&&(null!==n.pixelated&&n.hasOwnProperty("pixelated")||(n.pixelated=$10ed0b997def83af$var$Resources.pixelated),!0===c.original?c.data=$10ed0b997def83af$var$Resources.resizeImage(c,c.width,c.height,n.pixelated,!0):c.data=$10ed0b997def83af$var$Resources.resizeImage(c,c.width*(n.pixelated?$d36cc4eae272df9c$export$9099ad97b570f7c.integerScaleFactor:$d36cc4eae272df9c$export$9099ad97b570f7c.scaleFactor),c.height*(n.pixelated?$d36cc4eae272df9c$export$9099ad97b570f7c.integerScaleFactor:$d36cc4eae272df9c$export$9099ad97b570f7c.scaleFactor),n.pixelated,!0)),c.rscale=c.data.width/c.width,1==n._i&&(n.width=c.width,n.height=c.height,n.rscale=c.rscale),$d36cc4eae272df9c$export$9099ad97b570f7c.tempDisplayBuffer.drawImage(c.data,0,0),$d36cc4eae272df9c$export$9099ad97b570f7c.renderer.prepareImage(c.data),n.data.push(c),h()},c.data.onerror=function(){console.error("Error: Unable to load: "+c.resName)},c.data.src=c.src+"?r="+Math.random()})();break;case"audio":if(n.track||(n.track="sfx"),$parcel$global.plugins&&$parcel$global.plugins.NativeAudio&&"sfx"==n.track){$10ed0b997def83af$var$reported||($c911639689a6d3da$export$9099ad97b570f7c.write("ENGINE_NATIVEAUDIO"),$10ed0b997def83af$var$reported=!0),n.engine=$7dcf116364111cf8$exports.Sound.ENGINE_NATIVEAUDIO,n.data="snd_"+a,$parcel$global.plugins.NativeAudio.preloadSimple(n.data,n.src,(function(){$10ed0b997def83af$var$Resources.onLoaded(t,i[a]),$10ed0b997def83af$var$Resources.load(t,e,r,i,a+1)}),(function(t){console.error("Error: Unable to load (sfx): "+n.resName+"\n"+t)}));break}if($parcel$global.audioContext){$10ed0b997def83af$var$reported||($c911639689a6d3da$export$9099ad97b570f7c.write("ENGINE_WEBAUDIO"),$10ed0b997def83af$var$reported=!0),n.engine=$7dcf116364111cf8$exports.Sound.ENGINE_WEBAUDIO,fetchAudioBuffer(n.src+"?r="+Math.random()).then((s=>{n.data=s,$10ed0b997def83af$var$Resources.onLoaded(t,i[a]),$10ed0b997def83af$var$Resources.load(t,e,r,i,a+1)})).catch((t=>{console.error("Error: Unable to load: "+n.resName)}));break}$10ed0b997def83af$var$reported||($c911639689a6d3da$export$9099ad97b570f7c.write("ENGINE_HTML5"),$10ed0b997def83af$var$reported=!0),n.data=new Audio,n.engine=$7dcf116364111cf8$exports.Sound.ENGINE_HTML5,n.data.oncanplaythrough=function(){$10ed0b997def83af$var$Resources.onLoaded(t,i[a]),$10ed0b997def83af$var$Resources.load(t,e,r,i,a+1)},n.data.onerror=function(){console.error("Error: Unable to load: "+n.resName)},n.data.src=n.src+"?r="+Math.random();break;case"audios":var c,l,h;s=(c=n.src).indexOf("#"),o=(l=c.lastIndexOf("#"))-s+1;if(-1==s)return void console.error("Unable to load: "+n.resName+"\nError: The 'src' attribute requires one or more '#' marks.");if(!n.count)return void console.error("Unable to load: "+n.resName+"\nError: The 'count' attribute was not found.");n._i=0,n.data=[],(h=function(){if(n._i==n.count)return $10ed0b997def83af$var$Resources.onLoaded(t,i[a]),void $10ed0b997def83af$var$Resources.load(t,e,r,i,a+1);var c={type:"audio",track:n.track};return c.src=n.src.substr(0,s)+(n._i++/Math.pow(10,o)).toFixed(o).substr(2)+n.src.substr(l+1),c.resName=n.resName+"#"+(n._i-1),c.track||(c.track="sfx"),$parcel$global.plugins&&$parcel$global.plugins.NativeAudio&&"sfx"==c.track?(c.engine=$7dcf116364111cf8$exports.Sound.ENGINE_NATIVEAUDIO,c.data="snd_"+a+"_"+n._i,void $parcel$global.plugins.NativeAudio.preloadSimple(c.data,c.src,(function(){n.data.push(c),h()}),(function(t){console.error("Error: Unable to load (sfx): "+c.resName+"\n"+t)}))):$parcel$global.audioContext?(c.engine=$7dcf116364111cf8$exports.Sound.ENGINE_WEBAUDIO,void fetchAudioBuffer(c.src+"?r="+Math.random()).then((t=>{c.data=t,n.data.push(c),h()})).catch((t=>{console.error("Error: Unable to load: "+c.resName)}))):(c.data=new Audio,c.engine=$7dcf116364111cf8$exports.Sound.ENGINE_HTML5,c.data.oncanplaythrough=function(){n.data.push(c),h()},c.data.onerror=function(){console.error("Error: Unable to load: "+c.resName)},void(c.data.src=c.src+"?r="+Math.random()))})();break;case"json":fetchd(n.src+"?r="+Math.random(),{responseType:"json"}).then((function(s){n.data=s,$10ed0b997def83af$var$Resources.onLoaded(t,i[a]),$10ed0b997def83af$var$Resources.load(t,e,r,i,a+1)})).catch((function(t){console.error("Error: Unable to load: "+n.resName+". Error: "+t)}));break;case"data":fetchd(n.src+"?r="+Math.random()).then((function(s){n.data=s,$10ed0b997def83af$var$Resources.onLoaded(t,i[a]),$10ed0b997def83af$var$Resources.load(t,e,r,i,a+1)})).catch((function(t){console.error("Error: Unable to load: "+n.resName+". Error: "+t)}));break;case"text":fetchd(n.src+"?r="+Math.random()).then((function(s){n.data=String.fromCharCode.apply(null,new Uint8Array(s)),$10ed0b997def83af$var$Resources.onLoaded(t,i[a]),$10ed0b997def83af$var$Resources.load(t,e,r,i,a+1)})).catch((function(t){console.error("Error: Unable to load: "+n.resName+". Error: "+t)}));break;case"object":n.data={},$10ed0b997def83af$var$Resources.onLoaded(t,i[a]),$10ed0b997def83af$var$Resources.load(t,e,r,i,a+1)}},unload:function(t){throw new Error("IMPLEMENTED UNLOAD!")},onLoaded:function(t,e){var r=t[e];r.wrapper&&r.wrapper in $7dcf116364111cf8$exports&&(t[e]=new $7dcf116364111cf8$exports[r.wrapper](r),t[e].__loaded=!0)},resizeImage:function(t,e,r,i,a){var n=t.data.width,s=t.data.height;if(e=int(e),r=int(r),n==e&&s==r)return t.data;if(!this.integerScaling&&i&&(i=null),i){if(int(e/n)>0){var o,c=int(e/n+.9),l=(e=c*n)/n,h=(r=c*s)/s;p=new $8cb3108385e4214b$export$9099ad97b570f7c({hidden:!0,antialias:!1}).resize(e,r);(o=new $8cb3108385e4214b$export$9099ad97b570f7c({hidden:!0,antialias:!1}).resize(n,s)).drawImage(t.data,0,0);for(var u=0;u<s;u++)for(var f=o.getImageData(0,u,n,1).data,d=0,$=0;$<n&&d<f.length;$++,d+=4)p.fillStyle("rgba("+f[d]+","+f[d+1]+","+f[d+2]+","+f[d+3]/255+")"),p.fillRect($*l,u*h,l,h);return o.dispose(),p.elem}return this.resizeImage(t,e,r,null,a)}for((o=new $8cb3108385e4214b$export$9099ad97b570f7c({hidden:!0,antialias:i=null!==i}).resize(n,s)).drawImage(t.data,0,0);;){var p,b=n>>1,m=s>>1;if(b<=e||m<=r)break;(p=new $8cb3108385e4214b$export$9099ad97b570f7c({hidden:!0,antialias:i}).resize(b,m)).drawImage(o.elem,0,0,b,m),o.dispose(),n=b,s=m,o=p}return(p=new $8cb3108385e4214b$export$9099ad97b570f7c({hidden:!0,antialias:i}).resize(e,r)).drawImage(o.elem,0,0,e,r),o.dispose(),a&&dispose(t.data),p.elem},flipImageHorz:function(t){var e=new $8cb3108385e4214b$export$9099ad97b570f7c({hidden:!0}).resize(t.data.width,t.data.height);return e.translate(t.data.width,0),e.scale(-1,1),e.drawImage(t.data,0,0),e.elem},showDownload:function(t,e){var r=document.createElement("a");r.href=e,r.style.display="none",r.download=t,r.target="_blank",document.body.appendChild(r),r.click(),document.body.removeChild(r)},showFilePicker:function(t,e,r){var i=document.createElement("input");i.type="file",i.accept=e,i.style.display="none",i.multiple=t,document.body.appendChild(i),i.onchange=function(){r(i.files)},document.body.onfocus=function(){document.body.onfocus=null,document.body.removeChild(i)},i.click()},loadAsDataURL:function(t,e){var r=new FileReader;r.onload=function(t){e(t.target.result)},r.readAsDataURL(t)},loadAsText:function(t,e){var r=new FileReader;r.onload=function(t){e(t.target.result)},r.readAsText(t)},loadAsArrayBuffer:function(t,e){var r=new FileReader;r.onload=function(t){e(t.target.result)},r.readAsArrayBuffer(t)},loadAllAsDataURL:function(t,e){var r=[];if(t&&t.length){var i=function(a){a!=t.length?$10ed0b997def83af$var$Resources.loadAsDataURL(t[a],(function(e){r.push({name:t[a].name,size:t[a].size,url:e}),i(a+1)})):e(r)};i(0)}else e(r)}});var $8d90b6c3b3d120b9$export$9099ad97b570f7c=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Drawable",width:null,height:null,__ctor:function(t){if("image"!=t.type)throw new Error("Resource is not an image.");this.width=t.width,this.height=t.height,this.r=t,this.r.wrapper=this},draw:function(t,e=0,r=0,i=null,a=null){null===i?t.drawImageResource(this.r,e,r):t.drawImageResource(this.r,e,r,i,a)},getDrawable:function(){return this}});$10ed0b997def83af$export$9099ad97b570f7c.Image=function(t,e=null){return{type:"image",wrapper:"Drawable",src:t,pixelated:null,...e}};var $2a945df34c29fadb$export$9099ad97b570f7c=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Placeholder",width:null,height:null,__ctor:function(t){if("object"!=t.type)throw new Error("Resource is not an object.");this.width=t.width,this.height=t.height,this.r=t,this.r.wrapper=this,this.data=null,$8cb3108385e4214b$export$9099ad97b570f7c.renderImage(t.width,t.height,(e=>{e.fillStyle(this.r.color),e.fillRect(0,0,t.width,t.height)}),(t=>{this.data=t}))},draw:function(t,e=0,r=0,i=null,a=null){this.data&&t.drawImageResource(this,e,r,i,a)},getDrawable:function(){return this}});$10ed0b997def83af$export$9099ad97b570f7c.Placeholder=function(t,e,r="#ff0000",i=null){return{type:"object",wrapper:"Placeholder",width:t,height:e,color:r,...i}};var $eef7a05e3a922e04$export$9099ad97b570f7c=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Spritesheet",width:0,height:0,numCols:0,numFrames:0,drawableCache:null,__ctor:function(t){if("image"!=t.type&&"images"!=t.type)throw new Error("Resource is not a sprite sheet.");var e,r;if("image"==t.type){if(!(t.config.sheetWidth||t.config.numFrames&&t.config.frameWidth))throw new Error("Required sheetWidth or numFrames+frameWidth");t.config.sheetWidth||(t.config.sheetWidth=t.config.numFrames*t.config.frameWidth),t.config.frameHeight||(t.config.frameHeight=t.data.height),e=t.data.width/t.config.sheetWidth,r=t.width/t.config.sheetWidth}else t.config||(t.config={}),t.config.frameWidth||(t.config.frameWidth=t.data[0].width),t.config.frameHeight||(t.config.frameHeight=t.data[0].height),e=t.data[0].data.width/t.config.frameWidth,r=t.data[0].width/t.config.frameWidth;this.r_frameWidth=t.config.frameWidth*e,this.r_frameHeight=t.config.frameHeight*e,this.width=t.config.frameWidth*r,this.height=t.config.frameHeight*r,"image"==t.type?(this.numCols=int(t.data.width/this.r_frameWidth),this.numRows=Math.ceil(t.data.height/this.r_frameHeight),this.numFrames=t.config.numFrames||this.numCols*this.numRows):(this.numCols=this.numRows=0,this.numFrames=t.data.length),this.drawableCache={},this.r=t,this.r.wrapper=this},drawFrame:function(t,e,r,i,a=0,n=0){if(!(i<0||i>=this.numFrames))if(a||(a=this.width),n||(n=this.height),0!=this.numCols){var s=int(i/this.numCols)*this.r_frameHeight,o=i%this.numCols*this.r_frameWidth;t.drawImage(this.r.data,o,s,this.r_frameWidth,this.r_frameHeight,e,r,a,n)}else t.drawImage(this.r.data[i].data,0,0,this.r_frameWidth,this.r_frameHeight,e,r,a,n)},getFrame:function(t,e=null){let r;if(r=null!==e?e*this.numCols+t:t,r<0||r>=this.numFrames)throw new Error("frameIndex out of range");return this.drawableCache[r]||(this.drawableCache[r]={width:this.width,height:this.height,frameIndex:r,r:this,draw:function(t,e=0,r=0,i=0,a=0){t.drawFrame(this.r,e,r,this.frameIndex,i,a)},getDrawable:function(){return this}}),this.drawableCache[r]},getDrawable:function(){return this.getFrame(0)}});$8cb3108385e4214b$export$9099ad97b570f7c.prototype.drawFrame=function(t,e,r,i,a,n){t.drawFrame(this,e,r,i,a,n)};const $e7cffe338e99620f$export$e941b8d9ca0db7aa=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Animation",width:null,height:null,seq:null,seq_i:0,trans:null,trans_i:0,trans_t:null,queue:null,fps:0,frameSeconds:0,time:0,frameNumber:-1,finished:!1,_paused:!1,finishedCallback:null,finishedCallbackHandler:null,finishedCallbackContext:null,frameCallback:null,__ctor:function(t,e,r){this.anim=t,this.queue=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),this.seq=e,this.seq_i=0,this.trans=null,this.trans_i=0,this.trans_t=null,this.width=t.width,this.height=t.height,this.frameNumber=-1,this.finished=!1,this._paused=!1,this.finishedCallback=null,this.finishedCallbackHandler=null,this.finishedCallbackContext=null,this.frameCallback=null,this.fps=r,this.setFps(this.seq.fps||this.fps)},__dtor:function(){this.queue.free(),this.finishedCallbackHandler&&this.finishedCallbackHandler.free(),this.finishedCallbackContext&&this.finishedCallbackContext.free()},setFps:function(t){return this.frameSeconds=1/t,this.time=0,this},paused:function(t=null){return null===t?this._paused:(this._paused=t,this)},setInitialDelay:function(t){return this.time=-t,this},onFinished:function(t){return this.finishedCallback=t,this},then:function(t,e=null){return this.finishedCallback!==this.thenCallback&&(this.finishedCallback=this.thenCallback,this.finishedCallbackHandler=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),this.finishedCallbackContext=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc()),this.finishedCallbackHandler.push(t),this.finishedCallbackContext.push(e),this},thenCallback:function(){if(!this.finishedCallbackHandler.length)return!1;let t=this.finishedCallbackContext.shift();this.finishedCallbackHandler.shift()(this,t)},onFrame:function(t){return this.frameCallback=t,this},setFrame:function(t){return this.seq_i=int(t)%this.seq.group.length,this},getFrame:function(t){return!0===t?this.seq_i/(this.seq.group.length-1):this.seq_i},getLength:function(){return this.seq.group.length},draw:function(t,e=0,r=0){if(this.time<0)return this._paused||(this.time+=this.frameNumber===$d36cc4eae272df9c$export$9099ad97b570f7c.frameNumber?0:$d36cc4eae272df9c$export$9099ad97b570f7c.frameDelta,this.frameNumber=$d36cc4eae272df9c$export$9099ad97b570f7c.frameNumber),void(this.time>0&&(this.time=0));if(this.seq_i===this.seq.group.length){let i=this.seq.group[this.seq_i-1];if(null!=t)for(let a=0;a<i.length;a++)t.drawFrame(this.anim,e,r,i[a]);return}let i=this.seq.group[this.seq_i];if(null!=t)for(let a=0;a<i.length;a++)t.drawFrame(this.anim,e,r,i[a]);if(this._paused||(this.time+=this.frameNumber===$d36cc4eae272df9c$export$9099ad97b570f7c.frameNumber?0:$d36cc4eae272df9c$export$9099ad97b570f7c.frameDelta,this.frameNumber=$d36cc4eae272df9c$export$9099ad97b570f7c.frameNumber),this.time>=this.frameSeconds){const t=this.seq_i;this.time-=this.frameSeconds,this.seq_i++,this.seq_i===this.seq.group.length&&(null!=this.trans?(++this.trans_i===this.trans.length?(this.trans=null,this.seq=this.trans_t):this.seq=this.trans[this.trans_i],this.setFps(this.seq.fps||this.fps),this.seq_i=0,this.time=0,this.finished=!1):(this.seq.loop?this.seq_i=0:(this.finished=!0,this.finishedCallback&&!1===this.finishedCallback(this)&&(this.finishedCallback=null)),this.queue.length&&this.use(this.queue.shift(),!0))),this.frameCallback&&!1===this.frameCallback(t,this.seq.group.length-1,this)&&(this.frameCallback=null)}},getDrawable:function(){return this},advance:function(){this.paused(!1),this.draw(null,0,0)},getSequenceName:function(){return(null===this.trans?this.seq:this.trans_t).name},use:function(t,e=!1){let r=null===this.trans?this.seq:this.trans_t;return!(r.name===t&&!this.finished&&!0!==e)&&(r.trans&&r.trans[t]?(this.trans_t=this.anim.a.seq[t],this.trans=r.trans[t],this.trans_i=0,this.seq=this.trans[this.trans_i]):(!0===e&&(this.trans=null),this.seq=this.anim.a.seq[t]),this.setFps(this.seq.fps||this.fps),this.seq_i=0,this.time=0,this.finished=!1,!0)},setQueue:function(t){if(!$aa9d485c680b8e6e$export$9099ad97b570f7c.isInstance(t))throw new Error("setQueue: Parameter must be an instance of List");null!=this.queue&&this.queue.clear().free(),this.queue=t,this.use(this.queue.shift(),!0)},enqueue:function(t,e=!1){let r=null===this.trans?this.seq:this.trans_t,i=this.queue.length>0?this.queue[this.queue.length-1]:r.name;return r.name===t&&r.loop?this:i!==t||e?r.loop||this.finished?(this.use(t,!0),this):(this.queue.push(t),this):this}});$40681449f8cf34e0$export$9099ad97b570f7c.createPool($e7cffe338e99620f$export$e941b8d9ca0db7aa);var $e7cffe338e99620f$export$9099ad97b570f7c=$eef7a05e3a922e04$export$9099ad97b570f7c.extend({className:"SpritesheetAnimation",defaultDrawable:null,__ctor:function(t){if(!t.anim)throw new Error("Animation descriptors not found.");this._super.Spritesheet.__ctor(t),this.r=t,this.r.wrapper=this;let e=this.a=this.r.anim;if(e.initialized)return;if(e.def||(e.def="def"),e.seq||(e.seq={}),!e.seq[e.def]&&("def"==e.def||"defloop"==e.def)){let t={loop:"def"!=e.def,group:[]};for(let e=0;e<this.numFrames;e++)t.group.push([e]);e.seq[e.def]=t}if(!e.seq[e.def])throw new Error("Undefined default sequence: "+e.def);e.fps||(e.fps=25),e.def=e.seq[e.def];let r=0;for(let t in e.seq)if(e.seq[t].name=t,e.seq[t].loop||(e.seq[t].loop=!1),"string"==typeof e.seq[t].group){let i,a,n;if(-1!=e.seq[t].group.indexOf(" ")){i=e.seq[t].group.split(" "),e.seq[t].group=[];for(let r in i)e.seq[t].group.push([int(i[r])])}else if(-1!=e.seq[t].group.indexOf("-"))if(n=e.seq[t].group.split("-"),i=int(n[0]),a=int(n[1]),e.seq[t].group=[],i<a)for(n=i;n<=a;n++)e.seq[t].group.push([n]);else for(n=i;n>=a;n--)e.seq[t].group.push([n]);else for(i=int(e.seq[t].group),e.seq[t].group=[];i--;)e.seq[t].group.push([r++]);e.seq[t].count=e.seq[t].group.length}if(e.trans)for(let t in e.trans){e.seq[t].trans=e.trans[t];for(let r in e.trans[t])for(let i=0;i<e.trans[t][r].length;i++){let a=e.trans[t][r][i];if(!e.seq[a])throw new Error("Undefined sequence: "+a);e.trans[t][r][i]=e.seq[a]}}e.initialized=!0},getAnimation:function(t=null,e=null){return $e7cffe338e99620f$export$e941b8d9ca0db7aa.Pool.alloc(this,t?this.a.seq[t]:this.a.def,e||this.a.fps)},getSequence:function(t){return this.a.seq[t]},getDrawable:function(){return null===this.defaultDrawable&&(this.defaultDrawable=this.getAnimation()),this.defaultDrawable}}),$80fff4d9d6207904$export$9099ad97b570f7c=$02c835380fe912d5$export$85a4e7644ad1465d.extend({__ctor:function(t){if("image"!=t.type||!t.font)throw new Error("Resource is not a sprite font.");t.font.sheetWidth||(t.font.sheetWidth=t.width);let e=t.data.width/t.font.sheetWidth,r=t.width/t.font.sheetWidth;this.r_charWidth=t.font.charWidth*e,this.r_charHeight=t.font.charHeight*e,this.charWidth=t.font.charWidth*r,this.charHeight=t.font.charHeight*r,this.paddingX=(t.font.paddingX||0)*r,this.paddingY=(t.font.paddingY||0)*r,this.spacingX=(t.font.spacingX||0)*r,this.spacingY=(t.font.spacingY||0)*r;let i=int(t.font.sheetWidth/t.font.charWidth);this.r=t,this.r.wrapper=this;let a=t.font.charset.length,n=0,s=0;for(this.charTable={},this.charTable[" "]={charWidth:int(2*(this.charWidth+this.paddingX)/3),r_charWidth:this.r_charWidth};n<a;){let e=0;for(let r=0;r<i&&n<a;r++){let r=t.font.charset[n++];this.charTable[r]={x:e,y:s,charWidth:this.charWidth,r_charWidth:this.r_charWidth},e+=this.r_charWidth}s+=this.r_charHeight}if(t.font.widths){a=t.font.widths.length;for(let i=0;i<a;i+=2){let a=t.font.widths[i]*r,n=t.font.widths[i]*e,s=t.font.widths[i+1];for(let t=0;t<s.length;t++)this.charTable[s[t]].charWidth=a,this.charTable[s[t]].r_charWidth=n}}},drawText:function(t,e,r,i){let a=i.length,n=-2*this.paddingX+this.spacingX;e-=this.paddingX,r-=this.paddingY;for(let s=0;s<a;s++){if(" "==i[s]){e+=this.charTable[i[s]].charWidth+n;continue}let a=this.charTable[i[s]];a&&(t.drawImage(this.r.data,a.x,a.y,a.r_charWidth,this.r_charHeight,e,r,a.charWidth,this.charHeight),e+=a.charWidth+n)}},measureWidth:function(t){let e=t.length,r=0,i=-2*this.paddingX+this.spacingX;for(let a=0;a<e;a++){let e=this.charTable[t[a]];e&&(r+=e.charWidth+i)}return r},measureHeight:function(t){return this.charHeight-2*this.paddingY+this.spacingY}});$8cb3108385e4214b$export$9099ad97b570f7c.prototype.drawText=function(t,e,r,i){t.drawText(this,e,r,i)},$8cb3108385e4214b$export$9099ad97b570f7c.prototype.drawTextAligned=function(t,e,r,i,a,n,s,o){0==n?e+=i-t.measureWidth(o)>>1:n<0?e=e-n-1:n>0&&(e=e+i-n+1-t.measureWidth(o)),0==s?r+=a-t.measureHeight(o)>>1:s<0?r=r-s-1:s>0&&(r=r+a-s+1-t.measureHeight(o)),t.drawText(this,e,r,o)},$8cb3108385e4214b$export$9099ad97b570f7c.prototype.drawTextAligned2=function(t,e,r,i,a){this.drawTextAligned(t,e.x1,e.y1,e.width(),e.height(),r,i,a)};const $11dc26786c66d827$var$Sound=$02c835380fe912d5$export$85a4e7644ad1465d.extend({r:null,__ctor:function(t){if("audio"!=t.type)throw new Error("Resource is not audio.");this.r=t,this.r.wrapper=this,this.track=$11dc26786c66d827$var$Sound[this.r.track.toUpperCase()]},play:function(t,e){return $11dc26786c66d827$var$Sound.play(this,t,e)},playLoop:function(t,e){return $11dc26786c66d827$var$Sound.playLoop(this,t,e)}});$11dc26786c66d827$var$Sound.ENGINE_HTML5=1,$11dc26786c66d827$var$Sound.ENGINE_WEBAUDIO=2,$11dc26786c66d827$var$Sound.ENGINE_NATIVEAUDIO=3,Object.assign($11dc26786c66d827$var$Sound,{MASTER:{enabled:!0,volume:1},SFX:{enabled:!0,volume:1},MUSIC:{enabled:!0,volume:.8},VOICE:{enabled:!0,volume:1},MAX_POOL_SIZE:100,pool:[],active:[],register:function(t){t.registered||(t.registered=!0,this.active.push(t))},unregister:function(t){if(t.registered){t.registered=!1;var e=$11dc26786c66d827$var$Sound.active.indexOf(t);-1!=e&&$11dc26786c66d827$var$Sound.active.splice(e,1)}},updateNode:function(t,e){switch(t.snd.r.engine){case $11dc26786c66d827$var$Sound.ENGINE_WEBAUDIO:return this.updateNode_webaudio(t,e);case $11dc26786c66d827$var$Sound.ENGINE_NATIVEAUDIO:return this.updateNode_nativeaudio(t,e)}return this.updateNode_audio(t,e)},alloc_webaudio:function(t){t.gainNode=audioContext.createGain(),t.gainNode.gain.value=0,t.gainNode.connect(audioContext.destination),t.res=audioContext.createBufferSource(),t.res.buffer=t.snd.r.data,t.res.loop=!1,t.res.connect(t.gainNode),t.res.node=t},free_webaudio:function(t){t.res&&(t.gainNode.disconnect(),t.res=null,t.gainNode=null)},alloc_nativeaudio:function(t){t.res=!0},free_nativeaudio:function(t){t.res=!1},alloc_audio:function(t){return this.pool.length?item=this.pool.pop():item=t.cloneNode(),item._src=t.src,item},free_audio:function(t){this.pool.length!=this.MAX_POOL_SIZE&&this.pool.push(t)},updateNode_webaudio:function(t,e){if(!t)return null;var r=$11dc26786c66d827$var$Sound.MASTER.volume*t.snd.track.volume*t.volume;switch(e){case"play":if(t.playing)break;t.res||$11dc26786c66d827$var$Sound.alloc_webaudio(t),t.playTime=hrnow(),t.playing=!0,t.pause=!1,t.res.onended=$11dc26786c66d827$var$Sound.onended_webaudio,t.gainNode.gain.value=r;try{t.res.start(0,t.startTime/1e3)}catch(e){return $11dc26786c66d827$var$Sound.free_webaudio(t),null}$11dc26786c66d827$var$Sound.register(t);break;case"setvolume":if(!t.res)break;t.gainNode.gain.value=r;break;case"stop":if(!t.playing&&t.paused){t.startTime=0,t.paused=!1,$11dc26786c66d827$var$Sound.free_webaudio(t),t.callback&&t.callback();break}if(!t.res)break;t.startTime=0,t.playing=!1,t.pause=!1,t.res.onended=null,$11dc26786c66d827$var$Sound.unregister(t),t.res.stop(),$11dc26786c66d827$var$Sound.free_webaudio(t),t.callback&&t.callback();break;case"pause":if(!t.playing||!t.res)break;t.startTime+=hrnow()-t.playTime,t.playing=!1,t.pause=!0,t.res.onended=null,$11dc26786c66d827$var$Sound.unregister(t),t.res.stop(),$11dc26786c66d827$var$Sound.free_webaudio(t);break;case"softstop":if(!t.playing&&t.paused){t.startTime=0,t.paused=!1;break}if(!t.playing||!t.res)break;t.startTime=0,t.playing=!1,t.pause=!1,t.res.loop=!1}return t},onended_webaudio:function(t){var e=t.currentTarget.node;if(e.playing&&0!=e.loop)return $11dc26786c66d827$var$Sound.free_webaudio(e),-1!=e.loop&&e.loop--,e.startTime=0,e.playing=!1,e.pause=!1,void $11dc26786c66d827$var$Sound.updateNode_webaudio(e,"play");e.res.onended=null,e.res.volume=0,$11dc26786c66d827$var$Sound.updateNode_webaudio(e,"stop")},updateNode_nativeaudio:function(t,e){if(!t)return null;switch(e){case"play":if(t.playing)break;t.res||$11dc26786c66d827$var$Sound.alloc_nativeaudio(t),t.playing=!0,t.pause=!1;try{$parcel$global.plugins.NativeAudio.play(t.snd.r.data,null,null,(function(){$11dc26786c66d827$var$Sound.onended_nativeaudio(t)}))}catch(e){return $11dc26786c66d827$var$Sound.free_nativeaudio(t),null}$11dc26786c66d827$var$Sound.register(t);break;case"setvolume":case"pause":case"softstop":break;case"stop":if(!t.res)break;t.playing=!1,t.pause=!1,$11dc26786c66d827$var$Sound.unregister(t),$parcel$global.plugins.NativeAudio.stop(t.snd.r.data,null),$11dc26786c66d827$var$Sound.free_nativeaudio(t),t.callback&&t.callback()}return t},onended_nativeaudio:function(t){$11dc26786c66d827$var$Sound.updateNode_nativeaudio(t,"stop")},updateNode_audio:function(t,e){if(!t)return null;var r=$11dc26786c66d827$var$Sound.MASTER.volume*t.snd.track.volume*t.volume;switch(e){case"play":if(t.playing)break;t.res||(t.res=$11dc26786c66d827$var$Sound.alloc_audio(t.snd.r.data),t.res.node=t,t.res.src=t.res._src),t.playTime=hrnow(),t.playing=!0,t.pause=!1,t.res.onended=$11dc26786c66d827$var$Sound.onended_audio,t.res.currentTime=t.startTime/1e3,t.res.volume=r;try{t.res.play()}catch(e){return $11dc26786c66d827$var$Sound.free_audio(t.res),t.res=null,null}$11dc26786c66d827$var$Sound.register(t);break;case"setvolume":if(!t.res)break;t.res.volume=r;break;case"stop":if(!t.playing&&t.paused){t.startTime=0,t.paused=!1,$11dc26786c66d827$var$Sound.free_audio(t.res),t.res=null,t.callback&&t.callback();break}if(!t.res)break;t.startTime=0,t.playing=!1,t.pause=!1,$11dc26786c66d827$var$Sound.unregister(t),t.res.pause(),$11dc26786c66d827$var$Sound.free_audio(t.res),t.res=null,t.callback&&t.callback();break;case"pause":if(!t.playing||!t.res)break;t.startTime+=hrnow()-t.playTime,t.playing=!1,t.pause=!0,$11dc26786c66d827$var$Sound.unregister(t),t.res.pause();break;case"softstop":if(!t.playing&&t.paused){t.startTime=0,t.paused=!1;break}if(!t.playing||!t.res)break;t.startTime=0,t.playing=!1,t.pause=!1}return t},onended_audio:function(t){var e=t.currentTarget.node;if(e.playing&&0!=e.loop)return-1!=e.loop&&e.loop--,e.startTime=0,e.playing=!1,e.pause=!1,void $11dc26786c66d827$var$Sound.updateNode_audio(e,"play");e.res.onended=null,e.res.volume=0,$11dc26786c66d827$var$Sound.updateNode_audio(e,"stop")},enableTrack:function(t){t&&(t.enabled=!0)},disableTrack:function(t){t&&(t.enabled=!1)},setVolume:function(t,e){t&&(t.volume=e)},createNode:function(t,e){var r={};return r.startVolume=e,r.volume=e,r.snd=t,r.loop=0,r.playing=!1,r.paused=!1,r.startTime=0,r.playTime=0,r.callback=null,r.timer=null,r.res=null,r},play:function(t,e,r){if(!this.MASTER.enabled||!t||!t.track.enabled)return null;r=null!=r?r:1;var i=this.createNode(t,r);return i.callback=e,this.updateNode(i,"play")},playLoop:function(t,e,r){if(!this.MASTER.enabled||!t||!t.track.enabled)return null;r=null!=r?r:1;var i=this.createNode(t,r);return i.callback=e,i.loop=-1,this.updateNode(i,"play")},stop:function(t,e){return t?(e&&!0!==e&&(t.callback=e),this.updateNode(t,!0===e?"stop":"softstop")):null},pause:function(t){return t?this.updateNode(t,"pause"):null},resume:function(t){return t?this.updateNode(t,"play"):null},fadeOut:function(t,e,r){if(t)if(t.playing&&!t.timer){var i=hrnow();t.startVolume=t.volume,t.timer=setInterval((function(){var a=(hrnow()-i)/e;a>1&&(a=1),t.volume=t.startVolume*(1-a),$11dc26786c66d827$var$Sound.updateNode(t,"setvolume"),1==a&&(clearInterval(t.timer),t.timer=null,!0===r?$11dc26786c66d827$var$Sound.updateNode(t,"stop"):$11dc26786c66d827$var$Sound.updateNode(t,"pause"),r&&!0!==r&&r())}),50)}else r&&r()},fadeIn:function(t,e,r){if(t)if(t.playing||t.timer)r&&r();else{var i=hrnow();t.volume=0,this.updateNode(t,"play"),t.timer=setInterval((function(){var a=(hrnow()-i)/e;a>1&&(a=1),t.volume=t.startVolume*a,$11dc26786c66d827$var$Sound.updateNode(t,"setvolume"),1==a&&(clearInterval(t.timer),t.timer=null,r&&r())}),50)}}}),$10ed0b997def83af$export$9099ad97b570f7c.Audio=function(t,e=null){return{type:"audio",wrapper:"Sound",src:t,...e}};var $11dc26786c66d827$export$9099ad97b570f7c=$11dc26786c66d827$var$Sound,$11907a037a589575$export$9099ad97b570f7c=$02c835380fe912d5$export$85a4e7644ad1465d.extend({r:null,__ctor:function(t){if("audios"!=t.type)throw new Error("Resource is not audios.");this.r=t,this.r.wrapper=this,this.r.track||(this.r.track="sfx"),this.r.mode||(this.r.mode="random"),this.track=$11dc26786c66d827$export$9099ad97b570f7c[this.r.track.toUpperCase()],this.sounds=[],this.lastIndex=-1;for(var e=0;e<this.r.data.length;e++)this.sounds.push(new $11dc26786c66d827$export$9099ad97b570f7c(Object.assign(this.r.data[e],{track:this.r.track})))},getRandomSound:function(){return"random"==this.r.mode?this.sounds[randr(0,this.sounds.length-1)]:(this.lastIndex=++this.lastIndex%this.sounds.length,this.sounds[this.lastIndex])},play:function(t,e){return $11dc26786c66d827$export$9099ad97b570f7c.play(this.getRandomSound(),t,e)},playLoop:function(t,e){return $11dc26786c66d827$export$9099ad97b570f7c.playLoop(this.getRandomSound(),t,e)},playAt:function(t,e,r){return $11dc26786c66d827$export$9099ad97b570f7c.play(this.sounds[t%this.sounds.length],e,r)},playLoopAt:function(t,e,r){return $11dc26786c66d827$export$9099ad97b570f7c.playLoop(this.sounds[t%this.sounds.length],e,r)}});const $7dcf116364111cf8$export$c903b85f19077462=$8d90b6c3b3d120b9$export$9099ad97b570f7c,$7dcf116364111cf8$export$607e81148a39a1eb=$2a945df34c29fadb$export$9099ad97b570f7c,$7dcf116364111cf8$export$66f5a329fcd4e7f1=$eef7a05e3a922e04$export$9099ad97b570f7c,$7dcf116364111cf8$export$b6a42bc1a28e9983=$e7cffe338e99620f$export$9099ad97b570f7c,$7dcf116364111cf8$export$521a6209cb98e667=$80fff4d9d6207904$export$9099ad97b570f7c,$7dcf116364111cf8$export$cc977a016eb16241=$11dc26786c66d827$export$9099ad97b570f7c,$7dcf116364111cf8$export$35c0ef1940b3d513=$11907a037a589575$export$9099ad97b570f7c;var $4b75cf23acd7232f$export$9099ad97b570f7c=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"PriorityQueue",queue:null,queueKeys:null,order:null,__ctor:function(){this.queue={},this.queueKeys=[]},add:function(t){if(null==t)return null;if(!("priority"in t))throw new Error("PriorityQueue (add): Object has no `priority` property.");return t.priority in this.queue||(this.queue[t.priority]={is_dirty:!1,list:[]},this.queueKeys.push(t.priority),this.order=Object.keys(this.queue).sort(((t,e)=>t-e))),-1===this.queue[t.priority].list.indexOf(t)&&this.queue[t.priority].list.push(t),t},remove:function(t){if(null==t)return null;if(!("priority"in t))throw new Error("PriorityQueue (remove): Object has no `priority` property.");if(!(t.priority in this.queue))return t;let e=this.queue[t.priority].list.indexOf(t);return-1===e||(this.queue[t.priority].is_dirty=!0,this.queue[t.priority].list[e]=null),t},cleanup:function(){for(let t=0;t<this.queueKeys.length;t++){let e=this.queue[this.queueKeys[t]];if(e.is_dirty){for(let t=0;t<e.list.length;t++)null==e.list[t]&&e.list.splice(t--,1);e.is_dirty=!1}}},forEach:function(t){let e=!1,r=!1;for(let i=0;!r&&i<this.order.length;i++){let a=this.queue[this.order[i]].list;for(let i=0;!r&&i<a.length;i++)null!=a[i]&&!1===t(a[i])&&(r=!0),null==a[i]&&(e=!0)}e&&this.cleanup()},forEachRev:function(t){let e=!1,r=!1;for(let i=this.order.length-1;!r&&i>=0;i--){let a=this.queue[this.order[i]].list;for(let i=a.length-1;!r&&i>=0;i--)null!=a[i]&&!1===t(a[i])&&(r=!0),null==a[i]&&(e=!0)}e&&this.cleanup()},forEachAsync:function(t,e=null){let r=this,i=!1,a=!1,n=-1,s=-1,o=null,c=function(){s++,!a&&s<o.length?(null!=o[s]&&!1===t(o[s],c)&&(a=!0),null==o[s]&&(i=!0),a&&c()):l()},l=function(){n++,!a&&n<r.order.length?(o=r.queue[r.order[n]].list,s=-1,c()):(i&&r.cleanup(),e&&e())};l()},forEachRevAsync:function(t){alert("NOT IMPLEMENTED: forEachRevAsync")}});const $28c170c471ce71ff$var$Callback=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Callback",callback:null,context:null,arg1:null,arg2:null,arg3:null,arg4:null,prev:null,next:null,__ctor:function(t,e=null,r=null,i=null,a=null,n=null){this.callback=t,this.context=e,this.arg1=r,this.arg2=i,this.arg3=a,this.arg4=n,this.prev=null,this.next=null},__dtor:function(){this.callback=null,this.context=null,this.arg1=null,this.arg2=null,this.arg3=null,this.arg4=null,this.prev=null,this.next=null},isEqual:function(t=null,e=null,r=null,i=null,a=null,n=null){return null!==t&&$28c170c471ce71ff$var$Callback.isInstance(t)?t===this:(null===t||this.callback===t)&&((null===e||this.context===e)&&((null===r||this.arg1===r)&&((null===i||this.arg2===i)&&((null===a||this.arg3===a)&&(null===n||this.arg4===n)))))},exec:function(t){return null===this.callback||this.callback(t,this.context,this.arg1,this.arg2,this.arg3,this.arg4)}});$40681449f8cf34e0$export$9099ad97b570f7c.createPool($28c170c471ce71ff$var$Callback,16384,6144);var $28c170c471ce71ff$export$9099ad97b570f7c=$28c170c471ce71ff$var$Callback;const $5b7e3c1c3884e506$var$Handler=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Handler",host:null,top:null,bottom:null,__ctor:function(t=null){return this.host=t,this.top=null,this.bottom=null,this},__dtor:function(){this.remove()},add:function(t,e=null,r=null,i=null,a=null,n=null){let s=$28c170c471ce71ff$export$9099ad97b570f7c.isInstance(t)?t:$28c170c471ce71ff$export$9099ad97b570f7c.Pool.alloc(t,e,r,i,a,n);return s.prev=this.bottom,null!==this.bottom&&(this.bottom.next=s),this.bottom=s,null===this.top&&(this.top=s),s},unlink:function(t){t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),this.top===t&&(this.top=t.next),this.bottom===t&&(this.bottom=t.prev),t.prev=null,t.next=null,dispose(t)},remove:function(t=null,e=null,r=null,i=null,a=null,n=null){if(null!==t&&$28c170c471ce71ff$export$9099ad97b570f7c.isInstance(t))return this.unlink(t),this;let s=this.top;for(;null!==s;){let o=s.next;s.isEqual(t,e,r,i,a,n)&&this.unlink(s),s=o}return this},find:function(t,e=null,r=null,i=null,a=null,n=null){let s=this.top;for(;null!==s;){if(s.isEqual(t,e,r,i,a,n))return s;s=s.next}return null},exec:function(){let t=this.top;for(;null!==t;){let e=t.next;!1===t.exec(this.host)&&this.unlink(t),t=e}},execf:function(t=null,e=null,r=null,i=null,a=null,n=null){let s=this.top;for(;null!==s;){let o=s.next;if(s.isEqual(t,e,r,i,a,n)){!1===s.exec(this.host)&&this.unlink(s);break}s=o}},execc:function(t){!1===t.exec(this.host)&&this.unlink(t)}});$40681449f8cf34e0$export$9099ad97b570f7c.createPool($5b7e3c1c3884e506$var$Handler,16384,6144);var $5b7e3c1c3884e506$export$9099ad97b570f7c=$5b7e3c1c3884e506$var$Handler;const $a7307a37e7460017$var$Rect=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Rect",cx:0,cy:0,x1:0,y1:0,x2:0,y2:0,__ctor:function(t=null,e=null,r=null,i=null){return null===t?(this.x1=this.y1=this.x2=this.y2=this.cx=this.cy=0,this):null===r?(this.set(0,0,0,0),this.resize(t,e),this):this.set(t,e,r,i)},__dtor:function(){},clone:function(){return $a7307a37e7460017$var$Rect.Rool.alloc(this.x1,this.y1,this.x2,this.y2)},zero:function(){return this.cx=0,this.cy=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this},reset:function(){return this.cx=null,this.cy=null,this.x1=null,this.y1=null,this.x2=null,this.y2=null,this},extendWithPoint:function(t,e=null){if(null===e){const r=t;t=r.x,e=r.y}return(null===this.x1||t<this.x1)&&(this.x1=t),(null===this.y1||e<this.y1)&&(this.y1=e),(null===this.x2||t>this.x2)&&(this.x2=t),(null===this.y2||e>this.y2)&&(this.y2=e),this.cx=(this.x1+this.x2)/2,this.cy=(this.y1+this.y2)/2,this},translate:function(t,e){return this.x1+=t,this.y1+=e,this.x2+=t,this.y2+=e,this.cx+=t,this.cy+=e,this},centerAt:function(t,e,r=!1){return 1==r&&(t=this.x1+t*(this.x2-this.x1),e=this.y1+e*(this.y2-this.y1)),this.translate(t-this.cx,e-this.cy)},set:function(t,e=null,r=null,i=null){if(null===e){const a=t;t=a.x1,e=a.y1,r=a.x2,i=a.y2}return this.cx=(t+r)/2,this.cy=(e+i)/2,this.x1=t,this.y1=e,this.x2=r,this.y2=i,this},equals:function(t,e=null,r=null,i=null){if(null===e){const a=t;t=a.x1,e=a.y1,r=a.x2,i=a.y2}return t==this.x1&&r==this.x2&&e==this.y1&&i==this.y2},contains:function(t,e=null,r=null,i=null){if(null===e){const a=t;t=a.x1,e=a.y1,r=a.x2,i=a.y2}return t==Math.max(this.x1,t)&&e==Math.max(this.y1,e)&&r==Math.min(this.x2,r)&&i==Math.min(this.y2,i)},setAsUnion:function(t,e=null,r=null,i=null){if(null===e){const a=t;t=a.x1,e=a.y1,r=a.x2,i=a.y2}return this.x1=Math.min(this.x1,t),this.y1=Math.min(this.y1,e),this.x2=Math.max(this.x2,r),this.y2=Math.max(this.y2,i),this},intersects:function(t,e=null,r=null,i=null){if(null===e){const a=t;t=a.x1,e=a.y1,r=a.x2,i=a.y2}let a=Math.max(this.x1,t),n=Math.max(this.y1,e),s=Math.min(this.x2,r),o=Math.min(this.y2,i);return Math.max(0,o-n)*Math.max(0,s-a)>0},setAsIntersection:function(t,e=null,r=null,i=null){if(null===e){const a=t;t=a.x1,e=a.y1,r=a.x2,i=a.y2}return this.x1=Math.max(this.x1,t),this.y1=Math.max(this.y1,e),this.x2=Math.min(this.x2,r),this.y2=Math.min(this.y2,i),Math.max(0,this.y2-this.y1)*Math.max(0,this.x2-this.x1)>0},resize:function(t,e,r=!1,i=!1){return 1==r&&(t*=this.x2-this.x1,e*=this.y2-this.y1),1==i?(this.x2=this.x1+t,this.y2=this.y1+e):(t/=2,e/=2,this.x1=this.cx-t,this.y1=this.cy-e,this.x2=this.cx+t,this.y2=this.cy+e),this},resizeBy:function(t,e,r=!1){return 1==r?(this.x2+=t,this.y2+=e):(t/=2,e/=2,this.x1-=t,this.y1-=e,this.x2+=t,this.y2+=e),this},width:function(){return this.x2-this.x1},height:function(){return this.y2-this.y1},ncx:function(){return(this.cx-this.x1)/(this.x2-this.x1)},ncy:function(){return(this.cy-this.y1)/(this.y2-this.y1)},isRight:function(){return this.x1<=this.x2&&this.y1<=this.y2},containsPoint:function(t,e,r=0){return this.x1-r<=t&&t<=this.x2+r&&this.y1-r<=e&&e<=this.y2+r},area:function(t){return t?this.isRight()?(this.y2-this.y1)*(this.x2-this.x1):0:(this.y2-this.y1)*(this.x2-this.x1)},floor:function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.floor(this.x2),this.y2=Math.floor(this.y2),this.cx=Math.floor(this.cx),this.cy=Math.floor(this.cy),this},ceil:function(){return this.x1=Math.ceil(this.x1),this.y1=Math.ceil(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this.cx=Math.ceil(this.cx),this.cy=Math.ceil(this.cy),this},toString:function(){return"("+this.x1.toFixed(2)+", "+this.y1.toFixed(2)+", "+this.x2.toFixed(2)+", "+this.y2.toFixed(2)+")"},flatten:function(){return[this.x1,this.y1,this.x2,this.y2]},unflatten:function(t){return this.set(t[0],t[1],t[2],t[3]),this}});$40681449f8cf34e0$export$9099ad97b570f7c.createPool($a7307a37e7460017$var$Rect,4096,2048);var $a7307a37e7460017$export$9099ad97b570f7c=$a7307a37e7460017$var$Rect;const $4e74aae29faea1dd$var$TFunction=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"TFunction",t:null,y:null,f:null,__ctor:function(t){this.reset(t)},reset:function(t=0){return this.t=[0],this.y=[t],this.f=[null],this},copyFrom:function(t,e,r){if(this.t=[],this.y=[],this.f=[],null==e&&null==r){for(let e=0;e<t.t.length;e++)this.t.push(t.t[e]),this.y.push(t.y[e]),this.f.push(t.f[e]);return this}null==e&&(e=t.t[0]),null==r&&(r=t.t[t.t.length-1]),e<t.t[0]&&(e=t.t[0]);let i=t.find(e),a=t.find(r);if(null==i)return null;if(null==a)return null;t.t[i]!=e&&(this.set(e,t.getAt(e),t.f[i]),i++);for(let e=i;e<=a;e++)this.set(t.t[e],t.y[e],t.f[e]);if(t.t[a]!=r){let e=(r-t.t[a])/Math.ceil(Math.log(r-t.t[a])),i=this.t[this.t.length-1];for(e<=0&&(e=1),e=r-i;i!=r;)i+e>r&&(e=r-i),i+=e,this.set(float4(i),t.getAt(i),t.f[a])}return this},clone:function(t,e){return(new $4e74aae29faea1dd$var$TFunction).copyFrom(this,t,e)},endTime:function(t=0){return this.t[this.t.length-1]+t},startTime:function(t=0){return this.t[0]+t},find:function(t){if(t<this.t[0])return null;const e=this.t.length;for(let r=1;r<e;r++)if(t<this.t[r])return r-1;return e-1},set:function(t,e,r=null){let i=this.find(t);return null!=i&&(this.t[i]==t?(this.y[i]=e,null!=r&&(this.f[i]=r)):(i++,this.t.splice(i,0,t),this.y.splice(i,0,e),this.f.splice(i,0,r)),!0)},get:function(){return this.y[this.y.length-1]},getAt:function(t){let e=this.find(t);if(null==e)return 0;let r=e+1;if(this.t[e]==t||r>=this.t.length||this.y[e]==this.y[r]||null==this.f[e])return this.y[e];if(null==this.f[e])return this.y[e];let i=t,a=this.t[e],n=this.t[r],s=this.y[e],o=this.y[r];return t=(i-a)/(n-a),(t=this.f[e](t))*o+(1-t)*s},integral:function(t=null,e=null,r=0){null==t&&(t=this.t[0]),null==e&&(e=this.t[this.t.length-1]),t<this.t[0]&&(t=this.t[0]);let i=1;if(t>e){let r;r=t,t=e,e=r,i=-1}let a=r;for(let r=t;r<e;){let t=this.find(r);if(null==t)return 0;let i=t+1,n=Math.max(this.t[t],r),s=Math.min(i<this.t.length?this.t[i]:e,e),o=this.getAt(n),c=s-n,l=this.getAt(s)-o;null==this.f[t]?a+=o*c:a+=.5*l*(s+n)-n*l+o*c,r+=c}return i*a},second_integral:function(t=null,e=null,r=0){null==t&&(t=this.t[0]),null==e&&(e=this.t[this.t.length-1]);let i=$4e74aae29faea1dd$var$TFunction.Temp1.copyFrom(this,this.t[0],t).integrate(r).integral();return $4e74aae29faea1dd$var$TFunction.Temp2.copyFrom(this,this.t[0],e).integrate(r).integral()-i},integrate:function(t=0){let e=[];e.push(t);for(let t=1;t<this.t.length;t++)e.push(e[t-1]+this.integral(this.t[t-1],this.t[t]));return this.y=e,this},accumulate:function(t=0){this.y[0]+=t;for(let t=1;t<this.t.length;t++)this.y[t]+=this.y[t-1];return this},chopLeft:function(t){return this.t.splice(0,t),this.f.splice(0,t),this.y.splice(0,t),this},chopRight:function(t){return this.t.splice(t+1,this.t.length-t-1),this.f.splice(t+1,this.f.length-t-1),this.y.splice(t+1,this.y.length-t-1),this},map:function(t){for(let e=0;e<this.y.length;e++)this.y[e]=t(this.y[e],this.t[e],e);return this},toString:function(t=0){let e="",r=10;const i=function(t,e,r){for(t=t.toString(),null==r&&(r=" "),r=r[0];t.length<e;)t+=r;return t};e+="\n",e+=i(" Time",r)+" "+i(" Value",r)+" "+i(" Integral",r)+"\n",e+=i("",r,"-")+" "+i("",r,"-")+" "+i("",r,"-")+"\n";for(let a=0;a<this.t.length;a++)e+=i(" "+float4(this.t[a]),r)+" "+i(" "+float4(this.y[a]),r)+" "+i(" "+float4(this.integral(this.t[0],this.t[a],t)),r)+"\n";return e}});$4e74aae29faea1dd$var$TFunction.Temp1=new $4e74aae29faea1dd$var$TFunction,$4e74aae29faea1dd$var$TFunction.Temp2=new $4e74aae29faea1dd$var$TFunction;var $4e74aae29faea1dd$export$9099ad97b570f7c=$4e74aae29faea1dd$var$TFunction;const $9448267cbb48e2e7$var$Point2=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Point2",ux:0,uy:0,x:0,y:0,__ctor:function(t=null,e=null){return this.set(t,e)},downscale:function(){return this.x=downscale(this.ux),this.y=downscale(this.uy),this},clone:function(){return $9448267cbb48e2e7$var$Point2.Pool.alloc(this)},set:function(t,e=null,r=!1){return null===t?(t=0,e=0):null===e?$9448267cbb48e2e7$var$Point2.isInstance(t)?(e=t.uy,t=t.ux):(e=upscale(t.y),t=upscale(t.x)):r||(t=upscale(t),e=upscale(e)),this.ux=t,this.uy=e,this.downscale(this)},setX:function(t){return this.ux=upscale(t),this.downscale(this)},setY:function(t){return this.uy=upscale(t),this.downscale(this)},zero:function(){return this.set(0,0)},isZero:function(){return 0==this.x&&0==this.y},equals:function(t,e=null){return null===e?$9448267cbb48e2e7$var$Point2.isInstance(t)?(e=t.y,t=t.x):(e=int(t.y),t=int(t.x)):(t=int(t),e=int(e)),this.x==t&&this.y==e},add:function(t,e=null,r=!1){return null===e?$9448267cbb48e2e7$var$Point2.isInstance(t)?(e=t.uy,t=t.ux):(e=upscale(t.y),t=upscale(t.x)):r||(t=upscale(t),e=upscale(e)),this.ux+=t,this.uy+=e,this.downscale()},sub:function(t,e,r=!1){return null===e?$9448267cbb48e2e7$var$Point2.isInstance(t)?(e=t.uy,t=t.ux):(e=upscale(t.y),t=upscale(t.x)):r||(t=upscale(t),e=upscale(e)),this.ux-=t,this.uy-=e,this.downscale()},toString:function(){return`(${this.x}, ${this.y})`}});$40681449f8cf34e0$export$9099ad97b570f7c.createPool($9448267cbb48e2e7$var$Point2,2048,1024);var $9448267cbb48e2e7$export$9099ad97b570f7c=$9448267cbb48e2e7$var$Point2;const $8c9106190296a533$var$Bounds2=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Bounds2",cx:0,cy:0,x1:0,y1:0,x2:0,y2:0,ucx:0,ucy:0,ux1:0,uy1:0,ux2:0,uy2:0,__ctor:function(t=null,e=null,r=null,i=null,a=!1){return null===t?(this.ux1=this.uy1=this.ux2=this.uy2=this.ucx=this.ucy=0,this.downscale()):null!==e&&null===r?this.set(0,0,0,0).resize(t,e):this.set(t,e,r,i,a)},downscale:function(){return this.x1=downscale(this.ux1),this.y1=downscale(this.uy1),this.x2=downscale(this.ux2),this.y2=downscale(this.uy2),this.cx=downscale(this.ucx),this.cy=downscale(this.ucy),this},trunc:function(){return this.ux1=upscale(this.x1),this.uy1=upscale(this.y1),this.ux2=upscale(this.x2),this.uy2=upscale(this.y2),this.ucx=upscale(this.cx),this.ucy=upscale(this.cy),this},clone:function(){return $8c9106190296a533$var$Bounds2.Pool.alloc(this.ux1,this.uy1,this.ux2,this.uy2,!0)},zero:function(){return this.ux1=0,this.uy1=0,this.ux2=0,this.uy2=0,this.ucx=0,this.ucy=0,this.downscale()},reset:function(){return this.ux1=null,this.uy1=null,this.ux2=null,this.uy2=null,this.ucx=null,this.ucy=null,this.x1=null,this.y1=null,this.x2=null,this.y2=null,this.cx=null,this.cy=null,this},translate:function(t,e=null,r=!1){return null===e?$9448267cbb48e2e7$export$9099ad97b570f7c.isInstance(t)?(e=t.uy,t=t.ux):(e=upscale(t.y),t=upscale(t.x)):r||(t=upscale(t),e=upscale(e)),this.ux1+=t,this.uy1+=e,this.ux2+=t,this.uy2+=e,this.ucx+=t,this.ucy+=e,this.downscale()},set:function(t,e=null,r=null,i=null,a=!1){return null===e?$8c9106190296a533$var$Bounds2.isInstance(t)?(i=t.uy2,r=t.ux2,e=t.uy1,t=t.ux1):(i=upscale(t.y2),r=upscale(t.x2),e=upscale(t.y1),t=upscale(t.x1)):a||(t=upscale(t),e=upscale(e),r=upscale(r),i=upscale(i)),this.ux1=t,this.uy1=e,this.ux2=r,this.uy2=i,this.ucx=t+r>>1,this.ucy=e+i>>1,this.downscale()},add:function(t,e=null,r=null,i=null,a=!1){return null===e?$8c9106190296a533$var$Bounds2.isInstance(t)?(i=t.uy2,r=t.ux2,e=t.uy1,t=t.ux1):(i=upscale(t.y2),r=upscale(t.x2),e=upscale(t.y1),t=upscale(t.x1)):a||(t=upscale(t),e=upscale(e),r=upscale(r),i=upscale(i)),this.ux1+=t,this.uy1+=e,this.ux2+=r,this.uy2+=i,this.ucx+=t+r>>1,this.ucy+=e+i>>1,this.downscale()},equals:function(t,e=null,r=null,i=null){return null===e?$8c9106190296a533$var$Bounds2.isInstance(t)?(i=t.y2,r=t.x2,e=t.y1,t=t.x1):(i=int(t.y2),r=int(t.x2),e=int(t.y1),t=int(t.x1)):(t=int(t),e=int(e),r=int(r),i=int(i)),t==this.x1&&r==this.x2&&e==this.y1&&i==this.y2},contains:function(t,e=null,r=null,i=null){return null===e?$8c9106190296a533$var$Bounds2.isInstance(t)?(i=t.y2,r=t.x2,e=t.y1,t=t.x1):(i=int(t.y2),r=int(t.x2),e=int(t.y1),t=int(t.x1)):(t=int(t),e=int(e),r=int(r),i=int(i)),t==Math.max(this.x1,t)&&e==Math.max(this.y1,e)&&r==Math.min(this.x2,r)&&i==Math.min(this.y2,i)},setAsUnion:function(t,e=null,r=null,i=null){if(null===e){if($8c9106190296a533$var$Bounds2.isInstance(t))return this.setAsUnion(t.ux1,t.uy1,!0),this.setAsUnion(t.ux2,t.uy2,!0),this;if($a7307a37e7460017$export$9099ad97b570f7c.isInstance(t))return this.setAsUnion(t.x1,t.y1),this.setAsUnion(t.x2,t.y2),this;$9448267cbb48e2e7$export$9099ad97b570f7c.isInstance(t)?(e=t.uy,t=t.ux):(e=upscale(t.y),t=upscale(t.x))}else{if(null!==i)return this.setAsUnion(t,e),this.setAsUnion(r,i),this;!0!==r&&(t=upscale(t),e=upscale(e))}return(null===this.ux1||t<this.ux1)&&(this.ux1=t),(null===this.uy1||e<this.uy1)&&(this.uy1=e),(null===this.ux2||t>this.ux2)&&(this.ux2=t),(null===this.uy2||e>this.uy2)&&(this.uy2=e),this.ucx=this.ux1+this.ux2>>1,this.ucy=this.uy1+this.uy2>>1,this.downscale()},intersects:function(t,e=null,r=null,i=null){null===e?$8c9106190296a533$var$Bounds2.isInstance(t)?(i=t.y2,r=t.x2,e=t.y1,t=t.x1):(i=int(t.y2),r=int(t.x2),e=int(t.y1),t=int(t.x1)):(t=int(t),e=int(e),r=int(r),i=int(i));let a=Math.max(this.x1,t),n=Math.max(this.y1,e),s=Math.min(this.x2,r),o=Math.min(this.y2,i);return Math.max(0,o-n)*Math.max(0,s-a)>0},setAsIntersection:function(t,e=null,r=null,i=null){return null===e?$8c9106190296a533$var$Bounds2.isInstance(t)?(i=t.y2,r=t.x2,e=t.y1,t=t.x1):(i=int(t.y2),r=int(t.x2),e=int(t.y1),t=int(t.x1)):(t=int(t),e=int(e),r=int(r),i=int(i)),this.ux1=upscale(Math.max(this.x1,t)),this.uy1=upscale(Math.max(this.y1,e)),this.ux2=upscale(Math.min(this.x2,r)),this.uy2=upscale(Math.min(this.y2,i)),this.ucx=this.ux1+this.ux2>>1,this.ucy=this.uy1+this.uy2>>1,this.downscale(),Math.max(0,this.uy2-this.uy1)*Math.max(0,this.ux2-this.ux1)>0},resize:function(t,e,r=!1){return t=upscale(t),e=upscale(e),!0===r?(this.ux2=this.ux1+t,this.uy2=this.uy1+e,this.ucx=this.ux1+this.ux2>>1,this.ucy=this.uy1+this.uy2>>1):(t>>=1,e>>=1,this.ux1=this.ucx-t,this.uy1=this.ucy-e,this.ux2=this.ucx+t,this.uy2=this.ucy+e),this.downscale()},resizeBy:function(t,e,r=!1){return t=upscale(t),e=upscale(e),!0===r?(this.ux2+=t,this.uy2+=e,this.ucx=this.ux1+this.ux2>>1,this.ucy=this.uy1+this.uy2>>1):(t>>=1,e>>=1,this.ux1-=t,this.uy1-=e,this.ux2+=t,this.uy2+=e),this.downscale()},width:function(){return this.x2-this.x1},height:function(){return this.y2-this.y1},isForward:function(){return this.ux1<=this.ux2&&this.uy1<=this.uy2},containsPoint:function(t,e,r=0){return t=upscale(t),e=upscale(e),r=upscale(r),this.ux1-r<=t&&t<=this.ux2+r&&this.uy1-r<=e&&e<=this.uy2+r},area:function(t=!1){return t?this.isForward()?(this.y2-this.y1)*(this.x2-this.x1):0:(this.y2-this.y1)*(this.x2-this.x1)},toString:function(){return"("+this.x1+", "+this.y1+", "+this.x2+", "+this.y2+")"},flatten:function(){return[this.ux1,this.uy1,this.ux2,this.uy2]},unflatten:function(t){return this.ux1=t[0],this.uy1=t[1],this.ux2=t[2],this.uy2=t[3],this.ucx=this.ux1+this.ux2>>1,this.ucy=this.uy1+this.uy2>>1,this.downscale()}});$40681449f8cf34e0$export$9099ad97b570f7c.createPool($8c9106190296a533$var$Bounds2,8192,3072);var $8c9106190296a533$export$9099ad97b570f7c=$8c9106190296a533$var$Bounds2;const $79ead9078b2906d6$var$Easing={Linear:{IN:function(t){return t},OUT:function(t){return t},IN_OUT:function(t){return t}},Back:{k:1.70158,IN:function(t,e){return void 0===e&&(e=$79ead9078b2906d6$var$Easing.Back.k),t*t*((e+1)*t-e)},OUT:function(t,e){return 1-$79ead9078b2906d6$var$Easing.Back.IN(1-t,e)},IN_OUT:function(t,e){return t<.5?$79ead9078b2906d6$var$Easing.Back.IN(2*t,e)/2:$79ead9078b2906d6$var$Easing.Back.OUT(2*(t-.5),e)/2+.5}},Bounce:{getConst:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},IN:function(t){return 1-$79ead9078b2906d6$var$Easing.Bounce.getConst(1-t)},OUT:function(t){return $79ead9078b2906d6$var$Easing.Bounce.getConst(t)},IN_OUT:function(t){return t<.5?(1-$79ead9078b2906d6$var$Easing.Bounce.getConst(1-2*t))/2:$79ead9078b2906d6$var$Easing.Bounce.getConst(2*(t-.5))/2+.5}},Circ:{IN:function(t){return 1-Math.sqrt(1-t*t)},OUT:function(t){return 1-$79ead9078b2906d6$var$Easing.Circ.IN(1-t)},IN_OUT:function(t){return t<.5?$79ead9078b2906d6$var$Easing.Circ.IN(2*t)/2:$79ead9078b2906d6$var$Easing.Circ.OUT(2*(t-.5))/2+.5}},Cubic:{IN:function(t){return t*t*t},OUT:function(t){return 1-$79ead9078b2906d6$var$Easing.Cubic.IN(1-t)},IN_OUT:function(t){return t<.5?$79ead9078b2906d6$var$Easing.Cubic.IN(2*t)/2:$79ead9078b2906d6$var$Easing.Cubic.OUT(2*(t-.5))/2+.5}},Expo:{IN:function(t){return Math.pow(2,12*(t-1))},OUT:function(t){return 1-Math.pow(2,-12*t)},IN_OUT:function(t){return(t*=2)<1?Math.pow(2,12*(t-1))/2:(2-Math.pow(2,-12*(t-1)))/2}},Power:{p:12,IN:function(t){return Math.pow(t,$79ead9078b2906d6$var$Easing.Power.p)},OUT:function(t){return 1-$79ead9078b2906d6$var$Easing.Power.IN(1-t)},IN_OUT:function(t){return t<.5?$79ead9078b2906d6$var$Easing.Power.IN(2*t)/2:$79ead9078b2906d6$var$Easing.Power.OUT(2*(t-.5))/2+.5}},Quad:{IN:function(t){return t*t},OUT:function(t){return 1-$79ead9078b2906d6$var$Easing.Quad.IN(1-t)},IN_OUT:function(t){return t<.5?$79ead9078b2906d6$var$Easing.Quad.IN(2*t)/2:$79ead9078b2906d6$var$Easing.Quad.OUT(2*(t-.5))/2+.5}},Quartic:{IN:function(t){return t*t*t*t},OUT:function(t){return 1-$79ead9078b2906d6$var$Easing.Quartic.IN(1-t)},IN_OUT:function(t){return t<.5?$79ead9078b2906d6$var$Easing.Quartic.IN(2*t)/2:$79ead9078b2906d6$var$Easing.Quartic.OUT(2*(t-.5))/2+.5}},Quintic:{IN:function(t){return t*t*t*t*t},OUT:function(t){return 1-$79ead9078b2906d6$var$Easing.Quintic.IN(1-t)},IN_OUT:function(t){return t<.5?$79ead9078b2906d6$var$Easing.Quintic.IN(2*t)/2:$79ead9078b2906d6$var$Easing.Quintic.OUT(2*(t-.5))/2+.5}},Sine:{IN:function(t){return 1-Math.sin(1.5708*(1-t))},OUT:function(t){return Math.sin(1.5708*t)},IN_OUT:function(t){return(Math.cos(3.1416*t)-1)/-2}},Step:{IN:function(t){return 1!=t?0:1},OUT:function(t){return 1!=t?0:1},IN_OUT:function(t){return 1!=t?0:1}}};var $79ead9078b2906d6$export$9099ad97b570f7c=$79ead9078b2906d6$var$Easing;const $c8953f2a853a94f0$var$PARALLEL={init:function(t,e=!1){if(!e)return t.block=$c8953f2a853a94f0$var$Block.alloc(),void(t.blocks=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc());let r;for(;null!=(r=t.block.commands.shift());){let e=$c8953f2a853a94f0$var$Block.alloc();e.add(r),t.blocks.push(e)}t.block.free(),t.block=null},update:function(t,e,r){if(!1===r.started){for(let t=r.blocks.top;null!==t;t=t.next)t.value.reset(e.time);r.started=!0}let i=e.time,a=0,n=0;for(let e=r.blocks.top;null!==e;e=e.next){let r=e.value.update(t);!0===r?a++:null===r&&n++,e.value.time>i&&(i=e.value.time)}return a+n==r.blocks.length&&(r.started=!1,e.time=i,!0)}},$c8953f2a853a94f0$var$SERIAL={init:function(t,e=!1){e||(t.block=$c8953f2a853a94f0$var$Block.alloc())},update:function(t,e,r){!1===r.started&&(r.block.reset(e.time),r.started=!0);let i=r.block.update(t);return!0!==i?i:(r.started=!1,e.time=r.block.time,!0)}},$c8953f2a853a94f0$var$REPEAT={init:function(t,e=!1){e||(t.block=$c8953f2a853a94f0$var$Block.alloc())},update:function(t,e,r){!1===r.started&&(r.block.reset(e.time),r._count=r.count,r.started=!0);let i=r.block.update(t);return!0!==i?i:r._count<=1?(r.started=!1,e.time=r.block.time,!0):(r.block.restart(),r._count--,!1)}},$c8953f2a853a94f0$var$SET={init:function(t,e=!1){},update:function(t,e,r){return t.setValue(r.field,t.getValue(r.field,r.value)),!0}},$c8953f2a853a94f0$var$RESTART={init:function(t,e=!1){},update:function(t,e,r){return e.restart(),!0}},$c8953f2a853a94f0$var$WAIT={init:function(t,e=!1){},update:function(t,e,r){return!1===r.started&&(r._duration="string"===$02c835380fe912d5$export$2625a93b35cc52e6.typeOf(r.duration)?t.getValue(r.duration):r.duration,r.started=!0),!(t.time<e.time+r._duration)&&(r.started=!1,e.time+=r._duration,!0)}},$c8953f2a853a94f0$var$RANGE={init:function(t,e=!1){},update:function(t,e,r){!1===r.started&&(r._startValue=t.getValue(r.field,r.startValue),r._duration="string"===$02c835380fe912d5$export$2625a93b35cc52e6.typeOf(r.duration)?t.getValue(r.duration):r.duration,r.started=!0),r._endValue=t.getValue(r.field,r.endValue,r._startValue);let i=1;return t.time<e.time+r._duration&&(i=(t.time-e.time)/r._duration),r.easing&&1!=i?t.setValue(r.field,r.easing(i)*(r._endValue-r._startValue)+r._startValue):t.setValue(r.field,i*(r._endValue-r._startValue)+r._startValue),1==i&&(r.started=!1,e.time+=r._duration,!0)}},$c8953f2a853a94f0$var$RAND={init:function(t,e=!1){},update:function(t,e,r){!1===r.started&&(r._duration="string"===$02c835380fe912d5$export$2625a93b35cc52e6.typeOf(r.duration)?t.getValue(r.duration):r.duration,r._last=null,r.started=!0);let a=1;if(t.time<e.time+r._duration&&(a=(t.time-e.time)/r._duration),r.easing&&1!=a?r._cur=int(r.easing(a)*r.count):r._cur=int(a*r.count),r._cur!=r._last){let e=t.getValue(r.field);for(;;){if(int(Math.random()*(r.endValue-r.startValue+1))+r.startValue!=e)break}t.setValue(r.field,i),r._last=r._cur}return 1==a&&(r.started=!1,e.time+=r._duration,!0)}},$c8953f2a853a94f0$var$RANDT={init:function(t,e=!1){if(!e)return;let r=[];for(let e=0;e<t.count;e++)r.push(e%(t.endValue-t.startValue+1)+t.startValue);for(let e=t.count>>2;e>0;e--){let e=int(Math.random()*t.count),i=int(Math.random()*t.count),a=r[i];r[i]=r[e],r[e]=a}t.table=r},update:function(t,e,r){!1===r.started&&(r._duration="string"===$02c835380fe912d5$export$2625a93b35cc52e6.typeOf(r.duration)?t.getValue(r.duration):r.duration,r.started=!0);let i,a=1;return t.time<e.time+r._duration&&(a=(t.time-e.time)/r._duration),i=r.easing&&1!=a?r.easing(a)*(r.count-1):a*(r.count-1),t.setValue(r.field,r.table[int((i+r.count)%r.count)]),1==a&&(r.started=!1,e.time+=r._duration,!0)}},$c8953f2a853a94f0$var$PLAY={init:function(t,e=!1){},update:function(t,e,r){return r.snd.play(),!0}},$c8953f2a853a94f0$var$EXEC={init:function(t,e=!1){},update:function(t,e,r){!1===r.started&&(r._last=t.time,r.started=!0);let i=t.time-r._last;r._last=t.time;let a=r.fn(i,t.data,t);return!0===a?(r.started=!1,!0):a}},$c8953f2a853a94f0$var$Block=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Anim_Block",commands:null,first:!0,current:!1,time:0,init:function(){return this.commands=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),this.reset(0),this},__dtor:function(){this.clear(),this.commands.free()},add:function(t){return this.commands.push(t),t},clone:function(){throw new Error("NOT IMPLEMENTED CLONE ON ANIM")},clear:function(){return this.commands.clear(),this.reset(0),this},reset:function(t){return this.first=!0,this.current=null,this.time=t,this},restart:function(){return this.first=!0,this},isFinished:function(){return!0===this.first&&(this.current=this.commands.top,this.first=!1),null===this.current},update:function(t){for(;!this.isFinished();){let e=this.current.value.update(t,this);if(!0!==e)return e;this.current=this.current.next}return!0}});$40681449f8cf34e0$export$9099ad97b570f7c.attachTo($c8953f2a853a94f0$var$Block,8192);const $c8953f2a853a94f0$var$Command=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Anim_Command",op:null,started:!1,field:null,value:null,duration:0,_duration:0,count:0,_count:0,startValue:0,_startValue:0,endValue:0,_endValue:0,easing:null,_cur:null,_last:null,block:null,blocks:null,table:null,snd:null,fn:null,init:function(t){return this.op=t,this.started=!1,this.block=null,this.blocks=null,this.table=null,this.snd=null,this.fn=null,t.init(this,!1),this},__dtor:function(){null!==this.block&&this.block.clear().free(),null!==this.blocks&&this.blocks.clear().free()},ready:function(){this.op.init(this,!0)},update:function(t,e){return this.op.update(t,e,this)}});$40681449f8cf34e0$export$9099ad97b570f7c.attachTo($c8953f2a853a94f0$var$Command);const $c8953f2a853a94f0$var$Anim=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Anim",initialData:null,data:null,blockStack:null,cmdStack:null,timeScale:1,block:null,time:0,paused:!1,finished:!1,finishedCallback:null,finishedCallbackHandler:null,finishedCallbackContext:null,__ctor:function(){return this.initialData={},this.data={},this.block=$c8953f2a853a94f0$var$Block.alloc(),this.blockStack=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),this.cmdStack=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),this.reset()},__dtor:function(){this.block.free(),this.blockStack.clear().free(),this.cmdStack.clear().free(),null!==this.finishedCallbackHandler&&(this.finishedCallbackHandler.free(),this.finishedCallbackHandler=null),null!==this.finishedCallbackContext&&(this.finishedCallbackContext.free(),this.finishedCallbackContext=null)},copyTo:function(t){return t.block=this.block.clone(),t.initialData=this.initialData,t.reset()},onFinished:function(t){return this.finishedCallback=t,this},then:function(t,e=null){return this.finishedCallback!==this.thenCallback&&(this.finishedCallback=this.thenCallback,null===this.finishedCallbackHandler?(this.finishedCallbackHandler=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),this.finishedCallbackContext=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc()):(this.finishedCallbackHandler.reset(),this.finishedCallbackContext.reset())),this.finishedCallbackHandler.push(t),this.finishedCallbackContext.push(e),this},thenCallback:function(){if(!this.finishedCallbackHandler.length)return!1;let t=this.finishedCallbackContext.shift();this.finishedCallbackHandler.shift()(this,t)},clear:function(){return this.blockStack.clear(),this.cmdStack.clear(),this.block.clear(),this.paused=!1,this.finished=!1,this.time=0,this.timeScale=1,null!==this.finishedCallbackHandler&&(this.finishedCallbackHandler.free(),this.finishedCallbackHandler=null),null!==this.finishedCallbackContext&&(this.finishedCallbackContext.free(),this.finishedCallbackContext=null),this.finishedCallback=null,this},reset:function(){return this.clear(),Object.assign(this.data,this.initialData),this},initial:function(t=null){return null!==t&&(this.initialData=t),Object.assign(this.data,this.initialData),this},speed:function(t){return this.timeScale=t>0?t:1,this},output:function(t){return this.data=t,this},pause:function(){return this.paused=!0,this},resume:function(){return this.finished=!1,this.paused=!1,this},setValue:function(t,e){let r=this.data;if("string"!=typeof t)if("function"==typeof t)t(this,e);else{let i=0;for(;null!==r&&i<t.length-1;)r=r[t[i++]];r[t[i]]=e}else r[t]=e},getValue:function(t,e=null,r=null){let i=this.data;if("string"!=typeof t)if("function"==typeof t)i=t(this,null);else{let e=0;for(;null!==i&&e<t.length;)i=i[t[e++]]}else i=i[t];if(null===e&&(e=i),null===r&&(r=i),"string"==typeof e)switch(e[0]){case"+":e=r+Number(e.substr(1));break;case"-":e=r-Number(e.substr(1));break;default:e=Number(e)}else"function"==typeof e&&(e=e(i,r,this));return e},update:function(t){if(this.paused||this.block.isFinished())return!0;if(this.time+=t*this.timeScale*$c8953f2a853a94f0$var$Anim.timeScale,!0!==this.block.update(this))return!1;let e=this.finished,r=this.block.length,i=this.block;return this.finished=!0,!(!e&&null!==this.finishedCallback&&(!1===this.finishedCallback(this.data,this)&&(this.finishedCallback=null),this.block!==i||this.block.length!=r))||(this.resume(),!1)},prepareFieldName:function(t){return"function"==typeof t?t:-1!=t.indexOf(".")?t.split("."):t},parallel:function(){let t=this.block.add($c8953f2a853a94f0$var$Command.alloc($c8953f2a853a94f0$var$PARALLEL));return this.blockStack.push(this.block),this.cmdStack.push(t),this.block=t.block,this},serial:function(){let t=this.block.add($c8953f2a853a94f0$var$Command.alloc($c8953f2a853a94f0$var$SERIAL));return this.blockStack.push(this.block),this.cmdStack.push(t),this.block=t.block,this},repeat:function(t){let e=this.block.add($c8953f2a853a94f0$var$Command.alloc($c8953f2a853a94f0$var$REPEAT));return e.count=t,this.blockStack.push(this.block),this.cmdStack.push(e),this.block=e.block,this},end:function(){return this.cmdStack.pop().ready(),this.block=this.blockStack.pop(),this},set:function(t,e){let r=this.block.add($c8953f2a853a94f0$var$Command.alloc($c8953f2a853a94f0$var$SET));return r.field=this.prepareFieldName(t),r.value=e,this},restart:function(){return this.block.add($c8953f2a853a94f0$var$Command.alloc($c8953f2a853a94f0$var$RESTART)),this},wait:function(t){return this.block.add($c8953f2a853a94f0$var$Command.alloc($c8953f2a853a94f0$var$WAIT)).duration=t,this},range:function(t,e,r,i,a=null){let n=this.block.add($c8953f2a853a94f0$var$Command.alloc($c8953f2a853a94f0$var$RANGE));return n.field=this.prepareFieldName(t),n.duration=e,n.startValue=r,n.endValue=i,n.easing=a,this},rand:function(t,e,r,i,a,n=null){let s=this.block.add($c8953f2a853a94f0$var$Command.alloc($c8953f2a853a94f0$var$RAND));return s.field=this.prepareFieldName(t),s.duration=e,s.count=r,s.startValue=i,s.endValue=a,s.easing=n,this},randt:function(t,e,r,i,a,n){let s=this.block.add($c8953f2a853a94f0$var$Command.alloc($c8953f2a853a94f0$var$RANDT));return s.field=this.prepareFieldName(t),s.duration=e,s.count=r,s.startValue=i,s.endValue=a,s.easing=n,s.ready(),this},play:function(t){return this.block.add($c8953f2a853a94f0$var$Command.alloc($c8953f2a853a94f0$var$PLAY)).snd=t,this},exec:function(t){return this.block.add($c8953f2a853a94f0$var$Command.alloc($c8953f2a853a94f0$var$EXEC)).fn=t,this},_bounds_x1:function(t,e){if(null===e)return t.data.bounds.x1;t.data.translate(int(e)-t.data.bounds.x1,0)},_bounds_y1:function(t,e){if(null===e)return t.data.bounds.y1;t.data.translate(0,int(e)-t.data.bounds.y1)},setX:function(t){return this.set(this._bounds_x1,t)},setY:function(t){return this.set(this._bounds_y1,t)},position:function(t,e){return this.set(this._bounds_x1,t).set(this._bounds_y1,e)},translateX:function(t,e,r){return this.range(this._bounds_x1,t,null,(e<0?"-":"+")+Math.abs(e),r)},translateY:function(t,e,r){return this.range(this._bounds_y1,t,null,(e<0?"-":"+")+Math.abs(e),r)},translate:function(t,e,r,i,a=null){return this.parallel().range(this._bounds_x1,t,null,(e<0?"-":"+")+Math.abs(e),i).range(this._bounds_y1,t,null,(r<0?"-":"+")+Math.abs(r),a||i).end()},moveTo:function(t,e,r,i,a=null){return this.parallel().range(this._bounds_x1,t,null,e,i).range(this._bounds_y1,t,null,r,a||i).end()},moveX:function(t,e,r=null){return this.range(this._bounds_x1,t,null,e,r)},moveY:function(t,e,r=null){return this.range(this._bounds_y1,t,null,e,r)},scaleX:function(t,e,r){return this.range("sx",t,null,e,r)},scaleY:function(t,e,r){return this.range("sy",t,null,e,r)},scale:function(t,e,r,i,a=null){return this.parallel().range("sx",t,null,e,i).range("sy",t,null,r,a||i).end()},rotate:function(t,e,r){return this.range("angle",t,null,(e<0?"-":"+")+Math.abs(e),r)}});$c8953f2a853a94f0$var$Anim.timeScale=1,$c8953f2a853a94f0$var$Anim.speed=function(t){$c8953f2a853a94f0$var$Anim.timeScale=t>0?t:1},$40681449f8cf34e0$export$9099ad97b570f7c.createPool($c8953f2a853a94f0$var$Anim,8192);var $c8953f2a853a94f0$export$9099ad97b570f7c=$c8953f2a853a94f0$var$Anim;const $ec332034a18f1fbe$var$Boot={modules:new $4b75cf23acd7232f$export$9099ad97b570f7c,register:function(t){return this.modules.add(t)},unregister:function(t){this.modules.remove(t),this.modules.cleanup()},startup:function(t=null){this.modules.forEachAsync(((t,e)=>{!1!==t.onStartup(e)&&e()}),t)},shutdown:function(t=null){this.modules.forEachAsyncRev(((t,e)=>{!1!==t.onShutdown(e)&&e()}),t)}};$ec332034a18f1fbe$var$Boot.Module=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Module",priority:5,__ctor:function(){$ec332034a18f1fbe$var$Boot.register(this)},__dtor:function(){$ec332034a18f1fbe$var$Boot.unregister(this)},onStartup:function(t){},onShutdown:function(t){}});var $ec332034a18f1fbe$export$9099ad97b570f7c=$ec332034a18f1fbe$var$Boot;const $f005ca949837a330$var$GridElement=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"GridElement",id:null,bounds:null,flags:0,data:null,container:null,_grid_remove_node:null,remover:null,__ctor:function(t,e,r,i){this.bounds=$8c9106190296a533$export$9099ad97b570f7c.Pool.alloc(),this.bounds.translate(t,e),this.bounds.resize(r,i,!0),this.flags=$f005ca949837a330$var$GridElement.ALIVE|$f005ca949837a330$var$GridElement.VISIBLE|$f005ca949837a330$var$GridElement.DIRTY|$f005ca949837a330$var$GridElement.DEPTH_FLAG,this.data=null,this.remover=$5b7e3c1c3884e506$export$9099ad97b570f7c.Pool.alloc(this)},__dtor:function(){this.alive(!1),null!==this.data&&(dispose(this.data),this.data=null),this.remover.exec(),this.remover.free(),this.bounds.free()},setId:function(t){return this.id=t,this},setFlags:function(t){return this.flags|=t,this},clearFlags:function(t){return this.flags&=~t,this},getFlags:function(t,e=null){return null===e?(this.flags&t)===t:(this.flags&t)===e},setData:function(t){return this.data=t,this},getData:function(){return this.data},visible:function(t=null){return null===t?!!(this.flags&$f005ca949837a330$var$GridElement.VISIBLE):(this.flags&=~$f005ca949837a330$var$GridElement.VISIBLE,t&&(this.flags|=$f005ca949837a330$var$GridElement.VISIBLE),this)},alive:function(t=null){return null===t?!!(this.flags&$f005ca949837a330$var$GridElement.ALIVE):(this.flags&=~$f005ca949837a330$var$GridElement.ALIVE,t&&(this.flags|=$f005ca949837a330$var$GridElement.ALIVE),this)},dirty:function(t=null){return null===t?!!(this.flags&$f005ca949837a330$var$GridElement.DIRTY):(this.flags&=~$f005ca949837a330$var$GridElement.DIRTY,t&&(this.flags|=$f005ca949837a330$var$GridElement.DIRTY),this)},depthFlagEnabled:function(t=null){return null===t?!!(this.flags&$f005ca949837a330$var$GridElement.DEPTH_FLAG_ENABLED):(this.flags&=~$f005ca949837a330$var$GridElement.DEPTH_FLAG_ENABLED,t&&(this.flags|=$f005ca949837a330$var$GridElement.DEPTH_FLAG_ENABLED),this)},depthFlag:function(t=null){return null===t?!!(this.flags&$f005ca949837a330$var$GridElement.DEPTH_FLAG):(this.flags&=~$f005ca949837a330$var$GridElement.DEPTH_FLAG,t&&(this.flags|=$f005ca949837a330$var$GridElement.DEPTH_FLAG),this)},remove:function(){return this.remover.exec(),this},sync:function(){return null!==this.container&&this.getFlags($f005ca949837a330$var$GridElement.ALIVE|$f005ca949837a330$var$GridElement.DIRTY)?(this.container.sync(this),this):this},resize:function(t,e){return this.flags|=$f005ca949837a330$var$GridElement.DIRTY,this.bounds.resize(t,e,!0),this},resizeBy:function(t,e){return this.resize(this.bounds.width()+t,this.bounds.height()+e)},translate:function(t,e,r=!1){return this.flags|=$f005ca949837a330$var$GridElement.DIRTY,this.bounds.translate(t,e,r),this},setPosition:function(t,e){return this.translate(upscale(t)-this.bounds.ux1,upscale(e)-this.bounds.uy1,!0)}});$f005ca949837a330$var$GridElement.ALIVE=1,$f005ca949837a330$var$GridElement.VISIBLE=2,$f005ca949837a330$var$GridElement.DIRTY=4,$f005ca949837a330$var$GridElement.DEPTH_FLAG_ENABLED=8,$f005ca949837a330$var$GridElement.DEPTH_FLAG=16,$f005ca949837a330$var$GridElement.USERDEF=256,$f005ca949837a330$var$GridElement.LAST_FLAG=128,$f005ca949837a330$var$GridElement.allocFlag=function(){let t=$f005ca949837a330$var$GridElement.LAST_FLAG;if(1073741824===t)throw new Error("allocFlag: out of bit space to allocate another flag");return t<<=1,$f005ca949837a330$var$GridElement.LAST_FLAG=t,t};var $f005ca949837a330$export$9099ad97b570f7c=$f005ca949837a330$var$GridElement;const $104a41fe69a021d0$var$Grid=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Grid",grid:null,count:0,offsx:0,offsy:0,kx:0,ky:0,stride:0,verifyIntersection:!0,__ctor:function(t,e,r,i=null){t=1<<Math.ceil(Math.log2(t)),e=1<<Math.ceil(Math.log2(e)),this.offsx=t>>1,this.offsy=e>>1,r=Math.floor(Math.log2(r)),null===i&&(i=r),this.kx=r,this.ky=i;let a=t>>r,n=e>>i;this.grid=new Array(a*n).fill(null),this.stride=a},__dtor:function(){this.clear(),this.grid=null},clear:function(){for(let t=0;t<this.grid.length;t++){if(null===this.grid[t])continue;let e;for(;null!==(e=this.grid[t].shift());)e.remover.remove(this._remove,this),e.container=null,dispose(e);this.grid[t].free(),this.grid[t]=null}this.count=0},reset:function(){for(let t=0;t<this.grid.length;t++){if(null===this.grid[t])continue;let e;for(;null!==(e=this.grid[t].shift());)e.remover.remove(this._remove,this),e.container=null;this.grid[t].free(),this.grid[t]=null}this.count=0},add:function(t){if(!$f005ca949837a330$export$9099ad97b570f7c.isInstance(t))throw new Error("argument must be a GridElement");let e=int(t.bounds.y1+this.offsy>>this.ky)*this.stride+int(t.bounds.x1+this.offsx>>this.kx);return!(e<0||e>=this.grid.length)&&(null===this.grid[e]&&(this.grid[e]=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc()),this.grid[e].push(t),this.count++,t.container=this,t._grid_remove_node=t.remover.add(this._remove,this,e,this.grid[e].bottom),!0)},_remove:function(t,e,r,i){return e.grid[r].remove(i),e.count--,t.container=null,!1},remove:function(t){return t.remover.execc(this._grid_remove_node),t},sync:function(t){t.clearFlags($f005ca949837a330$export$9099ad97b570f7c.DIRTY);let e=t._grid_remove_node,r=int(t.bounds.y1+this.offsy>>this.ky)*this.stride+int(t.bounds.x1+this.offsx>>this.kx);return r<0||r>=this.grid.length?(t.remover.execc(e),!1):(e.arg1===r||(this.grid[e.arg1].remove(e.arg2),null===this.grid[r]&&(this.grid[r]=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc()),this.grid[r].push(t),e.arg1=r,e.arg2=this.grid[r].bottom),!0)},forEachInRegion:function(t,e,r,i,a){let n=(t.y1+this.offsy-(1<<this.ky-1)>>this.ky)*this.stride,s=(t.y2+this.offsy+(1<<this.ky-1)>>this.ky)*this.stride,o=t.x1+this.offsx-(1<<this.kx-1)>>this.kx,c=t.x2+this.offsx+(1<<this.kx-1)>>this.kx,l=this.grid.length-1;n<0&&(n=0),s<0&&(s=0),o<0&&(o=0),c<0&&(c=0),n>l&&(n=l),s>l&&(s=l),o>l&&(o=l),c>l&&(c=l);for(let h=n;h<=s;h+=this.stride)for(let u=o;u<=c;u++){let f=h+u;if(!(f>l||null===this.grid[f]))for(let l=this.grid[f].top;l;l=l.next)if(l.value.getFlags(e,r)&&(!this.verifyIntersection||!(h<=n+1||u<=o+1||h>=s-1||u>=c-1)||l.value.bounds.intersects(t))&&!1===i(l.value,a))return}},selectInRegion:function(t,e,r){let i=(t.y1+this.offsy-(1<<this.ky-1)>>this.ky)*this.stride,a=(t.y2+this.offsy+(1<<this.ky-1)>>this.ky)*this.stride,n=t.x1+this.offsx-(1<<this.kx-1)>>this.kx,s=t.x2+this.offsx+(1<<this.kx-1)>>this.kx,o=this.grid.length-1;i<0&&(i=0),a<0&&(a=0),n<0&&(n=0),s<0&&(s=0),i>o&&(i=o),a>o&&(a=o),n>o&&(n=o),s>o&&(s=o);let c=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc();for(let l=i;l<=a;l+=this.stride)for(let h=n;h<=s;h++){let u=l+h;if(!(u>o||null===this.grid[u]))for(let o=this.grid[u].top;o;o=o.next)o.value.getFlags(e,r)&&(this.verifyIntersection&&(l<=i+1||h<=n+1||l>=a-1||h>=s-1)&&!o.value.bounds.intersects(t)||c.push(o.value))}return c},countInRegion:function(t,e,r){let i=(t.y1+this.offsy-(1<<this.ky-1)>>this.ky)*this.stride,a=(t.y2+this.offsy+(1<<this.ky-1)>>this.ky)*this.stride,n=t.x1+this.offsx-(1<<this.kx-1)>>this.kx,s=t.x2+this.offsx+(1<<this.kx-1)>>this.kx,o=this.grid.length-1;i<0&&(i=0),a<0&&(a=0),n<0&&(n=0),s<0&&(s=0),i>o&&(i=o),a>o&&(a=o),n>o&&(n=o),s>o&&(s=o);let c=0;for(let l=i;l<=a;l+=this.stride)for(let h=n;h<=s;h++){let u=l+h;if(!(u>o||null===this.grid[u]))for(let o=this.grid[u].top;o;o=o.next)o.value.getFlags(e,r)&&(this.verifyIntersection&&(l<=i+1||h<=n+1||l>=a-1||h>=s-1)&&!o.value.bounds.intersects(t)||c++)}return c},selectFirst:function(t,e,r){let i=(t.y1+this.offsy-(1<<this.ky-1)>>this.ky)*this.stride,a=(t.y2+this.offsy+(1<<this.ky-1)>>this.ky)*this.stride,n=t.x1+this.offsx-(1<<this.kx-1)>>this.kx,s=t.x2+this.offsx+(1<<this.kx-1)>>this.kx,o=this.grid.length-1;i<0&&(i=0),a<0&&(a=0),n<0&&(n=0),s<0&&(s=0),i>o&&(i=o),a>o&&(a=o),n>o&&(n=o),s>o&&(s=o);for(let c=i;c<=a;c+=this.stride)for(let l=n;l<=s;l++){let h=c+l;if(!(h>o||null===this.grid[h]))for(let o=this.grid[h].top;o;o=o.next)if(o.value.getFlags(e,r)&&(!this.verifyIntersection||!(c<=i+1||l<=n+1||c>=a-1||l>=s-1)||o.value.bounds.intersects(t)))return o.value}return null}});var $104a41fe69a021d0$export$9099ad97b570f7c=$104a41fe69a021d0$var$Grid;const $8d5810663b8c1ffa$var$Container=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Container",viewportBounds:null,width:0,height:0,zvalue:0,scene:null,flags:0,g:null,elementCount:0,drawCount:0,__ctor:function(t=32768,e=32768){this.width=t,this.height=e,this.flags=$8d5810663b8c1ffa$var$Container.VISIBLE|$8d5810663b8c1ffa$var$Container.DEPTH_FLAG},__dtor:function(){},visible:function(t=null){return null===t?!!(this.flags&$8d5810663b8c1ffa$var$Container.VISIBLE):(this.flags&=~$8d5810663b8c1ffa$var$Container.VISIBLE,t&&(this.flags|=$8d5810663b8c1ffa$var$Container.VISIBLE),this)},depthFlag:function(t=null){return null===t?!!(this.flags&$8d5810663b8c1ffa$var$Container.DEPTH_FLAG):(this.flags&=~$8d5810663b8c1ffa$var$Container.DEPTH_FLAG,t&&(this.flags|=$8d5810663b8c1ffa$var$Container.DEPTH_FLAG),this)},setViewportBounds:function(t){return this.viewportBounds=t,this},drawElement:function(t,e){return e.drawCount++,t.draw(e.g)},syncZ:function(t){t.__zvalue=this.zvalue+t._zvalue+t.bounds.y2},sync:function(t){throw new Error("Container::sync not implemented")},clear:function(){throw new Error("Container::clear not implemented")},reset:function(){throw new Error("Container::reset not implemented")},add:function(t){throw new Error("Container::add not implemented")},remove:function(t){throw new Error("Container::remove not implemented")},draw:function(t){if(!this.visible())return;let e=t.pushDepthFlag(this.flags&$8d5810663b8c1ffa$var$Container.DEPTH_FLAG);t.zvalue=this.zvalue,this.drawCount=0,this.g=t,this._draw(),e&&t.popDepthFlag()},_draw:function(){throw new Error("Container::draw not implemented")}});$8d5810663b8c1ffa$var$Container.VISIBLE=1,$8d5810663b8c1ffa$var$Container.DEPTH_FLAG=2;var $8d5810663b8c1ffa$export$9099ad97b570f7c=$8d5810663b8c1ffa$var$Container;const $bc943005a3d31ea3$var$Viewport=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Viewport",width:0,height:0,sx:0,sy:0,x:0,y:0,centerRatioX:0,centerRatioY:0,offset:null,worldX1:0,worldY1:0,worldX2:0,worldY2:0,focusFactorX:0,focusFactorY:0,focusRect:null,focusOffsX:0,focusOffsY:0,focusAxisX:!0,focusAxisY:!0,flags:0,scale:1,globalScale:1,bounds:null,padding:null,focusBounds:null,screenBounds:null,__ctor:function(t,e,r,i,a,n,s,o){this.focusFactorX=null==s?.4:s,this.focusFactorY=null==o?.4:o,this.focusRect=null,this.sx=t,this.sy=e,this.width=r,this.height=i,this.x=0,this.y=0,this.bounds=$8c9106190296a533$export$9099ad97b570f7c.Pool.alloc(),this.padding=null,this.focusBounds=$8c9106190296a533$export$9099ad97b570f7c.Pool.alloc(),this.screenBounds=$8c9106190296a533$export$9099ad97b570f7c.Pool.alloc(),this.offset=$9448267cbb48e2e7$export$9099ad97b570f7c.Pool.alloc(),this.flags=$bc943005a3d31ea3$var$Viewport.ENABLED,this.setWorldBounds(-a>>1,-n>>1,a>>1,n>>1),this.updateScreenBounds(),this.updateBounds()},__dtor:function(){this.bounds.free(),this.focusBounds.free(),this.screenBounds.free(),null!==this.padding&&this.padding.free()},enabled:function(t=null){return null===t?!!(this.flags&$bc943005a3d31ea3$var$Viewport.ENABLED):(this.flags&=~$bc943005a3d31ea3$var$Viewport.ENABLED,t&&(this.flags|=$bc943005a3d31ea3$var$Viewport.ENABLED),this)},setWorldBounds:function(t,e,r,i){return this.width>r-t&&(this.width=r-t),this.height>i-e&&(this.height=i-e),this.worldX1=t,this.worldY1=e,this.worldX2=r,this.worldY2=i,this},setPadding:function(t,e=null,r=null,i=null){return null===this.padding&&(this.padding=$8c9106190296a533$export$9099ad97b570f7c.Pool.alloc()),null===e&&(r=i=t,t=e=-t),this.padding.set(t,e,r,i),this},updateBounds:function(t=!1){let e=this.width>>1,r=this.height>>1,i=e/this.scale,a=r/this.scale,n=this.x-i+this.offset.x,s=this.y-a+this.offset.y,o=this.x+i+this.offset.x,c=this.y+a+this.offset.y;t&&(n<this.worldX1?this.offset.setX(this.worldX1-this.x+i):o>this.worldX2&&this.offset.setX(this.worldX2-this.x-i),s<this.worldY1?this.offset.setY(this.worldY1-this.y+a):c>this.worldY2&&this.offset.setY(this.worldY2-this.y-a),n=this.x-i+this.offset.x,s=this.y-a+this.offset.y,o=this.x+i+this.offset.x,c=this.y+a+this.offset.y),this.bounds.set(n,s,o,c),null!==this.padding&&this.bounds.add(this.padding),this.focusBounds.set(this.x-(this.focusFactorX*e+this.centerRatioX*e)/this.scale,this.y-(this.focusFactorY*r+this.centerRatioY*r)/this.scale,this.x+(this.focusFactorX*e+this.centerRatioX*e)/this.scale,this.y+(this.focusFactorY*r+this.centerRatioY*r)/this.scale)},updateScreenBounds:function(){this.screenBounds.set(this.sx,this.sy,this.sx+this.width,this.sy+this.height)},resize:function(t,e){return this.width=t,this.height=e,this.updateScreenBounds(),this.updateBounds(),this},resizeBy:function(t,e){return this.width+=t,this.height+=e,this.updateScreenBounds(),this.updateBounds(),this},setPosition:function(t,e){return this.x=t,this.y=e,this.offset.set(0,0),this.updateBounds(),this},setOffsets:function(t,e){return this.offset.set(t,e),this.updateBounds(),this},setScale:function(t){return this.scale=t,this.updateScreenBounds(),this.updateBounds(),this},setGlobalScale:function(t){return this.globalScale=t,this},setCenter:function(t,e){return this.centerRatioX=t,this.centerRatioY=e,this},translate:function(t,e,r=!1){return this.offset.add(t,e),this.updateBounds(r),this},setScreenPosition:function(t,e){return this.sx=t,this.sy=e,this.updateScreenBounds(),this},getX:function(t=!1){return this.x+(t?0:this.offset.x)},getY:function(t=!1){return this.y+(t?0:this.offset.y)},getOffsetX:function(){return this.offset.x},getOffsetY:function(){return this.offset.y},getWidth:function(){return this.width},getHeight:function(){return this.height},getBounds:function(){return this.bounds},getScreenBounds:function(){return this.screenBounds},getFocusBounds:function(){return this.focusBounds},focusX:function(t,e=null,r=null){null===r&&(r=this.focusFactorX),null===e&&(e=t);let i=this.width>>1,a=this.x-int((r*i+this.centerRatioX*i)/this.scale),n=this.x+int((r*i+this.centerRatioX*i)/this.scale);a==n&&(t=e=t+e>>1);let s=this.x;return t<a?s+=t-a:e>n&&(s+=e-n),a=s-i,n=s+i,a<this.worldX1&&(s=this.worldX1+i),n>this.worldX2&&(s=this.worldX2-i),this.x=s,this},focusY:function(t,e=null,r=null){null===r&&(r=this.focusFactorY),null===e&&(e=t);let i=this.height>>1,a=this.y-int((r*i+this.centerRatioY*i)/this.scale),n=this.y+int((r*i+this.centerRatioY*i)/this.scale);a==n&&(t=e=t+e>>1);let s=this.y;return t<a?s+=t-a:e>n&&(s+=e-n),a=s-i,n=s+i,a<this.worldY1&&(s=this.worldY1+i),n>this.worldY2&&(s=this.worldY2-i),this.y=s,this},update:function(t){null!==this.focusRect&&(this.focusAxisX&&this.focusX(this.focusRect.x1,this.focusRect.x2),this.focusAxisY&&this.focusY(this.focusRect.y1,this.focusRect.y2),this.updateBounds())},setFocusRect:function(t,e=0,r=0){return this.focusRect=t,this.focusOffsX=e,this.focusOffsY=r,this.update(0),this},setFocusOffsets:function(t,e){return this.focusOffsX=t,this.focusOffsY=e,this},setFocusAxes:function(t,e){return this.focusAxisX=t,this.focusAxisY=e,this},setFocusFactor:function(t,e){return this.focusFactorX=t,this.focusFactorY=void 0===e?t:e,this},applyClip:function(t){t.clip(this.screenBounds.x1,this.screenBounds.y1,this.screenBounds.width(),this.screenBounds.height())},applyTransform:function(t){let e=this.screenBounds.x1+(this.screenBounds.width()>>1),r=this.screenBounds.y1+(this.screenBounds.height()>>1);t.translate(e,r),1!=this.scale&&t.scale(this.scale,this.scale),1!=this.globalScale&&t.scale(this.globalScale,this.globalScale),t.translate(-this.getX(),-this.getY()),t.updateTransform()},toWorldSpace:function(t,e,r=!1){let i=this.screenBounds.x1+(this.screenBounds.width()>>1),a=this.screenBounds.y1+(this.screenBounds.height()>>1);return r?(t=(t-int(i))/this.scale+int(this.getX()),e=(e-int(a))/this.scale+int(this.getY())):(t=(t-i)/this.scale+this.getX(),e=(e-a)/this.scale+this.getY()),{x:t,y:e}},toScreenSpace:function(t,e,r=!1){let i=this.screenBounds.x1+(this.screenBounds.width()>>1),a=this.screenBounds.y1+(this.screenBounds.height()>>1);return r?(t=(t-int(this.getX()))*this.scale+int(i),e=(e-int(this.getY()))*this.scale+int(a)):(t=(t-this.getX())*this.scale+i,e=(e-this.getY())*this.scale+a),{x:t,y:e}}});$bc943005a3d31ea3$var$Viewport.ENABLED=1;var $bc943005a3d31ea3$export$9099ad97b570f7c=$bc943005a3d31ea3$var$Viewport;const $92d13821ebf791dd$var$Element=$f005ca949837a330$export$9099ad97b570f7c.extend({className:"Element",group:null,img:null,debugBounds:!1,_zvalue:0,__zvalue:0,_alpha:1,_shaderProgram:null,_uniformSetter:null,__ctor:function(t,e,r=null,i=null,a=null){null===r&&(r=i=0),null===i&&(r=(a=r).width,i=a.height),this._super.GridElement.__ctor(t,e,r,i),this.img=null!==a?a.getDrawable():a,this.group=null,this.debugBounds=!1,this._zvalue=0,this.__zvalue=0,this._alpha=1,this._shaderProgram=null},__dtor:function(){null!==this.img&&(dispose(this.img),this.img=null),this._super.GridElement.__dtor()},destroyLater:function(){this.alive()&&(null!==this.container?this.container.scene.disposeLater(this):dispose(this))},alpha:function(t=null){return null===t?this._alpha:(this._alpha=t,this)},zvalue:function(t=null){return null===t?this._zvalue:(this._zvalue=t,this)},shaderProgram:function(t=!1){return!1===t?this._shaderProgram:(this._shaderProgram=t,this)},uniformSetter:function(t){return this._uniformSetter=t,this},draw:function(t){let e=null!==this._shaderProgram&&t.pushShaderProgram(this._shaderProgram),r=!!this.depthFlagEnabled()&&t.pushDepthFlag(this.depthFlag());if(null!==this._shaderProgram&&null!==this._uniformSetter&&null!==t.gl&&this._uniformSetter(this,t.gl,t.getShaderProgram()),t.zvalue=this.__zvalue,1!=this._alpha&&(t.pushAlpha(),t.alpha(this._alpha)),this.render(t),r&&t.popDepthFlag(),e&&t.popShaderProgram(),1!=this._alpha&&t.popAlpha(),$f37b9fd5341d0b91$export$9099ad97b570f7c.debugBounds||this.debugBounds){let e=System.displayBuffer2;e.pushMatrix(),e.loadMatrix(t.getMatrix()),e.fillStyle("rgba(0,255,255,0.5)"),e.fillRect(this.bounds.x1,this.bounds.y1,this.bounds.width(),this.bounds.height()),e.popMatrix()}},render:function(t){this.img.draw(t,this.bounds.x1,this.bounds.y1)}});$40681449f8cf34e0$export$9099ad97b570f7c.createPool($92d13821ebf791dd$var$Element);var $92d13821ebf791dd$export$9099ad97b570f7c=$92d13821ebf791dd$var$Element;const $b5123f2e08f44320$var$tempPoint=$9448267cbb48e2e7$export$9099ad97b570f7c.Pool.alloc(),$b5123f2e08f44320$var$Group=$92d13821ebf791dd$export$9099ad97b570f7c.extend({className:"Group",children:null,ref:null,__ctor:function(t=null){this._super.Element.__ctor(0,0,0,0),this.children=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),this.bounds.reset(),this.ref=$9448267cbb48e2e7$export$9099ad97b570f7c.Pool.alloc(),this.setId(t)},__dtor:function(){this.clear(),this.children.free(),this.ref.free(),this._super.Element.__dtor()},destroyLater:function(){if(!this.alive())return;let t;for(;null!=(t=this.children.shift());)t.remover.remove(this._remove,this),t.group=null,t.destroyLater();this._super.Element.destroyLater()},clear:function(){let t;for(;null!=(t=this.children.shift());)t.remover.remove(this._remove,this),t.group=null,dispose(t);return this},reset:function(){let t;for(;null!=(t=this.children.shift());)t.remover.remove(this._remove,this),t.group=null;return this},addChild:function(t=null){if(!t)return t;let e=null===this.bounds.x1;return(e||t.bounds.x1<this.bounds.x1)&&this.ltranslate(t.bounds.x1-this.bounds.x1,0),(e||t.bounds.y1<this.bounds.y1)&&this.ltranslate(0,t.bounds.y1-this.bounds.y1),(e||t.bounds.x2>this.bounds.x2)&&this.resizeBy(t.bounds.x2-this.bounds.x2,0),(e||t.bounds.y2>this.bounds.y2)&&this.resizeBy(0,t.bounds.y2-this.bounds.y2),this.children.push(t),null!==t.id&&(this[t.id]=t),t.group=this,t.remover.add(this._remove,this,this.children.bottom),t},_remove:function(t,e,r){return e.children.remove(r),t.group=null,null!==t.id&&(e[t.id]=null),!1},removeChild:function(t){return t&&t.group===this?(t.remover.execf(this._remove,this),t):t},sync:function(){for(let t=this.children.top;t;t=t.next)t.value.sync();return this._super.Element.sync()},ltranslate:function(t,e,r=!1){return this._super.Element.translate(t,e,r)},translate:function(t,e,r=!1){let i=this.bounds.x1,a=this.bounds.y1;this._super.Element.translate(t,e,r),this.ref.add(t,e,r),i=this.bounds.x1-i,a=this.bounds.y1-a;for(let t=this.children.top;t;t=t.next)t.value.translate(i,a);return this},getOffsets:function(t,e,r=!1){$b5123f2e08f44320$var$tempPoint.set(this.bounds.ux1,this.bounds.uy1,!0);let i=$b5123f2e08f44320$var$tempPoint.x,a=$b5123f2e08f44320$var$tempPoint.y;return $b5123f2e08f44320$var$tempPoint.add(t,e,r),i=$b5123f2e08f44320$var$tempPoint.x-i,a=$b5123f2e08f44320$var$tempPoint.y-a,$b5123f2e08f44320$var$tempPoint.set(i,a),$b5123f2e08f44320$var$tempPoint.x-=t,$b5123f2e08f44320$var$tempPoint.y-=e,$b5123f2e08f44320$var$tempPoint},setFlags:function(t){for(let e=this.children.top;e;e=e.next)e.value.setFlags(t);return this._super.Element.setFlags(t)},clearFlags:function(t){for(let e=this.children.top;e;e=e.next)e.value.clearFlags(t);return this._super.Element.clearFlags(t)},visible:function(t=null){if(null===t)return this._super.Element.visible();for(let e=this.children.top;e;e=e.next)e.value.visible(t);return this._super.Element.visible(t)},render:function(t){}});$40681449f8cf34e0$export$9099ad97b570f7c.createPool($b5123f2e08f44320$var$Group);var $b5123f2e08f44320$export$9099ad97b570f7c=$b5123f2e08f44320$var$Group;const $88d898e877fdfd8e$var$Scene=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Scene",minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,containers:null,viewports:null,viewportBounds:null,groupList:null,groups:null,disposalQueue:null,fupdater:null,updater:null,synchronizer:null,lupdater:null,destroyer:null,dt:0,flags:0,drawCount:0,scene:null,__ctor:function(){this.containers=[],this.viewports=[],this.viewportBounds=$8c9106190296a533$export$9099ad97b570f7c.Pool.alloc(),this.groupList=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),this.groups={},this.disposalQueue=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),this.fupdater=$5b7e3c1c3884e506$export$9099ad97b570f7c.Pool.alloc(this),this.updater=$5b7e3c1c3884e506$export$9099ad97b570f7c.Pool.alloc(this),this.synchronizer=$5b7e3c1c3884e506$export$9099ad97b570f7c.Pool.alloc(this),this.lupdater=$5b7e3c1c3884e506$export$9099ad97b570f7c.Pool.alloc(this),this.destroyer=$5b7e3c1c3884e506$export$9099ad97b570f7c.Pool.alloc(this),this.flags=$88d898e877fdfd8e$var$Scene.VISIBLE,this.scene=this},__dtor:function(){let t;for(this.disposeQueued(),this.disposalQueue.free(),this.destroyer.exec(),this.destroyer.free(),this.fupdater.free(),this.updater.free(),this.synchronizer.free(),this.lupdater.free();null!==(t=this.groupList.shift());)t.remover.remove(this._remove,this),t.container=null,dispose(t);for(t=0;t<this.containers.length;t++)this.containers[t]&&(this.containers[t].scene=null,dispose(this.containers[t]),this.containers[t]=null);for(t=0;t<this.viewports.length;t++)this.viewports[t]&&(dispose(this.viewports[t]),this.viewports[t]=null);this.viewportBounds.free(),this.groupList.free()},visible:function(t=null){return null===t?!!(this.flags&$88d898e877fdfd8e$var$Scene.VISIBLE):(this.flags&=~$88d898e877fdfd8e$var$Scene.VISIBLE,t&&(this.flags|=$88d898e877fdfd8e$var$Scene.VISIBLE),this)},setContainer:function(t,e){if(t<0)return this;if(null===e)return this.containers[t].scene=null,this.containers[t]=null,this;if(!$8d5810663b8c1ffa$export$9099ad97b570f7c.isInstance(e))throw new Error("Scene: Unable to set container at index "+t+": argument is not a Container");return(null===this.minWidth||e.width<this.minWidth)&&(this.minWidth=e.width),(null===this.minHeight||e.height<this.minHeight)&&(this.minHeight=e.height),(null===this.maxWidth||e.width>this.maxWidth)&&(this.maxWidth=e.width),(null===this.maxHeight||e.height>this.maxHeight)&&(this.maxHeight=e.height),e.scene=this,e.zvalue=1048576*t,this.containers[t]=e,this},getContainer:function(t){return t<0||t>=this.containers.length?null:this.containers[t]},setViewport:function(t,e){if(t<0)return this;if(null!==e&&!$bc943005a3d31ea3$export$9099ad97b570f7c.isInstance(e))throw new Error("Scene: Unable to set viewport at index "+t+": argument is not a Viewport.");return this.viewports[t]=e,this},getViewport:function(t){return t<0||t>=this.viewports.length?null:this.viewports[t]},disposeLater:function(t){t.alive()&&(this.disposalQueue.push(t),t.alive(!1))},disposeQueued:function(){let t;for(;null!==(t=this.disposalQueue.shift());)dispose(t)},addGroup:function(t){if(!$b5123f2e08f44320$export$9099ad97b570f7c.isInstance(t))throw new Error("argument must be a Group");return this.groupList.push(t),null!==t.id&&(this.groups[t.id]=t),t.container=this,t.remover.add(this._removeGroup,this,this.groupList.bottom),!0},_removeGroup:function(t,e,r){return t.container=null,e.groupList.remove(r),null!==t.id&&(e.groups[t.id]=null),!1},removeGroup:function(t){return t.remover.execf(this._remove,this),t},sync:function(t){return!0},draw:function(t){if(this.visible())if(this.drawCount=0,this.viewports.length)for(let e=0;e<this.viewports.length;e++){let r=this.viewports[e];r&&r.enabled()&&($f37b9fd5341d0b91$export$9099ad97b570f7c.viewport=r,t.pushClip(),t.pushMatrix(),r.applyClip(t),r.applyTransform(t),this.viewportBounds.set(r.getBounds()),this.drawContainers(t,this.viewportBounds),t.popMatrix(),t.popClip())}else this.drawContainers(t,null)},drawContainers:function(t,e){try{for(let r=0;r<this.containers.length;r++)this.containers[r]&&(this.containers[r].setViewportBounds(e),this.containers[r].draw(t),this.drawCount+=this.containers[r].drawCount)}catch(t){if("FRAME_END"!==t.message)throw t}},updateViewports:function(){for(let t=0;t<this.viewports.length;t++)this.viewports[t]&&this.viewports[t].update(this.dt)},update:function(t){this.dt=t,this.fupdater.exec(),this.updater.exec(),this.disposeQueued(),this.synchronizer.exec(),this.updateViewports(),this.lupdater.exec()}});$88d898e877fdfd8e$var$Scene.VISIBLE=1;var $88d898e877fdfd8e$export$9099ad97b570f7c=$88d898e877fdfd8e$var$Scene;const $1395e03f9ccf250b$var$Updater=$02c835380fe912d5$export$85a4e7644ad1465d.extend({className:"Updater",scene:null,list:null,__update:null,__context:null,__ctor:function(t,e=null,r=null){this.list=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc(),this.scene=t,this.__update=e,this.__context=r,this.scene.updater.add(this._update,this),this.scene.synchronizer.add(this._sync,this),this.scene.destroyer.add(this._destroy,this)},__dtor:function(){let t;for(this.scene.updater.remove(this._update,this),this.scene.synchronizer.remove(this._sync,this),this.scene.destroyer.remove(this._destroy,this);null!==(t=this.list.shift());)t.remover.remove(this._remove,this);this.list.free()},_destroy:function(t,e){dispose(e)},add:function(t){if(!$92d13821ebf791dd$export$9099ad97b570f7c.isInstance(t))throw new Error("argument must be an Element");return this.list.push(t),t.remover.add(this._remove,this,this.list.bottom),!0},_remove:function(t,e,r){return e.list.remove(r),!1},remove:function(t){return t.remover.execf(this._remove,this),t},_sync:function(t,e){for(let t=e.list.top;t;t=t.next)t.value.sync()},_update:function(t,e){e.update(t.dt)},update:function(t){if(null!==this.__update){let e=null;for(let r=this.list.top;r;r=e)e=r.next,!1===this.__update(r.value,t,this.__context)&&this.remove(r.value)}}});var $1395e03f9ccf250b$export$9099ad97b570f7c=$1395e03f9ccf250b$var$Updater,$361d95e73ee6b179$export$9099ad97b570f7c=$8d5810663b8c1ffa$export$9099ad97b570f7c.extend({className:"SimpleContainer",list:null,__ctor:function(t,e){this._super.Container.__ctor(t,e),this.list=$aa9d485c680b8e6e$export$9099ad97b570f7c.Pool.alloc()},__dtor:function(){this.clear(),this.list.free(),this._super.Container.__dtor()},sync:function(t){return this.syncZ(t),!0},clear:function(){let t;for(;null!==(t=this.list.shift());)t.remover.remove(this._remove,this),t.container=null,dispose(t);this.elementCount=0},reset:function(){let t;for(;null!==(t=this.list.shift());)t.remover.remove(this._remove,this),t.container=null;this.elementCount=0},add:function(t){if(!$92d13821ebf791dd$export$9099ad97b570f7c.isInstance(t))throw new Error("argument must be an Element");return this.list.push(t),this.elementCount++,t.container=this,t.remover.add(this._remove,this,this.list.bottom),this.syncZ(t),!0},_remove:function(t,e,r){return e.list.remove(r),e.elementCount--,t.container=null,!1},remove:function(t){return t.remover.execf(this._remove,this),t},_draw:function(){let t=$f005ca949837a330$export$9099ad97b570f7c.ALIVE|$f005ca949837a330$export$9099ad97b570f7c.VISIBLE;for(let e=this.list.top;e&&(!e.value.getFlags(t)||!1!==this.drawElement(e.value,this));e=e.next);}}),$14971b1dbc66c542$export$9099ad97b570f7c=$8d5810663b8c1ffa$export$9099ad97b570f7c.extend({className:"GridContainer",grid:null,debugBounds:!1,__ctor:function(t=32768,e=32768,r=64){this._super.Container.__ctor(t,e),this.grid=new $104a41fe69a021d0$export$9099ad97b570f7c(t,e,r)},__dtor:function(){this.clear(),this._super.Container.__dtor()},sync:function(t){return this.syncZ(t),this.grid.sync(t)},clear:function(){this.grid.clear()},reset:function(){this.grid.reset()},add:function(t){if(!$92d13821ebf791dd$export$9099ad97b570f7c.isInstance(t))throw new Error("argument must be an Element");return!!this.grid.add(t)&&(t.container=this,this.elementCount=this.grid.count,this.syncZ(t),!0)},remove:function(t){return this.grid.remove(t),this.elementCount=this.grid.count,t},_draw:function(){if(this.grid.forEachInRegion(this.viewportBounds,$f005ca949837a330$export$9099ad97b570f7c.ALIVE|$f005ca949837a330$export$9099ad97b570f7c.VISIBLE,$f005ca949837a330$export$9099ad97b570f7c.ALIVE|$f005ca949837a330$export$9099ad97b570f7c.VISIBLE,this.drawElement,this),!this.debugBounds||null===this.viewportBounds)return;let t=$d36cc4eae272df9c$export$9099ad97b570f7c.displayBuffer2;t.pushMatrix(),t.loadMatrix(this.g.getMatrix());let e=(this.viewportBounds.y1+this.grid.offsy-(1<<this.grid.ky-1)>>this.grid.ky)*this.grid.stride,r=(this.viewportBounds.y2+this.grid.offsy+(1<<this.grid.ky-1)>>this.grid.ky)*this.grid.stride,i=this.viewportBounds.x1+this.grid.offsx-(1<<this.grid.kx-1)>>this.grid.kx,a=this.viewportBounds.x2+this.grid.offsx+(1<<this.grid.kx-1)>>this.grid.kx;e=(int(e/this.grid.stride)<<this.grid.ky)-this.grid.offsy,r=(int(r/this.grid.stride)<<this.grid.ky)-this.grid.offsy+(1<<this.grid.ky),i=(i<<this.grid.kx)-this.grid.offsx,a=(a<<this.grid.kx)-this.grid.offsx+(1<<this.grid.kx),t.fillStyle("rgba(255,0,0,0.2)"),t.fillRect(i,e,a-i+1,r-e+1),e=this.viewportBounds.y1,r=this.viewportBounds.y2,i=this.viewportBounds.x1,a=this.viewportBounds.x2,t.lineWidth(1/$d36cc4eae272df9c$export$9099ad97b570f7c.canvasScaleFactor),t.strokeStyle("#fff"),t.strokeRect(i,e,a-i+1,r-e+1),t.lineWidth(1/$d36cc4eae272df9c$export$9099ad97b570f7c.canvasScaleFactor),t.strokeStyle("#008");for(let e=$f37b9fd5341d0b91$export$9099ad97b570f7c.viewport.worldY1+this.grid.offsy;e<$f37b9fd5341d0b91$export$9099ad97b570f7c.viewport.worldY2+this.grid.offsy;e+=1<<this.grid.ky)for(let r=$f37b9fd5341d0b91$export$9099ad97b570f7c.viewport.worldX1+this.grid.offsx;r<$f37b9fd5341d0b91$export$9099ad97b570f7c.viewport.worldX2+this.grid.offsx;r+=1<<this.grid.kx)t.strokeRect(r-this.grid.offsx,e-this.grid.offsy,1<<this.grid.kx,1<<this.grid.ky);t.popMatrix()},forEachInRegion:function(t,e,r,i,a){this.grid.forEachInRegion(t,e,r,i,a)},selectInRegion:function(t,e,r){return this.grid.selectInRegion(t,e,r)},countInRegion:function(t,e,r){return this.grid.countInRegion(t,e,r)},selectFirst:function(t,e,r){return this.grid.selectFirst(t,e,r)}});const $00f51581a30af6ed$var$Mask=$92d13821ebf791dd$export$9099ad97b570f7c.extend({className:"Mask",type:0,__ctor:function(t,e,r,i,a){this._super.Element.__ctor(e,r,i,a),this.type=t},draw:function(t){let e=$d36cc4eae272df9c$export$9099ad97b570f7c.displayBuffer2;e.pushMatrix(),e.loadMatrix(t.getMatrix()),e.fillStyle("rgba(255,0,255,0.3)"),e.fillRect(this.bounds.x1,this.bounds.y1,this.bounds.width(),this.bounds.height()),e.popMatrix()}});$40681449f8cf34e0$export$9099ad97b570f7c.createPool($00f51581a30af6ed$var$Mask);var $00f51581a30af6ed$export$9099ad97b570f7c=$00f51581a30af6ed$var$Mask;const $b1c6f6855d522000$var$Label=$92d13821ebf791dd$export$9099ad97b570f7c.extend({className:"Label",text:null,font:null,_ltext:null,_twidth:null,_theight:null,_align:-1,_valign:-1,_offsx:null,_offsy:null,__ctor:function(t,e,r,i){this._super.Element.__ctor(t,e,4,4),this.text=i,this.font=r},align:function(t){return this._align=t,this._offsx=null,this},valign:function(t){return this._valign=t,this._offsy=null,this},render:function(t){this.text!==this._ltext&&(this._twidth=this.font.measureWidth(this.text),this._theight=this.font.measureHeight(this.text),this._ltext=this.text),null===this._offsx&&(this._align<0?this._offsx=0:0===this._align?this._offsx=-this._twidth>>1:this._offsx=-this._twidth),null===this._offsy&&(this._valign<0?this._offsy=0:0===this._valign?this._offsy=-this._theight>>1:this._offsy=-this._theight),this.font.drawText(t,this.bounds.x1+this._offsx,this.bounds.y1+this._offsy,this.text)}});$40681449f8cf34e0$export$9099ad97b570f7c.createPool($b1c6f6855d522000$var$Label);var $b1c6f6855d522000$export$9099ad97b570f7c=$b1c6f6855d522000$var$Label,$d7d122118d302d6d$export$9099ad97b570f7c=$ec332034a18f1fbe$export$9099ad97b570f7c.Module.create({handlers:null,__ctor:function(){const t=this;this._super.Module.__ctor(),this.handlers=new $4b75cf23acd7232f$export$9099ad97b570f7c,this._callOnKeyboardEvent=function(e){return t.callOnKeyboardEvent(e)}},register:function(t){try{this.handlers.add(t),"init"in t&&t.init()}catch(t){throw new Error("KeyboardHandler (register): "+t.message)}return t},unregister:function(t){try{this.handlers.remove(t),this.handlers.cleanup()}catch(t){throw new Error("KeyboardHandler (unregister): "+t.message)}},callOnKeyboardEvent:function(t){return t.onKeyboardEvent(this._action,this._keyCode,this._keyState)},onStartup:function(){$d36cc4eae272df9c$export$9099ad97b570f7c.onKeyboardEvent=(t,e,r)=>{this._action=t,this._keyCode=e,this._keyState=r,this.handlers.forEach(this._callOnKeyboardEvent)}},onShutdown:function(){$d36cc4eae272df9c$export$9099ad97b570f7c.onKeyboardEvent=null}}),$9679bce102fe7bb5$export$9099ad97b570f7c=$ec332034a18f1fbe$export$9099ad97b570f7c.Module.create({handlers:null,__ctor:function(){const t=this;this._super.Module.__ctor(),this.handlers=new $4b75cf23acd7232f$export$9099ad97b570f7c,this._callOnPointerEvent=function(e){return t.callOnPointerEvent(e)}},register:function(t){try{this.handlers.add(t),"init"in t&&t.init()}catch(t){throw new Error("PointerHandler (register): "+t.message)}return t},unregister:function(t){try{this.handlers.remove(t),this.handlers.cleanup()}catch(t){throw new Error("PointerHandler (unregister): "+t.message)}},callOnPointerEvent:function(t){return t.onPointerEvent(this._action,this._p,this._pointers)},onStartup:function(){$d36cc4eae272df9c$export$9099ad97b570f7c.onPointerEvent=(t,e,r)=>{this._action=t,this._p=e,this._pointers=r,this.handlers.forEach(this._callOnPointerEvent)}},onShutdown:function(){$d36cc4eae272df9c$export$9099ad97b570f7c.onPointerEvent=null}});const $96ed3f7cdd3945f5$var$ScreenControls={priority:5,list:[],dummy:{},hoverEnabled:!1,zindexEnabled:!1,lastFrame:0,add:function(t){this.zindexEnabled&&!("zindex"in t)&&(t.zindex=0),-1===this.list.indexOf(t)&&this.list.push(t)},remove:function(t){var e=this.list.indexOf(t);-1!==e&&this.list.splice(e,1)},setHoverEnabled:function(t){this.hoverEnabled=t},setZIndexEnabled:function(t){this.zindexEnabled=t},findTarget:function(t,e,r){if(this.zindexEnabled&&this.lastFrame!=$d36cc4eae272df9c$export$9099ad97b570f7c.frameNumber){let t=this.list[0].zindex;for(let e of this.list){if(e.zindex>t){this.list=this.list.sort(((t,e)=>e.zindex-t.zindex));break}t=e.zindex}this.lastFrame=$d36cc4eae272df9c$export$9099ad97b570f7c.frameNumber}for(let i=0;i<this.list.length;i++)if(this.list[i]&&(null==r||!1!==r(this.list[i]))&&this.list[i].containsPoint(t,e))return this.list[i];return null},filterHover:function(t){return"hover"in t},onPointerEvent:function(t,e,r){let i=!0,a=null;switch(t){case $d36cc4eae272df9c$export$9099ad97b570f7c.EVT_POINTER_DOWN:null!=e._ref&&(a=e._ref,e._ref=null,a.pointerDeactivate(e)),a=this.findTarget(e.x,e.y),null!=a&&((e._ref=a).pointerActivate(e),i=!1);break;case $d36cc4eae272df9c$export$9099ad97b570f7c.EVT_POINTER_DRAG_START:null!=e._ref&&(i=!1);break;case $d36cc4eae272df9c$export$9099ad97b570f7c.EVT_POINTER_DRAG_MOVE:this.hoverEnabled&&(null!=e._refh?e._refh.containsPoint(e.x,e.y)||(a=e._refh,e._refh=null,a.hover(!1,e),a=this.findTarget(e.x,e.y,this.filterHover),null!=a&&(e._refh=a).hover(!0,e)):(a=this.findTarget(e.x,e.y,this.filterHover),null!=a&&(e._refh=a).hover(!0,e))),null!=e._ref?e._ref.containsPoint(e.x,e.y)||1==e._ref.focusLock?(e._ref.pointerUpdate(e.x,e.y,e),i=!1):(a=e._ref,e._ref=null,a.pointerDeactivate(e),a=this.findTarget(e.x,e.y),null!=a&&((e._ref=a).pointerActivate(e),i=!1)):(a=this.findTarget(e.x,e.y),null!=a&&((e._ref=a).pointerActivate(e),i=!1));break;case $d36cc4eae272df9c$export$9099ad97b570f7c.EVT_POINTER_MOVE:if(this.hoverEnabled&&(null!=e._refh?e._refh.containsPoint(e.x,e.y)||(a=e._refh,e._refh=null,a.hover(!1,e),a=this.findTarget(e.x,e.y,this.filterHover),null!=a&&(e._refh=a).hover(!0,e)):(a=this.findTarget(e.x,e.y,this.filterHover),null!=a&&(e._refh=a).hover(!0,e))),null==e._ref)break;e._ref.containsPoint(e.x,e.y)||1==e._ref.focusLock?(e._ref.pointerUpdate(e.x,e.y,e),i=!1):(a=e._ref,e._ref=null,a.pointerDeactivate(e));break;case $d36cc4eae272df9c$export$9099ad97b570f7c.EVT_POINTER_DRAG_STOP:null!=e._ref&&(i=!1);break;case $d36cc4eae272df9c$export$9099ad97b570f7c.EVT_POINTER_UP:null!=e._ref&&(a=e._ref,e._ref=null,a.pointerDeactivate(e),i=!1)}return i},onKeyboardEvent:function(t,e,r){switch(t){case $d36cc4eae272df9c$export$9099ad97b570f7c.EVT_KEY_DOWN:for(let t=0;t<this.list.length&&(!this.list[t]||!this.list[t].keyboardEvents||!1!==this.list[t].keyDown(e,r));t++);break;case $d36cc4eae272df9c$export$9099ad97b570f7c.EVT_KEY_UP:for(let t=0;t<this.list.length&&(!this.list[t]||!this.list[t].keyboardEvents||!1!==this.list[t].keyUp(e,r));t++);}}};$9679bce102fe7bb5$export$9099ad97b570f7c.register($96ed3f7cdd3945f5$var$ScreenControls),$d7d122118d302d6d$export$9099ad97b570f7c.register($96ed3f7cdd3945f5$var$ScreenControls);var $96ed3f7cdd3945f5$export$9099ad97b570f7c=$96ed3f7cdd3945f5$var$ScreenControls,$ee5086aec90900a4$export$9099ad97b570f7c=$b5123f2e08f44320$export$9099ad97b570f7c.extend({focusLock:!1,keyboardEvents:!0,isPressed:!1,wasPressed:!1,unpressedImg:null,pressedImg:null,keyCode:null,hitbox:0,__ctor:function(t,e,r,i,a=null){this._super.Group.__ctor(),this.unpressedImg=i,this.pressedImg=a||i,this.hitbox=new $00f51581a30af6ed$export$9099ad97b570f7c(0,e,r,i.width,i.height).visible(!1),this.addChild(this.hitbox),t.add(this.hitbox),t.add(this),$96ed3f7cdd3945f5$export$9099ad97b570f7c.add(this)},__dtor:function(){this._super.Group.__dtor(),$96ed3f7cdd3945f5$export$9099ad97b570f7c.remove(this)},setImage:function(t,e=null){return this.unpressedImg=t,this.pressedImg=e||t,this},setKeyCode:function(t){return this.keyCode=t,this},reset:function(){this.onChange(this.isPressed=!1,this.wasPressed=!1)},render:function(t){this.isPressed?this.pressedImg.draw(t,this.bounds.x1,this.bounds.y1):this.unpressedImg.draw(t,this.bounds.x1,this.bounds.y1)},pointerUpdate:function(t,e){},setStatus:function(t){return this.isPressed&&t||!this.isPressed&&!t||(this.updateStatus(t),this.onChange(this.isPressed,this.wasPressed)),this},updateStatus:function(t=null){return this.wasPressed=this.isPressed,this.isPressed=null===t?this.isPressed:t,this},pointerActivate:function(t){this.setStatus(!0)},pointerDeactivate:function(t){this.setStatus(!1)},containsPoint:function(t,e){return!!this.visible()&&this.hitbox.bounds.containsPoint(t,e)},onChange:function(t,e){t!=e&&(t?this.onButtonDown():this.onButtonUp()),!t&&e&&this.onTap()},keyDown:function(t){if(t===this.keyCode)return this.pointerActivate(),!1},keyUp:function(t,e){if(t===this.keyCode)return this.pointerDeactivate(),!1},onButtonDown:function(){},onButtonUp:function(){},onTap:function(){}}),$6fa6148c506b0c92$export$9099ad97b570f7c=$b5123f2e08f44320$export$9099ad97b570f7c.extend({focusLock:!0,keyboardEvents:!0,status:0,lstatus:0,unpressedImg:null,pressedImg:null,unpressedImgInner:null,pressedImgInner:null,angleSteps:0,radiusSteps:0,rdirx:0,rdiry:0,dirx:0,diry:0,magnitude:0,angle:0,frdirx:0,frdiry:0,fdirx:0,fdiry:0,fmagnitude:0,fangle:0,dispx:0,dispy:0,radius:0,maxRadius:0,deadZoneX:0,deadZoneY:0,hitbox:0,__ctor:function(t,e,r,i,a,n,s=null,o=null){this._super.Group.__ctor(),this.unpressedImg=a,this.pressedImg=s||a,this.unpressedImgInner=n,this.pressedImgInner=o||n,this.maxRadius=i,this.deadZoneX=0,this.deadZoneY=0,this.hitbox=new $00f51581a30af6ed$export$9099ad97b570f7c(0,e,r,a.width,a.height).visible(!1),this.addChild(this.hitbox),t.add(this.hitbox),t.add(this),$96ed3f7cdd3945f5$export$9099ad97b570f7c.add(this)},__dtor:function(){this._super.Group.__dtor(),$96ed3f7cdd3945f5$export$9099ad97b570f7c.remove(this)},setImage:function(t,e=null){return this.unpressedImg=t,this.pressedImg=e||t,this},setImageInner:function(t,e=null){return this.unpressedImgInner=t,this.pressedImgInner=e||t,this},setAngleSteps:function(t){return this.angleSteps=t,this},setRadiusSteps:function(t){return this.radiusSteps=t,this},setDeadZone:function(t,e){return this.deadZoneX=t,this.deadZoneY=e,this},reset:function(){this.dispx=0,this.dispy=0,this.rdirx=0,this.rdiry=0,this.dirx=0,this.diry=0,this.magnitude=0,this.onChange(this.dirx,this.diry,this.magnitude,this.angle)},render:function(t){this.status?(this.pressedImg.draw(t,this.bounds.x1,this.bounds.y1),this.pressedImgInner.draw(t,this.bounds.x1+this.dispx,this.bounds.y1+this.dispy)):(this.unpressedImg.draw(t,this.bounds.x1,this.bounds.y1),this.unpressedImgInner.draw(t,this.bounds.x1,this.bounds.y1))},pointerUpdate:function(t,e){let r=t-this.bounds.cx,i=e-this.bounds.cy;if(this.angle=Math.atan2(-i,r),this.radius=Math.sqrt(r*r+i*i),this.radius>this.maxRadius&&(this.radius=this.maxRadius),this.angleSteps){let t=2*Math.PI/this.angleSteps;this.angle=int((this.angle+Math.PI+t/2)/t)*t-Math.PI}if(this.radiusSteps){let t=this.maxRadius/this.radiusSteps;this.radius=int((this.radius+t/2)/t)*t}this.rdirx=Math.min(1,Math.max(r/this.maxRadius,-1)),this.rdiry=Math.min(1,Math.max(i/this.maxRadius,-1)),this.dispx=this.radius*Math.cos(this.angle),this.dispy=this.radius*-Math.sin(this.angle),this.radius>0?(this.dirx=this.dispx/this.radius,this.diry=this.dispy/this.radius,this.magnitude=this.radius/this.maxRadius):(this.dirx=0,this.diry=0,this.magnitude=0),Math.abs(this.rdirx)<this.deadZoneX&&(this.rdirx=0,this.dirx=0),Math.abs(this.rdiry)<this.deadZoneY&&(this.rdiry=0,this.diry=0),this.onChange(this.dirx,this.diry,this.magnitude,this.angle)},pointerActivate:function(t){this.lstatus=this.status,this.status=1,this.pointerUpdate(t.x,t.y)},pointerDeactivate:function(t){this.lstatus=this.status,this.status=0,this.reset()},containsPoint:function(t,e){return!!this.visible()&&this.hitbox.bounds.containsPoint(t,e)},setDirection:function(t,e,r=.1,i=.1){return Math.abs(t)<r&&(t=0),Math.abs(e)<i&&(e=0),this.lstatus=this.status,this.status=0==t&&0==e?0:1,this.pointerUpdate(this.bounds.cx+t*this.maxRadius,this.bounds.cy+e*this.maxRadius),!1},freezeState:function(t=!1){return this.frdirx=t?0!=this.rdirx?this.rdirx:this.frdirx:this.rdirx,this.frdiry=t?0!=this.rdiry?this.rdiry:this.frdiry:this.rdiry,this.fdirx=t?0!=this.dirx?this.dirx:this.fdirx:this.dirx,this.fdiry=t?0!=this.diry?this.diry:this.fdiry:this.diry,this.fmagnitude=t?0!=this.magnitude?this.magnitude:this.fmagnitude:this.magnitude,this.fangle=t?0!=this.angle?this.angle:this.fangle:this.angle,this},keyDown:function(t,e){let r=0,i=0;if(!0===e[$c4eb26169b07d885$export$9099ad97b570f7c.UP]&&(i=-this.maxRadius),!0===e[$c4eb26169b07d885$export$9099ad97b570f7c.LEFT]&&(r=-this.maxRadius),!0===e[$c4eb26169b07d885$export$9099ad97b570f7c.DOWN]&&(i=this.maxRadius),!0===e[$c4eb26169b07d885$export$9099ad97b570f7c.RIGHT]&&(r=this.maxRadius),t===$c4eb26169b07d885$export$9099ad97b570f7c.UP||t===$c4eb26169b07d885$export$9099ad97b570f7c.LEFT||t===$c4eb26169b07d885$export$9099ad97b570f7c.DOWN||t===$c4eb26169b07d885$export$9099ad97b570f7c.RIGHT)return r=this.bounds.cx+r,i=this.bounds.cy+i,this.lstatus=this.status,this.status=1,this.pointerUpdate(r,i),!1},keyUp:function(t,e){let r=0,i=0;if(!0===e[$c4eb26169b07d885$export$9099ad97b570f7c.UP]&&(i=-this.maxRadius),!0===e[$c4eb26169b07d885$export$9099ad97b570f7c.LEFT]&&(r=-this.maxRadius),!0===e[$c4eb26169b07d885$export$9099ad97b570f7c.DOWN]&&(i=this.maxRadius),!0===e[$c4eb26169b07d885$export$9099ad97b570f7c.RIGHT]&&(r=this.maxRadius),t===$c4eb26169b07d885$export$9099ad97b570f7c.UP||t===$c4eb26169b07d885$export$9099ad97b570f7c.LEFT||t===$c4eb26169b07d885$export$9099ad97b570f7c.DOWN||t===$c4eb26169b07d885$export$9099ad97b570f7c.RIGHT)return this.pointerUpdate(this.bounds.cx+r,this.bounds.cy+i),0===r&&0===i&&(this.lstatus=this.status,this.status=0),!1},onChange:function(t,e,r,i){}}),$bf8b8f5483f2c108$exports={};$parcel$export($bf8b8f5483f2c108$exports,"r",(function(){return $bf8b8f5483f2c108$export$a76dc8286969aab3})),$parcel$export($bf8b8f5483f2c108$exports,"sys",(function(){return $bf8b8f5483f2c108$export$cc441a5911fd36d3})),$parcel$export($bf8b8f5483f2c108$exports,"res",(function(){return $bf8b8f5483f2c108$export$c7bee8ca66f4cbc})),$parcel$export($bf8b8f5483f2c108$exports,"world",(function(){return $bf8b8f5483f2c108$export$b4d539348f26d1ad})),$parcel$export($bf8b8f5483f2c108$exports,"input",(function(){return $bf8b8f5483f2c108$export$75417c12d4a7d146})),$parcel$export($bf8b8f5483f2c108$exports,"collider",(function(){return $bf8b8f5483f2c108$export$760d5042b493f87a}));const $fb622c142687857d$var$system={initialized:!1,screenWidth:0,screenHeight:0,renderer:null,time:0,dt:0,options:{gl:!0,log:!1,antialias:!1,background:"#000000",orientation:"automatic",screenWidth:null,screenHeight:null,fps:144,minFps:10},init:function(t){return new Promise(((e,r)=>{if(this.initialized)return e();Object.assign(this.options,t),$10ed0b997def83af$export$9099ad97b570f7c.init({pixelated:!this.antialias}),$d36cc4eae272df9c$export$9099ad97b570f7c.init(this.options),$d36cc4eae272df9c$export$9099ad97b570f7c.updateQueueAdd({update:function(t){$fb622c142687857d$var$system.time=$d36cc4eae272df9c$export$9099ad97b570f7c.frameTime,$fb622c142687857d$var$system.dt=t}}),$ec332034a18f1fbe$export$9099ad97b570f7c.startup((function(){$d36cc4eae272df9c$export$9099ad97b570f7c.start(),$fb622c142687857d$var$system.screenWidth=$d36cc4eae272df9c$export$9099ad97b570f7c.screenWidth,$fb622c142687857d$var$system.screenHeight=$d36cc4eae272df9c$export$9099ad97b570f7c.screenHeight,$fb622c142687857d$var$system.renderer=$d36cc4eae272df9c$export$9099ad97b570f7c.renderer,$fb622c142687857d$var$system.initialized=!0,!0===$fb622c142687857d$var$system.options.log&&$c911639689a6d3da$export$9099ad97b570f7c.enable(),e()}))}))}};var $fb622c142687857d$export$9099ad97b570f7c=$fb622c142687857d$var$system;const $b798f6a6d531005f$var$world={SCENE_MAIN:0,SCENE_HUD:1,LAYER_BG0:0,LAYER_BG1:1,LAYER_BG2:2,LAYER_MAIN:3,LAYER_FG0:4,LAYER_FG1:5,LAYER_FG2:6,LAYER_MASK:7,LAYER_HUD_BG:0,LAYER_HUD_FG:1,_scenes:[],activeScene:null,_viewports:[],activeViewport:null,activeContainer:null,activeGroup:null,lastGroup:null,lastElement:null,bounds:$8c9106190296a533$export$9099ad97b570f7c.Pool.alloc(),init:function(t=32768,e=32768,r=null){null===r&&(r=Math.max(t,e)/512),r<32&&(r=32),this.bounds.zero().resize(t,e),this.createScene($b798f6a6d531005f$var$world.SCENE_MAIN),this.setContainer($b798f6a6d531005f$var$world.LAYER_BG0,new $14971b1dbc66c542$export$9099ad97b570f7c(t,e,r)),this.setContainer($b798f6a6d531005f$var$world.LAYER_BG1,new $14971b1dbc66c542$export$9099ad97b570f7c(t,e,r)),this.setContainer($b798f6a6d531005f$var$world.LAYER_BG2,new $14971b1dbc66c542$export$9099ad97b570f7c(t,e,r)),this.setContainer($b798f6a6d531005f$var$world.LAYER_MAIN,new $14971b1dbc66c542$export$9099ad97b570f7c(t,e,r)),this.setContainer($b798f6a6d531005f$var$world.LAYER_FG0,new $14971b1dbc66c542$export$9099ad97b570f7c(t,e,r)),this.setContainer($b798f6a6d531005f$var$world.LAYER_FG1,new $14971b1dbc66c542$export$9099ad97b570f7c(t,e,r)),this.setContainer($b798f6a6d531005f$var$world.LAYER_FG2,new $14971b1dbc66c542$export$9099ad97b570f7c(t,e,r)),this.setContainer($b798f6a6d531005f$var$world.LAYER_MASK,new $14971b1dbc66c542$export$9099ad97b570f7c(t,e,r)),this.getContainer($b798f6a6d531005f$var$world.LAYER_MASK).visible(!1),this.createViewport(0),this.createScene($b798f6a6d531005f$var$world.SCENE_HUD),this.setContainer($b798f6a6d531005f$var$world.LAYER_HUD_BG,new $361d95e73ee6b179$export$9099ad97b570f7c($fb622c142687857d$export$9099ad97b570f7c.screenWidth,$fb622c142687857d$export$9099ad97b570f7c.screenHeight)),this.setContainer($b798f6a6d531005f$var$world.LAYER_HUD_FG,new $361d95e73ee6b179$export$9099ad97b570f7c($fb622c142687857d$export$9099ad97b570f7c.screenWidth,$fb622c142687857d$export$9099ad97b570f7c.screenHeight))},createScene:function(t){this._scenes[t]&&($d36cc4eae272df9c$export$9099ad97b570f7c.queueRemove(this._scenes[t]),$parcel$global.dispose(this._scenes[t])),this._scenes[t]=new $88d898e877fdfd8e$export$9099ad97b570f7c,$d36cc4eae272df9c$export$9099ad97b570f7c.queueAdd(this._scenes[t]),this.selectScene(t)},getScene:function(t=null){return null===t?this.activeScene:t<0||t>=this._scenes.length?null:this._scenes[t]},selectScene:function(t){return!(t<0||t>=this._scenes.length||!this._scenes[t])&&(this.activeScene=this._scenes[t],this.activeContainer=null,!0)},createViewport:function(t){if(null===this.activeScene)throw new Error("createViewport: use `selectScene` first to select the active scene.");this._viewports[t]&&($parcel$global.dispose(this._viewports[t]),this.activeScene.setViewport(t,null)),this._viewports[t]=new $bc943005a3d31ea3$export$9099ad97b570f7c(0,0,$fb622c142687857d$export$9099ad97b570f7c.screenWidth,$fb622c142687857d$export$9099ad97b570f7c.screenHeight,this.activeScene.maxWidth,this.activeScene.maxHeight,0,0),this.activeScene.setViewport(t,this._viewports[t]),this.selectViewport(t)},getViewport:function(t=null){return null===t?this.activeViewport:t<0||t>=this._viewports.length?null:this._viewports[t]},selectViewport:function(t){return!(t<0||t>=this._viewports.length||!this._viewports[t])&&(this.activeViewport=this._viewports[t],!0)},setContainer:function(t,e){if(null===this.activeScene)throw new Error("setContainer: use `selectScene` first to select the active scene.");return this.activeScene.setContainer(t,e),e},getContainer:function(t=null,e=!1){if(null===t){if(null===this.activeContainer&&e)throw new Error("getContainer: container index not specified and default container not set.");return this.activeContainer}if(null===this.activeScene)throw new Error("getContainer: use `selectScene` first to select the active scene.");let r=this.activeScene.getContainer(t);if(null===r&&e)throw new Error("getContainer: container index out of bounds.");return r},selectContainer:function(t){return this.activeContainer=this.getContainer(t,!0),null!==this.activeContainer},createGroup:function(t=null){if(null===this.activeScene)throw new Error("createGroup: use selectScene first to select the active scene.");return this.activeGroup=$b5123f2e08f44320$export$9099ad97b570f7c.Pool.alloc(t),this.activeScene.addGroup(this.activeGroup),this.activeGroup},endGroup:function(t=null,e=null){return null!==t&&this.activeGroup.translate(t,e),this.lastGroup=this.activeGroup,this.activeGroup=null,this.lastGroup.sync()},createElement:function(t,e,r,i=null,a=null){"string"!=typeof t&&(a=i,i=r,r=e,e=t,t=null);let n=this.getContainer(a),s=$92d13821ebf791dd$export$9099ad97b570f7c.Pool.alloc(e,r,i);return n.add(s.setId(t)),null!==this.activeGroup&&this.activeGroup.addChild(s),this.lastElement=s,s},createMask:function(t,e=null,r=null,i=null,a=null,n=null,s=null){"string"!=typeof t&&(s=n,n=a,a=i,i=r,r=e,e=t,t=null);let o=this.getContainer(s||$b798f6a6d531005f$var$world.LAYER_MASK);if(null===r){if(null===this.activeGroup)throw new Error("createMask: create a group first to use automatic masks");r=this.activeGroup.bounds.x1,i=this.activeGroup.bounds.y1,a=this.activeGroup.bounds.width(),n=this.activeGroup.bounds.height()}let c=$00f51581a30af6ed$export$9099ad97b570f7c.Pool.alloc(e,r,i,a,n);return o.add(c.setId(t)),null!==this.activeGroup&&this.activeGroup.addChild(c),c},createLabel:function(t,e,r,i,a,n=null){"string"!=typeof t&&(n=a,a=i,i=r,r=e,e=t,t=null);let s=this.getContainer(n),o=$b1c6f6855d522000$export$9099ad97b570f7c.Pool.alloc(e,r,i,a);return s.add(o.setId(t)),null!==this.activeGroup&&this.activeGroup.addChild(o),this.lastElement=o,o},createUpdater:function(t=null,e=null){if(null===this.activeScene)throw new Error("createUpdater: use selectScene first to select the active scene.");return new $1395e03f9ccf250b$export$9099ad97b570f7c(this.activeScene,t,e)}};var $b798f6a6d531005f$export$9099ad97b570f7c=$b798f6a6d531005f$var$world;const $4945fb9086156947$var$r={};var $4945fb9086156947$export$9099ad97b570f7c=$4945fb9086156947$var$r;const $6479fe3f67bce16e$var$res={load:function(t=null){return new Promise((function(e,r){$10ed0b997def83af$export$9099ad97b570f7c.load($4945fb9086156947$export$9099ad97b570f7c,(function(e,r,i){t&&t(i)}),(function(){e()}))}))},get:function(t){return $4945fb9086156947$export$9099ad97b570f7c[t]},__resIdMustNotExist:function(t){if(t in $4945fb9086156947$export$9099ad97b570f7c)throw new Error("Resource identifier `"+t+"` is already in use")},placeholder:function(t,e,r,i){return this.__resIdMustNotExist(t),$4945fb9086156947$export$9099ad97b570f7c[t]={type:"object",wrapper:"Placeholder",color:e,width:r,height:i}},image:function(t,e,r=null){return this.__resIdMustNotExist(t),$4945fb9086156947$export$9099ad97b570f7c[t]={type:"image",wrapper:"Drawable",src:e,pixelated:null,...r}},spritesheet:function(t,e,r,i,a=0,n=null,s=null){return this.__resIdMustNotExist(t),$4945fb9086156947$export$9099ad97b570f7c[t]={type:"image",wrapper:"Spritesheet",src:e,pixelated:null,config:{frameWidth:r,frameHeight:i,numFrames:a,...n},...s}},animation:function(t,e,r,i,a=null,n=null,s=null){return this.__resIdMustNotExist(t),$4945fb9086156947$export$9099ad97b570f7c[t]={type:"image",wrapper:"SpritesheetAnimation",src:e,config:{frameWidth:r,frameHeight:i,numFrames:a,...n},anim:{def:null,fps:15,seq:{},trans:{}},...s,fps:function(t){return this.anim.fps=t,this},seq:function(t,e,r,i=null){return this.anim.seq[t]={loop:e,group:r},null!==i&&(this.anim.seq[t].fps=i),this},trans:function(t,e,r){return t in this.anim.trans||(this.anim.trans[t]={}),this.anim.trans[t][e]=r,this},def:function(t){return this.anim.def=t,this}}},spritefont:function(t,e,r,i,a,n=null,s=null){return this.__resIdMustNotExist(t),$4945fb9086156947$export$9099ad97b570f7c[t]={type:"image",wrapper:"SpriteFont",src:e,font:{charWidth:r,charHeight:i,charset:a,...n},...s}},json:function(t,e,r=null){return this.__resIdMustNotExist(t),$4945fb9086156947$export$9099ad97b570f7c[t]={type:"json",src:e,...r}},data:function(t,e,r=null){return this.__resIdMustNotExist(t),$4945fb9086156947$export$9099ad97b570f7c[t]={type:"data",src:e,...r}},text:function(t,e,r=null){return this.__resIdMustNotExist(t),$4945fb9086156947$export$9099ad97b570f7c[t]={type:"text",src:e,...r}},sfx:function(t,e,r=null){return this.__resIdMustNotExist(t),$4945fb9086156947$export$9099ad97b570f7c[t]={type:"audio",wrapper:"Sound",src:e,track:"sfx",...r}},music:function(t,e,r=null){return this.__resIdMustNotExist(t),$4945fb9086156947$export$9099ad97b570f7c[t]={type:"audio",wrapper:"Sound",src:e,track:"music",...r}}};var $6479fe3f67bce16e$export$9099ad97b570f7c=$6479fe3f67bce16e$var$res;const $b896760f13513e38$var$Gamepad=$02c835380fe912d5$export$85a4e7644ad1465d.extend({sticks:null,buttons:null,scene:null,container:null,_visible:!0,__ctor:function(t,e){this.sticks={},this.buttons={},this.scene=t,this.layer=t.getContainer(e),this.layer.depthFlag(!1)},addStick:function(t,e,r,i,a,n=0){0==n&&(n=i.width-a.width);let s=new $6fa6148c506b0c92$export$9099ad97b570f7c(this.layer,e,r,n,i,a);return this.sticks[t]=s,this[t]=s,s},addButton:function(t,e,r,i,a=null){let n=new $ee5086aec90900a4$export$9099ad97b570f7c(this.layer,e,r,i,a);return this.buttons[t]=n,this[t]=n,n},visible:function(t=null){if(null===t)return this._visible;this._visible=t;for(let e in this.sticks)this.sticks[e].visible(t);for(let e in this.buttons)this.buttons[e].visible(t);return this},showMasks:function(t){for(let e in this.sticks)this.sticks[e].hitbox.visible(t);for(let e in this.buttons)this.buttons[e].hitbox.visible(t);return this}});var $b896760f13513e38$export$9099ad97b570f7c=$b896760f13513e38$var$Gamepad;const $83db74e4881f3a0d$var$input={_gamepads:[],activeGamepad:null,_cursorEnabled:null,_cursorHandler:null,activeCursor:null,pointer:null,cursorElement:function(t=!1){return!1===t?this.activeCursor:(this.activeCursor=t,this)},cursorEnabled:function(t=null){return null===t?this._cursorEnabled:(this._cursorEnabled===t||(this._cursorEnabled=t,!0===t?($fb622c142687857d$export$9099ad97b570f7c.renderer.elem.style.cursor="none",$9679bce102fe7bb5$export$9099ad97b570f7c.register(this.cursorPointerHandler)):($fb622c142687857d$export$9099ad97b570f7c.renderer.elem.style.removeProperty("cursor"),$9679bce102fe7bb5$export$9099ad97b570f7c.unregister(this.cursorPointerHandler))),this)},cursorHandler:function(t){return this._cursorHandler=t,this},cursorPointerHandler:{priority:50,onPointerEvent:function(t,e,r){$83db74e4881f3a0d$var$input._cursorEnabled&&($83db74e4881f3a0d$var$input.pointer=e,null!==$83db74e4881f3a0d$var$input.activeCursor&&$83db74e4881f3a0d$var$input.activeCursor.setPosition(e.x,e.y),null!==this._cursorHandler&&this._cursorHandler(t,e))}},createGamepad:function(t,e=null){if(null===$b798f6a6d531005f$export$9099ad97b570f7c.activeScene)throw new Error("input.createGamepad: use world.selectScene first to select the active scene.");return this._gamepads[t]=new $b896760f13513e38$export$9099ad97b570f7c($b798f6a6d531005f$export$9099ad97b570f7c.activeScene,null!==e?e:$b798f6a6d531005f$export$9099ad97b570f7c.LAYER_HUD_FG),this},getGamepad:function(t){return t<0||t>=this._gamepads.length?null:this._gamepads[t]||null},selectGamepad:function(t){return this.activeGamepad=this.getGamepad(t),!0},debugGamepad:function(t,e){if(null!==t)this._gamepads[t].debug(e);else for(let t=0;t<this._gamepads.length;t++)this._gamepads[t]&&this.debugGamepad(t,e)},stick:function(t,e,r,i,a,n=0){if(null===this.activeGamepad)throw new Error("input.addStick: use input.selectGamepad first to select the active gamepad.");return this.activeGamepad.addStick(t,e,r,i,a,n)},button:function(t,e,r,i,a=null){if(null===this.activeGamepad)throw new Error("input.addButton: use input.selectGamepad first to select the active gamepad.");return this.activeGamepad.addButton(t,e,r,i,a)}};var $83db74e4881f3a0d$export$9099ad97b570f7c=$83db74e4881f3a0d$var$input;const $f7e74beefa10abd6$var$collider={CONTACT_LEFT:1,CONTACT_RIGHT:2,CONTACT_HORIZONTAL:3,CONTACT_TOP:4,CONTACT_BOTTOM:8,CONTACT_VERTICAL:12,FLAG_EXCLUDE:$f005ca949837a330$export$9099ad97b570f7c.allocFlag(),contactRules:{},truncationRules:{},scene:null,maskLayer:null,fupdater:null,lupdater:null,flagsAnd:0,flagsValue:0,state:{contact:$8c9106190296a533$export$9099ad97b570f7c.Pool.alloc(),flags:0,dx:0,dy:0,bounds:$8c9106190296a533$export$9099ad97b570f7c.Pool.alloc(),x:new Array(32).fill(0),y:new Array(32).fill(0),v0x:new Array(32).fill(0),v0y:new Array(32).fill(0),v1x:new Array(32).fill(0),v1y:new Array(32).fill(0),v2x:new Array(32).fill(0),v2y:new Array(32).fill(0),count:0,target:0,v0:0,w0:0,delta0:0,v1:0,w1:0,delta1:0,w2:0,t_dx:0,t_dy:0},enable:function(t=null,e=null){this.scene=$b798f6a6d531005f$export$9099ad97b570f7c.getScene(t||$b798f6a6d531005f$export$9099ad97b570f7c.SCENE_MAIN),this.maskLayer=this.scene.getContainer(e||$b798f6a6d531005f$export$9099ad97b570f7c.LAYER_MASK),this.flagsAnd=$f005ca949837a330$export$9099ad97b570f7c.ALIVE|$f005ca949837a330$export$9099ad97b570f7c.VISIBLE|$f7e74beefa10abd6$var$collider.FLAG_EXCLUDE,this.flagsValue=$f005ca949837a330$export$9099ad97b570f7c.ALIVE|$f005ca949837a330$export$9099ad97b570f7c.VISIBLE,this.scene.fupdater.add(this.update,this),this.fupdater=$5b7e3c1c3884e506$export$9099ad97b570f7c.Pool.alloc(this),this.lupdater=$5b7e3c1c3884e506$export$9099ad97b570f7c.Pool.alloc(this)},disable:function(){this.scene.fupdater.remove(this.update,this),this.maskLayer=null,this.fupdater.free(),this.lupdater.free()},update:function(t,e){e.fupdater.exec(),e.lupdater.exec()},later:{run:function(t,e,r,i,a){$f7e74beefa10abd6$var$collider.fupdater.add(this._run,t,e,r,i,a)},setVisible:function(t,e){$f7e74beefa10abd6$var$collider.fupdater.add(this._setVisible,t,e)},setFlags:function(t,e){$f7e74beefa10abd6$var$collider.fupdater.add(this._setFlags,t,e)},clearFlags:function(t,e){$f7e74beefa10abd6$var$collider.fupdater.add(this._clearFlags,t,e)},_run:function(t,e,r,i,a,n){return r(t,e,i,a,n),!1},_setVisible:function(t,e,r){return e.visible(r),!1},_setFlags:function(t,e,r){return e.setFlags(r),!1},_clearFlags:function(t,e,r){return e.clearFlags(r),!1}},contact:function(t,e,r,i=null){return t in this.contactRules||(this.contactRules[t]={}),this.contactRules[t][e]={callback:r,context:i},this},truncate:function(t,e,r=null,i=null){return t in this.truncationRules||(this.truncationRules[t]={}),this.truncationRules[t][e]={callback:r,context:i},this},getContactFlags:function(t,e){this.state.contact.set(t).setAsIntersection(e);let r=this.state.contact;return this.state.flags=0,this.state.numFlags=0,r.x1==e.x1&&(this.state.flags|=$f7e74beefa10abd6$var$collider.CONTACT_LEFT,this.state.numFlags++),r.x2==e.x2&&(this.state.flags|=$f7e74beefa10abd6$var$collider.CONTACT_RIGHT,this.state.numFlags++),r.y1==e.y1&&(this.state.flags|=$f7e74beefa10abd6$var$collider.CONTACT_TOP,this.state.numFlags++),r.y2==e.y2&&(this.state.flags|=$f7e74beefa10abd6$var$collider.CONTACT_BOTTOM,this.state.numFlags++),this.state.flags},calc:function(t,e,r,i,a,n){let s=this.state.count,o=null,c=0;if(e>0)for(let t=0;t<s;t++)!i[t]||!a[t]||r[t]<0||((null===o||r[t]>o)&&(o=r[t]),a[t]=n[t]=0,c+=i[t]);else for(let t=0;t<s;t++)!i[t]||!a[t]||r[t]>0||((null===o||r[t]<o)&&(o=r[t]),a[t]=n[t]=0,c+=i[t]);null===o&&(o=0),t?(this.state.v0=c,this.state.w0=Math.abs(o),this.state.delta0=o):(this.state.v1=c,this.state.w1=Math.abs(o),this.state.delta1=o)},attemptSelect:function(t){this.state.v1+this.state.v0===this.state.target&&(null===this.state.w2||this.state.w1+this.state.w0<this.state.w2)&&(this.state.w2=this.state.w1+this.state.w0,t?(this.state.t_dx=this.state.delta0,this.state.t_dy=this.state.delta1):(this.state.t_dx=this.state.delta1,this.state.t_dy=this.state.delta0))},load0:function(){let t=this.state.count;for(let e=0;e<t;e++)this.state.v1x[e]=this.state.v0x[e],this.state.v1y[e]=this.state.v0y[e]},save1:function(){let t=this.state.count;for(let e=0;e<t;e++)this.state.v2x[e]=this.state.v1x[e],this.state.v2y[e]=this.state.v1y[e]},load1:function(){let t=this.state.count;for(let e=0;e<t;e++)this.state.v1x[e]=this.state.v2x[e],this.state.v1y[e]=this.state.v2y[e]},resolveXpos:function(t=!1){if(this.calc(t,1,this.state.x,this.state.v0x,this.state.v1x,this.state.v1y),t)return!0;this.save1(),this.resolveYpos(!0)&&this.attemptSelect(!1),this.load1(),this.resolveYneg(!0)&&this.attemptSelect(!1),this.load0()},resolveXneg:function(t=!1){if(this.calc(t,-1,this.state.x,this.state.v0x,this.state.v1x,this.state.v1y),t)return!0;this.save1(),this.resolveYpos(!0)&&this.attemptSelect(!1),this.load1(),this.resolveYneg(!0)&&this.attemptSelect(!1),this.load0()},resolveYpos:function(t=!1){if(this.calc(t,1,this.state.y,this.state.v0y,this.state.v1y,this.state.v1x),t)return!0;this.save1(),this.resolveXpos(!0)&&this.attemptSelect(!0),this.load1(),this.resolveXneg(!0)&&this.attemptSelect(!0),this.load0()},resolveYneg:function(t=!1){if(this.calc(t,-1,this.state.y,this.state.v0y,this.state.v1y,this.state.v1x),t)return!0;this.save1(),this.resolveXpos(!0)&&this.attemptSelect(!0),this.load1(),this.resolveXneg(!0)&&this.attemptSelect(!0),this.load0()},commit:function(){this.state.group.alive()&&(this.state.group.translate(this.state.dx,this.state.dy),this.state.group.clearFlags($f7e74beefa10abd6$var$collider.FLAG_EXCLUDE))},translate:function(t,e=null,r=0,i=0){if("number"==typeof e&&(i=r,r=e,e=null),e||(e=t.group),!e.alive()||!t.alive())return;if(this.state.mask=t,this.state.group=e,this.state.dx=downscalef(upscale(r)),this.state.dy=downscalef(upscale(i)),!this.maskLayer||!t.visible())return this.commit();let a=this.truncationRules[t.type];if(!a)return this.scan(t,e);this.state.offs=e.getOffsets(this.state.dx,this.state.dy),this.state.bounds.set(t.bounds).translate(this.state.offs.x+this.state.dx,this.state.offs.y+this.state.dy),e.setFlags($f7e74beefa10abd6$var$collider.FLAG_EXCLUDE);let n=this.maskLayer.selectInRegion(this.state.bounds,this.flagsAnd,this.flagsValue);if(0===n.length)return n.free(),this.commit();let s=0,o=0;for(;;){let e=n.shift();if(null===e)break;let r=a[e.type];if(!r)continue;if(!1===r.callback||null!==r.callback&&!0!==r.callback&&!r.callback(t,e,r.context))continue;let i=Math.min(this.state.bounds.x2,e.bounds.x2)-Math.max(this.state.bounds.x1,e.bounds.x1),c=Math.min(this.state.bounds.y2,e.bounds.y2)-Math.max(this.state.bounds.y1,e.bounds.y1);this.state.v0x[s]=0,this.state.v0y[s]=0,Math.min(this.state.bounds.width(),e.bounds.width())!=i&&(this.state.x[s]=absmin(this.state.bounds.x2-e.bounds.x1,this.state.bounds.x1-e.bounds.x2),this.state.v0x[s]=1),Math.min(this.state.bounds.height(),e.bounds.height())!=c&&(this.state.y[s]=absmin(this.state.bounds.y2-e.bounds.y1,this.state.bounds.y1-e.bounds.y2),this.state.v0y[s]=1);let l=this.state.v0x[s]+this.state.v0y[s];o+=l,l>1&&(this.state.v0x[s]=l,this.state.v0y[s]=l),this.state.v1x[s]=this.state.v0x[s],this.state.v1y[s]=this.state.v0y[s],s++}if(n.free(),0==o)return this.commit(),this.scan(t,e);if(this.state.target=o,this.state.count=s,this.state.w2=null,this.resolveXpos(),this.resolveXneg(),this.resolveYpos(),this.resolveYneg(),null!==this.state.w2){let e=this.contactRules[t.type];if(e){for(this.state.bounds.set(t.bounds).translate(this.state.offs.x+this.state.dx-.5*this.state.t_dx,this.state.offs.y+this.state.dy-.5*this.state.t_dy),n=this.maskLayer.selectInRegion(this.state.bounds,this.flagsAnd,this.flagsValue);;){let r=n.shift();if(null===r)break;let i=e[r.type];i&&i.callback(t,r,i.context)}n.free()}this.state.dx-=this.state.t_dx,this.state.dy-=this.state.t_dy}this.commit()},scan:function(t,e=null){if(e||(e=t.group),!e.alive()||!t.alive())return;this.state.mask=t,this.state.group=e;let r=this.contactRules[t.type];if(!this.maskLayer||!t.visible()||!r)return;e.setFlags($f7e74beefa10abd6$var$collider.FLAG_EXCLUDE);let i=this.maskLayer.selectInRegion(t.bounds,this.flagsAnd,this.flagsValue);for(e.clearFlags($f7e74beefa10abd6$var$collider.FLAG_EXCLUDE);;){let e=i.shift();if(null===e)break;let a=r[e.type];a&&a.callback(t,e,a.context)}i.free()}};var $f7e74beefa10abd6$export$9099ad97b570f7c=$f7e74beefa10abd6$var$collider;const $bf8b8f5483f2c108$export$cc441a5911fd36d3=$fb622c142687857d$export$9099ad97b570f7c,$bf8b8f5483f2c108$export$b4d539348f26d1ad=$b798f6a6d531005f$export$9099ad97b570f7c,$bf8b8f5483f2c108$export$a76dc8286969aab3=$4945fb9086156947$export$9099ad97b570f7c,$bf8b8f5483f2c108$export$c7bee8ca66f4cbc=$6479fe3f67bce16e$export$9099ad97b570f7c,$bf8b8f5483f2c108$export$75417c12d4a7d146=$83db74e4881f3a0d$export$9099ad97b570f7c,$bf8b8f5483f2c108$export$760d5042b493f87a=$f7e74beefa10abd6$export$9099ad97b570f7c,$658ba0b07a4ec711$export$85a4e7644ad1465d=$02c835380fe912d5$export$85a4e7644ad1465d,$658ba0b07a4ec711$export$6aaccd98745ad9c8=$f37b9fd5341d0b91$export$9099ad97b570f7c,$658ba0b07a4ec711$export$f784aa1b07eeac6=$d36cc4eae272df9c$export$9099ad97b570f7c,$658ba0b07a4ec711$export$4d59e12a1c7697d7=$b2a8f8940aea7a8f$export$9099ad97b570f7c,$658ba0b07a4ec711$export$3333a050bfc0ada3=$a4f6dcde8eac4617$export$9099ad97b570f7c,$658ba0b07a4ec711$export$840ab787eaee4157=$c4eb26169b07d885$export$9099ad97b570f7c,$658ba0b07a4ec711$export$557110b7a952b643=$8cb3108385e4214b$export$9099ad97b570f7c,$658ba0b07a4ec711$export$c9cfdf8a66a4d2ca=$00b1ad65b4c7b9c6$export$9099ad97b570f7c,$658ba0b07a4ec711$export$2b5ff101e1b2bb00=$c911639689a6d3da$export$9099ad97b570f7c,$658ba0b07a4ec711$export$2b6a748984e845f3=$591b01159cd21b49$export$9099ad97b570f7c,$658ba0b07a4ec711$export$d1377b383b9c97b1=$1a869689662b0ec8$export$9099ad97b570f7c,$658ba0b07a4ec711$export$d803f74f26e64d17=$90c43dcad69fbbb9$export$9099ad97b570f7c,$658ba0b07a4ec711$export$73b9aaf46ae254c4=$7dcf116364111cf8$exports,$658ba0b07a4ec711$export$788042a0cc1455ce=$10ed0b997def83af$export$9099ad97b570f7c,$658ba0b07a4ec711$export$407f1fb841a9103c=$40681449f8cf34e0$export$9099ad97b570f7c,$658ba0b07a4ec711$export$65be554b6c5a5f69=$f2fc3aaf8b986d20$export$9099ad97b570f7c,$658ba0b07a4ec711$export$67ff6ad4c3221cd5=$aa9d485c680b8e6e$export$9099ad97b570f7c,$658ba0b07a4ec711$export$85f86eb1fd7c7af5=$4b75cf23acd7232f$export$9099ad97b570f7c,$658ba0b07a4ec711$export$9603dc63f4b26676=$5b7e3c1c3884e506$export$9099ad97b570f7c,$658ba0b07a4ec711$export$98c16e1ff98bb093=$8e088f0009ece130$export$9099ad97b570f7c,$658ba0b07a4ec711$export$37c6ae4f022bed69=$a7307a37e7460017$export$9099ad97b570f7c,$658ba0b07a4ec711$export$5c2dd915c3178dd5=$04b906e53587fc1a$export$9099ad97b570f7c,$658ba0b07a4ec711$export$5bd07c235d380351=$4e74aae29faea1dd$export$9099ad97b570f7c,$658ba0b07a4ec711$export$d54906fab9190f08=$8c9106190296a533$export$9099ad97b570f7c,$658ba0b07a4ec711$export$56ce2844da725845=$9448267cbb48e2e7$export$9099ad97b570f7c,$658ba0b07a4ec711$export$1770dcac1b234222=$79ead9078b2906d6$export$9099ad97b570f7c,$658ba0b07a4ec711$export$b9bf57cbc26e1015=$c8953f2a853a94f0$export$9099ad97b570f7c,$658ba0b07a4ec711$export$6e47fbc78ae048bb=$ec332034a18f1fbe$export$9099ad97b570f7c,$658ba0b07a4ec711$export$dde849f16326d204=$f005ca949837a330$export$9099ad97b570f7c,$658ba0b07a4ec711$export$c0beb0283cd0caa9=$104a41fe69a021d0$export$9099ad97b570f7c,$658ba0b07a4ec711$export$df6b198c079ba70b=$88d898e877fdfd8e$export$9099ad97b570f7c,$658ba0b07a4ec711$export$7f841115a8fce801=$bc943005a3d31ea3$export$9099ad97b570f7c,$658ba0b07a4ec711$export$f65528cc6a59fcb6=$1395e03f9ccf250b$export$9099ad97b570f7c,$658ba0b07a4ec711$export$84330cc577268f09=$8d5810663b8c1ffa$export$9099ad97b570f7c,$658ba0b07a4ec711$export$ce555014ad1fb2e2=$361d95e73ee6b179$export$9099ad97b570f7c,$658ba0b07a4ec711$export$295b31e4521ee09f=$14971b1dbc66c542$export$9099ad97b570f7c,$658ba0b07a4ec711$export$a145e63780346cea=$b5123f2e08f44320$export$9099ad97b570f7c,$658ba0b07a4ec711$export$8f1dff5cc2b79014=$92d13821ebf791dd$export$9099ad97b570f7c,$658ba0b07a4ec711$export$26a09b3cc8d9d2df=$00f51581a30af6ed$export$9099ad97b570f7c,$658ba0b07a4ec711$export$f439af0d78941234=$b1c6f6855d522000$export$9099ad97b570f7c,$658ba0b07a4ec711$export$56dc43da7bb81ccd=$d7d122118d302d6d$export$9099ad97b570f7c,$658ba0b07a4ec711$export$3e1e281e8d01b44c=$9679bce102fe7bb5$export$9099ad97b570f7c,$658ba0b07a4ec711$export$37ae0460fb21e8f7=$96ed3f7cdd3945f5$export$9099ad97b570f7c,$658ba0b07a4ec711$export$3e142902fa56c5af=$ee5086aec90900a4$export$9099ad97b570f7c,$658ba0b07a4ec711$export$1ea29c2583ef834e=$6fa6148c506b0c92$export$9099ad97b570f7c;var $658ba0b07a4ec711$export$9099ad97b570f7c=$bf8b8f5483f2c108$exports,$7954af91ce3351df$export$9099ad97b570f7c=froxel=$658ba0b07a4ec711$exports;