(function(){var $parcel$global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function $parcel$export(e,t,a){Object.defineProperty(e,t,{get:a,enumerable:!0})}var $0c9c00c2409eb95b5e4d849b566b4428$exports={};let $3ceb97a86c97e49f496755485fbe7a5f$export$default={invokeLater:function(e){e&&setTimeout((function(){e()}),10)},wait:function(e){return new Promise((function(t,a){setTimeout(t,e)}))},typeOf:function(e){return e instanceof Array?"array":null===e?"null":(typeof e).toString().toLowerCase()},isArrayOrObject:function(e){switch($3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e)){case"array":case"object":return!0}return!1},clone:function(e){let t=$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e);if("array"===t){t=[];for(let a=0;a<e.length;a++)t.push($3ceb97a86c97e49f496755485fbe7a5f$export$default.clone(e[a]))}else if("object"===t){if("clone"in e&&"function"==typeof e.clone)return e.clone();t={};for(let a in e)t[a]=$3ceb97a86c97e49f496755485fbe7a5f$export$default.clone(e[a])}else t=e;return t},merge:function(e,...t){if("array"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e))for(let a=0;a<t.length;a++){let i=t[a];if("array"!=$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(i))e.push(i);else for(let t=0;t<i.length;t++)e.push($3ceb97a86c97e49f496755485fbe7a5f$export$default.clone(i[t]))}else if("object"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e))for(let a=0;a<t.length;a++){let i=t[a];if("object"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(i))for(let t in i)$3ceb97a86c97e49f496755485fbe7a5f$export$default.isArrayOrObject(i[t])?t in e?$3ceb97a86c97e49f496755485fbe7a5f$export$default.merge(e[t],i[t]):e[t]=$3ceb97a86c97e49f496755485fbe7a5f$export$default.clone(i[t]):e[t]=i[t]}return e},override:function(e,...t){for(let a=0;a<t.length;a++)for(let i in t[a])e[i]=t[a][i];return e},partialCompare:function(e,t){if(null==e||null==t)return!1;if(e===t)return!0;for(var a in t)if(e[a]!=t[a])return!1;return!0},arrayFind:function(e,t,a){for(var i=0;e&&i<e.length;i++)if(this.partialCompare(e[i],t))return a?e[i]:i;return!!a&&null},isInstanceOf:function(e,t){return!(!e||!t||"object"!=typeof e)&&(e instanceof t||"isInstanceOf"in e&&e.isInstanceOf(t))},indexOf:function(e,t,a=!1){if(a){for(let a=0;a<e.length;a++)if(e[a]===t)return a;return-1}for(let a in e)if(e[a]===t)return a;return-1},escape:function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},ensureTypeOf:function(e,t){return!t||!e||t instanceof e||t.isInstanceOf&&e.prototype.className&&t.isInstanceOf(e.prototype.className)?t:new e(t)},serialize:function(e){return JSON.stringify(e)},deserialize:function(e){return JSON.parse(e)},hookAppend:function(e,t,a,i=!0){const r=e[t];return e[t]=i?function(...e){if(!1!==r.apply(this,e))return a.apply(this,e)}:function(...e){return r.apply(this,e),a.apply(this,e)},{unhook:function(){e[t]=r}}},hookPrepend:function(e,t,a,i=!0){const r=e[t];return e[t]=i?function(...e){if(!1!==a.apply(this,e))return r.apply(this,e)}:function(...e){return a.apply(this,e),r.apply(this,e)},{unhook:function(){e[t]=r}}}},$362774b94d49f24810750f9afdb3753f$export$default=function(){};$362774b94d49f24810750f9afdb3753f$export$default._class=$362774b94d49f24810750f9afdb3753f$export$default,$362774b94d49f24810750f9afdb3753f$export$default._super={},$362774b94d49f24810750f9afdb3753f$export$default.prototype.className="Class",$362774b94d49f24810750f9afdb3753f$export$default.prototype.__ctor=function(){},$362774b94d49f24810750f9afdb3753f$export$default.prototype.__dtor=function(){},$362774b94d49f24810750f9afdb3753f$export$default.prototype.isInstanceOf=function(e){return(e="string"===$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e)?e:e.prototype?e.prototype.className:e.constructor.prototype.className)in this._super||this.className===e},$362774b94d49f24810750f9afdb3753f$export$default.prototype._initSuperRefs=function(){let e=this.constructor._super,t={};const a=this;for(let i in e){let r={},n=e[i].prototype;for(let e in n)"function"===$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(n[e])&&(r[e]=function(e){return function(t,i,r,n,s,c,o,f,l,d,u){return e.call(a,t,i,r,n,s,c,o,f,l,d,u)}}(n[e]));t[i]=r}this._super=t},$362774b94d49f24810750f9afdb3753f$export$default.inherit=function(e){let t=this._class,a=t._super,i=t._class;if("function"===$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e)){for(let a in e._class)/^[A-Z]/.test(a)||(t[a]=e._class[a]);$3ceb97a86c97e49f496755485fbe7a5f$export$default.override(t.prototype,e._class.prototype),$3ceb97a86c97e49f496755485fbe7a5f$export$default.override(a,e._class._super),e._class.prototype.className&&(a[e._class.prototype.className]=e._class)}else $3ceb97a86c97e49f496755485fbe7a5f$export$default.override(t.prototype,e);return t._super=a,t._class=i,t},$362774b94d49f24810750f9afdb3753f$export$default.prototype._extend=function(e,t){if(0===t.length)return e;const a=function(...e){this._initSuperRefs(),this.__ctor.apply(this,e)};a._class=a,a._super={},$362774b94d49f24810750f9afdb3753f$export$default.inherit.call(a,e),delete a.prototype.className;for(let e=0;e<t.length;e++)a.inherit(t[e]);return delete a._super.Class,"classInit"in a.prototype&&a.prototype.classInit(),a.isInstance=function(e){return $3ceb97a86c97e49f496755485fbe7a5f$export$default.isInstanceOf(e,a)},a},$362774b94d49f24810750f9afdb3753f$export$default.extend=function(...e){return this._class.prototype._extend(this,e)},$362774b94d49f24810750f9afdb3753f$export$default.create=function(e){return new(this.extend(e))};var $c04d28fb896be8a6f73a315d6d946608$export$default=$362774b94d49f24810750f9afdb3753f$export$default.extend({className:"Event",source:null,name:null,args:null,_async:!1,list:null,next:null,ret:null,original:null,i:-1,__ctor:function(e,t,a,i,r,n){this.source=e,this.name=a,this.args=i,this.cbHandler=r,this.cbContext=n,this.list=t,this.reset()},reset:function(){return this.next=null,this.ret=[],this._async=!1,this.i=-1,this},setSource:function(e){return this.source=e,this},wait:function(){return this._async=!0,this},resume:function(){for(this._async=!1;!(this._async||++this.i>=this.list.length);)if(!this.list[this.i].silent)if("string"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(this.list[this.i].handler)){if(this.list[this.i].context){if(!this.list[this.i].context[this.list[this.i].handler])continue;if(!1===this.list[this.i].context[this.list[this.i].handler](this,this.args,this.list[this.i].data))break}else if(!1===$parcel$global[this.list[this.i].handler].call(null,this,this.args,this.list[this.i].data))break}else if(!1===this.list[this.i].handler.call(this.list[this.i].context,this,this.args,this.list[this.i].data))break;return this._async||(this.i>=this.list.length&&this.next&&this.next.resume(),this.cbHandler&&this.cbHandler.call(this.cbContext)),this},from:function(e){return this.original=e,this},enqueue:function(e){if(!e)return this;var t;for(t=this;null!=t.next;t=t.next);return t.next=e,e.from(this),this}}),$a9faffe322318a64f1985439c7e08c88$export$default=$362774b94d49f24810750f9afdb3753f$export$default.extend({className:"EventDispatcher",listeners:null,namespace:null,__ctor:function(){this.listeners={}},setNamespace:function(e){return this.namespace=e,this},addEventListener:function(e,t,a,i){var r=(e=e.split(":"))[e.length-1],n=e.length>1?e[0]:null;return this.listeners[r]||(this.listeners[r]=[]),this.listeners[r].push({ns:n,handler:t,context:a,data:i,silent:0}),this},removeEventListener:function(e,t,a){var i=(e=e.split(":"))[e.length-1],r=e.length>1?e[0]:null;if("*"==i)for(var n in this.listeners)for(var s=this.listeners[n],c=0;c<s.length;c++){var o=!0;t&&(o=o&&s[c].handler===t),a&&(o=o&&s[c].context===a),r&&(o=o&&s[c].ns==r),o&&s.splice(c--,1)}else{if(!this.listeners[i])return this;for(s=this.listeners[i],c=0;c<s.length;c++){o=!0;t&&(o=o&&s[c].handler===t),a&&(o=o&&s[c].context===a),r&&(o=o&&s[c].ns==r),o&&s.splice(c--,1)}}return this},prepareEvent:function(e,t,a,i){var r=[],n=(e=e.split(":"))[e.length-1],s=e.length>1?e[0]:null;this.listeners[n]&&(r=r.concat(this.listeners[n])),this.listeners["*"]&&(r=r.concat(this.listeners["*"]));for(var c=0;c<r.length;c++)r[c].silent&&r.splice(c--,1);if(s)for(c=0;c<r.length;c++)r[c].ns!=s&&r.splice(c--,1);return new $c04d28fb896be8a6f73a315d6d946608$export$default(this,r,n,t,a,i)},silence:function(e,t){var a=(e=e.split(":"))[e.length-1],i=e.length>1?e[0]:null;if(t=!1===t?-1:1,"*"==a)for(var r in this.listeners)for(var n=this.listeners[r],s=0;s<n.length;s++)i&&n[s].ns!=i||(n[s].silent+=t);else{if(!this.listeners[a])return this;for(n=this.listeners[a],s=0;s<n.length;s++)i&&n[s].ns!=i||(n[s].silent+=t)}return this},dispatchEvent:function(e,t,a,i){return this.prepareEvent(this.namespace?this.namespace+":"+e:e,t,a,i).resume()}}),$628b2663dd62299e7b2444a2de7f9153$export$default={email:/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)+$/i,url:/^[\w-]+:\/\/[\w-]+(\.\w+)+.*$/,urlNoProt:/^[\w-]+(\.\w+)+.*$/,name:/^[-A-Za-z0-9_.]+$/,uname:/^['\pL\pN ]+$/,text:/^[^&<>{}]*$/,utext:/^([\r\n\pL\pN\pS &!@#$%*\[\]()_+=;',.\/?:"~-]+)$/},$1af3bbb333f7838ae832df5e3332f3f3$exports=function(){var exports=this,module={exports:this};exports.__esModule=!0;var $1af3bbb333f7838ae832df5e3332f3f3$export$default={_getref:function(value,obj){return"string"==typeof value?("#"==value.substr(0,1)?value=obj.get(value.substr(1)):"@"==value.substr(0,1)&&(value=obj[value.substr(1)]),"string"==typeof value?eval(value):value):value},type:function(e,t,a,i){switch(t){case"int":if(i=parseInt(i),isNaN(i))throw new Error(t);break;case"float":if(i=parseFloat(i),isNaN(i))throw new Error(t);break;case"string":i=null==i?"":i.toString();break;case"bit":if(!0===i||!1===i){i=i?1:0;break}if(i=parseInt(i),isNaN(i))throw new Error(t);i=i?1:0;break;case"array":if("array"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(i))break;if(null==i){i=[];break}throw new Error(t);case"bool":if("true"===i||!0===i){i=!0;break}if("false"===i||!1===i){i=!1;break}throw new Error(t)}return i},model:function(e,t,a,i){var r=this._getref(t,e);if(!r)throw new Error(t);return i?r.ensure(i):new r},cls:function(e,t,a,i){var r=this._getref(t,e);return i?$3ceb97a86c97e49f496755485fbe7a5f$export$default.ensureTypeOf(r,i):new r},arrayof:function(e,t,a,i){var r=this._getref(t,e);if(i||(i=[]),!r||"array"!=$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(i))throw new Error(t);for(var n=0;n<i.length;n++)i[n]=$3ceb97a86c97e49f496755485fbe7a5f$export$default.ensureTypeOf(r,i[n]);return i},arraynull:function(e,t,a,i){var r=!1;if("object"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(t)&&(t.remove&&(r=t.remove),t=t.value),t)return i;if("array"!=$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(i))throw new Error(t);for(var n=0;n<i.length;n++)if(null==i[n]){if(!r)throw new Error(t);i.splice(n--,1)}return i},arraycompliant:function(e,t,a,i){var r=!1;if("object"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(t)&&(t.remove&&(r=t.remove),t=t.value),!t)return i;if("array"!=$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(i))throw new Error(t);for(var n=0;n<i.length;n++)if(null!=i[n]&&!i[n].isCompliant()){if(!r)throw new Error(t);i.splice(n--,1)}return i},required:function(e,t,a,i){if(null==i)throw new Error(t?"":"null");switch($3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(i)){case"array":if(0==i.length)throw new Error(t?"":"null");break;default:if(0==i.toString().length)throw new Error(t?"":"null")}return i},minlen:function(e,t,a,i){if(i.toString().length<t)throw new Error(t);return i},maxlen:function(e,t,a,i){if(i.toString().length>t)throw new Error(t);return i},minval:function(e,t,a,i){if(parseFloat(i)<t)throw new Error(t);return i},maxval:function(e,t,a,i){if(parseFloat(i)>t)throw new Error(t);return i},mincount:function(e,t,a,i){if("array"!=$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(i)||i.length<t)throw new Error(t);return i},maxcount:function(e,t,a,i){if("array"!=$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(i)||i.length>t)throw new Error(t);return i},pattern:function(e,t,a,i){if(!$628b2663dd62299e7b2444a2de7f9153$export$default[t].test(i.toString()))throw new Error(t);return i},inset:function(e,t,a,i){if("array"!=$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(t)){if(!new RegExp("^("+t.toString()+")$").test(i.toString()))throw new Error(t);return i}if(-1==t.indexOf(i.toString()))throw new Error(t.join("|"));return i},upper:function(e,t,a,i){return t?i.toString().toUpperCase():i},lower:function(e,t,a,i){return t?i.toString().toLowerCase():i}};return $parcel$export(exports,"default",(function(){return $1af3bbb333f7838ae832df5e3332f3f3$export$default})),module.exports}.call({});let $2f7ebfe35530a50778e04edf3edb1269$export$default=$a9faffe322318a64f1985439c7e08c88$export$default.extend({className:"Model",defaults:null,constraints:null,data:null,changedList:null,_silent:0,_level:0,__ctor:function(e,t){if(this._super.EventDispatcher.__ctor(),this.data={},null!=t)this.reset(t);else{var a=null;if(!this.defaults&&this.constraints){a={};for(var i in this.constraints){var r=this.constraints[i];null!==r.def&&void 0!==r.def?"function"==typeof r.def?a[i]=r.def():a[i]=r.def:a[i]=null}}this.reset(a)}this.init(),null!=e&&this.set(arguments[0],!0),this.constraints&&this.update(),this.ready()},reset:function(e,t){if(!this.defaults){if(!e||"object"!=$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e)&&"function"!=$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e))return this;this.defaults=e}return"function"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(this.defaults)?this.data=this.defaults():this.data=$3ceb97a86c97e49f496755485fbe7a5f$export$default.clone(this.defaults),!1===t||!1===e?this:this.update(null,!0)},init:function(){},ready:function(){},silent:function(e){return this._silent+=e?1:-1,this},_validate:function(e,t){if(!this.constraints||!this.constraints[e])return t;var a=this.constraints[e],i=t;for(var r in a)if($2f7ebfe35530a50778e04edf3edb1269$export$default.Constraints[r])try{i=$2f7ebfe35530a50778e04edf3edb1269$export$default.Constraints[r](this,a[r],e,i)}catch(t){if("null"==t.message)break;throw new Error(`Constraint [${r}:${a[r]}] failed on property '${e}'.`)}return i},_set:function(e,t){if(!this.constraints||!this.constraints[e])return this.data[e]=t,t;var a=this.constraints[e],i=(this.data[e],t);for(var r in a)if($2f7ebfe35530a50778e04edf3edb1269$export$default.Constraints[r])try{i=$2f7ebfe35530a50778e04edf3edb1269$export$default.Constraints[r](this,a[r],e,i)}catch(a){if("null"==a.message)break;this._silent||this.dispatchEvent("constraintError",{constraint:r,message:a.message,name:e,value:t});break}return this.data[e]=i},_propertyEvent:function(e,t,a,i){var r={name:e,old:t,value:a,level:this._level},n=this.dispatchEvent("propertyChanging",r);i?this.data[e]=r.value:r.value=this._set(e,r.value),null!=n&&n.ret.length&&!1===n.ret[0]||(this.dispatchEvent("propertyChanged."+e,r),this.dispatchEvent("propertyChanged",r),this.changedList.push(e))},set:function(){var e=arguments.length,t=!1,a=!1;if((e>2||2==e&&"object"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(arguments[0]))&&"boolean"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(arguments[e-1])&&!1===(t=arguments[--e])&&(a=!0),0==this._level&&(this.changedList=[]),this._level++,2==e)(this.data[arguments[0]]!=arguments[1]||t)&&(this._silent||a?this._set(arguments[0],arguments[1]):this._propertyEvent(arguments[0],this.data[arguments[0]],this._validate(arguments[0],arguments[1])));else for(var i in arguments[0])(this.data[i]!=arguments[0][i]||t)&&(this._silent||a?this._set(i,arguments[0][i]):this._propertyEvent(i,this.data[i],this._validate(i,arguments[0][i])));return--this._level||!this.changedList.length||a||this._silent||this.dispatchEvent("modelChanged",{fields:this.changedList}),this},has:function(e){return e in this.data},get:function(e,t){return 0==arguments.length||!1===e?this.data:1==arguments.length&&!0===e?this.flatten():2==arguments.length&&void 0===this.data[e]?t:this.data[e]},getInt:function(e,t){return 2==arguments.length&&void 0===this.data[e]?t:parseInt(this.data[e])},getFloat:function(e,t){return 2==arguments.length&&void 0===this.data[e]?t:parseFloat(this.data[e])},getBool:function(e,t){return"true"===(e=2==arguments.length&&void 0===this.data[e]?t:this.data[e])||!0===e||"false"!==e&&!1!==e&&!!parseInt(e)},getReference:function(e){var t=this;return{get:function(){return t.get(e)},set:function(a){t.set(e,a)}}},constraint:function(e,t,a){if(3==arguments.length||2==arguments.length||1==arguments.length&&"object"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e)){switch(this.constraints===this.constructor.prototype.constraints&&(this.constraints=$3ceb97a86c97e49f496755485fbe7a5f$export$default.clone(this.constraints)),arguments.length){case 1:$3ceb97a86c97e49f496755485fbe7a5f$export$default.override(this.constraints,e);break;case 2:$3ceb97a86c97e49f496755485fbe7a5f$export$default.override(this.constraints[e],t);break;case 3:this.constraints[e][t]=a}return this}return e?this.constraints[e]:this},flatten:function(e,t){if(e)return null==(r=this.flatten(!1,!0))?null:(r.class=this.classPath,r);if(!this.constraints&&!this.defaults)return this.data;if(!this.isCompliant())return{};var a=this.constraints,i=this.defaults?"function"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(this.defaults)?this.defaults():this.defaults:this.constraints,r={};for(var n in this.data)if(n in i){if(a&&a[n]){var s=a[n];if(s.model){r[n]=this.data[n]?this.data[n].flatten(t):null;continue}if(s.arrayof){r[n]=[];for(var c=0;c<this.data[n].length;c++)r[n][c]=this.data[n][c]?this.data[n][c].flatten(t):null;continue}if(s.cls){r[n]=this.data[n]?this.data[n].flatten():null;continue}}r[n]=this.data[n]}return r},remove:function(e,t){if("array"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e)){for(var a=0;a<e.length;a++)delete this.data[e[a]];!1===t||this._silent||this.dispatchEvent("propertyRemoved",{fields:e})}else delete this.data[e],!1===t||this._silent||this.dispatchEvent("propertyRemoved",{fields:[e]})},update:function(e,t){if(this._silent)return this;if(0==this._level&&(this.changedList=[]),this._level++,e&&"string"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e))this._propertyEvent(e,this.data[e],this.data[e],t);else if(e&&"array"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e))for(var a of e)this._propertyEvent(a,this.data[a],this.data[a],t);else for(var a in this.data)this._propertyEvent(a,this.data[a],this.data[a],t);return--this._level||this._silent||0==this.changedList.length&&!0!==e||this.dispatchEvent("modelChanged",{fields:this.changedList}),this},validate:function(e){if(!this.constraints)return this;if(e&&"string"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e))this._set(e,this.data[e]);else for(var t in this.data)e&&-1==$3ceb97a86c97e49f496755485fbe7a5f$export$default.indexOf(e,t)||this._set(t,this.data[t]);return this},isCompliant:function(){if(!this.constraints)return!0;try{for(var e in this.data)this._validate(e,this.data[e]);return!0}catch(e){}return!1},observe:function(e,t,a){this.addEventListener("propertyChanged."+e,t,a)},unobserve:function(e,t,a){this.removeEventListener("propertyChanged."+e,t,a)},watch:function(e,t){1==(e=e.split(":")).length&&(e[1]=e[0],e[0]="watch"),this.addEventListener(e[0]+":propertyChanged."+e[1],(function(e,a){t(a.value,a,e)}))},unwatch:function(e){1==(e=e.split(":")).length&&(e[1]=e[0],e[0]="watch"),this.removeEventListener(e[0]+":propertyChanged."+e[1])},toString:function(){return $3ceb97a86c97e49f496755485fbe7a5f$export$default.serialize(this.get(!0))}});$2f7ebfe35530a50778e04edf3edb1269$export$default.Constraints=$1af3bbb333f7838ae832df5e3332f3f3$exports.default;var $1b34262781301ee786b89a6f27f8ba34$export$default=$2f7ebfe35530a50778e04edf3edb1269$export$default.extend({className:"ModelList",itemt:$2f7ebfe35530a50778e04edf3edb1269$export$default,contents:null,itemId:null,nextId:null,defaults:{contents:null},constraints:{contents:{type:"array",arrayof:"@itemt"}},__ctor:function(...e){this.itemId=[],this.nextId=0,this._super.Model.__ctor(...e)},ready:function(){this._eventGroup="ModelList_"+Date.now()+":modelChanged",this.contents=this.data.contents},_bind:function(e,t){return t&&t.addEventListener&&t.addEventListener(this._eventGroup,this._onItemEvent,this,e),t},_unbind:function(e){return e&&e.removeEventListener&&e.removeEventListener(this._eventGroup),e},_onItemEvent:function(e,t,a){this.prepareEvent("itemChanged",{id:a,item:e.source}).from(e).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume()},length:function(){return this.data.contents.length},clear:function(){for(var e=0;e<this.data.contents;e++)this._unbind(this.data.contents[e]);this.itemId=[],this.nextId=0,this.contents=this.data.contents=[],this.prepareEvent("itemsCleared").enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume()},setData:function(e){if(this.clear(),e){for(var t=0;t<e.length;t++){var a=$3ceb97a86c97e49f496755485fbe7a5f$export$default.ensureTypeOf(this.itemt,e[t]);this.itemId.push(this.nextId++),this.data.contents.push(a),this._bind(this.nextId-1,a)}this.prepareEvent("itemsChanged").enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume()}},getData:function(){return this.data.contents},getAt:function(e){return e<0||e>=this.data.contents.length?null:this.data.contents[e]},removeAt:function(e){if(e<0||e>=this.data.contents.length)return null;let t=this.data.contents.splice(e,1)[0],a=this.itemId.splice(e,1)[0];return this._unbind(t),this.prepareEvent("itemRemoved",{id:a,item:t}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),t},setAt:function(e,t){return!(e<0||e>=this.data.contents.length)&&(t=$3ceb97a86c97e49f496755485fbe7a5f$export$default.ensureTypeOf(this.itemt,t),this._unbind(this.data.contents[e]),this.data.contents[e]=t,this._bind(this.itemId[e],t),this.prepareEvent("itemChanged",{id:this.itemId[e],item:t}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),!0)},updateAt:function(e){return!(e<0||e>=this.data.contents.length)&&(this.prepareEvent("itemChanged",{id:this.itemId[e],item:this.data.contents[e]}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),!0)},push:function(e){return e&&"object"!=$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e)?null:(e=$3ceb97a86c97e49f496755485fbe7a5f$export$default.ensureTypeOf(this.itemt,e),this.itemId.push(this.nextId++),this.data.contents.push(e),this._bind(this.nextId-1,e),this.prepareEvent("itemAdded",{id:this.itemId[this.itemId.length-1],item:e,position:"tail"}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),e)},pop:function(){return this._unbind(this.data.contents.pop())},unshift:function(e){return e&&"object"!=$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e)?null:(e=$3ceb97a86c97e49f496755485fbe7a5f$export$default.ensureTypeOf(this.itemt,e),this.itemId.unshift(this.nextId++),this.data.contents.unshift(e),this._bind(this.nextId-1,e),this.prepareEvent("itemAdded",{id:this.itemId[0],item:e,position:"head"}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),e)},shift:function(){return this._unbind(this.data.contents.shift())},find:function(e,t){for(var a=this.data.contents,i=0;i<a.length;i++)if($3ceb97a86c97e49f496755485fbe7a5f$export$default.partialCompare(a[i].data,e))return t?a[i]:i;return t?null:-1}});let $bfb70efaddca37b3e97c302907a1a3f5$export$default={Type:function(e){let t={flatten:function(e,t){return e},unflatten:function(e,t){return e}};return e?$3ceb97a86c97e49f496755485fbe7a5f$export$default.override(t,e):t},String:function(){return $bfb70efaddca37b3e97c302907a1a3f5$export$default.Type({flatten:function(e,t){return null!=e?e.toString():null},unflatten:function(e,t){return null!=e?e.toString():null}})},Integer:function(){return $bfb70efaddca37b3e97c302907a1a3f5$export$default.Type({flatten:function(e,t){return~~e},unflatten:function(e,t){return~~e}})},Number:function(e){return $bfb70efaddca37b3e97c302907a1a3f5$export$default.Type({_precision:e,_round:!1,precision:function(e){return this._precision=~~e,this},flatten:function(e,t){return e=parseFloat(e),this._precision>0&&(e=~~(e*Math.pow(10,this._precision))/Math.pow(10,this._precision)),e},unflatten:function(e,t){return parseFloat(e)}})},Bool:function(e){return $bfb70efaddca37b3e97c302907a1a3f5$export$default.Type({_compact:e,compact:function(e){return this._compact=e,this},flatten:function(e,t){return e=~~e,this._compact?e>0?1:0:e>0},unflatten:function(e,t){return!!~~e}})},SharedString:function(){return $bfb70efaddca37b3e97c302907a1a3f5$export$default.Type({flatten:function(e,t){return null==e?0:(e=e.toString(),"strings"in t||(t.strings_map={},t.strings=[]),e in t.strings_map||(t.strings.push(e),t.strings_map[e]=t.strings.length),t.strings_map[e])},unflatten:function(e,t){return null==e||0==e?null:t.strings[~~e-1]}})},Array:function(e){return $bfb70efaddca37b3e97c302907a1a3f5$export$default.Type({itemType:e,_debug:!1,debug:function(e){return this._debug=e,this},of:function(e){return this.itemType=e,this},flatten:function(e,t){if(null==e)return null;let a=[];for(let i=0;i<e.length;i++)a.push(this.itemType.flatten(e[i],t));return a},unflatten:async function(e,t){if(null==e)return null;let a=[];for(let i=0;i<e.length;i++)a.push(await this.itemType.unflatten(e[i],t));return a}})},Object:function(){return $bfb70efaddca37b3e97c302907a1a3f5$export$default.Type({properties:[],property:function(e,t,a=null){return this.properties.push({name:e,type:t,defvalue:a}),this},flatten:function(e,t){if(null==e)return null;let a;if(!0===t.symbolic){a={};for(let i=0;i<this.properties.length;i++)a[this.properties[i].name]=this.properties[i].type.flatten(e[this.properties[i].name],t)}else{a=[];for(let i=0;i<this.properties.length;i++)a.push(this.properties[i].type.flatten(e[this.properties[i].name],t))}return a},unflatten:async function(e,t){if(null==e)return null;let a={};if(!0===t.symbolic)for(let i=0;i<this.properties.length;i++)a[this.properties[i].name]=await this.properties[i].type.unflatten(this.properties[i].name in e?e[this.properties[i].name]:this.properties[i].defvalue,t);else for(let i=0;i<this.properties.length;i++)a[this.properties[i].name]=await this.properties[i].type.unflatten(i in e?e[i]:this.properties[i].defvalue,t);return a}})},Class:function(e){return $bfb70efaddca37b3e97c302907a1a3f5$export$default.Type({_constructor:e,constructor:function(e){return this._constructor=e,this},flatten:function(e,t){return null==e?null:e.flatten(t)},unflatten:async function(e,t){return null==e?null:await(new this._constructor).unflatten(e,t)}})},Property:function(e,t){return $bfb70efaddca37b3e97c302907a1a3f5$export$default.Type({property:e,type:t,name:function(e){return this.property=e,this},is:function(e){return this.type=e,this},flatten:function(e,t){if(null==e)return null;let a;return!0===t.symbolic?(a={},a[this.property]=this.type.flatten(e[this.property],t)):a=this.type.flatten(e[this.property],t),a},unflatten:async function(e,t){if(null==e)return null;let a={};return!0===t.symbolic?a[this.property]=await this.type.unflatten(e[this.property],t):a[this.property]=await this.type.unflatten(e,t),a}})},Map:function(){return $bfb70efaddca37b3e97c302907a1a3f5$export$default.Type({flatten:function(e,t){if(null==e)return null;if(!0===t.symbolic)return e;let a=[];for(let t in e)a.push(t),a.push(e[t]);return a},unflatten:function(e,t){if(null==e)return null;if(!0===t.symbolic)return e;let a={};for(let t=0;t<e.length;t+=2)a[e[t]]=e[t+1];return a}})}};var $c66cec705a74cd97c80e654695cbc7bf$export$default=$362774b94d49f24810750f9afdb3753f$export$default.extend({className:"Flattenable",typeSchema:null,flatten:function(e){return this.typeSchema.flatten(this,e)},unflatten:async function(e,t){return Object.assign(this,await this.typeSchema.unflatten(e,t)),await this.onUnflattened(),this},onUnflattened:async function(){}}),$7f499fb6ae525cccb42bc3703ca82ffc$export$default=$c66cec705a74cd97c80e654695cbc7bf$export$default.extend({className:"Collection",itemTypeSchema:null,items:null,__ctor:function(e){e||(e=this.itemTypeSchema),e&&(this.typeSchema=$bfb70efaddca37b3e97c302907a1a3f5$export$default.Property("items").is($bfb70efaddca37b3e97c302907a1a3f5$export$default.Array().of(e))),this.reset()},onUnflattened:function(){let e=this.items;this.reset();for(let t of e)this.add(t)},reset:function(){return this.items=[],this},clear:function(){var e=this.items;this.reset();for(var t=0;t<e.length;t++)this.onItemRemoved(e[t],0);return this},sort:function(e,t){return"function"!=typeof e?this.items.sort((function(a,i){return(a[e]<=i[e]?-1:1)*(!0===t?-1:1)})):this.items.sort(e),this},findItem:function(e,t){if(!this.items)return null;for(var a=0;a<this.items.length;a++)if((!t||!$3ceb97a86c97e49f496755485fbe7a5f$export$default.partialCompare(this.items[a],t))&&$3ceb97a86c97e49f496755485fbe7a5f$export$default.partialCompare(this.items[a],e))return this.items[a];return null},getItems:function(){return this.items},length:function(){return this.items.length},isEmpty:function(){return!this.items.length},indexOf:function(e){return this.items.indexOf(e)},getAt:function(e,t=!1){return e<0&&1==t&&(e+=this.items.length),e>=0&&e<this.items.length?this.items[e]:null},first:function(){return this.getAt(0)},last:function(){return this.getAt(-1,!0)},addAt:function(e,t){if(!t||!this.onBeforeItemAdded(t))return this;if(e<0&&(e=0),e>this.items.length&&(e=this.items.length),0==e)this.items.unshift(t);else if(e==this.items.length)this.items.push(t);else{var a=this.items.splice(0,e);a.push(t),this.items=a.concat(this.items)}return this.onItemAdded(t),this},unshift:function(e){return this.addAt(0,e)},push:function(e){return this.addAt(this.items.length,e)},add:function(e){return this.push(e)},removeAt:function(e,t=!1){if(e<0&&1==t&&(e+=this.items.length),e<0||e>=this.items.length)return null;var a=this.items[e];return this.items.splice(e,1),this.onItemRemoved(a,e),a},pop:function(e){return this.removeAt(-1,!0)},shift:function(e){return this.removeAt(0)},remove:function(e){return this.removeAt(this.indexOf(e))},forEach:function(e){if(this.isEmpty())return this;for(var t=0;t<this.items.length&&!1!==e(this.items[t],t,this);t++);return this},forEachCall:function(e,...t){if(this.isEmpty())return this;for(var a=0;a<this.items.length&&!1!==this.items[a][e](...t);a++);return this},forEachRev:function(e){if(this.isEmpty())return this;for(var t=this.items.length-1;t>=0&&!1!==e(this.items[t],t,this);t--);return this},forEachRevCall:function(e,...t){if(this.isEmpty())return this;for(var a=this.items.length-1;a>=0&&!1!==this.items[a][e](...t);a--);return this},onBeforeItemAdded:function(e){return!0},onItemAdded:function(e){},onItemRemoved:function(e){}});let $3c7e9e824106ff726f04cd7ecac64f05$export$default={strict:!1,parseTemplate:function(e,t,a,i=!1,r=1){let n="string",s=null,c=0,o=0,f="",l=[],d=l,u=!1;function h(e,i){if("template"==e?i=$3c7e9e824106ff726f04cd7ecac64f05$export$default.parseTemplate(i,t,a,!0,0):"parse"==e?(i=$3c7e9e824106ff726f04cd7ecac64f05$export$default.parseTemplate(i,t,a,!1,0),e="base-string","array"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(i)&&(e=i[0].type,i=i[0].data)):"parse-trim-merge"==e?i=$3c7e9e824106ff726f04cd7ecac64f05$export$default.parseTemplate(i.trim().split("\n").map((e=>e.trim())).join("\n"),t,a,!1,0):"parse-merge"==e?i=$3c7e9e824106ff726f04cd7ecac64f05$export$default.parseTemplate(i,t,a,!1,0):"parse-merge-alt"==e&&(i=$3c7e9e824106ff726f04cd7ecac64f05$export$default.parseTemplate(i,"{","}",!1,0)),"parse-merge"==e||"parse-merge-alt"==e||"parse-trim-merge"==e)for(let e=0;e<i.length;e++)l.push(i[e]);else l.push({type:e,data:i});u&&(d.push(l=[]),u=!1)}!0===i&&(e=e.trim(),n="identifier",c=10,d.push(l=[])),e+="\0";for(let i=0;i<e.length;i++)if("\\"!=e[i]){switch(c){case 0:"\0"==e[i]?s="string":e[i]==t&&"<"==e[i+1]?(c=1,o=1,s="string",n="parse-merge"):e[i]==t&&"@"==e[i+1]?(c=1,o=1,s="string",n="parse-trim-merge",i++):e[i]==t&&":"==e[i+1]?(c=12,o=1,s="string",n="string",i++):e[i]==t?(c=1,o=1,s="string",n="template"):f+=e[i];break;case 1:if("\0"==e[i])throw new Error("Parse error: Unexpected end of template");if(e[i]==a){if(o--,o<0)throw new Error("Parse error: Unmatched "+a);if(0==o){c=0,s=n;break}}else e[i]==t&&o++;f+=e[i];break;case 10:if("\0"==e[i]){s=n;break}if("."==e[i]){h(n,f),h("access","."),n="identifier",f="";break}if(null!=e[i].match(/[\t\n\r\f\v ]/)){for(s=n,n="identifier",u=!0;null!=e[i].match(/[\t\n\r\f\v ]/);)i++;i--;break}if(e[i]==t&&"<"==e[i+1]){f&&(s=n),c=11,o=1,n="parse-merge";break}if(e[i]==t&&"@"==e[i+1]){f&&(s=n),c=11,o=1,n="parse-trim-merge",i++;break}if('"'==e[i]){f&&(s=n),c=14,o=1,n="parse-merge";break}if("'"==e[i]){f&&(s=n),c=15,o=1,n="parse-merge";break}if("`"==e[i]){f&&(s=n),c=16,o=1,n="parse-merge-alt";break}if(e[i]==t&&":"==e[i+1]){f&&(s=n),c=13,o=1,n="string",i++;break}if(e[i]==t){f&&h(n,f),c=11,o=1,f="",n="parse",f+=e[i];break}"identifier"!=n&&(h(n,f),f="",n="identifier"),f+=e[i];break;case 11:if("\0"==e[i])throw new Error("Parse error: Unexpected end of template");if(e[i]==a){if(o--,o<0)throw new Error("Parse error: Unmatched "+a);if(0==o&&(c=10,"parse-merge"==n||"parse-merge-alt"==n||"parse-trim-merge"==n))break}else e[i]==t&&o++;f+=e[i];break;case 12:if("\0"==e[i])throw new Error("Parse error: Unexpected end of template");if(e[i]==a){if(o--,o<0)throw new Error("Parse error: Unmatched "+a);if(0==o){0!=f.length&&"<"!=f[0]&&"["!=f[0]&&" "!=f[0]&&(f=t+f+a),c=0,s=n;break}}else e[i]==t&&o++;f+=e[i];break;case 13:if("\0"==e[i])throw new Error("Parse error: Unexpected end of template");if(e[i]==a){if(o--,o<0)throw new Error("Parse error: Unmatched "+a);if(0==o){"<"!=f[0]&&"["!=f[0]&&" "!=f[0]&&(f=t+f+a),c=10;break}}else e[i]==t&&o++;f+=e[i];break;case 14:if("\0"==e[i])throw new Error("Parse error: Unexpected end of template");if('"'==e[i]){if(o--,o<0)throw new Error('Parse error: Unmatched "');if(0==o&&(c=10,"parse-merge"==n||"parse-merge-alt"==n||"parse-trim-merge"==n))break}f+=e[i];break;case 15:if("\0"==e[i])throw new Error("Parse error: Unexpected end of template");if("'"==e[i]){if(o--,o<0)throw new Error("Parse error: Unmatched '");if(0==o&&(c=10,"parse-merge"==n||"parse-merge-alt"==n||"parse-trim-merge"==n))break}f+=e[i];break;case 16:if("\0"==e[i])throw new Error("Parse error: Unexpected end of template");if("`"==e[i]){if(o--,o<0)throw new Error("Parse error: Unmatched `");if(0==o&&(c=10,"parse-merge"==n||"parse-merge-alt"==n||"parse-trim-merge"==n))break}f+=e[i]}s&&(h(s,f),s=f="")}else f+="\\",f+=e[++i];if(!i){let e=0;for(;e<d.length&&"string"==d[e].type&&""==d[e].data;)d.splice(e,1);for(e=d.length-1;e>0&&"string"==d[e].type&&""==d[e].data;)d.splice(e--,1);0==d.length&&d.push({type:"string",data:""})}return r&&function e(t){if("object"==typeof t){if(t instanceof Array)for(let a=0;a<t.length;a++)e(t[a]);else t.data=e(t.data);return t}for(let e=0;e<t.length;e++)if("\\"==t[e]){let a=t[e+1];switch(a){case"n":a="\n";break;case"r":a="\r";break;case"f":a="\f";break;case"v":a="\v";break;case"t":a="\t";break;case"s":a="s";break;case'"':a='"';break;case"'":a="'"}t=t.substr(0,e)+a+t.substr(e+2)}return t}(d),d},parse:function(e){return this.parseTemplate(e.trim(),"[","]",!1)},clean:function(e){for(let t=0;t<e.length;t++)"template"!=e[t].type&&(e.splice(t,1),t--);return e},expand:function(e,t,a="text",i="base-string"){let r=[];if("var"==i){let a=!0,i=!1,n=t,s=null,c=!0,o="";for(let r=0;r<e.length&&null!=t;r++)switch(e[r].type){case"identifier":case"string":o+=e[r].data,s=null;break;case"template":s=this.expand(e[r].data,n,"arg","template"),o+="object"!=typeof s?s:"";break;case"base-string":o+=this.expand(e[r].data,n,"arg","base-string"),s=null;break;case"access":if(s&&"object"==typeof s)t=s;else{for(""==o&&(o="this");;)if("!"==o[0])o=o.substr(1),a=!1;else{if("$"!=o[0])break;o=o.substr(1),i=!0}if("this"!=o&&null!=t){let e=t;null===(t=o in t?t[o]:null)&&c&&o in $3c7e9e824106ff726f04cd7ecac64f05$export$default.functions&&(t=$3c7e9e824106ff726f04cd7ecac64f05$export$default.functions[o](null,null,e)),c=!1}}o=""}for(;""!=o;)if("!"==o[0])o=o.substr(1),a=!1;else{if("$"!=o[0])break;o=o.substr(1),i=!0}if("this"!=o){let a=!1;if(null!=t?o in t?t=t[o]:(a=!0,t=null):a=!0,a&&1==e.length&&1==$3c7e9e824106ff726f04cd7ecac64f05$export$default.strict)throw new Error("Expression function `"+o+"` not found.")}"string"==typeof t&&(a&&(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),i&&(t='"'+t+'"')),r.push(t)}if("varref"==a){let a=t,i=null,r=!0,n="";for(let s=0;s<e.length&&null!=t;s++)switch(e[s].type){case"identifier":case"string":n+=e[s].data,i=null;break;case"template":i=this.expand(e[s].data,a,"arg","template"),n+="object"!=typeof i?i:"";break;case"base-string":n+=this.expand(e[s].data,a,"arg","base-string"),i=null;break;case"access":if(i&&"object"==typeof i)t=i;else{for(""==n&&(n="this");;)if("!"==n[0])n=n.substr(1);else{if("$"!=n[0])break;n=n.substr(1)}if("this"!=n&&null!=t){let e=t;null===(t=n in t?t[n]:null)&&r&&n in $3c7e9e824106ff726f04cd7ecac64f05$export$default.functions&&(t=$3c7e9e824106ff726f04cd7ecac64f05$export$default.functions[n](null,null,e)),r=!1}}n=""}for(;""!=n;)if("!"==n[0])n=n.substr(1);else{if("$"!=n[0])break;n=n.substr(1)}return"this"!=n?[t,n]:null}if("fn"==i){var n=[];if(n.push($3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[0],t,"text","base-string")),"_"+n[0]in $3c7e9e824106ff726f04cd7ecac64f05$export$default.functions&&(n[0]="_"+n[0]),!(n[0]in $3c7e9e824106ff726f04cd7ecac64f05$export$default.functions)){if(1==$3c7e9e824106ff726f04cd7ecac64f05$export$default.strict)throw new Error("Expression function `"+n[0]+"` not found.");return`(Unknown: ${n[0]})`}if("_"==n[0][0])return $3c7e9e824106ff726f04cd7ecac64f05$export$default.functions[n[0]](e,t);for(let a=1;a<e.length;a++)n.push($3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[a],t,"arg","base-string"));r.push($3c7e9e824106ff726f04cd7ecac64f05$export$default.functions[n[0]](n,e,t))}if("template"==i){if(1==e.length){if(1==e[0].length&&"string"==e[0][0].type)return e[0][0].data;if(1==e[0].length&&"identifier"==e[0][0].type){let i=e[0][0].data;if(i in $3c7e9e824106ff726f04cd7ecac64f05$export$default.functions||"_"+i in $3c7e9e824106ff726f04cd7ecac64f05$export$default.functions)return $3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e,t,a,"fn")}return $3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[0],t,a,"var")}return $3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e,t,a,"fn")}if("base-string"==i){let i=-1;for(let n of e){let s=null;switch(i++,n.type){case"template":s=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(n.data,t,a,"template");break;case"string":case"identifier":s=n.data;break;case"base-string":s=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(n.data,t,a,"base-string")}"void"!=a&&("last"==a&&i!=e.length-1||r.push(s))}}if("obj"==a)return r;if("last"==a)return"Rose\\Arry"==typeOf(r)&&(r=r[0]),r;if("void"==a)return null;if("arg"==a)return"array"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(r)?1!=r.length?r.join(""):r[0]:r;if("text"==a&&"array"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(r)){let e=t=>null!=t&&"object"==typeof t?"map"in t?t.map(e).join(""):"join"in t?t.join(""):t.toString():t;r=r.map(e).join("")}return r},compile:function(e){return e=$3c7e9e824106ff726f04cd7ecac64f05$export$default.parse(e),function(t=null,a="text"){return $3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e,t||{},a)}},eval:function(e,t=null,a="text"){return e=$3c7e9e824106ff726f04cd7ecac64f05$export$default.parse(e),$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e,t||{},a)},value:function(e,t=null){return"array"!=$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e)?e:$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e,t||{},"arg")},register:function(e,t){$3c7e9e824106ff726f04cd7ecac64f05$export$default.functions[e]=t},call:function(e,t,a=null){return e in $3c7e9e824106ff726f04cd7ecac64f05$export$default.functions?$3c7e9e824106ff726f04cd7ecac64f05$export$default.functions[e](t,null,a):null},getNamedValues:function(e,t,a=1,i=!0){let r={},n=0;for(;a<e.length;a+=2){let s=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[a],t,"arg");n||(n=s.startsWith(":")?1:s.endsWith(":")?2:3),1==n?s=s.substr(1):2==n&&(s=s.substr(0,s.length-1)),r[s]=i?$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[a+1],t,"arg"):e[a+1]}return r}};$3c7e9e824106ff726f04cd7ecac64f05$export$default.functions={global:function(e){return globalThis},null:function(e){return null},true:function(e){return!0},false:function(e){return!1},len:function(e){return e[1].toString().length},int:function(e){return~~e[1]},str:function(e){return e[1].toString()},float:function(e){return parseFloat(e[1])},chr:function(e){return String.fromCharCode(e[1])},ord:function(e){return e[1].toString().charCodeAt(0)},not:function(e){return!e[1]},neg:function(e){return-e[1]},abs:function(e){return Math.abs(e[1])},and:function(e){for(let t=1;t<e.length;t++)if(!e[t])return!1;return!0},or:function(e){for(let t=1;t<e.length;t++)if(~~e[t])return!0;return!1},eq:function(e){return e[1]==e[2]},ne:function(e){return e[1]!=e[2]},lt:function(e){return e[1]<e[2]},le:function(e){return e[1]<=e[2]},gt:function(e){return e[1]>e[2]},ge:function(e){return e[1]>=e[2]},isnotnull:function(e){return!!e[1]},isnull:function(e){return!e[1]},iszero:function(e){return 0==parseInt(e[1])},"eq?":function(e){return e[1]==e[2]},"ne?":function(e){return e[1]!=e[2]},"lt?":function(e){return e[1]<e[2]},"le?":function(e){return e[1]<=e[2]},"gt?":function(e){return e[1]>e[2]},"ge?":function(e){return e[1]>=e[2]},"notnull?":function(e){return!!e[1]},"null?":function(e){return!e[1]},"zero?":function(e){return 0==parseInt(e[1])},typeof:function(e){return $3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e[1])},"*":function(e){let t=e[1];for(let a=2;a<e.length;a++)t*=e[a];return t},"/":function(e){let t=e[1];for(let a=2;a<e.length;a++)t/=e[a];return t},"+":function(e){let t=e[1];for(let a=2;a<e.length;a++)t-=-e[a];return t},"-":function(e){let t=e[1];for(let a=2;a<e.length;a++)t-=e[a];return t},mul:function(e){let t=e[1];for(let a=2;a<e.length;a++)t*=e[a];return t},div:function(e){let t=e[1];for(let a=2;a<e.length;a++)t/=e[a];return t},sum:function(e){let t=e[1];for(let a=2;a<e.length;a++)t-=-e[a];return t},sub:function(e){let t=e[1];for(let a=2;a<e.length;a++)t-=e[a];return t},mod:function(e){let t=e[1];for(let a=2;a<e.length;a++)t%=e[a];return t},pow:function(e){let t=e[1];for(let a=2;a<e.length;a++)t=Math.pow(t,e[a]);return t},dump:function(e){return JSON.stringify(e[1])},_set:function(e,t){for(let a=1;a+1<e.length;a+=2){let i=$3c7e9e824106ff726f04cd7ecac64f05$export$default.value(e[a+1],t);if(e[a].length>1){let r=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[a],t,"varref");null!=r&&(r[0][r[1]]=i)}else t[$3c7e9e824106ff726f04cd7ecac64f05$export$default.value(e[a],t)]=i}return""},_unset:function(e,t){for(let a=1;a<e.length;a++)if(e[a].length>1){let i=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[a],t,"varref");null!=i&&delete i[0][i[1]]}else delete t[$3c7e9e824106ff726f04cd7ecac64f05$export$default.value(e[a],t)];return null},trim:function(e){return e[1]?"object"==typeof e[1]?e[1].map((e=>e.trim())):e[1].trim():""},upper:function(e){return e[1]?"object"==typeof e[1]?e[1].map((e=>e.toUpperCase())):e[1].toUpperCase():""},lower:function(e){return e[1]?"object"==typeof e[1]?e[1].map((e=>e.toLowerCase())):e[1].toLowerCase():""},substr:function(e){let t=e[e.length-1].toString(),a=0,i=null;return 4==e.length?(a=~~e[1],i=~~e[2]):(a=~~e[1],i=null),a<0&&(a+=t.length),i<0&&(i+=t.length),null===i&&(i=t.length-a),t.substr(a,i)},replace:function(e){return e[3].split(e[1]).join(e[2])},nl2br:function(e){return e[1]?"object"==typeof e[1]?e[1].map((e=>e.replace(/\n/g,"<br/>"))):e[1].replace(/\n/g,"<br/>"):""},"%":function(e){e.shift();var t=e.shift();let a="";for(let i=0;i<e.length;i++)if("array"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e[i])){a+=`<${t}>`;for(let t=0;t<e[i].length;t++)a+=e[i][t];a+=`</${t}>`}else a+=`<${t}>${e[i]}</${t}>`;return a},"%%":function(e){e.shift();var t=e.shift();let a="",i="";for(let t=0;t<e.length;t+=2)t+1<e.length?a+=` ${e[t]}="${e[t+1]}"`:i=e[t];return i?`<${t}${a}>${i}</${t}>`:`<${t}${a}/>`},join:function(e){return e[2]&&"array"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(e[2])?e[2].join(e[1]):""},split:function(e){return e[2]&&"string"==typeof e[2]?e[2].split(e[1]):[]},keys:function(e){return e[1]&&"object"==typeof e[1]?Object.keys(e[1]):[]},values:function(e){return e[1]&&"object"==typeof e[1]?Object.values(e[1]):[]},_each:function(e,t){let a=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[1],t,"arg"),i=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[2],t,"arg"),r="",n=0;if(!i)return r;for(let s in i)t[a]=i[s],t[a+"##"]=n++,t[a+"#"]=s,r+=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[3],t,"text");return delete t[a],delete t[a+"##"],delete t[a+"#"],r},_foreach:function(e,t){let a=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[1],t,"arg"),i=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[2],t,"arg"),r=0;if(!i)return null;for(let n in i)t[a]=i[n],t[a+"##"]=r++,t[a+"#"]=n,$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[3],t,"text");return delete t[a],delete t[a+"##"],delete t[a+"#"],null},"_?":function(e,t){return $3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[1],t,"arg")?$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[2],t,"arg"):e.length>3?$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[3],t,"arg"):""},"_??":function(e,t){let a=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[1],t,"arg");return a||$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[2],t,"arg")},_if:function(e,t){for(let a=0;a<e.length;a+=3){if("else"==$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[a],t,"arg"))return $3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[a+1],t,"text");if($3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[a+1],t,"arg"))return $3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[a+2],t,"text")}return""},_switch:function(e,t){let a=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[1],t,"arg");for(let i=2;i<e.length;i+=2){let r=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[i],t,"arg");if(r==a||"default"==r)return $3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[i+1],t,"text")}return""},_break:function(e,t){throw new Error("EXC_BREAK")},_continue:function(e,t){throw new Error("EXC_CONTINUE")},_repeat:function(e,t){if(e.length<3||1!=(1&e.length))return"(`repeat`: Wrong number of parameters)";let a=$3c7e9e824106ff726f04cd7ecac64f05$export$default.value(e[1],t),i=null,r=0,n=null,s=null;for(let a=2;a<e.length-1;a+=2){switch($3c7e9e824106ff726f04cd7ecac64f05$export$default.value(e[a],t).toLowerCase()){case"from":r=parseFloat($3c7e9e824106ff726f04cd7ecac64f05$export$default.value(e[a+1],t));break;case"to":n=parseFloat($3c7e9e824106ff726f04cd7ecac64f05$export$default.value(e[a+1],t));break;case"count":i=parseFloat($3c7e9e824106ff726f04cd7ecac64f05$export$default.value(e[a+1],t));break;case"step":s=parseFloat($3c7e9e824106ff726f04cd7ecac64f05$export$default.value(e[a+1],t))}}let c=e[e.length-1],o=[];if(null!==n)if(null===s&&(s=r>n?-1:1),s<0)for(let e=r;e>=n;e+=s)try{t[a]=e,o.push($3c7e9e824106ff726f04cd7ecac64f05$export$default.value(c,t))}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}else for(let e=r;e<=n;e+=s)try{t[a]=e,o.push($3c7e9e824106ff726f04cd7ecac64f05$export$default.value(c,t))}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}else if(null!==i){null===s&&(s=1);for(let e=r;i>0;i--,e+=s)try{t[a]=e,o.push($3c7e9e824106ff726f04cd7ecac64f05$export$default.value(c,t))}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}}else{null===s&&(s=1);for(let e=r;;e+=s)try{t[a]=e,o.push($3c7e9e824106ff726f04cd7ecac64f05$export$default.value(c,t))}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}}return delete t[a],o},_for:function(e,t){if(e.length<3||1!=(1&e.length))return"(`for`: Wrong number of parameters)";let a=$3c7e9e824106ff726f04cd7ecac64f05$export$default.value(e[1],t),i=null,r=0;to=null;let n=null;for(let a=2;a<e.length-1;a+=2)switch(value=$3c7e9e824106ff726f04cd7ecac64f05$export$default.value(e[a],t),value.toLowerCase()){case"from":r=parseFloat($3c7e9e824106ff726f04cd7ecac64f05$export$default.value(e[a+1],t));break;case"to":to=parseFloat($3c7e9e824106ff726f04cd7ecac64f05$export$default.value(e[a+1],t));break;case"count":i=parseFloat($3c7e9e824106ff726f04cd7ecac64f05$export$default.value(e[a+1],t));break;case"step":n=parseFloat($3c7e9e824106ff726f04cd7ecac64f05$export$default.value(e[a+1],t))}let s=e[e.length-1];if(null!==to)if(null===n&&(n=r>to?-1:1),n<0)for(let e=r;e>=to;e+=n)try{t[a]=e,$3c7e9e824106ff726f04cd7ecac64f05$export$default.value(s,t)}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}else for(let e=r;e<=to;e+=n)try{t[a]=e,$3c7e9e824106ff726f04cd7ecac64f05$export$default.value(s,t)}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}else if(null!==i){null===n&&(n=1);for(let e=r;i>0;i--,e+=n)try{t[a]=e,$3c7e9e824106ff726f04cd7ecac64f05$export$default.value(s,t)}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}}else{null===n&&(n=1);for(let e=r;;e+=n)try{t[a]=e,$3c7e9e824106ff726f04cd7ecac64f05$export$default.value(s,t)}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}}return delete t[a],null},_loop:function(e,t){if(e.length<2)return"(`loop`: Wrong number of parameters)";let a=e[1];for(;;)try{$3c7e9e824106ff726f04cd7ecac64f05$export$default.value(a,t)}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}return null},_echo:function(e,t){let a="";for(let i=1;i<e.length;i++)a+=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[i],t,"arg");return console.log(a),""},"_#":function(e,t){let a=[];for(let i=1;i<e.length;i++)a.push($3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[i],t,"arg"));return a},"_##":function(e,t){let a=[];for(let t=1;t<e.length;t++)a.push(e[t]);return a},"_&":function(e,t){return $3c7e9e824106ff726f04cd7ecac64f05$export$default.getNamedValues(e,t,1,!0)},"_&&":function(e,t){return $3c7e9e824106ff726f04cd7ecac64f05$export$default.getNamedValues(e,t,1,!1)},contains:function(e,t,a){let i=e[1];if("object"!=typeof i)return a.err="Argument is not a Map",!1;let r="";for(let t=2;t<e.length;t++)e[t]in i||(r+=", "+e[t]);return""==r||(a.err=r.substr(1),!1)},has:function(e,t,a){let i=e[2];return"object"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(i)&&e[1]in i},_map:function(e,t){let a=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[1],t,"arg"),i=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[2],t,"arg");if(!i)return i;let r="array"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(i),n=r?[]:{},s=0;for(let c in i)t[a]=i[c],t[a+"##"]=s++,t[a+"#"]=c,r?n.push($3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[3],t,"arg")):n[c]=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[3],t,"arg");return delete t[a],delete t[a+"##"],delete t[a+"#"],n},_filter:function(e,t){let a=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[1],t,"arg"),i=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[2],t,"arg");if(!i)return i;let r="array"==$3ceb97a86c97e49f496755485fbe7a5f$export$default.typeOf(i),n=r?[]:{},s=0;for(let c in i)t[a]=i[c],t[a+"##"]=s++,t[a+"#"]=c,~~$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[3],t,"arg")&&(r?n.push(i[c]):n[c]=i[c]);return delete t[a],delete t[a+"##"],delete t[a+"#"],n},expand:function(e,t,a){return $3c7e9e824106ff726f04cd7ecac64f05$export$default.expand($3c7e9e824106ff726f04cd7ecac64f05$export$default.parseTemplate(e[1],"{","}"),3==e.length?e[2]:a)},_call:function(e,t){let a=$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[1],t,"varref");if(!a||"function"!=typeof a[0][a[1]])throw new Error("Expression is not a function: "+$3c7e9e824106ff726f04cd7ecac64f05$export$default.expand(e[1],t,"obj").map((e=>null==e?".":e)).join(""));let i=[];for(let a=2;a<e.length;a++)i.push($3c7e9e824106ff726f04cd7ecac64f05$export$default.value(e[a],t));return a[0][a[1]](...i)}};const $49a0a27d43075b98f896056be628f99a$export$Rin=$3ceb97a86c97e49f496755485fbe7a5f$export$default,$49a0a27d43075b98f896056be628f99a$export$Class=$362774b94d49f24810750f9afdb3753f$export$default,$883e395d0b2123d7f53561ada8782bc4$var$rol16=function(e,t){return 65535&(e<<t|e>>>16-t&(1<<t)-1)},$883e395d0b2123d7f53561ada8782bc4$var$ror16=function(e,t){return 65535&(e>>>t|(e&(1<<t)-1)<<16-t)},$883e395d0b2123d7f53561ada8782bc4$var$add16=function(e,t){return e+t&65535},$883e395d0b2123d7f53561ada8782bc4$var$sub16=function(e,t){return e-t&65535},$883e395d0b2123d7f53561ada8782bc4$var$xor16=function(e,t){return 65535&(e^t)},$883e395d0b2123d7f53561ada8782bc4$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({seed:0,a:0,b:0,last:0,__ctor:function(e=3672614355){this.setSeed(e)},setSeed:function(e){return this.seed=e,this.a=e>>16&65535,this.b=e>>0&65535,this.last=this.a>>4&255|this.b<<4&65280,this},nextInt16:function(){let e=this.last;return e=$883e395d0b2123d7f53561ada8782bc4$var$add16(e,this.a),e=$883e395d0b2123d7f53561ada8782bc4$var$xor16(e,5397),this.a=$883e395d0b2123d7f53561ada8782bc4$var$xor16(this.a,20897),this.a=$883e395d0b2123d7f53561ada8782bc4$var$sub16(this.a,this.b),this.b=$883e395d0b2123d7f53561ada8782bc4$var$xor16(this.b,6677),e=$883e395d0b2123d7f53561ada8782bc4$var$rol16(e,15&this.b),65535&(this.last=e)},nextInt8:function(){return 255&this.nextInt16()},nextFloat:function(){return this.nextInt16()/65535}}),$c5794ced0840f4a2f23c1c50dcedc59f$export$default={gl:null,time:0,viewport:null,debugBounds:!1,rand0:new $883e395d0b2123d7f53561ada8782bc4$export$default,rand1:new $883e395d0b2123d7f53561ada8782bc4$export$default,rand2:new $883e395d0b2123d7f53561ada8782bc4$export$default};$parcel$global.px=function(e){return e*C.SCALE},$parcel$global.dispose=function(e){if(e)return"free"in e?e.free():"dispose"in e?e.dispose():void("__dtor"in e&&e.__dtor())},$parcel$global.audioContext="AudioContext"in $parcel$global?new AudioContext:null,$parcel$global.fetchd=function(e,t){return new Promise(((a,i)=>{t||(t={}),"responseType"in t||(t.responseType="arraybuffer");var r=new XMLHttpRequest;r.open("GET",e,!0);for(let e in t)r[e]=t[e];r.onload=function(){a(r.response)},r.onerror=function(){i("Unable to fetch specified resource.")},r.send()}))},$parcel$global.fetchAudioBuffer=function(e){return new Promise(((t,a)=>{$parcel$global.audioContext?fetchd(e).then((e=>audioContext.decodeAudioData(e))).then((e=>t(e))).catch((e=>a(e))):a("AudioContext is not available.")}))},$parcel$global.int=function(e){return e>>0},$parcel$global.bool=function(e){return!0===e||!1===e?e:"true"==e||"false"!=e&&!!e},$parcel$global.float=function(e){return parseFloat(e)},$parcel$global.float2=function(e){return int(100*e)/100},$parcel$global.float3=function(e){return int(1e3*e)/1e3},$parcel$global.float4=function(e){return int(1e4*e)/1e4},$parcel$global.rad=function(e){return e*Math.PI/180},$parcel$global.deg=function(e){return e/Math.PI*180},$parcel$global.rand=function(){return $c5794ced0840f4a2f23c1c50dcedc59f$export$default.rand0.nextInt16()},$parcel$global.randf=function(){return $c5794ced0840f4a2f23c1c50dcedc59f$export$default.rand0.nextFloat()},$parcel$global.randrf=function(e,t){let a=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.rand0.nextFloat();return a*t+(1-a)*e},$parcel$global.randr=function(e,t){let a=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.rand0.nextFloat();return Math.round(a*t+(1-a)*e)},$parcel$global.randtf=function(e,t,a){for(var i=[],r=0;r<a;r++)i.push(randrf(e,t));return i},$parcel$global.hrnow=function(){return performance.now()},$parcel$global.randvar=function(e,t){return function(){return randr(e,t)}},$parcel$global.randitem=function(e,t,a){return t||(t=0),a||(a=e.length-1),function(){return e[randr(t,a)]}},$parcel$global.getLineSegmentIntersection=function(e,t,a,i,r,n,s,c){if(e==r&&t==n&&a==s&&i==c)return 0;var o=i-t,f=a-e,l=c-n,d=s-r;if(0==o&&0==l){if(t!=n)return 2;var u=Math.max(e,r);return u>Math.min(a,s)?2:(u-e)/f}if(0==f&&0==d){if(e!=r)return 2;var h=Math.max(t,n);return h>Math.min(i,c)?2:(h-t)/o}if(0==f)return 0>(p=(l*(e-r)+d*(n-t))/(d*o))||p>1||0>($=(e-r)/d)||$>1?2:p;var $,p,b=l*f-d*o;return 0==b||0>($=(o*(r-e)+f*(t-n))/b)||$>1||0>(p=(d*$+r-e)/f)||p>1?2:p},$parcel$global.lineSegmentIntersects=function(e,t,a,i,r,n,s,c){let o=getLineSegmentIntersection(e,t,a,i,r,n,s,c);return o>=0&&o<=1},$parcel$global.rotatePoint=function(e,t,a){return"object"==Rin.typeOf(e)?{x:t*e.x+a*e.y,y:a*e.x-t*e.y}:{x:t*Math.cos(e)+a*Math.sin(e),y:a*Math.cos(e)-t*Math.sin(e)}},$parcel$global.stepValue=function(e,t,a,i){return Math.round(i*(e-t)/(a-t))/i*(a-t)+t},$parcel$global.alignValue=function(e,t){return Math.round(e/t)*t},$parcel$global.FIXED_POINT_BITS=8,$parcel$global.upscale=function(e){return e*(1<<FIXED_POINT_BITS)>>0},$parcel$global.downscale=function(e){return e>>FIXED_POINT_BITS},$parcel$global.downscalef=function(e){return e/(1<<FIXED_POINT_BITS)},$parcel$global.falign=function(e){return downscalef(upscale(e))};var $ecb27258662111bab70dd084a4f71ebf$export$default={BACKSPACE:8,TAB:9,ENTER:13,ESC:27,SPACE:32,PGUP:33,PGDN:34,END:35,HOME:36,INS:45,DEL:46,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUM_PLUS:107,NUM_MINUS:109,NUM_ASTERISK:106,NUM_SLASH:111,NUM_DOT:110,NUM_0:96,NUM_1:97,NUM_2:98,NUM_3:99,NUM_4:100,NUM_5:101,NUM_6:102,NUM_7:103,NUM_8:104,NUM_9:105,D0:48,D1:49,D2:50,D3:51,D4:52,D5:53,D6:54,D7:55,D8:56,D9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90};const $ccdbbc32fd9f0a412799511487cd91a1$var$recyclingFacilities={},$ccdbbc32fd9f0a412799511487cd91a1$export$default={};let $ccdbbc32fd9f0a412799511487cd91a1$var$constructorAllowed=0;$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo=function(e,t=8192,a=1536){if(!e.prototype.className)throw new Error("Unable to attach recycler functions to unnamed class.");if(!("__dtor"in e.prototype))throw new Error("Recycler: Class "+e.prototype.className+" requires `__dtor` method.");if(!("init"in e.prototype))throw new Error("Recycler: Class "+e.prototype.className+" requires `init` method.");$ccdbbc32fd9f0a412799511487cd91a1$var$recyclingFacilities[e.prototype.className]=e,e.recyclerPool=[],e.recyclerPoolMax=t,e.prototype.objectId=0,e.recyclerNextObjectId=0,e.recyclerCreated=0,e.recyclerRecycled=0,e.recyclerMissed=0,e.recyclerLength=0,e.recyclerActive=0;for(let t=0;t<a;t++)e.recyclerPool.push(new e),e.recyclerLength++;const i=e.prototype.__ctor;e.prototype.__ctor=function(){if(!$ccdbbc32fd9f0a412799511487cd91a1$var$constructorAllowed)throw new Error("Recycler: Constructor blocked for class "+e.prototype.className+", use alloc() instead.");i.call(this)},e.alloc=function(){let t;return this.recyclerLength?(t=this.recyclerPool[--this.recyclerLength],e.recyclerRecycled++):($ccdbbc32fd9f0a412799511487cd91a1$var$constructorAllowed++,t=new e,$ccdbbc32fd9f0a412799511487cd91a1$var$constructorAllowed--,e.recyclerCreated++),e.recyclerActive++,t.objectId=++this.recyclerNextObjectId,this.recyclerNextObjectId&=2147483647,t},e.calloc=function(){return e.alloc().init()},e.free=function(e){return e?e.free():e},e.prototype.free=function(){return 0==this.objectId?(console.error("Already freed ("+e.prototype.className+")"),this):(this.__dtor(),this.objectId=0,e.recyclerLength>=t?e.recyclerMissed++:e.recyclerPool[e.recyclerLength++]=this,e.recyclerActive--,this)}},$ccdbbc32fd9f0a412799511487cd91a1$export$default.showStats=function(e=null){let t=$ccdbbc32fd9f0a412799511487cd91a1$var$recyclingFacilities;if(!0!==e){if(null!==e){if("string"==typeof e){let t=$ccdbbc32fd9f0a412799511487cd91a1$var$recyclingFacilities[e];return void console.debug(e+": "+(t.recyclerCreated/t.recyclerPoolMax*100).toFixed(1)+"%  =>  overhead="+t.recyclerCreated+", active="+t.recyclerActive+", capacity="+t.recyclerPool.length+", recycled="+t.recyclerRecycled+", in-recycler="+t.recyclerLength+", missed="+t.recyclerMissed+", space="+(t.recyclerPoolMax-t.recyclerLength))}t=e}console.group("Recycling Facilities");for(let e in t){let a=t[e];console.debug(e+": "+(a.recyclerCreated/a.recyclerPoolMax*100).toFixed(1)+"%  =>  overhead="+a.recyclerCreated+", active="+a.recyclerActive+", capacity="+a.recyclerPool.length+", recycled="+a.recyclerRecycled+", in-recycler="+a.recyclerLength+", missed="+a.recyclerMissed+", space="+(a.recyclerPoolMax-a.recyclerLength))}console.groupEnd()}else{console.group("Recycling Facilities");for(let e in t){let a=t[e];a.recyclerCreated&&console.debug(e+": "+(a.recyclerCreated/a.recyclerPoolMax*100).toFixed(1)+"%  =>  overhead="+a.recyclerCreated+", active="+a.recyclerActive+", capacity="+a.recyclerPool.length+", recycled="+a.recyclerRecycled+", in-recycler="+a.recyclerLength+", missed="+a.recyclerMissed+", space="+(a.recyclerPoolMax-a.recyclerLength))}console.groupEnd()}};const $8581dd2a4034ebdbe37300f3afba0093$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Linkable",prev:null,next:null,value:null,init:function(e){return this.value=e,this.clear(),this},__dtor:function(){this.unlink()},clear:function(){return this.next=this.prev=null,this},linkAfter:function(e){this.prev=e,this.next=e?e.next:null,e&&(e.next&&(e.next.prev=this),e.next=this)},linkBefore:function(e){this.prev=e?e.prev:null,this.next=e,e&&(e.prev&&(e.prev.next=this),e.prev=this)},unlink:function(){return this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.clear()}});$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($8581dd2a4034ebdbe37300f3afba0093$export$default,16384,6144);const $9331e791bdadeac9afb7e80808da523d$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"List",top:null,bottom:null,length:0,init:function(){return this.top=null,this.bottom=null,this.length=0,this},__dtor:function(){this.reset()},clone:function(){let e=$9331e791bdadeac9afb7e80808da523d$export$default.calloc();for(let t=this.top;t;t=t.next)e.push($49a0a27d43075b98f896056be628f99a$export$Rin.clone(t.value));return e},clear:function(){let e,t;for(e=this.top;null!=e;e=t)t=e.next,dispose(e.free().value);return this.top=this.bottom=null,this.length=0,this},reset:function(){let e,t;for(e=this.top;null!=e;e=t)t=e.next,e.free();return this.top=this.bottom=null,this.length=0,this},first:function(){return null!==this.top?this.top.value:null},last:function(){return null!==this.bottom?this.bottom.value:null},getAt:function(e){let t=null;for(t=this.top;t&&e--;t=t.next);return null!=t?t.value:null},getNodeAt:function(e){let t=null;for(t=this.top;t&&e--;t=t.next);return t},sgetNode:function(e){for(let t=this.top;t;t=t.next)if(t.value===e)return t;return null},remove:function(e){return null==e||"isInstanceOf"in e&&e.isInstanceOf($8581dd2a4034ebdbe37300f3afba0093$export$default)||(e=this.sgetNode(e)),e?(e.prev||(this.top=e.next),e.next||(this.bottom=e.prev),this.length--,e.free().value):null},insertBefore:function(e,t){if(!e)return this;let a=$8581dd2a4034ebdbe37300f3afba0093$export$default.alloc().init(t);return a.linkBefore(e),e==this.top&&(this.top=a),this.length++,t},insertAfter:function(e,t){if(!e)return this;let a=$8581dd2a4034ebdbe37300f3afba0093$export$default.alloc().init(t);return a.linkAfter(e),e==this.bottom&&(this.bottom=a),this.length++,t},unshift:function(e){let t=$8581dd2a4034ebdbe37300f3afba0093$export$default.alloc().init(e);return t.linkBefore(this.top),this.bottom||(this.bottom=t),this.top=t,this.length++,e},shift:function(){let e=this.top;return e?((this.top=e.next)||(this.bottom=null),this.length--,e.free().value):null},push:function(e){let t=$8581dd2a4034ebdbe37300f3afba0093$export$default.alloc().init(e);return t.linkAfter(this.bottom),this.top||(this.top=t),this.bottom=t,this.length++,e},pop:function(){let e=this.bottom;return e?((this.bottom=e.prev)||(this.top=null),this.length--,e.free().value):null},append:function(e){for(let t=e.top;t;t=t.next)this.push(t.value);return this},forEach:function(e,t=null){let a;for(let i=this.top;i;i=a)if(a=i.next,!1===e(i.value,i,this,t))return!1;return!0},forEachRev:function(e,t=null){let a;for(let i=this.bottom;i;i=a)if(a=i.prev,!1===e(i.value,i,this,t))return!1;return!0},find:function(e,t=null){for(let a=this.top;a;a=a.next)if(e(a.value,t))return a.value;return null},filter:function(e,t=null){let a=$9331e791bdadeac9afb7e80808da523d$export$default.calloc();for(let i=this.top;i;i=i.next)e(i.value,t)&&a.push(i.value);return a},toArray:function(){let e=[];for(let t=this.top;t;t=t.next)e.push(t.value);return e}});$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($9331e791bdadeac9afb7e80808da523d$export$default,16384,6144);const $b82d452f2e3484b177bea709fd7b4383$export$default=function(e,t,a){this.callback=a,this.interval=t,this.vsync=e,this.isRunning=!1,this.startTime=0,this.rTime=0,this.sTime=0,this.lTime=0,this.tDelta=0,this._onTimeout=()=>{this.onTimeout()},this._onTimeout_b=()=>{this.runNow()}};$b82d452f2e3484b177bea709fd7b4383$export$default.prototype.onTimeout=function(){if(!this.isRunning)return;this.rTime=hrnow()-this.startTime;let e=this.rTime-(this.sTime+this.interval);e<0?this.runAfter(-e):(this.sTime+=this.interval*(1+int(e/this.interval)),this.tDelta=e<0?this.interval:this.rTime-this.lTime,this.lTime=this.rTime,this.runAfter(this.sTime+this.interval-(hrnow()-this.startTime)),this.callback(this.tDelta,this))},$b82d452f2e3484b177bea709fd7b4383$export$default.prototype.onStart=function(){},$b82d452f2e3484b177bea709fd7b4383$export$default.prototype.start=function(e=!1,t=1){this.startTime=hrnow(),this.isRunning=!0,this.sTime=0,this.lTime=0,this.onStart(),e&&this.callback(0,this),this.runAfter(this.interval*t)},$b82d452f2e3484b177bea709fd7b4383$export$default.prototype.runAfter=function(e){this.vsync?requestAnimationFrame(this._onTimeout_b):setTimeout(this._onTimeout,0)},$b82d452f2e3484b177bea709fd7b4383$export$default.prototype.runNow=function(){setTimeout(this._onTimeout,0)},$b82d452f2e3484b177bea709fd7b4383$export$default.prototype.stop=function(){this.isRunning=!1};const $fe31f04e32686e924bb665d33d1abcbf$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Vec2",x:0,y:0,init:function(e=null,t=null){return this.set(e,t)},clone:function(){return $fe31f04e32686e924bb665d33d1abcbf$export$default.alloc().init(this)},set:function(e,t=null){if(null===e)e=0,t=0;else if(null===t){let a=e;e=a.x,t=a.y}return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},zero:function(){return this.set(0,0)},isZero:function(){return 0==this.x&&0==this.y},equals:function(e,t=null){if(null===t){let a=e;e=a.x,t=a.y}return this.x==e&&this.y==t},neg:function(){return this.x=-this.x,this.y=-this.y,this},inv:function(){return this.x=1/this.x,this.y=1/this.y,this},abs:function(){return this.x=this.x<0?-this.x:this.x,this.y=this.y<0?-this.y:this.y,this},translate:function(e,t=null){if(null===t){let a=e;e=a.x,t=a.y}return this.x+=e,this.y+=t,this},add:function(e,t=null){if(null===t){let a=e;e=a.x,t=a.y}return this.x+=e,this.y+=t,this},sub:function(e,t){if(null===t){let a=e;e=a.x,t=a.y}return this.x-=e,this.y-=t,this},scale:function(e,t=null){if(null===t)if($fe31f04e32686e924bb665d33d1abcbf$export$default.isInstance(e)){let a=e;e=a.x,t=a.y}else t=e;return this.x*=e,this.y*=t,this},floor:function(){return this.x=int(this.x),this.y=int(this.y),this},fract:function(){return this.x=this.x-int(this.x),this.y=this.y-int(this.y),this},dot:function(e,t=null){if(null===t){let a=e;e=a.x,t=a.y}return this.x*e+this.y*t},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.isZero()?this:this.scale(1/this.magnitude())},majorAxis:function(){return Math.abs(this.x)>Math.abs(this.y)?this.y=0:this.x=0,this},minorAxis:function(){return Math.abs(this.x)<Math.abs(this.y)?this.y=0:this.x=0,this},sign:function(){return this.x=this.x?this.x<0?-1:1:0,this.y=this.y?this.y<0?-1:1:0,this},toString:function(){return`(${this.x}, ${this.y})`}});$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($fe31f04e32686e924bb665d33d1abcbf$export$default,4096,2048);const $3e5498a08e31fe3580cca1707752773a$var$temp=new Float32Array(9).fill(0),$3e5498a08e31fe3580cca1707752773a$var$temp2=new Float32Array(9).fill(0),$3e5498a08e31fe3580cca1707752773a$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Matrix",__ctor:function(){this.data=new Float32Array(9)},init:function(e=null){return null!==e?this.set(e):this.identity(),this},zero:function(){return this.data.fill(0),this},fill:function(e){return this.data.fill(e),this},set:function(e){if($3e5498a08e31fe3580cca1707752773a$export$default.isInstance(e))for(let t=0;t<9;t++)this.data[t]=e.data[t];else for(let t=0;t<9;t++)this.data[t]=e[t];return this},identity:function(e=null){return null===e&&(e=this.data),e.fill(0),e[0]=e[4]=e[8]=1,this},scalef:function(e){for(let t=0;t<9;t++)this.data[t]*=e;return this},clone:function(){return $3e5498a08e31fe3580cca1707752773a$export$default.alloc().init(this)},append:function(e){e instanceof $3e5498a08e31fe3580cca1707752773a$export$default&&(e=e.data);for(let e=0;e<9;e++)$3e5498a08e31fe3580cca1707752773a$var$temp[e]=this.data[e];return this.data[0]=e[0]*$3e5498a08e31fe3580cca1707752773a$var$temp[0]+e[1]*$3e5498a08e31fe3580cca1707752773a$var$temp[3]+e[2]*$3e5498a08e31fe3580cca1707752773a$var$temp[6],this.data[1]=e[0]*$3e5498a08e31fe3580cca1707752773a$var$temp[1]+e[1]*$3e5498a08e31fe3580cca1707752773a$var$temp[4]+e[2]*$3e5498a08e31fe3580cca1707752773a$var$temp[7],this.data[2]=e[0]*$3e5498a08e31fe3580cca1707752773a$var$temp[2]+e[1]*$3e5498a08e31fe3580cca1707752773a$var$temp[5]+e[2]*$3e5498a08e31fe3580cca1707752773a$var$temp[8],this.data[3]=e[3]*$3e5498a08e31fe3580cca1707752773a$var$temp[0]+e[4]*$3e5498a08e31fe3580cca1707752773a$var$temp[3]+e[5]*$3e5498a08e31fe3580cca1707752773a$var$temp[6],this.data[4]=e[3]*$3e5498a08e31fe3580cca1707752773a$var$temp[1]+e[4]*$3e5498a08e31fe3580cca1707752773a$var$temp[4]+e[5]*$3e5498a08e31fe3580cca1707752773a$var$temp[7],this.data[5]=e[3]*$3e5498a08e31fe3580cca1707752773a$var$temp[2]+e[4]*$3e5498a08e31fe3580cca1707752773a$var$temp[5]+e[5]*$3e5498a08e31fe3580cca1707752773a$var$temp[8],this.data[6]=e[6]*$3e5498a08e31fe3580cca1707752773a$var$temp[0]+e[7]*$3e5498a08e31fe3580cca1707752773a$var$temp[3]+e[8]*$3e5498a08e31fe3580cca1707752773a$var$temp[6],this.data[7]=e[6]*$3e5498a08e31fe3580cca1707752773a$var$temp[1]+e[7]*$3e5498a08e31fe3580cca1707752773a$var$temp[4]+e[8]*$3e5498a08e31fe3580cca1707752773a$var$temp[7],this.data[8]=e[6]*$3e5498a08e31fe3580cca1707752773a$var$temp[2]+e[7]*$3e5498a08e31fe3580cca1707752773a$var$temp[5]+e[8]*$3e5498a08e31fe3580cca1707752773a$var$temp[8],this},translate:function(e,t){if(0==e&&0==t)return this;for(let e=0;e<9;e++)$3e5498a08e31fe3580cca1707752773a$var$temp[e]=this.data[e];return this.data[6]=e*$3e5498a08e31fe3580cca1707752773a$var$temp[0]+t*$3e5498a08e31fe3580cca1707752773a$var$temp[3]+$3e5498a08e31fe3580cca1707752773a$var$temp[6],this.data[7]=e*$3e5498a08e31fe3580cca1707752773a$var$temp[1]+t*$3e5498a08e31fe3580cca1707752773a$var$temp[4]+$3e5498a08e31fe3580cca1707752773a$var$temp[7],this.data[8]=e*$3e5498a08e31fe3580cca1707752773a$var$temp[2]+t*$3e5498a08e31fe3580cca1707752773a$var$temp[5]+$3e5498a08e31fe3580cca1707752773a$var$temp[8],this},rotate:function(e){if(0==e)return this;this.identity($3e5498a08e31fe3580cca1707752773a$var$temp2);let t=Math.cos(e),a=Math.sin(e);return $3e5498a08e31fe3580cca1707752773a$var$temp2[0]=t,$3e5498a08e31fe3580cca1707752773a$var$temp2[1]=-a,$3e5498a08e31fe3580cca1707752773a$var$temp2[3]=a,$3e5498a08e31fe3580cca1707752773a$var$temp2[4]=t,this.append($3e5498a08e31fe3580cca1707752773a$var$temp2)},scale:function(e,t){return 1==e&&1==t?this:(this.identity($3e5498a08e31fe3580cca1707752773a$var$temp2),$3e5498a08e31fe3580cca1707752773a$var$temp2[0]=e,$3e5498a08e31fe3580cca1707752773a$var$temp2[4]=t,this.append($3e5498a08e31fe3580cca1707752773a$var$temp2))},applyTo:function(e,t=null){if(null===t){const a=e;e=a.x,t=a.y}let a=this.data[0]*e+this.data[3]*t+this.data[6],i=this.data[1]*e+this.data[4]*t+this.data[7];return $fe31f04e32686e924bb665d33d1abcbf$export$default.alloc().init(a,i)},transpose:function(){$3e5498a08e31fe3580cca1707752773a$var$temp.fill(0);for(let e=0;e<3;e++)for(let t=0;t<3;t++)$3e5498a08e31fe3580cca1707752773a$var$temp[3*e+t]=this.data[3*t+e];for(let e=0;e<9;e++)this.data[e]=$3e5498a08e31fe3580cca1707752773a$var$temp[e];return this},det:function(){return this.data[0]*(this.data[4]*this.data[8]-this.data[5]*this.data[7])-this.data[1]*(this.data[3]*this.data[8]-this.data[5]*this.data[6])+this.data[2]*(this.data[3]*this.data[7]-this.data[4]*this.data[6])},adj:function(){throw new Error("NOT IMPLEMENTED")},inverse:function(){let e=this.det();return e?this.adj().scalef(1/e):null},toString:function(){return`[${this.data[0]}, ${this.data[3]}, ${this.data[6]}]\n[${this.data[1]}, ${this.data[4]}, ${this.data[7]}]\n[${this.data[2]}, ${this.data[5]}, ${this.data[8]}]\n`}});$3e5498a08e31fe3580cca1707752773a$export$default.loadIdentity=function(e){e.fill(0),e[0]=e[4]=e[8]=1},$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($3e5498a08e31fe3580cca1707752773a$export$default,4096,1024);const $e16e0ad9a75d38a76c35e0b8847ef4a3$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({id:null,type:0,sourceCode:null,shaderId:null,__ctor:function(e,t){this.id=e,this.type=t,this.sourceCode="",this.shaderId=null,$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.put(e,this)},__dtor:function(){let e=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl;e&&(e.deleteShader(this.shaderId),$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.remove(this.id))},source:function(e){return this.sourceCode+=e,this},compile:function(){let e=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl;e&&(this.shaderId=e.createShader(this.type===$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.VERTEX_SHADER?e.VERTEX_SHADER:this.type===$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.FRAGMENT_SHADER?e.FRAGMENT_SHADER:e.GEOMETRY_SHADER),e.shaderSource(this.shaderId,this.sourceCode),e.compileShader(this.shaderId))},getError:function(){let e=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl;return e?null===this.shaderId?"Shader has not been compiled.":e.getShaderInfoLog(this.shaderId):""}});$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.VERTEX_SHADER=0,$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.FRAGMENT_SHADER=1,$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.GEOMETRY_SHADER=2,$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.shaders={},$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.put=function(e,t){this.shaders[e]=t},$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.get=function(e){return this.shaders[e]},$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.remove=function(e){delete this.shaders[e]};const $472c416a359bf27a8e7b264fa919be0f$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({uniform_location_matrix:0,uniform_transform_matrix:0,uniform_texture_matrix:0,uniform_resolution:0,uniform_texture_size:0,uniform_base_color:0,uniform_time:0,uniform_depth:0,uniform_scale:0,uniform_alpha:0,uniform_texture_0:0,attrib_location:0,id:null,shaders:null,programId:null,__ctor:function(e){this.id=e,this.shaders=[],this.programId=null,$472c416a359bf27a8e7b264fa919be0f$export$default.put(e,this)},__dtor:function(){let e=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl;if(!e)return this;e.deleteProgram(this.programId),$472c416a359bf27a8e7b264fa919be0f$export$default.remove(this.id)},attach:function(e){if("string"==typeof e&&(e=$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.get(e)),!e)throw new Error("Unable to attach shader, invalid argument.");return this.shaders.push(e),this},bindLocations:function(e){e.bindAttribLocation(this.programId,0,"location")},loadLocations:function(e){this.uniform_location_matrix=e.getUniformLocation(this.programId,"m_location"),this.uniform_transform_matrix=e.getUniformLocation(this.programId,"m_transform"),this.uniform_texture_matrix=e.getUniformLocation(this.programId,"m_texture"),this.uniform_resolution=e.getUniformLocation(this.programId,"v_resolution"),this.uniform_texture_size=e.getUniformLocation(this.programId,"v_texture_size"),this.uniform_base_color=e.getUniformLocation(this.programId,"v_base_color"),this.uniform_time=e.getUniformLocation(this.programId,"f_time"),this.uniform_depth=e.getUniformLocation(this.programId,"f_depth"),this.uniform_scale=e.getUniformLocation(this.programId,"f_scale"),this.uniform_alpha=e.getUniformLocation(this.programId,"f_alpha"),this.uniform_texture_0=e.getUniformLocation(this.programId,"texture0"),this.attrib_location=e.getAttribLocation(this.programId,"location")},link:function(){let e=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl;if(!e)return this;this.programId=e.createProgram();for(let t of this.shaders)e.attachShader(this.programId,t.shaderId);return this.bindLocations(e),e.linkProgram(this.programId),this.loadLocations(e),this},use:function(){let e=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl;e&&e.useProgram(this.programId)},getStatus:function(){let e=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl;return!e||e.getProgramParameter(this.programId,e.LINK_STATUS)},getError:function(){let e=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl;return e?null===this.programId?"Program has not been linked.":e.getProgramInfoLog(this.programId):""},getAllErrors:function(){let e=">> PROGRAM:\n"+this.getError();for(let t of this.shaders)e+="\n>> "+(t.type===$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.VERTEX_SHADER?"vertex":"fragment").toUpperCase()+":\n"+t.getError();return e}});$472c416a359bf27a8e7b264fa919be0f$export$default.programs={},$472c416a359bf27a8e7b264fa919be0f$export$default.put=function(e,t){this.programs[e]=t},$472c416a359bf27a8e7b264fa919be0f$export$default.get=function(e){return this.programs[e]},$472c416a359bf27a8e7b264fa919be0f$export$default.remove=function(e){delete this.programs[e]};const $3c56105c2000e8ab7d1a19dceac231fb$export$default=function(e=null){let t={elem:null,gl:!1,background:"#000",width:0,height:0,hidden:!0,absolute:!1,antialias:!1,...e};null==t.elem?(this.elem=$parcel$global.document?$parcel$global.document.createElement("canvas"):$49a0a27d43075b98f896056be628f99a$export$Rin.clone($3c56105c2000e8ab7d1a19dceac231fb$export$default.passThruCanvas),$parcel$global.document&&1!=t.hidden&&($parcel$global.document.body.appendChild(this.elem),!0===t.absolute&&(this.elem.style.position="absolute",this.elem.style.left="0",this.elem.style.top="0"))):this.elem=elem,this.elem.getContext&&(!0===t.gl?(this.gl=this.elem.getContext("webgl2",{desynchronized:!1,alpha:!1}),this.context=null,console.log(this.gl.getParameter(this.gl.VERSION)),console.log(this.gl.getParameter(this.gl.SHADING_LANGUAGE_VERSION)),$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl=this.gl):(this.context=this.elem.getContext("2d",{desynchronized:!1}),this.gl=null),this.matrixStack=$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),this.alphaStack=$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),this.depthFlagStack=$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),this.shaderProgramStack=$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),this.matr=$3e5498a08e31fe3580cca1707752773a$export$default.calloc(),this.transform=$3e5498a08e31fe3580cca1707752773a$export$default.calloc(),this._globalScale=1,this._alpha=1,this._depthFlag=!0,this.shaderProgram=null,this.updateTransform(),this.strokeStyle("#fff"),this.fillStyle("#fff"),t.width&&t.height&&this.resize(t.width,t.height),!0===t.gl&&this.initGl(),this.antialias=t.antialias,this.setBackground(t.background))};$3c56105c2000e8ab7d1a19dceac231fb$export$default.passThruCanvas={parentNode:null,imageSmoothingEnabled:!0,style:{},width:950,height:540,getContext:function(e){return this},pushClip:function(){},popClip:function(){},scale:function(e,t){},rotate:function(e){},translate:function(e,t){},setTransform:function(e,t,a,i,r,n){},updateTransform:function(){},toDataURL:function(e,t){return""},beginPath:function(){},moveTo:function(e,t){},closePath:function(){},lineTo:function(){},rect:function(e,t,a,i){},fill:function(){},stroke:function(){},fillRect:function(e,t,a,i){},strokeRect:function(e,t,a,i){},clip:function(){},quadraticCurveTo:function(e,t,a,i){},bezierCurveTo:function(e,t,a,i,r,n){},arc:function(e,t,a,i,r,n){},arcTo:function(e,t,a,i,r){},fillText:function(e,t,a,i){},strokeText:function(e,t,a,i){},measureText:function(e){return{width:0}},createImageData:function(e,t){return{width:e,height:t}},getImageData:function(e,t,a,i){return{width:a,height:i,data:[]}},putImageData:function(e,t,a){},drawImage:function(e,t=0,a=0,i=null,r=null,n=null,s=null,c=null,o=null){},getBoundingClientRect:function(){return{left:0,top:0}}},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.initGl=function(){let e=this.gl;if(this.glDefaultProgram=new $472c416a359bf27a8e7b264fa919be0f$export$default("def"),new $e16e0ad9a75d38a76c35e0b8847ef4a3$export$default("def-vert",$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.VERTEX_SHADER).source("#version 300 es\n\t\tprecision highp float;\n\n\t\tuniform mat3 m_location;\n\t\tuniform mat3 m_transform;\n\t\tuniform mat3 m_texture;\n\n\t\tuniform vec2 v_resolution;\n\t\tuniform vec2 v_texture_size;\n\n\t\tuniform float f_time;\n\t\tuniform float f_depth;\n\n\t\tuniform sampler2D texture0;\n\n\t\tin vec2 location;\n\t\tout vec2 texcoords;\n\n\t\tvoid main()\n\t\t{\n\t\t\tgl_Position = vec4(((vec2(m_transform * m_location * vec3(location, 1.0)) / v_resolution)*2.0 - vec2(1.0, 1.0)) * vec2(1.0, -1.0), f_depth / 16777216.0, 1.0);\n\t\t\ttexcoords = vec2(m_texture * vec3(location, 1.0)) / v_texture_size;\n\t\t}\n\t").compile(),new $e16e0ad9a75d38a76c35e0b8847ef4a3$export$default("def-frag",$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.FRAGMENT_SHADER).source("#version 300 es\n\t\tprecision highp float;\n\n\t\tuniform sampler2D texture0;\n\t\tuniform float f_alpha;\n\t\tin vec2 texcoords;\n\n\t\tout vec4 color;\n\n\t\tvoid main()\n\t\t{\n\t\t\tcolor = texture(texture0, texcoords);\n\t\t\tcolor.a *= f_alpha;\n\n\t\t\tif (color.a == 0.0) discard;\n\t\t}\n\t").compile(),this.glBlitProgram=new $472c416a359bf27a8e7b264fa919be0f$export$default("blit"),new $e16e0ad9a75d38a76c35e0b8847ef4a3$export$default("blit-vert",$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.VERTEX_SHADER).source("#version 300 es\n\t\tprecision highp float;\n\n\t\tuniform mat3 m_location;\n\t\tuniform mat3 m_texture;\n\t\tuniform vec2 v_resolution;\n\t\tuniform vec2 v_texture_size;\n\t\tuniform sampler2D texture0;\n\n\t\tin vec2 location;\n\t\tout vec2 texcoords;\n\n\t\tvoid main()\n\t\t{\n\t\t\tgl_Position = vec4(((vec2(m_location * vec3(location, 1.0)) / v_resolution)*2.0 - vec2(1.0, 1.0)) * vec2(1.0, 1.0), 0.0, 1.0);\n\t\t\ttexcoords = vec2(m_texture * vec3(location, 1.0)) / v_texture_size;\n\t\t}\n\t").compile(),new $e16e0ad9a75d38a76c35e0b8847ef4a3$export$default("blit-frag",$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default.FRAGMENT_SHADER).source("#version 300 es\n\t\tprecision highp float;\n\n\t\tuniform sampler2D texture0;\n\t\tin vec2 texcoords;\n\n\t\tout vec4 color;\n\n\t\tvoid main()\n\t\t{\n\t\t\tcolor = texture(texture0, texcoords);\n\t\t}\n\t").compile(),this.glDefaultProgram.attach("def-vert"),this.glDefaultProgram.attach("def-frag"),this.glBlitProgram.attach("blit-vert"),this.glBlitProgram.attach("blit-frag"),this.glDefaultProgram.link(),this.glBlitProgram.link(),!this.glDefaultProgram.getStatus())throw new Error(this.glDefaultProgram.getAllErrors());if(!this.glBlitProgram.getStatus())throw new Error(this.glDefaultProgram.getAllErrors());this.setShaderProgram(this.glDefaultProgram);let t=this.attrib_location_buffer=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(this.shaderProgram.attrib_location),e.vertexAttribPointer(this.shaderProgram.attrib_location,2,e.FLOAT,e.FALSE,2*Float32Array.BYTES_PER_ELEMENT,0*Float32Array.BYTES_PER_ELEMENT),e.clearColor(0,0,0,1),e.enable(e.DEPTH_TEST),e.clearDepth(0),e.depthFunc(e.GEQUAL),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),this.m_location=new Float32Array(9).fill(0),this.m_texture=new Float32Array(9).fill(0),this.v_texture_size=new Float32Array(2).fill(0),this.v_resolution=new Float32Array(2).fill(0),this.zvalue=0,$3e5498a08e31fe3580cca1707752773a$export$default.loadIdentity(this.m_location),$3e5498a08e31fe3580cca1707752773a$export$default.loadIdentity(this.m_texture),this.drawImage=function(e,t=0,a=0,i=null,r=null,n=null,s=null,c=null,o=null){if(!e.glTextureReady)return;let f=this.gl,l=this.shaderProgram;if(f.uniform2fv(l.uniform_resolution,this.v_resolution),f.uniform1f(l.uniform_time,$parcel$global.time),f.uniform1f(l.uniform_scale,this._globalScale),f.uniform1f(l.uniform_alpha,this._alpha),this.glActiveTextureId===e.glTextureId&&this.glActiveShader===l||(f.activeTexture(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,e.glTextureId),f.uniform1i(l.uniform_texture_0,0),this.v_texture_size[0]=e.width,this.v_texture_size[1]=e.height,f.uniform2fv(l.uniform_texture_size,this.v_texture_size),this.glActiveTextureId=e.glTextureId,this.glActiveShader=l),null===i)return this.m_location[0]=e.width,this.m_location[4]=e.height,this.m_location[6]=t,this.m_location[7]=a,this.m_texture[0]=e.width,this.m_texture[4]=e.height,this.m_texture[6]=0,this.m_texture[7]=0,f.uniformMatrix3fv(l.uniform_transform_matrix,!1,this.transform.data),f.uniformMatrix3fv(l.uniform_location_matrix,!1,this.m_location),f.uniformMatrix3fv(l.uniform_texture_matrix,!1,this.m_texture),f.uniform1f(l.uniform_depth,this.zvalue),void f.drawArrays(f.TRIANGLE_STRIP,0,4);null!==n&&(this.m_location[0]=c,this.m_location[4]=o,this.m_location[6]=n,this.m_location[7]=s,this.m_texture[0]=i,this.m_texture[4]=r,this.m_texture[6]=t,this.m_texture[7]=a,f.uniformMatrix3fv(l.uniform_transform_matrix,!1,this.transform.data),f.uniformMatrix3fv(l.uniform_location_matrix,!1,this.m_location),f.uniformMatrix3fv(l.uniform_texture_matrix,!1,this.m_texture),f.uniform1f(l.uniform_depth,this.zvalue),f.drawArrays(f.TRIANGLE_STRIP,0,4))},this.drawRect=function(e,t,a,i){let r=this.gl,n=this.shaderProgram;r.uniform2fv(n.uniform_resolution,this.v_resolution),r.uniform1f(n.uniform_time,$parcel$global.time),r.uniform1f(n.uniform_scale,this._globalScale),r.uniform1f(n.uniform_alpha,this._alpha),this.glActiveTextureId=null,this.v_texture_size[0]=a,this.v_texture_size[1]=i,r.uniform2fv(n.uniform_texture_size,this.v_texture_size),this.m_location[0]=a,this.m_location[4]=i,this.m_location[6]=e,this.m_location[7]=t,this.m_texture[0]=a,this.m_texture[4]=i,this.m_texture[6]=0,this.m_texture[7]=0,r.uniformMatrix3fv(n.uniform_transform_matrix,!1,this.transform.data),r.uniformMatrix3fv(n.uniform_location_matrix,!1,this.m_location),r.uniformMatrix3fv(n.uniform_texture_matrix,!1,this.m_texture),r.uniform1f(n.uniform_depth,this.zvalue),r.drawArrays(r.TRIANGLE_STRIP,0,4)}},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.prepareImage=function(e){let t=this.gl;if(null==t)return!1;let a=t.createTexture();return t.bindTexture(t.TEXTURE_2D,a),t.texStorage2D(t.TEXTURE_2D,1,t.RGBA8,e.width,e.height),t.texSubImage2D(t.TEXTURE_2D,0,0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),e.glTextureId=a,e.glTextureReady=!0,!0},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.applyConfig=function(){0==this.antialias?(null!=this.context&&(this.context.imageSmoothingEnabled=!1),this.elem.style.imageRendering="crisp-edges"):(null!=this.context&&(this.context.imageSmoothingEnabled=!0),this.elem.style.imageRendering="auto")},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.dispose=function(){this.elem.parentNode&&this.elem.parentNode.removeChild(this.elem),this.matrixStack.free(),this.alphaStack.free(),this.depthFlagStack.free(),this.shaderProgramStack.free(),this.matr=null,this.context=null,this.elem=null},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.setBackground=function(e){if(this.elem.style.background=e,this.backgroundColor=e,null!==this.gl){if(7!=e.length)throw new Error("Canvas.setBackground: color parameter should be CSS-style hex-rgb with 6 digits.");let t=parseInt(e.substr(1,2),16)/255,a=parseInt(e.substr(3,2),16)/255,i=parseInt(e.substr(5,2),16)/255;this.gl.clearColor(t,a,i,1)}},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.resize=function(e,t){let a=this.elem.getBoundingClientRect();e||(e=a.width),t||(t=a.height),this.elem.width=e,this.elem.height=t,this.width=this.elem.width,this.height=this.elem.height,this._width=int(this.width/this._globalScale),this._height=int(this.height/this._globalScale);let i=this.gl;return null!=i&&(i.enable(i.SCISSOR_TEST),i.scissor(0,0,this.width,this.height),i.viewport(0,0,this.width,this.height),this.v_resolution&&(this.v_resolution[0]=this.width,this.v_resolution[1]=this.height)),this.applyConfig(),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.globalScale=function(e){return this._globalScale=e,this._width=int(this.width/this._globalScale),this._height=int(this.height/this._globalScale),this.loadIdentity(),this.scale(e,e),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.flipped=function(e){return e?(this._width=int(this.height/this._globalScale),this._height=int(this.width/this._globalScale)):(this._width=int(this.width/this._globalScale),this._height=int(this.height/this._globalScale)),this.isFlipped=e,this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.pushClip=function(){return this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.popClip=function(){return null!=this.gl&&this.gl.scissor(0,0,this.width,this.height),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.toDataUrl=function(e="image/png",t=null){return this.elem.toDataURL(e,t)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.toPng64=function(){return this.elem.toDataURL("image/png").substr(22)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype._contextAttribute=function(e,t=null){if(this.context)return null!==t?(this.context[e]=t,this):this.context[e]},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.fillStyle=function(e){return this._contextAttribute("fillStyle",e)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.strokeStyle=function(e){return this._contextAttribute("strokeStyle",e)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.lineCap=function(e){return this._contextAttribute("lineCap",e)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.lineJoin=function(e){return this._contextAttribute("lineJoin",e)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.lineWidth=function(e){return this._contextAttribute("lineWidth",e)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.miterLimit=function(e){return this._contextAttribute("miterLimit",e)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.shadowColor=function(e){return this._contextAttribute("shadowColor",e)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.shadowOffsetX=function(e){return this._contextAttribute("shadowOffsetX",e)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.shadowOffsetY=function(e){return this._contextAttribute("shadowOffsetY",e)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.shadowBlur=function(e){return this._contextAttribute("shadowBlur",e)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.font=function(e){return this._contextAttribute("font",e)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.textAlign=function(e){return this._contextAttribute("textAlign",e)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.textBaseline=function(e){return this._contextAttribute("textBaseline",e)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.globalAlpha=function(e=null){return null===e?this._alpha:(this._alpha=e,this.alpha(1))},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.globalCompositeOperation=function(e){return this._contextAttribute("globalCompositeOperation",e)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.updateTransform=function(){return this.setTransform(this.matr.data[0],this.matr.data[1],this.matr.data[3],this.matr.data[4],this.matr.data[6],this.matr.data[7]),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.setTransform=function(e,t,a,i,r,n){return null===this.context?(this.transform.data[0]=e,this.transform.data[1]=t,this.transform.data[2]=0,this.transform.data[3]=a,this.transform.data[4]=i,this.transform.data[5]=0,this.transform.data[6]=int(r),this.transform.data[7]=int(n),this.transform.data[8]=1,this):(this.context.setTransform(e,t,a,i,int(r),int(n)),this)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.fillRect=function(e,t,a,i){return this.context.fillRect(e,t,a,i),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.strokeRect=function(e,t,a,i){return this.context.strokeRect(e,t,a,i),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.clearRect=function(e,t,a,i){return this.context.clearRect(e,t,a,i),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.beginPath=function(){return this.context.beginPath(),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.moveTo=function(e,t){return this.context.moveTo(e,t),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.closePath=function(){return this.context.closePath(),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.lineTo=function(e,t){return this.context.lineTo(e,t),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.rect=function(e,t,a,i){return this.context.rect(e,t,a,i),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.fill=function(e=null){return e&&this.fillStyle(e),this.context.fill(),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.stroke=function(e=null){return e&&this.strokeStyle(e),this.context.stroke(),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.clip=function(e,t,a,i){return null!==this.gl&&(e*=this._globalScale,t*=this._globalScale,a*=this._globalScale,i*=this._globalScale,this.isFlipped?this.gl.scissor(this.width-t-i-1,this.height-e-a-1,i,a):this.gl.scissor(e,this.height-t-i-1,a,i)),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.quadraticCurveTo=function(e,t,a,i){return this.context.quadraticCurveTo(e,t,a,i),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.bezierCurveTo=function(e,t,a,i,r,n){return this.context.bezierCurveTo(e,t,a,i,r,n),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.arc=function(e,t,a,i,r,n){return this.context.arc(e,t,a,i,r,n),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.arcTo=function(e,t,a,i,r){return this.context.arcTo(e,t,a,i,r),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.fillText=function(e,t,a,i=1e3){return this.context.fillText(e,t,a,i),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.strokeText=function(e,t,a,i=1e3){return this.context.strokeText(e,t,a,i),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.measureText=function(e){return this.context.measureText(e).width},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.createImageData=function(e,t){return this.context.createImageData(e,t)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.getImageData=function(e,t,a,i){return this.context.getImageData(e,t,a,i)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.putImageData=function(e,t,a){return this.context.putImageData(e,t,a),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.drawImage=function(e,t=0,a=0,i=null,r=null,n=null,s=null,c=null,o=null){if(null===i)this.context.drawImage(e,int(t),int(a));else if(null===n)this.context.drawImage(e,int(t),int(a),int(i),int(r));else{let f=int(i),l=int(r);if(!f||!l)return this;let d=int(c),u=int(o);if(!d||!u)return this;this.context.drawImage(e,int(t),int(a),f,l,int(n),int(s),d,u)}return this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.clear=function(e=null){return null!=this.gl?(this.gl.clear(this.gl.DEPTH_BUFFER_BIT|this.gl.COLOR_BUFFER_BIT),this.glActiveTextureId=null,this):(e?this.globalCompositeOperation("source-over").globalAlpha(1).fillStyle(!0!==e?e:this.backgroundColor).fillRect(0,0,this._width,this._height):(this.elem.width=this.width,this.applyConfig()),this.updateTransform(),this)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.start=function(){},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.end=function(){},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.flush=function(){let e=this.gl;null!==e&&(e.colorMask(!1,!1,!1,!0),e.clear(e.COLOR_BUFFER_BIT),e.colorMask(!0,!0,!0,!0))},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.blit=function(e,t,a,i=null){let r=this.gl;null!==r&&(i=i||this.glBlitProgram,this.setShaderProgram(i),r.disable(r.DEPTH_TEST),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,e),r.uniform1i(i.uniform_texture_0,0),r.uniform2fv(i.uniform_resolution,this.v_resolution),r.uniform1f(i.uniform_time,$parcel$global.time),r.uniform1f(i.uniform_scale,this._globalScale),r.uniform1f(i.uniform_alpha,this._alpha),this.v_texture_size[0]=t,this.v_texture_size[1]=a,r.uniform2fv(i.uniform_texture_size,this.v_texture_size),this.m_location[0]=this.width,this.m_location[4]=this.height,this.m_location[6]=0,this.m_location[7]=0,this.m_texture[0]=this.width,this.m_texture[4]=this.height,this.m_texture[6]=0,this.m_texture[7]=0,r.uniformMatrix3fv(i.uniform_location_matrix,!1,this.m_location),r.uniformMatrix3fv(i.uniform_texture_matrix,!1,this.m_texture),r.drawArrays(r.TRIANGLE_STRIP,0,4),this.setShaderProgram(this.glDefaultProgram),r.enable(r.DEPTH_TEST))},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.reset=function(e=!1){return this.fillStyle("#000000").strokeStyle("#000000").lineCap("butt").lineJoin("miter").lineWidth("1").miterLimit("10").shadowColor("#000000").shadowOffsetX("0").shadowOffsetY("0").shadowBlur("0").globalAlpha("1.0").globalCompositeOperation("source-over"),e&&this.beginPath().closePath(),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.pushMatrix=function(){return this.matrixStack.push(this.matr),this.matr=this.matr.clone(),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.popMatrix=function(){return this.matr.free(),this.matr=this.matrixStack.pop(),this.updateTransform()},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.alpha=function(e){return this._alpha*=e,this.context&&null===this.gl&&(this.context.globalAlpha=this._alpha),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.pushAlpha=function(){return this.alphaStack.push(this.globalAlpha()),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.popAlpha=function(){return this.globalAlpha(this.alphaStack.pop()),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.setDepthFlag=function(e){let t=this.gl;null!==t&&(e?(t.enable(t.DEPTH_TEST),this._depthFlag=!0):(t.disable(t.DEPTH_TEST),this._depthFlag=!1))},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.getDepthFlag=function(){return this._depthFlag},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.pushDepthFlag=function(e=null){if(null!==e)return(e=!!e)!==this._depthFlag&&(this.depthFlagStack.push(this._depthFlag),this.setDepthFlag(e),!0);this.depthFlagStack.push(this._depthFlag)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.popDepthFlag=function(){this.setDepthFlag(this.depthFlagStack.pop())},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.setShaderProgram=function(e){null!==this.gl&&(this.shaderProgram=e,this.shaderProgram.use())},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.getShaderProgram=function(){return this.shaderProgram},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.pushShaderProgram=function(e=null){if(null!==e)return e!==this.shaderProgram&&(this.shaderProgramStack.push(this.shaderProgram),this.setShaderProgram(e),!0);this.shaderProgramStack.push(this.shaderProgram)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.popShaderProgram=function(){this.setShaderProgram(this.shaderProgramStack.pop())},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.loadIdentity=function(){return this.matr.identity(),this.updateTransform()},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.loadMatrix=function(e){return this.matr.set(e),this.updateTransform()},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.getMatrix=function(e=!1){return e?this.matr.clone():this.matr},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.appendMatrix=function(e){return this.matr.append(e),this.updateTransform()},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.scale=function(e,t,a){return a?(this.context.scale(e,t),this):(this.matr.scale(e,t),this.updateTransform())},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.rotate=function(e,t){return t?(this.context.rotate(e),this):(this.matr.rotate(e),this.updateTransform())},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.translate=function(e,t,a){return a?(this.context.translate(e,t),this):(this.matr.translate(e,t),this.updateTransform())},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.ellipse=function(e,t,a,i){var r=a/2*.5522848,n=i/2*.5522848,s=e+a-1,c=t+i-1,o=e+a/2,f=t+i/2;return this.beginPath().moveTo(e,f),this.bezierCurveTo(e,f-n,o-r,t,o,t),this.bezierCurveTo(o+r,t,s,f-n,s,f),this.bezierCurveTo(s,f+n,o+r,c,o,c),this.bezierCurveTo(o-r,c,e,f+n,e,f),this.closePath(),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.circle=function(e,t,a,i){return this.beginPath(),this.arc(e,t,a,0,2*Math.PI),this.closePath(),i&&this.stroke(i),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.line=function(e,t,a,i,r){return this.beginPath(),this.moveTo(e,t),this.lineTo(a,i),this.closePath(),r&&this.stroke(r),this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.enablePointerEvents=function(){if(this.pointerHandler)return this;this.pointerScale={sx:1,sy:1},this.pointerOffset={x:0,y:0};var e=this,t={action:"",buttons:0,lbuttons:0,x:0,y:0,containedBy:function(e,t,a,i){return this.x>=e&&this.x<=e+a-1&&this.y>=t&&this.y<=t+i-1}};return this.pointerHandlers=[],this.pointerHandler=function(a,i){var r=this.elem.getBoundingClientRect();t.action=a,t.buttons=i.buttons,t.x=t.rx=int(i.clientX-r.left),t.y=t.ry=int(i.clientY-r.top),t.x=(t.x-e.pointerOffset.x-0*e.pointerScale.sx)/e.pointerScale.sx,t.y=(t.y-e.pointerOffset.y-0*e.pointerScale.sy)/e.pointerScale.sy,t.dragging=!1,t.buttons&&!t.lbuttons&&(t.sx=t.x,t.sy=t.y,t.ldx=t.ldy=0),t.buttons&&t.lbuttons&&(t.dragging=!0,t.dx=t.x-t.sx,t.dy=t.y-t.sy,t.ddx=t.dx-t.ldx,t.ddy=t.dy-t.ldy,t.ldx=t.dx,t.ldy=t.dy),t.lbuttons=t.buttons;for(var n=0;n<this.pointerHandlers.length&&!1!==this.pointerHandlers[n][1](t,this.pointerHandlers[n][2]);n++);},this.elem.onmousedown=function(t){e.pointerHandler("DOWN",t)},this.elem.onmouseup=function(t){e.pointerHandler("UP",t)},this.elem.onmousemove=function(t){e.pointerHandler("MOVE",t)},this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.setPointerScale=function(e,t){return this.pointerScale={sx:e,sy:t},this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.setPointerOffset=function(e,t){return this.pointerOffset={x:e,y:t},this},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.addPointerHandler=function(e,t){return this.enablePointerEvents(),this.pointerHandlers.push([this.pointerHandlers.length+"_"+int(1e6*Math.random()),e,t]),this.pointerHandlers[this.pointerHandlers.length-1][0]},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.removePointerHandler=function(e){if(this.pointerHandlers)for(var t=0;t<this.pointerHandlers.length;t++)if(this.pointerHandlers[t][0]==e){this.pointerHandlers.splice(t,1);break}},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.drawImageResource=function(e,t=0,a=0,i=null,r=null){return null==i?this.drawImage(e.data,0,0,e.data.width,e.data.height,t,a,e.width,e.height):this.drawImage(e.data,0,0,e.data.width,e.data.height,t,a,i,r)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.renderImage=function(e,t,a,i){let r=new $3c56105c2000e8ab7d1a19dceac231fb$export$default({width:e,height:t});a(r);let n=new Image;n.onload=()=>{$cabc4716fe90fb352f6039743eaed35c$export$default.renderer.prepareImage(n),i(n)},n.src=r.toDataUrl(),r.dispose()};const $cabc4716fe90fb352f6039743eaed35c$export$default={flags:{renderingEnabled:!1,renderingPaused:!1},EVT_KEY_DOWN:1,EVT_KEY_UP:2,EVT_POINTER_DOWN:16,EVT_POINTER_UP:17,EVT_POINTER_MOVE:18,EVT_POINTER_DRAG_START:19,EVT_POINTER_DRAG_MOVE:20,EVT_POINTER_DRAG_STOP:21,DEFAULT:"default",LANDSCAPE:"landscape",PORTRAIT:"portrait",AUTOMATIC:"automatic",defaultOptions:{background:"#000",gl:!0,overdraw:!1,canvas:null,canvas2:null,canvas3:null,fps:144,minFps:15,vsync:!0,antialias:!0,screenWidth:null,screenHeight:null,orientation:0,extraScaleFactor:1,fullscreen:!1},screenWidth:0,screenHeight:0,orientation:0,offsX:0,offsY:0,devicePixelRatio:1,backingStoreRatio:1,canvasPixelRatio:1,canvasScaleFactor:1,scaleFactor:1,initialMatrix:null,renderer:null,displayBuffer2:null,displayBuffer3:null,tempDisplayBuffer:null,keyState:{time:0,shift:!1,ctrl:!1,alt:!1,keyCode:0},pointerState:{},updateQueue:null,drawQueue:null,timeScale:1,frameInterval:0,fixedFrameInterval:0,maxFrameInterval:0,frameDelta:0,frameTime:0,frameNumber:0,perf:{startTime:0,lastTime:0,numFrames:0,numSamples:0,updateTimeTotal:0,drawTimeTotal:0,extraTimeTotal:0,fps:0,averageFps:0,averageUpdateTime:0,averageDrawTime:0,averageExtraTime:0},init:function(e){let t={},a=this;Object.assign(t,this.defaultOptions),e&&Object.assign(t,e),this.options=t,t.screenWidth&&t.screenHeight&&t.orientation==$cabc4716fe90fb352f6039743eaed35c$export$default.DEFAULT&&(t.orientation=t.screenWidth>t.screenHeight?$cabc4716fe90fb352f6039743eaed35c$export$default.LANDSCAPE:$cabc4716fe90fb352f6039743eaed35c$export$default.PORTRAIT),this.orientation=t.orientation,this.updateQueue=$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),this.drawQueue=$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),this.frameInterval=1e3/t.fps,this.maxFrameInterval=1e3/t.minFps,$parcel$global.onresize=function(){a.onWindowResized()},this.frameTimer=new $b82d452f2e3484b177bea709fd7b4383$export$default(t.vsync,this.frameInterval,(e=>this.onFrame(e))),this.renderer=new $3c56105c2000e8ab7d1a19dceac231fb$export$default({gl:t.gl,elem:t.canvas,absolute:!0,hidden:!1,antialias:t.antialias,background:t.background}),this.displayBuffer2=new $3c56105c2000e8ab7d1a19dceac231fb$export$default({gl:!1,elem:t.canvas2,absolute:!0,hidden:!1,antialias:t.antialias,background:"none"}),this.displayBuffer2.elem.style.pointerEvents="none",this.displayBuffer3=new $3c56105c2000e8ab7d1a19dceac231fb$export$default({gl:!1,elem:t.canvas3,absolute:!0,hidden:!1,antialias:t.antialias,background:"none"}),this.displayBuffer3.elem.style.pointerEvents="none",this.tempDisplayBuffer=new $3c56105c2000e8ab7d1a19dceac231fb$export$default({hidden:!0,antialias:t.antialias}).resize(320,240);let i=this.renderer.elem;this.devicePixelRatio=$parcel$global.devicePixelRatio||1,this.backingStoreRatio=1==t.gl?1:this.renderer.context.webkitBackingStorePixelRatio||this.renderer.context.mozBackingStorePixelRatio||this.renderer.context.msBackingStorePixelRatio||this.renderer.context.oBackingStorePixelRatio||this.renderer.context.backingStorePixelRatio||1,this.canvasPixelRatio=this.devicePixelRatio/this.backingStoreRatio,$cabc4716fe90fb352f6039743eaed35c$export$default.onWindowResized(!0),$parcel$global.onkeydown=function(e){if(e.target===$parcel$global.document.body){if(a.keyState[e.keyCode])return!1;switch(a.keyState[e.keyCode]=!0,a.keyState.keyCode=e.keyCode,a.keyState.startTime=hrnow(),e.keyCode){case 16:a.keyState.shift=!0;break;case 17:a.keyState.ctrl=!0;break;case 18:a.keyState.alt=!0}return a.keyState.ctrl&&e.keyCode==$ecb27258662111bab70dd084a4f71ebf$export$default.TAB?(a.keyState[e.keyCode]=!1,!0):!1!==a.onKeyboardEvent(a.EVT_KEY_DOWN,e.keyCode,a.keyState)&&void 0}},$parcel$global.onkeyup=function(e){if(e.target===$parcel$global.document.body){if(!a.keyState[e.keyCode])return!1;switch(a.keyState[e.keyCode]=!1,a.keyState.endTime=hrnow(),a.keyState.keyCode=e.keyCode,e.keyCode){case 16:a.keyState.shift=!1;break;case 17:a.keyState.ctrl=!1;break;case 18:a.keyState.alt=!1}return!1!==a.onKeyboardEvent(a.EVT_KEY_UP,e.keyCode,a.keyState)&&void 0}};const r=function(e,t){return $cabc4716fe90fb352f6039743eaed35c$export$default.reverseRender?int($cabc4716fe90fb352f6039743eaed35c$export$default.screenWidth-1-(t-$cabc4716fe90fb352f6039743eaed35c$export$default.offsY)/$cabc4716fe90fb352f6039743eaed35c$export$default.canvasScaleFactor):int((e-$cabc4716fe90fb352f6039743eaed35c$export$default.offsX)/$cabc4716fe90fb352f6039743eaed35c$export$default.canvasScaleFactor)},n=function(e,t){return $cabc4716fe90fb352f6039743eaed35c$export$default.reverseRender?int((e-$cabc4716fe90fb352f6039743eaed35c$export$default.offsX)/$cabc4716fe90fb352f6039743eaed35c$export$default.canvasScaleFactor):int((t-$cabc4716fe90fb352f6039743eaed35c$export$default.offsY)/$cabc4716fe90fb352f6039743eaed35c$export$default.canvasScaleFactor)};"ontouchstart"in $parcel$global?(i.ontouchstart=function(e){e.preventDefault();let t=e.changedTouches;for(let e=0;e<t.length;e++){$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState[t[e].identifier]||($cabc4716fe90fb352f6039743eaed35c$export$default.pointerState[t[e].identifier]={id:t[e].identifier,isActive:!1,isDragging:!1,sx:0,sy:0,x:0,y:0,dx:0,dy:0,button:0});let a=$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState[t[e].identifier];a.isActive=!0,a.isDragging=!1,a.button=1,a.startTime=hrnow(),a.x=a.sx=r(t[e].clientX,t[e].clientY),a.y=a.sy=n(t[e].clientX,t[e].clientY),$cabc4716fe90fb352f6039743eaed35c$export$default.onPointerEvent($cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_DOWN,a,$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState)}return!1},i.ontouchend=function(e){e.preventDefault();let t=e.changedTouches;for(let e=0;e<t.length;e++){if(!$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState[t[e].identifier])continue;let a=$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState[t[e].identifier];a.endTime=hrnow(),a.deltaTime=a.endTime-a.startTime,a.x=r(t[e].clientX,t[e].clientY),a.y=n(t[e].clientX,t[e].clientY),a.isDragging&&$cabc4716fe90fb352f6039743eaed35c$export$default.onPointerEvent($cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_DRAG_STOP,a,$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState),$cabc4716fe90fb352f6039743eaed35c$export$default.onPointerEvent($cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_UP,a,$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState),a.isActive=!1,a.isDragging=!1,a.button=0}return!1},i.ontouchcancel=function(e){e.preventDefault();let t=e.changedTouches;for(let e=0;e<t.length;e++){if(!$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState[t[e].identifier])continue;let a=$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState[t[e].identifier];a.x=r(t[e].clientX,t[e].clientY),a.y=n(t[e].clientX,t[e].clientY),$cabc4716fe90fb352f6039743eaed35c$export$default.onPointerEvent(a.isDragging?$cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_DRAG_STOP:$cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_UP,a,$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState),a.isActive=!1,a.isDragging=!1,a.button=0}return!1},i.ontouchmove=function(e){e.preventDefault();let t=e.changedTouches;for(let e=0;e<t.length;e++){if(!$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState[t[e].identifier])continue;let a=$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState[t[e].identifier];a.isActive&&!a.isDragging&&($cabc4716fe90fb352f6039743eaed35c$export$default.onPointerEvent($cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_DRAG_START,a,$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState),a.isDragging=!0),a.x=r(t[e].clientX,t[e].clientY),a.y=n(t[e].clientX,t[e].clientY),a.dx=a.x-a.sx,a.dy=a.y-a.sy,$cabc4716fe90fb352f6039743eaed35c$export$default.onPointerEvent(a.isDragging?$cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_DRAG_MOVE:$cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_MOVE,a,$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState)}return!1}):(i.onmousedown=function(e){e.preventDefault(),$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState[0]||($cabc4716fe90fb352f6039743eaed35c$export$default.pointerState[0]={id:0,isActive:!1,isDragging:!1,button:0,sx:0,sy:0,x:0,y:0,dx:0,dy:0});let t=$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState[0];return t.isActive=!0,t.isDragging=!1,t.button=e.which,t.x=t.sx=r(e.clientX,e.clientY),t.y=t.sy=n(e.clientX,e.clientY),$cabc4716fe90fb352f6039743eaed35c$export$default.onPointerEvent($cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_DOWN,t,$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState),!1},i.onmouseup=function(e){if(e.preventDefault(),!$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState[0])return!1;let t=$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState[0];t.x=r(e.clientX,e.clientY),t.y=n(e.clientX,e.clientY),t.isDragging&&$cabc4716fe90fb352f6039743eaed35c$export$default.onPointerEvent($cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_DRAG_STOP,t,$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState),$cabc4716fe90fb352f6039743eaed35c$export$default.onPointerEvent($cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_UP,t,$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState),t.isActive=!1,t.isDragging=!1,t.button=0},i.onmousemove=function(e){if(e.preventDefault(),!$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState[0])return!1;let t=$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState[0];return t.isActive&&!t.isDragging&&($cabc4716fe90fb352f6039743eaed35c$export$default.onPointerEvent($cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_DRAG_START,t,$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState),t.isDragging=!0),t.x=r(e.clientX,e.clientY),t.y=n(e.clientX,e.clientY),t.dx=t.x-t.sx,t.dy=t.y-t.sy,$cabc4716fe90fb352f6039743eaed35c$export$default.onPointerEvent(t.isDragging?$cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_DRAG_MOVE:$cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_MOVE,t,$cabc4716fe90fb352f6039743eaed35c$export$default.pointerState),!1})},time:function(){return this.frameTime},start:function(){this.onWindowResized(),this.flags.renderingPaused=!1,this.frameTimer.start()},stop:function(){this.flags.renderingPaused=!0,this.frameTimer.stop()},pause:function(){this.flags.renderingPaused=!0},resume:function(){this.flags.renderingPaused=!1,this.resetPerf()},onFrame:function(e){let t,a=hrnow();e>this.maxFrameInterval&&(e=this.maxFrameInterval),0!==this.fixedFrameInterval&&(e=this.fixedFrameInterval),this.flags.renderingEnabled&&!this.flags.renderingPaused?(e*=this.timeScale,this.frameDelta=e/1e3,this.frameTime+=this.frameDelta,$parcel$global.time=this.frameTime,this.frameNumber++,t=hrnow(),this.update(this.frameDelta),this.perf.updateTimeTotal+=hrnow()-t,t=hrnow(),this.draw(),this.perf.drawTimeTotal+=hrnow()-t,this.perf.lastTime=a,this.perf.numFrames++,(e=this.perf.lastTime-this.perf.startTime)>1e3&&(this.perf.fps=int(1e3*this.perf.numFrames/e),this.perf.averageFps=int((this.perf.averageFps*this.perf.numSamples+this.perf.fps)/(this.perf.numSamples+1)),this.perf.averageUpdateTime=int((this.perf.averageUpdateTime*this.perf.numSamples+1e3*this.perf.updateTimeTotal/this.perf.numFrames)/(this.perf.numSamples+1)),this.perf.averageDrawTime=int((this.perf.averageDrawTime*this.perf.numSamples+1e3*this.perf.drawTimeTotal/this.perf.numFrames)/(this.perf.numSamples+1)),this.perf.averageExtraTime=int((this.perf.averageExtraTime*this.perf.numSamples+1e3*this.perf.extraTimeTotal/this.perf.numFrames)/(this.perf.numSamples+1)),this.perf.numSamples++,this.perf.startTime=a,this.perf.lastTime=a,this.perf.numFrames=0,this.perf.updateTimeTotal=0,this.perf.drawTimeTotal=0,this.perf.extraTimeTotal=0)):this.draw()},onWindowResized:function(e=!1){if("document"in $parcel$global)this.options.fullscreen?(this._screenWidth=int($parcel$global.screen.width),this._screenHeight=int($parcel$global.screen.height)):(this._screenWidth=$parcel$global.innerWidth,this._screenHeight=$parcel$global.innerHeight);else if(this._screenWidth=this.options.screenWidth,this._screenHeight=this.options.screenHeight,null==this.options.screenWidth&&null==this.options.screenHeight)throw new Error("At least one screen dimension must be specified in headless mode.");this._screenWidth<this._screenHeight&&this.orientation==$cabc4716fe90fb352f6039743eaed35c$export$default.LANDSCAPE||this._screenWidth>this._screenHeight&&this.orientation==$cabc4716fe90fb352f6039743eaed35c$export$default.PORTRAIT?(this.screenWidth=this._screenHeight,this.screenHeight=this._screenWidth,this.reverseRender=!0):(this.screenWidth=this._screenWidth,this.screenHeight=this._screenHeight,this.reverseRender=!1);let t=this.options.screenWidth,a=this.options.screenHeight;null!=t&&null!=a||(null==t?t=int(this.screenWidth*(this.options.screenHeight/this.screenHeight)):null==a&&(a=int(this.screenHeight*(this.options.screenWidth/this.screenWidth))));let i=t,r=a;this.orientation==$cabc4716fe90fb352f6039743eaed35c$export$default.AUTOMATIC&&i&&r&&(i>r&&this.screenWidth<this.screenHeight||i<r&&this.screenWidth>this.screenHeight)&&(i=r,r=t),this.canvasScaleFactor=1,i&&r?this.canvasScaleFactor=Math.min(this.screenWidth/i,this.screenHeight/r):i?this.canvasScaleFactor=this.screenWidth/i:r&&(this.canvasScaleFactor=this.screenHeight/r);let n=this.screenWidth,s=this.screenHeight;if(i&&(this.screenWidth=i),r&&(this.screenHeight=r),this.offsX=int(.5*(n-this.screenWidth*this.canvasScaleFactor)),this.offsY=int(.5*(s-this.screenHeight*this.canvasScaleFactor)),this.reverseRender){let e=this.offsX;this.offsX=this.offsY,this.offsY=e}this.scaleFactor=this.canvasScaleFactor*this.canvasPixelRatio,this.scaleFactor=int(.7+this.scaleFactor),this.flags.renderingEnabled=!1,"document"in $parcel$global&&($parcel$global.document.body.style.backgroundColor=this.renderer.backgroundColor),this.reverseRender?(this.renderer.resize(this.screenHeight*this.scaleFactor,this.screenWidth*this.scaleFactor),this.renderer.elem.style.width=this.screenHeight*this.canvasScaleFactor+"px",this.renderer.elem.style.height=this.screenWidth*this.canvasScaleFactor+"px",this.displayBuffer2.resize(this.screenHeight*this.scaleFactor,this.screenWidth*this.scaleFactor),this.displayBuffer2.elem.style.width=this.screenHeight*this.canvasScaleFactor+"px",this.displayBuffer2.elem.style.height=this.screenWidth*this.canvasScaleFactor+"px",this.displayBuffer3.resize(s,n),this.displayBuffer3.elem.style.width=s+"px",this.displayBuffer3.elem.style.height=n+"px"):(this.renderer.resize(this.screenWidth*this.scaleFactor,this.screenHeight*this.scaleFactor),this.renderer.elem.style.width=this.screenWidth*this.canvasScaleFactor+"px",this.renderer.elem.style.height=this.screenHeight*this.canvasScaleFactor+"px",this.displayBuffer2.resize(this.screenWidth*this.scaleFactor,this.screenHeight*this.scaleFactor),this.displayBuffer2.elem.style.width=this.screenWidth*this.canvasScaleFactor+"px",this.displayBuffer2.elem.style.height=this.screenHeight*this.canvasScaleFactor+"px",this.displayBuffer3.resize(n,s),this.displayBuffer3.elem.style.width=n+"px",this.displayBuffer3.elem.style.height=s+"px"),this.renderer.elem.style.marginLeft=this.offsX+"px",this.renderer.elem.style.marginTop=this.offsY+"px",this.displayBuffer2.elem.style.marginLeft=this.offsX+"px",this.displayBuffer2.elem.style.marginTop=this.offsY+"px",this.renderer.loadIdentity(),this.displayBuffer2.loadIdentity(),this.displayBuffer3.loadIdentity(),1!=this.scaleFactor&&(this.renderer.globalScale(this.scaleFactor),this.displayBuffer2.globalScale(this.scaleFactor)),this.reverseRender?(this.renderer.rotate(Math.PI/2),this.renderer.translate(-this.screenWidth,0),this.renderer.flipped(!0),this.displayBuffer2.rotate(Math.PI/2),this.displayBuffer2.translate(-this.screenWidth,0),this.displayBuffer2.flipped(!0),this.displayBuffer3.rotate(Math.PI/2),this.displayBuffer3.translate(-n,0),this.displayBuffer3.flipped(!0)):(this.renderer.flipped(!1),this.displayBuffer2.flipped(!1),this.displayBuffer3.flipped(!1)),this.scaleFactor*=this.options.extraScaleFactor,this.integerScaleFactor=int(this.scaleFactor+.9),this.resetPerf(),this.initialMatrix&&this.initialMatrix.free(),this.initialMatrix=this.renderer.getMatrix(!0),1!=e&&(this.flags.renderingEnabled=!0,this.onCanvasResized(this.screenWidth,this.screenHeight))},onCanvasResized:function(e,t){},resetPerf:function(){this.perf.startTime=hrnow(),this.perf.lastTime=hrnow(),this.perf.numFrames=0,this.perf.updateTimeTotal=0,this.perf.drawTimeTotal=0,this.perf.extraTimeTotal=0,this.perf.numSamples=0,this.perf.fps=0,this.perf.averageFps=0,this.perf.averageUpdateTime=0,this.perf.averageDrawTime=0,this.perf.averageExtraTime=0},updateQueueAdd:function(e){return this.updateQueue.push(e),this.updateQueue.bottom},updateQueueRemove:function(e){this.updateQueue.remove(e instanceof $8581dd2a4034ebdbe37300f3afba0093$export$default?e:this.updateQueue.sgetNode(e))},drawQueueAdd:function(e){return this.drawQueue.push(e),this.drawQueue.bottom},drawQueueRemove:function(e){this.drawQueue.remove(e instanceof $8581dd2a4034ebdbe37300f3afba0093$export$default?e:this.drawQueue.sgetNode(e))},queueAdd:function(e){return this.updateQueue.push(e),this.drawQueue.push(e),e},queueRemove:function(e){this.updateQueue.remove(this.updateQueue.sgetNode(e)),this.drawQueue.remove(this.drawQueue.sgetNode(e))},update:function(e){try{let t;for(let a=this.updateQueue.top;a;a=t)t=a.next,a.value.update(e)}catch(e){throw $cabc4716fe90fb352f6039743eaed35c$export$default.stop(),e}},draw:function(){null!==this.renderer.gl&&this.renderer.start(),this.options.overdraw||(this.renderer.clear(),this.displayBuffer2.clear(),this.displayBuffer3.clear());try{let e;for(let t=this.drawQueue.top;t;t=e)e=t.next,t.value.draw(this.renderer);null!==this.renderer.gl&&(this.renderer.flush(),this.renderer.end())}catch(e){throw $cabc4716fe90fb352f6039743eaed35c$export$default.stop(),e}},interpolate:function(e,t,a,i,r){let n={},s={},c=0;for(let t in e)n[t]=0,s[t]=e[t],c++;let o={update:function(f){for(let r in n){if(n[r]==a[r])continue;n[r]+=f,n[r]>=a[r]&&(n[r]=a[r],c--);let o=i[r](n[r]/a[r]);s[r]=(1-o)*e[r]+o*t[r]}r(s,0==c),0==c&&$cabc4716fe90fb352f6039743eaed35c$export$default.updateQueueRemove(o)}};$cabc4716fe90fb352f6039743eaed35c$export$default.updateQueueAdd(o),o.update(0)},onKeyboardEvent:function(e,t,a){},onPointerEvent:function(e,t,a){}},$363800ec3de62fddc1d9a5e33a6b17dc$export$default=function(e,t){this.data=[],this.accumSize=e,this.expectedValue=t,this.stdSum=0,this.stdCount=0};$363800ec3de62fddc1d9a5e33a6b17dc$export$default.SAMPLES=1,$363800ec3de62fddc1d9a5e33a6b17dc$export$default.MIN=2,$363800ec3de62fddc1d9a5e33a6b17dc$export$default.MAX=4,$363800ec3de62fddc1d9a5e33a6b17dc$export$default.AVG=8,$363800ec3de62fddc1d9a5e33a6b17dc$export$default.EXPECTED=16,$363800ec3de62fddc1d9a5e33a6b17dc$export$default.STDDEV=32,$363800ec3de62fddc1d9a5e33a6b17dc$export$default.AVG_STDDEV=64,$363800ec3de62fddc1d9a5e33a6b17dc$export$default.ALL=255,$363800ec3de62fddc1d9a5e33a6b17dc$export$default.prototype.begin=function(){this.startTime=performance.now()},$363800ec3de62fddc1d9a5e33a6b17dc$export$default.prototype.end=function(){this.feed(performance.now()-this.startTime)},$363800ec3de62fddc1d9a5e33a6b17dc$export$default.prototype.feed=function(e){this.data.push(e),this.data.length==this.accumSize&&(this.report(),this.data=[])},$363800ec3de62fddc1d9a5e33a6b17dc$export$default.prototype.update=function(){let e=null,t=null,a=0,i=0;for(let i=0;i<this.data.length;i++)e=null===e?this.data[i]:Math.min(e,this.data[i]),t=null===t?this.data[i]:Math.max(t,this.data[i]),a+=this.data[i];a/=this.data.length;let r=void 0!==this.expectedValue?this.expectedValue:a;for(let e=0;e<this.data.length;e++)i+=Math.pow(this.data[e]-r,2);return i=Math.sqrt(i/this.data.length),this.stdSum+=i,this.stdCount++,this.min=e,this.max=t,this.avg=a,this.std=i,this},$363800ec3de62fddc1d9a5e33a6b17dc$export$default.prototype.report=function(e=255){let t="";return e&$363800ec3de62fddc1d9a5e33a6b17dc$export$default.SAMPLES&&(t+="n: "+this.stdCount),e&$363800ec3de62fddc1d9a5e33a6b17dc$export$default.MIN&&(t+=(""!=t?", ":"")+"min: "+this.min),e&$363800ec3de62fddc1d9a5e33a6b17dc$export$default.MAX&&(t+=(""!=t?", ":"")+"max: "+this.max),e&$363800ec3de62fddc1d9a5e33a6b17dc$export$default.AVG&&(t+=(""!=t?", ":"")+"avg: "+this.avg.toFixed(2)),e&$363800ec3de62fddc1d9a5e33a6b17dc$export$default.EXPECTED&&(t+=(""!=t?", ":"")+(void 0!==this.expectedValue?"e: "+this.expectedValue:"")),e&$363800ec3de62fddc1d9a5e33a6b17dc$export$default.STDDEV&&(t+=(""!=t?", ":"")+"stddev: "+this.std.toFixed(2)),e&$363800ec3de62fddc1d9a5e33a6b17dc$export$default.AVG_STDDEV&&(t+=(""!=t?", ":"")+"avg_stddev: "+(this.stdSum/this.stdCount).toFixed(2)),t};const $4ca05bce8e5796b66097460c15da00c9$export$default={activated:!1,paused:!1,data:$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),count:0,maxsize:30,debugEcho:!1,color:"#fff",background:"#cf266a",vars:{},write:function(e){for(this.data.push(e),this.count++;this.data.length>this.maxsize;)this.data.shift();this.debugEcho&&console.debug(this.count+": "+e)},clear:function(){this.data.reset(),this.count=0},enable:function(e,t,a,i,r){if(this.activated)return;this.activated=!0,e||(e=0),t||(t=0),a||(a=9.5),!1===i&&(t-=16);let n=t;$cabc4716fe90fb352f6039743eaed35c$export$default.drawQueueAdd({draw:function(){if($4ca05bce8e5796b66097460c15da00c9$export$default.paused)return;let s=hrnow();const c=$cabc4716fe90fb352f6039743eaed35c$export$default.displayBuffer3;c.font("bold "+a+"pt Monospace"),c.textBaseline("top");let o="";t=n,!1!==i&&0!=$cabc4716fe90fb352f6039743eaed35c$export$default.perf.fps&&(o="fps: "+$cabc4716fe90fb352f6039743eaed35c$export$default.perf.fps+"/"+$cabc4716fe90fb352f6039743eaed35c$export$default.perf.averageFps+", update: "+$cabc4716fe90fb352f6039743eaed35c$export$default.perf.averageUpdateTime+", draw: "+$cabc4716fe90fb352f6039743eaed35c$export$default.perf.averageDrawTime+", extra: "+$cabc4716fe90fb352f6039743eaed35c$export$default.perf.averageExtraTime,$4ca05bce8e5796b66097460c15da00c9$export$default.background&&(c.fillStyle($4ca05bce8e5796b66097460c15da00c9$export$default.background),c.fillRect(e-3,t-1,c.measureText(o)+6,a+5)),c.fillStyle($4ca05bce8e5796b66097460c15da00c9$export$default.color),c.fillText(o,e,t)),o="";for(let e in $4ca05bce8e5796b66097460c15da00c9$export$default.vars)o+=e+": "+$4ca05bce8e5796b66097460c15da00c9$export$default.vars[e]+"  ";""!==o&&(t+=24,$4ca05bce8e5796b66097460c15da00c9$export$default.background&&(c.fillStyle($4ca05bce8e5796b66097460c15da00c9$export$default.background),c.fillRect(e-3,t-1,c.measureText(o)+6,a+5)),c.fillStyle($4ca05bce8e5796b66097460c15da00c9$export$default.color),c.fillText(o,e,t));let f=0;for(let i=$4ca05bce8e5796b66097460c15da00c9$export$default.data.top;i;i=i.next,f++)o=(!1!==r?"#"+($4ca05bce8e5796b66097460c15da00c9$export$default.count-$4ca05bce8e5796b66097460c15da00c9$export$default.data.length+f+1)+": ":"> ")+i.value,$4ca05bce8e5796b66097460c15da00c9$export$default.background&&(c.fillStyle($4ca05bce8e5796b66097460c15da00c9$export$default.background),c.fillRect(e-3,t-1+7+(a+5)*(f+1)-1,c.measureText(o)+6,a+5)),c.fillStyle($4ca05bce8e5796b66097460c15da00c9$export$default.color),c.fillText(o,e,t-1+7+(a+5)*(f+1));s=hrnow()-s,$cabc4716fe90fb352f6039743eaed35c$export$default.perf.drawTimeTotal-=s,$cabc4716fe90fb352f6039743eaed35c$export$default.perf.extraTimeTotal+=s}})},pause:function(){this.paused=!0},resume:function(){this.paused=!1}},$e0af888fbe72678addd891879b080a5a$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({framebufferId:null,attachments:null,attachmentTypes:null,width:0,height:0,drawBuffers:null,drawBufferIds:null,__ctor:function(e=null,t=null){null!==$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl&&(null===$e0af888fbe72678addd891879b080a5a$var$attachmentPointIds[0]&&$e0af888fbe72678addd891879b080a5a$var$initAttachmentPointIds($c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl),this.framebufferId=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl.createFramebuffer(),this.drawBuffers=[],this.drawBufferIds=[],this.width=e||$cabc4716fe90fb352f6039743eaed35c$export$default.renderer.width,this.height=t||$cabc4716fe90fb352f6039743eaed35c$export$default.renderer.height,this.attachments=new Array($e0af888fbe72678addd891879b080a5a$export$default.MAX_ATTACHMENT_POINTS).fill(null),this.attachmentTypes=new Array($e0af888fbe72678addd891879b080a5a$export$default.MAX_ATTACHMENT_POINTS).fill(null))},__dtor:function(){let e=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl;if(null!==e){for(let t=0;t<this.attachments.length;t++)null!==this.attachments[t]&&(this.attachmentTypes[t]===$e0af888fbe72678addd891879b080a5a$export$default.TEXTURE?e.deleteTexture(this.attachments[t]):e.deleteRenderbuffer(this.attachments[t]));e.deleteFramebuffer(this.frameBufferId)}},attach:function(e,t,a=null){let i=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl;if(null===i)return;null===a&&(a=e<$e0af888fbe72678addd891879b080a5a$export$default.DEPTH?$e0af888fbe72678addd891879b080a5a$export$default.TEXTURE:$e0af888fbe72678addd891879b080a5a$export$default.RENDERBUFFER),this.attachments[e]=t,this.attachmentTypes[e]=a,e<$e0af888fbe72678addd891879b080a5a$export$default.DEPTH&&-1===this.drawBuffers.indexOf(e)&&(this.drawBuffers.push(e),this.drawBufferIds.push($e0af888fbe72678addd891879b080a5a$var$attachmentPointIds[e]));let r=i.getParameter(i.FRAMEBUFFER_BINDING);switch(i.bindFramebuffer(i.FRAMEBUFFER,this.framebufferId),a){case $e0af888fbe72678addd891879b080a5a$export$default.TEXTURE:i.framebufferTexture2D(i.FRAMEBUFFER,$e0af888fbe72678addd891879b080a5a$var$attachmentPointIds[e],i.TEXTURE_2D,t,0);break;case $e0af888fbe72678addd891879b080a5a$export$default.RENDERBUFFER:i.framebufferRenderbuffer(i.FRAMEBUFFER,$e0af888fbe72678addd891879b080a5a$var$attachmentPointIds[e],i.RENDERBUFFER,t)}i.bindFramebuffer(i.FRAMEBUFFER,r)},createColorBuffer:function(e,t=null,a=null){let i=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl;if(null===i)return null;null===t&&(t=this.width),null===a&&(a=this.height);let r=i.createTexture();return i.bindTexture(i.TEXTURE_2D,r),i.texStorage2D(i.TEXTURE_2D,1,i.RGBA8,t,a),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),this.attach(e,r),r},createDepthBuffer:function(e=null,t=null){let a=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl;if(null===a)return null;null===e&&(e=this.width),null===t&&(t=this.height);let i=a.createRenderbuffer();return a.bindRenderbuffer(a.RENDERBUFFER,i),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT24,e,t),this.attach($e0af888fbe72678addd891879b080a5a$export$default.DEPTH,i),i},createStencilBuffer:function(e=null,t=null){let a=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl;if(null===a)return null;null===e&&(e=this.width),null===t&&(t=this.height);let i=a.createTexture();return a.bindTexture(a.TEXTURE_2D,i),a.texStorage2D(a.TEXTURE_2D,1,a.DEPTH_STENCIL,e,t),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),this.attach($e0af888fbe72678addd891879b080a5a$export$default.DEPTH_STENCIL,i),i},getTexture:function(e){return this.attachmentTypes[e]!==$e0af888fbe72678addd891879b080a5a$export$default.TEXTURE?null:this.attachments[e]},getRenderBuffer:function(e){return this.attachmentTypes[e]!==$e0af888fbe72678addd891879b080a5a$export$default.RENDERBUFFER?null:this.attachments[e]},bind:function(){let e=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl;null!==e&&(e.bindFramebuffer(e.FRAMEBUFFER,this.framebufferId),e.drawBuffers(this.drawBufferIds),e.viewport(0,0,this.width,this.height))},unbind:function(){let e=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl;null!==e&&(e.bindFramebuffer(e.FRAMEBUFFER,null),e.drawBuffers($e0af888fbe72678addd891879b080a5a$var$defaultDrawBuffers),e.viewport(0,0,$cabc4716fe90fb352f6039743eaed35c$export$default.renderer.width,$cabc4716fe90fb352f6039743eaed35c$export$default.renderer.height))},isComplete:function(){let e=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.gl;if(null===e)return!0;let t=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,this.framebufferId);let a=e.checkFramebufferStatus(e.FRAMEBUFFER);return e.bindFramebuffer(e.FRAMEBUFFER,t),a===e.FRAMEBUFFER_COMPLETE}});$e0af888fbe72678addd891879b080a5a$export$default.TEXTURE=1,$e0af888fbe72678addd891879b080a5a$export$default.RENDERBUFFER=2,$e0af888fbe72678addd891879b080a5a$export$default.COLOR0=0,$e0af888fbe72678addd891879b080a5a$export$default.COLOR1=1,$e0af888fbe72678addd891879b080a5a$export$default.COLOR2=2,$e0af888fbe72678addd891879b080a5a$export$default.COLOR3=3,$e0af888fbe72678addd891879b080a5a$export$default.COLOR4=4,$e0af888fbe72678addd891879b080a5a$export$default.COLOR5=5,$e0af888fbe72678addd891879b080a5a$export$default.COLOR6=6,$e0af888fbe72678addd891879b080a5a$export$default.COLOR7=7,$e0af888fbe72678addd891879b080a5a$export$default.DEPTH=8,$e0af888fbe72678addd891879b080a5a$export$default.STENCIL=9,$e0af888fbe72678addd891879b080a5a$export$default.DEPTH_STENCIL=10,$e0af888fbe72678addd891879b080a5a$export$default.MAX_ATTACHMENT_POINTS=11;const $e0af888fbe72678addd891879b080a5a$var$attachmentPointIds=new Array($e0af888fbe72678addd891879b080a5a$export$default.MAX_ATTACHMENT_POINTS).fill(null),$e0af888fbe72678addd891879b080a5a$var$defaultDrawBuffers=new Array(1).fill(null),$e0af888fbe72678addd891879b080a5a$var$initAttachmentPointIds=function(e){$e0af888fbe72678addd891879b080a5a$var$defaultDrawBuffers[0]=e.BACK,$e0af888fbe72678addd891879b080a5a$var$attachmentPointIds[$e0af888fbe72678addd891879b080a5a$export$default.COLOR0]=e.COLOR_ATTACHMENT0,$e0af888fbe72678addd891879b080a5a$var$attachmentPointIds[$e0af888fbe72678addd891879b080a5a$export$default.COLOR1]=e.COLOR_ATTACHMENT1,$e0af888fbe72678addd891879b080a5a$var$attachmentPointIds[$e0af888fbe72678addd891879b080a5a$export$default.COLOR2]=e.COLOR_ATTACHMENT2,$e0af888fbe72678addd891879b080a5a$var$attachmentPointIds[$e0af888fbe72678addd891879b080a5a$export$default.COLOR3]=e.COLOR_ATTACHMENT3,$e0af888fbe72678addd891879b080a5a$var$attachmentPointIds[$e0af888fbe72678addd891879b080a5a$export$default.COLOR4]=e.COLOR_ATTACHMENT4,$e0af888fbe72678addd891879b080a5a$var$attachmentPointIds[$e0af888fbe72678addd891879b080a5a$export$default.COLOR5]=e.COLOR_ATTACHMENT5,$e0af888fbe72678addd891879b080a5a$var$attachmentPointIds[$e0af888fbe72678addd891879b080a5a$export$default.COLOR6]=e.COLOR_ATTACHMENT6,$e0af888fbe72678addd891879b080a5a$var$attachmentPointIds[$e0af888fbe72678addd891879b080a5a$export$default.COLOR7]=e.COLOR_ATTACHMENT7,$e0af888fbe72678addd891879b080a5a$var$attachmentPointIds[$e0af888fbe72678addd891879b080a5a$export$default.DEPTH]=e.DEPTH_ATTACHMENT,$e0af888fbe72678addd891879b080a5a$var$attachmentPointIds[$e0af888fbe72678addd891879b080a5a$export$default.STENCIL]=e.STENCIL_ATTACHMENT,$e0af888fbe72678addd891879b080a5a$var$attachmentPointIds[$e0af888fbe72678addd891879b080a5a$export$default.DEPTH_STENCIL]=e.DEPTH_STENCIL_ATTACHMENT};var $c300508ff8318f231a03f90d08d1052b$exports={};const $8c2ed76c3be599228cd92e613ce51103$export$default={};Object.assign($8c2ed76c3be599228cd92e613ce51103$export$default,{integerScaling:!0,pixelated:!1,init:function(e=null){e&&Object.assign(this,e)},load:function(e,t,a,i,r){if(!i){i=Object.keys(e);for(let t in i)"__loaded"in e[i[t]]||(e[i[t]].__clone=$49a0a27d43075b98f896056be628f99a$export$Rin.clone(e[i[t]]));r=0}for(;r<i.length&&"__loaded"in e[i[r]];)r++;if(t&&t(r,i.length,r/i.length),r==i.length)return void(a&&a(e));let n=e[i[r]];switch(n.resName=i[r],n.type){case"image":n.data=new Image,n.data.onload=function(){var s=n.data.width/n.data.height;n.scale&&(n.width=int(n.data.width*n.scale),n.height=int(n.data.height*n.scale)),n.width||n.height?n.width&&!n.height?n.height=int(n.width/s):!n.width&&n.height&&(n.width=int(s*n.height)):(n.width=n.data.width,n.height=n.data.height),n.owidth=n.data.width,n.oheight=n.data.height,null!==n.pixelated&&n.hasOwnProperty("pixelated")||(n.pixelated=$8c2ed76c3be599228cd92e613ce51103$export$default.pixelated),(n.data.width!=n.width||n.data.height!=n.height||!0!==n.original&&1!=$cabc4716fe90fb352f6039743eaed35c$export$default.scaleFactor)&&(!0===n.original?n.data=$8c2ed76c3be599228cd92e613ce51103$export$default.resizeImage(n,n.width,n.height,n.pixelated,!0):n.data=$8c2ed76c3be599228cd92e613ce51103$export$default.resizeImage(n,n.width*(n.pixelated?$cabc4716fe90fb352f6039743eaed35c$export$default.integerScaleFactor:$cabc4716fe90fb352f6039743eaed35c$export$default.scaleFactor),n.height*(n.pixelated?$cabc4716fe90fb352f6039743eaed35c$export$default.integerScaleFactor:$cabc4716fe90fb352f6039743eaed35c$export$default.scaleFactor),n.pixelated,!0)),n.rscale=n.data.width/n.width,$cabc4716fe90fb352f6039743eaed35c$export$default.tempDisplayBuffer.drawImage(n.data,0,0),$cabc4716fe90fb352f6039743eaed35c$export$default.renderer.prepareImage(n.data),$8c2ed76c3be599228cd92e613ce51103$export$default.onLoaded(e,i[r]),$8c2ed76c3be599228cd92e613ce51103$export$default.load(e,t,a,i,r+1)},n.data.onerror=function(){console.error("Error: Unable to load: "+n.resName)},n.data.src=n.src+"?r="+Math.random();break;case"images":var s=(o=n.src).indexOf("#"),c=(f=o.lastIndexOf("#"))-s+1;if(-1==s)return void console.error("Unable to load: "+n.resName+"\nError: The 'src' attribute requires one or more '#' marks.");if(!n.count)return void console.error("Unable to load: "+n.resName+"\nError: The 'count' attribute was not found.");n._i=0,n.data=[],(l=function(){if(n._i==n.count)return $8c2ed76c3be599228cd92e613ce51103$export$default.onLoaded(e,i[r]),void $8c2ed76c3be599228cd92e613ce51103$export$default.load(e,t,a,i,r+1);var o={type:"image",width:n.width,height:n.height,scale:n.scale};o.src=n.src.substr(0,s)+(n._i++/Math.pow(10,c)).toFixed(c).substr(2)+n.src.substr(f+1),o.data=new Image,o.resName=n.resName+"#"+(n._i-1),o.data.onload=function(){var e=o.data.width/o.data.height;o.scale&&(o.width=int(o.data.width*o.scale),o.height=int(o.data.height*o.scale)),o.width||o.height?o.width&&!o.height?o.height=int(o.width/e):!o.width&&o.height&&(o.width=int(e*o.height)):(o.width=o.data.width,o.height=o.data.height),1==n._i&&(n.owidth=o.data.width,n.oheight=o.data.height),(o.data.width!=o.width||o.data.height!=o.height||!0!==o.original&&1!=$cabc4716fe90fb352f6039743eaed35c$export$default.scaleFactor)&&(null!==n.pixelated&&n.hasOwnProperty("pixelated")||(n.pixelated=$8c2ed76c3be599228cd92e613ce51103$export$default.pixelated),!0===o.original?o.data=$8c2ed76c3be599228cd92e613ce51103$export$default.resizeImage(o,o.width,o.height,n.pixelated,!0):o.data=$8c2ed76c3be599228cd92e613ce51103$export$default.resizeImage(o,o.width*(n.pixelated?$cabc4716fe90fb352f6039743eaed35c$export$default.integerScaleFactor:$cabc4716fe90fb352f6039743eaed35c$export$default.scaleFactor),o.height*(n.pixelated?$cabc4716fe90fb352f6039743eaed35c$export$default.integerScaleFactor:$cabc4716fe90fb352f6039743eaed35c$export$default.scaleFactor),n.pixelated,!0)),o.rscale=o.data.width/o.width,1==n._i&&(n.width=o.width,n.height=o.height,n.rscale=o.rscale),$cabc4716fe90fb352f6039743eaed35c$export$default.tempDisplayBuffer.drawImage(o.data,0,0),$cabc4716fe90fb352f6039743eaed35c$export$default.renderer.prepareImage(o.data),n.data.push(o),l()},o.data.onerror=function(){console.error("Error: Unable to load: "+o.resName)},o.data.src=o.src+"?r="+Math.random()})();break;case"audio":if(n.track||(n.track="sfx"),$parcel$global.plugins&&$parcel$global.plugins.NativeAudio&&"sfx"==n.track){n.engine=$c300508ff8318f231a03f90d08d1052b$export$Sound.ENGINE_NATIVEAUDIO,n.data="snd_"+r,$parcel$global.plugins.NativeAudio.preloadSimple(n.data,n.src,(function(){$8c2ed76c3be599228cd92e613ce51103$export$default.onLoaded(e,i[r]),$8c2ed76c3be599228cd92e613ce51103$export$default.load(e,t,a,i,r+1)}),(function(e){console.error("Error: Unable to load (sfx): "+n.resName+"\n"+e)}));break}if($parcel$global.audioContext){n.engine=$c300508ff8318f231a03f90d08d1052b$export$Sound.ENGINE_WEBAUDIO,fetchAudioBuffer(n.src+"?r="+Math.random()).then((s=>{n.data=s,$8c2ed76c3be599228cd92e613ce51103$export$default.onLoaded(e,i[r]),$8c2ed76c3be599228cd92e613ce51103$export$default.load(e,t,a,i,r+1)})).catch((e=>{console.error("Error: Unable to load: "+n.resName)}));break}n.data=new Audio,n.engine=$c300508ff8318f231a03f90d08d1052b$export$Sound.ENGINE_HTML5,n.data.oncanplaythrough=function(){$8c2ed76c3be599228cd92e613ce51103$export$default.onLoaded(e,i[r]),$8c2ed76c3be599228cd92e613ce51103$export$default.load(e,t,a,i,r+1)},n.data.onerror=function(){console.error("Error: Unable to load: "+n.resName)},n.data.src=n.src+"?r="+Math.random();break;case"audios":var o,f,l;s=(o=n.src).indexOf("#"),c=(f=o.lastIndexOf("#"))-s+1;if(-1==s)return void console.error("Unable to load: "+n.resName+"\nError: The 'src' attribute requires one or more '#' marks.");if(!n.count)return void console.error("Unable to load: "+n.resName+"\nError: The 'count' attribute was not found.");n._i=0,n.data=[],(l=function(){if(n._i==n.count)return $8c2ed76c3be599228cd92e613ce51103$export$default.onLoaded(e,i[r]),void $8c2ed76c3be599228cd92e613ce51103$export$default.load(e,t,a,i,r+1);var o={type:"audio",track:n.track};return o.src=n.src.substr(0,s)+(n._i++/Math.pow(10,c)).toFixed(c).substr(2)+n.src.substr(f+1),o.resName=n.resName+"#"+(n._i-1),o.track||(o.track="sfx"),$parcel$global.plugins&&$parcel$global.plugins.NativeAudio&&"sfx"==o.track?(o.engine=$c300508ff8318f231a03f90d08d1052b$export$Sound.ENGINE_NATIVEAUDIO,o.data="snd_"+r+"_"+n._i,void $parcel$global.plugins.NativeAudio.preloadSimple(o.data,o.src,(function(){n.data.push(o),l()}),(function(e){console.error("Error: Unable to load (sfx): "+o.resName+"\n"+e)}))):$parcel$global.audioContext?(o.engine=$c300508ff8318f231a03f90d08d1052b$export$Sound.ENGINE_WEBAUDIO,void fetchAudioBuffer(o.src+"?r="+Math.random()).then((e=>{o.data=e,n.data.push(o),l()})).catch((e=>{console.error("Error: Unable to load: "+o.resName)}))):(o.data=new Audio,o.engine=$c300508ff8318f231a03f90d08d1052b$export$Sound.ENGINE_HTML5,o.data.oncanplaythrough=function(){n.data.push(o),l()},o.data.onerror=function(){console.error("Error: Unable to load: "+o.resName)},void(o.data.src=o.src+"?r="+Math.random()))})();break;case"json":fetchd(n.src+"?r="+Math.random(),{responseType:"json"}).then((function(s){n.data=s,$8c2ed76c3be599228cd92e613ce51103$export$default.onLoaded(e,i[r]),$8c2ed76c3be599228cd92e613ce51103$export$default.load(e,t,a,i,r+1)})).catch((function(e){console.error("Error: Unable to load: "+n.resName+". Error: "+e)}));break;case"data":fetchd(n.src+"?r="+Math.random()).then((function(s){n.data=s,$8c2ed76c3be599228cd92e613ce51103$export$default.onLoaded(e,i[r]),$8c2ed76c3be599228cd92e613ce51103$export$default.load(e,t,a,i,r+1)})).catch((function(e){console.error("Error: Unable to load: "+n.resName+". Error: "+e)}));break;case"text":fetchd(n.src+"?r="+Math.random()).then((function(s){n.data=String.fromCharCode.apply(null,new Uint8Array(s)),$8c2ed76c3be599228cd92e613ce51103$export$default.onLoaded(e,i[r]),$8c2ed76c3be599228cd92e613ce51103$export$default.load(e,t,a,i,r+1)})).catch((function(e){console.error("Error: Unable to load: "+n.resName+". Error: "+e)}));break;case"object":n.data={},$8c2ed76c3be599228cd92e613ce51103$export$default.onLoaded(e,i[r]),$8c2ed76c3be599228cd92e613ce51103$export$default.load(e,t,a,i,r+1)}},unload:function(e){throw new Error("IMPLEMENTED UNLOAD!")},onLoaded:function(e,t){var a=e[t];a.wrapper&&a.wrapper in $c300508ff8318f231a03f90d08d1052b$exports&&(e[t]=new $c300508ff8318f231a03f90d08d1052b$exports[a.wrapper](a),e[t].__loaded=!0)},resizeImage:function(e,t,a,i,r){var n=e.data.width,s=e.data.height;if(t=int(t),a=int(a),n==t&&s==a)return e.data;if(!this.integerScaling&&i&&(i=null),i){if(int(t/n)>0){var c,o=int(t/n+.9),f=(t=o*n)/n,l=(a=o*s)/s;p=new $3c56105c2000e8ab7d1a19dceac231fb$export$default({hidden:!0,antialias:!1}).resize(t,a);(c=new $3c56105c2000e8ab7d1a19dceac231fb$export$default({hidden:!0,antialias:!1}).resize(n,s)).drawImage(e.data,0,0);for(var d=0;d<s;d++)for(var u=c.getImageData(0,d,n,1).data,h=0,$=0;$<n&&h<u.length;$++,h+=4)p.fillStyle("rgba("+u[h]+","+u[h+1]+","+u[h+2]+","+u[h+3]/255+")"),p.fillRect($*f,d*l,f,l);return c.dispose(),p.elem}return this.resizeImage(e,t,a,null,r)}for((c=new $3c56105c2000e8ab7d1a19dceac231fb$export$default({hidden:!0,antialias:i=null!==i}).resize(n,s)).drawImage(e.data,0,0);;){var p,b=n>>1,x=s>>1;if(b<=t||x<=a)break;(p=new $3c56105c2000e8ab7d1a19dceac231fb$export$default({hidden:!0,antialias:i}).resize(b,x)).drawImage(c.elem,0,0,b,x),c.dispose(),n=b,s=x,c=p}return(p=new $3c56105c2000e8ab7d1a19dceac231fb$export$default({hidden:!0,antialias:i}).resize(t,a)).drawImage(c.elem,0,0,t,a),c.dispose(),r&&dispose(e.data),p.elem},flipImageHorz:function(e){var t=new $3c56105c2000e8ab7d1a19dceac231fb$export$default({hidden:!0}).resize(e.data.width,e.data.height);return t.translate(e.data.width,0),t.scale(-1,1),t.drawImage(e.data,0,0),t.elem},showDownload:function(e,t){var a=document.createElement("a");a.href=t,a.style.display="none",a.download=e,a.target="_blank",document.body.appendChild(a),a.click(),document.body.removeChild(a)},showFilePicker:function(e,t,a){var i=document.createElement("input");i.type="file",i.accept=t,i.style.display="none",i.multiple=e,document.body.appendChild(i),i.onchange=function(){a(i.files)},document.body.onfocus=function(){document.body.onfocus=null,document.body.removeChild(i)},i.click()},loadAsDataURL:function(e,t){var a=new FileReader;a.onload=function(e){t(e.target.result)},a.readAsDataURL(e)},loadAsText:function(e,t){var a=new FileReader;a.onload=function(e){t(e.target.result)},a.readAsText(e)},loadAsArrayBuffer:function(e,t){var a=new FileReader;a.onload=function(e){t(e.target.result)},a.readAsArrayBuffer(e)},loadAllAsDataURL:function(e,t){var a=[];if(e&&e.length){var i=function(r){r!=e.length?$8c2ed76c3be599228cd92e613ce51103$export$default.loadAsDataURL(e[r],(function(t){a.push({name:e[r].name,size:e[r].size,url:t}),i(r+1)})):t(a)};i(0)}else t(a)}});var $1650bdc66a81ddb41761abeffd23210b$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Drawable",width:null,height:null,__ctor:function(e){if("image"!=e.type)throw new Error("Resource is not an image.");this.width=e.width,this.height=e.height,this.r=e,this.r.wrapper=this},draw:function(e,t=0,a=0,i=null,r=null){null==i?e.drawImageResource(this.r,t,a):e.drawImageResource(this.r,t,a,i,r)},getDrawable:function(){return this}});$8c2ed76c3be599228cd92e613ce51103$export$default.Image=function(e,t=null){return{type:"image",wrapper:"Drawable",src:e,pixelated:null,...t}};var $58dab9516df16ec182238d2ca8a1defb$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Placeholder",width:null,height:null,__ctor:function(e){if("object"!=e.type)throw new Error("Resource is not an object.");this.width=e.width,this.height=e.height,this.r=e,this.r.wrapper=this,this.data=null,$3c56105c2000e8ab7d1a19dceac231fb$export$default.renderImage(e.width,e.height,(t=>{t.fillStyle(this.r.color),t.fillRect(0,0,e.width,e.height)}),(e=>{this.data=e}))},draw:function(e,t=0,a=0,i=null,r=null){this.data&&e.drawImageResource(this,t,a,i,r)},getDrawable:function(){return this}});$8c2ed76c3be599228cd92e613ce51103$export$default.Placeholder=function(e,t,a="#ff0000",i=null){return{type:"object",wrapper:"Placeholder",width:e,height:t,color:a,...i}};var $627725a412dfe14c915059cb52478808$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Spritesheet",width:0,height:0,numCols:0,numFrames:0,drawableCache:null,__ctor:function(e){if("image"!=e.type&&"images"!=e.type)throw new Error("Resource is not a sprite sheet.");var t,a;if("image"==e.type){if(!(e.config.sheetWidth||e.config.numFrames&&e.config.frameWidth))throw new Error("Required sheetWidth or numFrames+frameWidth");e.config.sheetWidth||(e.config.sheetWidth=e.config.numFrames*e.config.frameWidth),e.config.frameHeight||(e.config.frameHeight=e.data.height),t=e.data.width/e.config.sheetWidth,a=e.width/e.config.sheetWidth}else e.config||(e.config={}),e.config.frameWidth||(e.config.frameWidth=e.data[0].width),e.config.frameHeight||(e.config.frameHeight=e.data[0].height),t=e.data[0].data.width/e.config.frameWidth,a=e.data[0].width/e.config.frameWidth;this.r_frameWidth=e.config.frameWidth*t,this.r_frameHeight=e.config.frameHeight*t,this.width=e.config.frameWidth*a,this.height=e.config.frameHeight*a,"image"==e.type?(this.numCols=int(e.data.width/this.r_frameWidth),this.numRows=Math.ceil(e.data.height/this.r_frameHeight),this.numFrames=e.config.numFrames||this.numCols*this.numRows):(this.numCols=this.numRows=0,this.numFrames=e.data.length),this.drawableCache={},this.r=e,this.r.wrapper=this},drawFrame:function(e,t,a,i,r=0,n=0){if(!(i<0||i>=this.numFrames))if(r||(r=this.width),n||(n=this.height),0!=this.numCols){var s=int(i/this.numCols)*this.r_frameHeight,c=i%this.numCols*this.r_frameWidth;e.drawImage(this.r.data,c,s,this.r_frameWidth,this.r_frameHeight,t,a,r,n)}else e.drawImage(this.r.data[i].data,0,0,this.r_frameWidth,this.r_frameHeight,t,a,r,n)},getFrame:function(e,t=null){let a;if(a=null!==t?t*this.numCols+e:e,a<0||a>=this.numFrames)throw new Error("frameIndex out of range");return this.drawableCache[a]||(this.drawableCache[a]={width:this.width,height:this.height,frameIndex:a,r:this,draw:function(e,t=0,a=0,i=0,r=0){e.drawFrame(this.r,t,a,this.frameIndex,i,r)},getDrawable:function(){return this}}),this.drawableCache[a]},getDrawable:function(){return this.getFrame(0)}});$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.drawFrame=function(e,t,a,i,r,n){e.drawFrame(this,t,a,i,r,n)};const $e342b055560c491aa3816f3d2921580a$export$Animation=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Animation",width:null,height:null,seq:null,seq_i:0,trans:null,trans_i:0,trans_t:null,queue:null,fps:0,frameSeconds:0,time:0,frameNumber:-1,finished:!1,_paused:!1,finishedCallback:null,finishedCallbackHandler:null,finishedCallbackContext:null,frameCallback:null,init:function(e,t,a){return this.anim=e,this.queue=$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),this.seq=t,this.seq_i=0,this.trans=null,this.trans_i=0,this.trans_t=null,this.width=e.width,this.height=e.height,this.frameNumber=-1,this.finished=!1,this._paused=!1,this.finishedCallback=null,this.finishedCallbackHandler=null,this.finishedCallbackContext=null,this.frameCallback=null,this.fps=a,this.setFps(this.seq.fps||this.fps),this},__dtor:function(){this.queue.free(),this.finishedCallbackHandler&&this.finishedCallbackHandler.free(),this.finishedCallbackContext&&this.finishedCallbackContext.free()},setFps:function(e){return this.frameSeconds=1/e,this.time=0,this},paused:function(e=null){return null===e?this._paused:(this._paused=e,this)},setInitialDelay:function(e){return this.time=-e,this},onFinished:function(e){return this.finishedCallback=e,this},then:function(e,t=null){return this.finishedCallback!==this.thenCallback&&(this.finishedCallback=this.thenCallback,this.finishedCallbackHandler=$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),this.finishedCallbackContext=$9331e791bdadeac9afb7e80808da523d$export$default.calloc()),this.finishedCallbackHandler.push(e),this.finishedCallbackContext.push(t),this},thenCallback:function(){if(!this.finishedCallbackHandler.length)return!1;let e=this.finishedCallbackContext.shift();this.finishedCallbackHandler.shift()(this,e)},onFrame:function(e){return this.frameCallback=e,this},setFrame:function(e){return this.seq_i=int(e)%this.seq.group.length,this},getFrame:function(e){return!0===e?this.seq_i/(this.seq.group.length-1):this.seq_i},getLength:function(){return this.seq.group.length},draw:function(e,t=0,a=0){if(this.time<0)return this._paused||(this.time+=this.frameNumber===$cabc4716fe90fb352f6039743eaed35c$export$default.frameNumber?0:$cabc4716fe90fb352f6039743eaed35c$export$default.frameDelta,this.frameNumber=$cabc4716fe90fb352f6039743eaed35c$export$default.frameNumber),void(this.time>0&&(this.time=0));if(this.seq_i===this.seq.group.length){let i=this.seq.group[this.seq_i-1];if(null!=e)for(let r=0;r<i.length;r++)e.drawFrame(this.anim,t,a,i[r]);return}let i=this.seq.group[this.seq_i];if(null!=e)for(let r=0;r<i.length;r++)e.drawFrame(this.anim,t,a,i[r]);if(this._paused||(this.time+=this.frameNumber===$cabc4716fe90fb352f6039743eaed35c$export$default.frameNumber?0:$cabc4716fe90fb352f6039743eaed35c$export$default.frameDelta,this.frameNumber=$cabc4716fe90fb352f6039743eaed35c$export$default.frameNumber),this.time>=this.frameSeconds){const e=this.seq_i;this.time-=this.frameSeconds,this.seq_i++,this.seq_i===this.seq.group.length&&(null!=this.trans?(++this.trans_i===this.trans.length?(this.trans=null,this.seq=this.trans_t):this.seq=this.trans[this.trans_i],this.seq_i=0,this.time=0,this.finished=!1):(this.seq.loop?this.seq_i=0:(this.finished=!0,this.finishedCallback&&!1===this.finishedCallback(this)&&(this.finishedCallback=null)),this.queue.length&&this.use(this.queue.shift(),!0))),this.frameCallback&&!1===this.frameCallback(e,this.seq.group.length-1,this)&&(this.frameCallback=null)}},getDrawable:function(){return this},advance:function(){this.paused(!1),this.draw(null,0,0)},getSequenceName:function(){return(null===this.trans?this.seq:this.trans_t).name},use:function(e,t=!1){let a=null===this.trans?this.seq:this.trans_t;return!(a.name===e&&!this.finished&&!0!==t)&&(a.trans&&a.trans[e]?(this.trans_t=this.anim.a.seq[e],this.trans=a.trans[e],this.trans_i=0,this.seq=this.trans[this.trans_i]):(this.seq=this.anim.a.seq[e],this.setFps(this.seq.fps||this.fps)),this.seq_i=0,this.time=0,this.finished=!1,!0)},setQueue:function(e){if(!$9331e791bdadeac9afb7e80808da523d$export$default.isInstance(e))throw new Error("setQueue: Parameter must be an instance of List");null!=this.queue&&this.queue.clear().free(),this.queue=e,this.use(this.queue.shift(),!0)},enqueue:function(e,t=!1){let a=null===this.trans?this.seq:this.trans_t,i=this.queue.length>0?this.queue[this.queue.length-1]:a.name;return a.name===e&&a.loop?this:i!==e||t?a.loop||this.finished?(this.use(e,!0),this):(this.queue.push(e),this):this}});$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($e342b055560c491aa3816f3d2921580a$export$Animation);var $e342b055560c491aa3816f3d2921580a$export$default=$627725a412dfe14c915059cb52478808$export$default.extend({className:"SpritesheetAnimation",defaultDrawable:null,__ctor:function(e){if(!e.anim)throw new Error("Animation descriptors not found.");this._super.Spritesheet.__ctor(e),this.r=e,this.r.wrapper=this;let t=this.a=this.r.anim;if(t.initialized)return;if(t.def||(t.def="def"),t.seq||(t.seq={}),!t.seq[t.def]&&("def"==t.def||"defloop"==t.def)){let e={loop:"def"!=t.def,group:[]};for(let t=0;t<this.numFrames;t++)e.group.push([t]);t.seq[t.def]=e}if(!t.seq[t.def])throw new Error("Undefined default sequence: "+t.def);t.fps||(t.fps=25),t.def=t.seq[t.def];let a=0;for(let e in t.seq)if(t.seq[e].name=e,t.seq[e].loop||(t.seq[e].loop=!1),"string"==typeof t.seq[e].group){let i,r,n;if(-1!=t.seq[e].group.indexOf(" ")){i=t.seq[e].group.split(" "),t.seq[e].group=[];for(let a in i)t.seq[e].group.push([int(i[a])])}else if(-1!=t.seq[e].group.indexOf(","))for(n=t.seq[e].group.split(","),i=int(n[0]),r=int(n[1]),t.seq[e].group=[],n=i;n<=r;n++)t.seq[e].group.push([n]);else for(i=int(t.seq[e].group),t.seq[e].group=[];i--;)t.seq[e].group.push([a++]);t.seq[e].count=t.seq[e].group.length}if(t.trans)for(let e in t.trans){t.seq[e].trans=t.trans[e];for(let a in t.trans[e])for(let i=0;i<t.trans[e][a].length;i++){let r=t.trans[e][a][i];if(!t.seq[r])throw new Error("Undefined sequence: "+r);t.trans[e][a][i]=t.seq[r]}}t.initialized=!0},getAnimation:function(e=null,t=null){return $e342b055560c491aa3816f3d2921580a$export$Animation.alloc().init(this,e?this.a.seq[e]:this.a.def,t||this.a.fps)},getSequence:function(e){return this.a.seq[e]},getDrawable:function(){return null===this.defaultDrawable&&(this.defaultDrawable=this.getAnimation()),this.defaultDrawable}}),$7348ebe4152ceb8aef436e181a4ab9b7$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({__ctor:function(e){if("image"!=e.type||!e.font)throw new Error("Resource is not a sprite font.");e.font.sheetWidth||(e.font.sheetWidth=e.width);let t=e.data.width/e.font.sheetWidth,a=e.width/e.font.sheetWidth;this.r_charWidth=e.font.charWidth*t,this.r_charHeight=e.font.charHeight*t,this.charWidth=e.font.charWidth*a,this.charHeight=e.font.charHeight*a,this.paddingX=(e.font.paddingX||0)*a,this.paddingY=(e.font.paddingY||0)*a,this.spacingX=(e.font.spacingX||0)*a,this.spacingY=(e.font.spacingY||0)*a;let i=int(e.font.sheetWidth/e.font.charWidth);this.r=e,this.r.wrapper=this;let r=e.font.charset.length,n=0,s=0;for(this.charTable={},this.charTable[" "]={charWidth:int(2*(this.charWidth+this.paddingX)/3),r_charWidth:this.r_charWidth};n<r;){let t=0;for(let a=0;a<i&&n<r;a++){let a=e.font.charset[n++];this.charTable[a]={x:t,y:s,charWidth:this.charWidth,r_charWidth:this.r_charWidth},t+=this.r_charWidth}s+=this.r_charHeight}if(e.font.widths){r=e.font.widths.length;for(let i=0;i<r;i+=2){let r=e.font.widths[i]*a,n=e.font.widths[i]*t,s=e.font.widths[i+1];for(let e=0;e<s.length;e++)this.charTable[s[e]].charWidth=r,this.charTable[s[e]].r_charWidth=n}}},drawText:function(e,t,a,i){let r=i.length,n=-2*this.paddingX+this.spacingX;t-=this.paddingX,a-=this.paddingY;for(let s=0;s<r;s++){if(" "==i[s]){t+=this.charTable[i[s]].charWidth+n;continue}let r=this.charTable[i[s]];r&&(e.drawImage(this.r.data,r.x,r.y,r.r_charWidth,this.r_charHeight,t,a,r.charWidth,this.charHeight),t+=r.charWidth+n)}},measureWidth:function(e){let t=e.length,a=0,i=-2*this.paddingX+this.spacingX;for(let r=0;r<t;r++){let t=this.charTable[e[r]];t&&(a+=t.charWidth+i)}return a},measureHeight:function(e){return this.charHeight-2*this.paddingY+this.spacingY}});$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.drawText=function(e,t,a,i){e.drawText(this,t,a,i)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.drawTextAligned=function(e,t,a,i,r,n,s,c){0==n?t+=i-e.measureWidth(c)>>1:n<0?t=t-n-1:n>0&&(t=t+i-n+1-e.measureWidth(c)),0==s?a+=r-e.measureHeight(c)>>1:s<0?a=a-s-1:s>0&&(a=a+r-s+1-e.measureHeight(c)),e.drawText(this,t,a,c)},$3c56105c2000e8ab7d1a19dceac231fb$export$default.prototype.drawTextAligned2=function(e,t,a,i,r){this.drawTextAligned(e,t.x1,t.y1,t.width(),t.height(),a,i,r)};const $c1b17ff2c1cc00f8fa2d10063393a8ec$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({r:null,__ctor:function(e){if("audio"!=e.type)throw new Error("Resource is not audio.");this.r=e,this.r.wrapper=this,this.track=$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default[this.r.track.toUpperCase()]},play:function(e,t){return $c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.play(this,e,t)},playLoop:function(e,t){return $c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.playLoop(this,e,t)}});$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.ENGINE_HTML5=1,$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.ENGINE_WEBAUDIO=2,$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.ENGINE_NATIVEAUDIO=3,Object.assign($c1b17ff2c1cc00f8fa2d10063393a8ec$export$default,{MASTER:{enabled:!0,volume:1},SFX:{enabled:!0,volume:1},MUSIC:{enabled:!0,volume:.8},VOICE:{enabled:!0,volume:1},MAX_POOL_SIZE:100,pool:[],active:[],register:function(e){e.registered||(e.registered=!0,this.active.push(e))},unregister:function(e){if(e.registered){e.registered=!1;var t=$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.active.indexOf(e);-1!=t&&$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.active.splice(t,1)}},updateNode:function(e,t){switch(e.snd.r.engine){case $c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.ENGINE_WEBAUDIO:return this.updateNode_webaudio(e,t);case $c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.ENGINE_NATIVEAUDIO:return this.updateNode_nativeaudio(e,t)}return this.updateNode_audio(e,t)},alloc_webaudio:function(e){e.gainNode=audioContext.createGain(),e.gainNode.gain.value=0,e.gainNode.connect(audioContext.destination),e.res=audioContext.createBufferSource(),e.res.buffer=e.snd.r.data,e.res.loop=!1,e.res.connect(e.gainNode),e.res.node=e},free_webaudio:function(e){e.res&&(e.gainNode.disconnect(),e.res=null,e.gainNode=null)},alloc_nativeaudio:function(e){e.res=!0},free_nativeaudio:function(e){e.res=!1},alloc_audio:function(e){return this.pool.length?item=this.pool.pop():item=e.cloneNode(),item._src=e.src,item},free_audio:function(e){this.pool.length!=this.MAX_POOL_SIZE&&this.pool.push(e)},updateNode_webaudio:function(e,t){if(!e)return null;var a=$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.MASTER.volume*e.snd.track.volume*e.volume;switch(t){case"play":if(e.playing)break;e.res||$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.alloc_webaudio(e),e.playTime=hrnow(),e.playing=!0,e.pause=!1,e.res.onended=$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.onended_webaudio,e.gainNode.gain.value=a;try{e.res.start(0,e.startTime/1e3)}catch(t){return $c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.free_webaudio(e),null}$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.register(e);break;case"setvolume":if(!e.res)break;e.gainNode.gain.value=a;break;case"stop":if(!e.playing&&e.paused){e.startTime=0,e.paused=!1,$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.free_webaudio(e),e.callback&&e.callback();break}if(!e.res)break;e.startTime=0,e.playing=!1,e.pause=!1,e.res.onended=null,$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.unregister(e),e.res.stop(),$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.free_webaudio(e),e.callback&&e.callback();break;case"pause":if(!e.playing||!e.res)break;e.startTime+=hrnow()-e.playTime,e.playing=!1,e.pause=!0,e.res.onended=null,$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.unregister(e),e.res.stop(),$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.free_webaudio(e);break;case"softstop":if(!e.playing&&e.paused){e.startTime=0,e.paused=!1;break}if(!e.playing||!e.res)break;e.startTime=0,e.playing=!1,e.pause=!1,e.res.loop=!1}return e},onended_webaudio:function(e){var t=e.currentTarget.node;if(t.playing&&0!=t.loop)return $c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.free_webaudio(t),-1!=t.loop&&t.loop--,t.startTime=0,t.playing=!1,t.pause=!1,void $c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.updateNode_webaudio(t,"play");t.res.onended=null,t.res.volume=0,$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.updateNode_webaudio(t,"stop")},updateNode_nativeaudio:function(e,t){if(!e)return null;switch(t){case"play":if(e.playing)break;e.res||$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.alloc_nativeaudio(e),e.playing=!0,e.pause=!1;try{$parcel$global.plugins.NativeAudio.play(e.snd.r.data,null,null,(function(){$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.onended_nativeaudio(e)}))}catch(t){return $c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.free_nativeaudio(e),null}$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.register(e);break;case"setvolume":break;case"stop":if(!e.res)break;e.playing=!1,e.pause=!1,$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.unregister(e),$parcel$global.plugins.NativeAudio.stop(e.snd.r.data,null),$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.free_nativeaudio(e),e.callback&&e.callback()}return e},onended_nativeaudio:function(e){$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.updateNode_nativeaudio(e,"stop")},updateNode_audio:function(e,t){if(!e)return null;var a=$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.MASTER.volume*e.snd.track.volume*e.volume;switch(t){case"play":if(e.playing)break;e.res||(e.res=$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.alloc_audio(e.snd.r.data),e.res.node=e,e.res.src=e.res._src),e.playTime=hrnow(),e.playing=!0,e.pause=!1,e.res.onended=$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.onended_audio,e.res.currentTime=e.startTime/1e3,e.res.volume=a;try{e.res.play()}catch(t){return $c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.free_audio(e.res),e.res=null,null}$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.register(e);break;case"setvolume":if(!e.res)break;e.res.volume=a;break;case"stop":if(!e.playing&&e.paused){e.startTime=0,e.paused=!1,$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.free_audio(e.res),e.res=null,e.callback&&e.callback();break}if(!e.res)break;e.startTime=0,e.playing=!1,e.pause=!1,$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.unregister(e),e.res.pause(),$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.free_audio(e.res),e.res=null,e.callback&&e.callback();break;case"pause":if(!e.playing||!e.res)break;e.startTime+=hrnow()-e.playTime,e.playing=!1,e.pause=!0,$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.unregister(e),e.res.pause();break;case"softstop":if(!e.playing&&e.paused){e.startTime=0,e.paused=!1;break}if(!e.playing||!e.res)break;e.startTime=0,e.playing=!1,e.pause=!1}return e},onended_audio:function(e){var t=e.currentTarget.node;if(t.playing&&0!=t.loop)return-1!=t.loop&&t.loop--,t.startTime=0,t.playing=!1,t.pause=!1,void $c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.updateNode_audio(t,"play");t.res.onended=null,t.res.volume=0,$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.updateNode_audio(t,"stop")},enableTrack:function(e){e&&(e.enabled=!0)},disableTrack:function(e){e&&(e.enabled=!1)},setVolume:function(e,t){e&&(e.volume=t)},createNode:function(e,t){var a={};return a.startVolume=t,a.volume=t,a.snd=e,a.loop=0,a.playing=!1,a.paused=!1,a.startTime=0,a.playTime=0,a.callback=null,a.timer=null,a.res=null,a},play:function(e,t,a){if(!this.MASTER.enabled||!e||!e.track.enabled)return null;a=null!=a?a:1;var i=this.createNode(e,a);return i.callback=t,this.updateNode(i,"play")},playLoop:function(e,t,a){if(!this.MASTER.enabled||!e||!e.track.enabled)return null;a=null!=a?a:1;var i=this.createNode(e,a);return i.callback=t,i.loop=-1,this.updateNode(i,"play")},stop:function(e,t){return e?(t&&!0!==t&&(e.callback=t),this.updateNode(e,!0===t?"stop":"softstop")):null},pause:function(e){return e?this.updateNode(e,"pause"):null},resume:function(e){return e?this.updateNode(e,"play"):null},fadeOut:function(e,t,a){if(e)if(e.playing&&!e.timer){var i=hrnow();e.startVolume=e.volume,e.timer=setInterval((function(){var r=(hrnow()-i)/t;r>1&&(r=1),e.volume=e.startVolume*(1-r),$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.updateNode(e,"setvolume"),1==r&&(clearInterval(e.timer),e.timer=null,!0===a?$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.updateNode(e,"stop"):$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.updateNode(e,"pause"),a&&!0!==a&&a())}),50)}else a&&a()},fadeIn:function(e,t,a){if(e)if(e.playing||e.timer)a&&a();else{var i=hrnow();e.volume=0,this.updateNode(e,"play"),e.timer=setInterval((function(){var r=(hrnow()-i)/t;r>1&&(r=1),e.volume=e.startVolume*r,$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.updateNode(e,"setvolume"),1==r&&(clearInterval(e.timer),e.timer=null,a&&a())}),50)}}}),$8c2ed76c3be599228cd92e613ce51103$export$default.Audio=function(e,t=null){return{type:"audio",wrapper:"Sound",src:e,...t}};var $e0fe2a194133545b94a50a8849a2aba0$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({r:null,__ctor:function(e){if("audios"!=e.type)throw new Error("Resource is not audios.");this.r=e,this.r.wrapper=this,this.r.track||(this.r.track="sfx"),this.r.mode||(this.r.mode="random"),this.track=$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default[this.r.track.toUpperCase()],this.sounds=[],this.lastIndex=-1;for(var t=0;t<this.r.data.length;t++)this.sounds.push(new $c1b17ff2c1cc00f8fa2d10063393a8ec$export$default(Object.assign(this.r.data[t],{track:this.r.track})))},getRandomSound:function(){return"random"==this.r.mode?this.sounds[randr(0,this.sounds.length-1)]:(this.lastIndex=++this.lastIndex%this.sounds.length,this.sounds[this.lastIndex])},play:function(e,t){return $c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.play(this.getRandomSound(),e,t)},playLoop:function(e,t){return $c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.playLoop(this.getRandomSound(),e,t)},playAt:function(e,t,a){return $c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.play(this.sounds[e%this.sounds.length],t,a)},playLoopAt:function(e,t,a){return $c1b17ff2c1cc00f8fa2d10063393a8ec$export$default.playLoop(this.sounds[e%this.sounds.length],t,a)}});const $c300508ff8318f231a03f90d08d1052b$export$Drawable=$1650bdc66a81ddb41761abeffd23210b$export$default;$parcel$export($c300508ff8318f231a03f90d08d1052b$exports,"Drawable",(function(){return $c300508ff8318f231a03f90d08d1052b$export$Drawable}));const $c300508ff8318f231a03f90d08d1052b$export$Placeholder=$58dab9516df16ec182238d2ca8a1defb$export$default;$parcel$export($c300508ff8318f231a03f90d08d1052b$exports,"Placeholder",(function(){return $c300508ff8318f231a03f90d08d1052b$export$Placeholder}));const $c300508ff8318f231a03f90d08d1052b$export$Spritesheet=$627725a412dfe14c915059cb52478808$export$default;$parcel$export($c300508ff8318f231a03f90d08d1052b$exports,"Spritesheet",(function(){return $c300508ff8318f231a03f90d08d1052b$export$Spritesheet}));const $c300508ff8318f231a03f90d08d1052b$export$SpritesheetAnimation=$e342b055560c491aa3816f3d2921580a$export$default;$parcel$export($c300508ff8318f231a03f90d08d1052b$exports,"SpritesheetAnimation",(function(){return $c300508ff8318f231a03f90d08d1052b$export$SpritesheetAnimation}));const $c300508ff8318f231a03f90d08d1052b$export$SpriteFont=$7348ebe4152ceb8aef436e181a4ab9b7$export$default;$parcel$export($c300508ff8318f231a03f90d08d1052b$exports,"SpriteFont",(function(){return $c300508ff8318f231a03f90d08d1052b$export$SpriteFont}));const $c300508ff8318f231a03f90d08d1052b$export$Sound=$c1b17ff2c1cc00f8fa2d10063393a8ec$export$default;$parcel$export($c300508ff8318f231a03f90d08d1052b$exports,"Sound",(function(){return $c300508ff8318f231a03f90d08d1052b$export$Sound}));const $c300508ff8318f231a03f90d08d1052b$export$SoundArray=$e0fe2a194133545b94a50a8849a2aba0$export$default;$parcel$export($c300508ff8318f231a03f90d08d1052b$exports,"SoundArray",(function(){return $c300508ff8318f231a03f90d08d1052b$export$SoundArray}));var $3a1f3760b46e848362e1421ba143903d$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"PriorityQueue",queue:null,queueKeys:null,order:null,__ctor:function(){this.queue={},this.queueKeys=[]},add:function(e){if(null==e)return null;if(!("priority"in e))throw new Error("PriorityQueue (add): Object has no `priority` property.");return e.priority in this.queue||(this.queue[e.priority]={is_dirty:!1,list:[]},this.queueKeys.push(e.priority),this.order=Object.keys(this.queue).sort(((e,t)=>e-t))),-1===this.queue[e.priority].list.indexOf(e)&&this.queue[e.priority].list.push(e),e},remove:function(e){if(null==e)return null;if(!("priority"in e))throw new Error("PriorityQueue (remove): Object has no `priority` property.");if(!(e.priority in this.queue))return e;let t=this.queue[e.priority].list.indexOf(e);return-1===t||(this.queue[e.priority].is_dirty=!0,this.queue[e.priority].list[t]=null),e},cleanup:function(){for(let e=0;e<this.queueKeys.length;e++){let t=this.queue[this.queueKeys[e]];if(t.is_dirty){for(let e=0;e<t.list.length;e++)null==t.list[e]&&(console.log("CLEANUP CALLED"),t.list[e--].splice(1,0));t.is_dirty=!1}}},forEach:function(e){let t=!1,a=!1;for(let i=0;!a&&i<this.order.length;i++){let r=this.queue[this.order[i]].list;for(let i=0;!a&&i<r.length;i++)null!=r[i]&&!1===e(r[i])&&(a=!0),null==r[i]&&(t=!0)}t&&this.cleanup()},forEachRev:function(e){let t=!1,a=!1;for(let i=this.order.length-1;!a&&i>=0;i--){let r=this.queue[this.order[i]].list;for(let i=r.length-1;!a&&i>=0;i--)null!=r[i]&&!1===e(r[i])&&(a=!0),null==r[i]&&(t=!0)}t&&this.cleanup()},forEachAsync:function(e,t=null){let a=this,i=!1,r=!1,n=-1,s=-1,c=null,o=function(){s++,!r&&s<c.length?(null!=c[s]&&!1===e(c[s],o)&&(r=!0),null==c[s]&&(i=!0),r&&o()):f()},f=function(){n++,!r&&n<a.order.length?(c=a.queue[a.order[n]].list,s=-1,o()):(i&&a.cleanup(),t&&t())};f()},forEachRevAsync:function(e){alert("NOT IMPLEMENTED: forEachRevAsync")}});const $25417dbe89218903ba33a32ca568e9df$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Callback",callback:null,context:null,arg1:null,arg2:null,arg3:null,arg4:null,prev:null,next:null,init:function(e,t=null,a=null,i=null,r=null,n=null){return this.callback=e,this.context=t,this.arg1=a,this.arg2=i,this.arg3=r,this.arg4=n,this.prev=null,this.next=null,this},__dtor:function(){this.callback=null,this.context=null,this.arg1=null,this.arg2=null,this.arg3=null,this.arg4=null,this.prev=null,this.next=null},isEqual:function(e=null,t=null,a=null,i=null,r=null,n=null){return null!==e&&$25417dbe89218903ba33a32ca568e9df$export$default.isInstance(e)?e===this:(null===e||this.callback===e)&&((null===t||this.context===t)&&((null===a||this.arg1===a)&&((null===i||this.arg2===i)&&((null===r||this.arg3===r)&&(null===n||this.arg4===n)))))},exec:function(e){return null===this.callback||this.callback(e,this.context,this.arg1,this.arg2,this.arg3,this.arg4)}});$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($25417dbe89218903ba33a32ca568e9df$export$default,16384,6144);const $b24b690628e515896a9fe69710f34dc4$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Handler",host:null,top:null,bottom:null,init:function(e){return this.host=e,this.top=null,this.bottom=null,this},__dtor:function(){this.remove()},add:function(e,t=null,a=null,i=null,r=null,n=null){let s=$25417dbe89218903ba33a32ca568e9df$export$default.isInstance(e)?e:$25417dbe89218903ba33a32ca568e9df$export$default.alloc().init(e,t,a,i,r,n);return s.prev=this.bottom,null!==this.bottom&&(this.bottom.next=s),this.bottom=s,null===this.top&&(this.top=s),s},unlink:function(e){e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),this.top===e&&(this.top=e.next),this.bottom===e&&(this.bottom=e.prev),e.prev=null,e.next=null,dispose(e)},remove:function(e=null,t=null,a=null,i=null,r=null,n=null){if(null!==e&&$25417dbe89218903ba33a32ca568e9df$export$default.isInstance(e))return this.unlink(e),this;let s=this.top;for(;null!==s;){let c=s.next;s.isEqual(e,t,a,i,r,n)&&this.unlink(s),s=c}return this},find:function(e,t=null,a=null,i=null,r=null,n=null){let s=this.top;for(;null!==s;){if(s.isEqual(e,t,a,i,r,n))return s;s=s.next}return null},exec:function(){let e=this.top;for(;null!==e;){let t=e.next;!1===e.exec(this.host)&&this.unlink(e),e=t}},execf:function(e=null,t=null,a=null,i=null,r=null,n=null){let s=this.top;for(;null!==s;){let c=s.next;if(s.isEqual(e,t,a,i,r,n)){!1===s.exec(this.host)&&this.unlink(s);break}s=c}},execc:function(e){!1===e.exec(this.host)&&this.unlink(e)}});$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($b24b690628e515896a9fe69710f34dc4$export$default,16384,6144);const $cfea91c9ac660d2876bf91c30bd6a9f3$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Rect",cx:0,cy:0,x1:0,y1:0,x2:0,y2:0,init:function(e=null,t=null,a=null,i=null){return null===e?(this.x1=this.y1=this.x2=this.y2=this.cx=this.cy=0,this):null===a?(this.set(0,0,0,0),this.resize(e,t),this):this.set(e,t,a,i)},__dtor:function(){},clone:function(){return $cfea91c9ac660d2876bf91c30bd6a9f3$export$default.alloc().init(this.x1,this.y1,this.x2,this.y2)},zero:function(){return this.cx=0,this.cy=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this},reset:function(){return this.cx=null,this.cy=null,this.x1=null,this.y1=null,this.x2=null,this.y2=null,this},extendWithPoint:function(e,t=null){if(null===t){const a=e;e=a.x,t=a.y}return(null===this.x1||e<this.x1)&&(this.x1=e),(null===this.y1||t<this.y1)&&(this.y1=t),(null===this.x2||e>this.x2)&&(this.x2=e),(null===this.y2||t>this.y2)&&(this.y2=t),this.cx=(this.x1+this.x2)/2,this.cy=(this.y1+this.y2)/2,this},translate:function(e,t){return this.x1+=e,this.y1+=t,this.x2+=e,this.y2+=t,this.cx+=e,this.cy+=t,this},centerAt:function(e,t,a=!1){return 1==a&&(e=this.x1+e*(this.x2-this.x1),t=this.y1+t*(this.y2-this.y1)),this.translate(e-this.cx,t-this.cy)},set:function(e,t=null,a=null,i=null){if(null===t){const r=e;e=r.x1,t=r.y1,a=r.x2,i=r.y2}return this.cx=(e+a)/2,this.cy=(t+i)/2,this.x1=e,this.y1=t,this.x2=a,this.y2=i,this},equals:function(e,t=null,a=null,i=null){if(null===t){const r=e;e=r.x1,t=r.y1,a=r.x2,i=r.y2}return e==this.x1&&a==this.x2&&t==this.y1&&i==this.y2},contains:function(e,t=null,a=null,i=null){if(null===t){const r=e;e=r.x1,t=r.y1,a=r.x2,i=r.y2}return e==Math.max(this.x1,e)&&t==Math.max(this.y1,t)&&a==Math.min(this.x2,a)&&i==Math.min(this.y2,i)},setAsUnion:function(e,t=null,a=null,i=null){if(null===t){const r=e;e=r.x1,t=r.y1,a=r.x2,i=r.y2}return this.x1=Math.min(this.x1,e),this.y1=Math.min(this.y1,t),this.x2=Math.max(this.x2,a),this.y2=Math.max(this.y2,i),this},intersects:function(e,t=null,a=null,i=null){if(null===t){const r=e;e=r.x1,t=r.y1,a=r.x2,i=r.y2}let r=Math.max(this.x1,e),n=Math.max(this.y1,t),s=Math.min(this.x2,a),c=Math.min(this.y2,i);return Math.max(0,c-n)*Math.max(0,s-r)>0},setAsIntersection:function(e,t=null,a=null,i=null){if(null===t){const r=e;e=r.x1,t=r.y1,a=r.x2,i=r.y2}return this.x1=Math.max(this.x1,e),this.y1=Math.max(this.y1,t),this.x2=Math.min(this.x2,a),this.y2=Math.min(this.y2,i),Math.max(0,this.y2-this.y1)*Math.max(0,this.x2-this.x1)>0},resize:function(e,t,a=!1,i=!1){return 1==a&&(e*=this.x2-this.x1,t*=this.y2-this.y1),1==i?(this.x2=this.x1+e,this.y2=this.y1+t):(e/=2,t/=2,this.x1=this.cx-e,this.y1=this.cy-t,this.x2=this.cx+e,this.y2=this.cy+t),this},resizeBy:function(e,t,a=!1){return 1==a?(this.x2+=e,this.y2+=t):(e/=2,t/=2,this.x1-=e,this.y1-=t,this.x2+=e,this.y2+=t),this},width:function(){return this.x2-this.x1},height:function(){return this.y2-this.y1},ncx:function(){return(this.cx-this.x1)/(this.x2-this.x1)},ncy:function(){return(this.cy-this.y1)/(this.y2-this.y1)},isRight:function(){return this.x1<=this.x2&&this.y1<=this.y2},containsPoint:function(e,t,a=0){return this.x1-a<=e&&e<=this.x2+a&&this.y1-a<=t&&t<=this.y2+a},area:function(e){return e?this.isRight()?(this.y2-this.y1)*(this.x2-this.x1):0:(this.y2-this.y1)*(this.x2-this.x1)},floor:function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.floor(this.x2),this.y2=Math.floor(this.y2),this.cx=Math.floor(this.cx),this.cy=Math.floor(this.cy),this},ceil:function(){return this.x1=Math.ceil(this.x1),this.y1=Math.ceil(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this.cx=Math.ceil(this.cx),this.cy=Math.ceil(this.cy),this},toString:function(){return"("+this.x1.toFixed(2)+", "+this.y1.toFixed(2)+", "+this.x2.toFixed(2)+", "+this.y2.toFixed(2)+")"},flatten:function(){return[this.x1,this.y1,this.x2,this.y2]},unflatten:function(e){return this.set(e[0],e[1],e[2],e[3]),this}});$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($cfea91c9ac660d2876bf91c30bd6a9f3$export$default,4096,2048);const $9e7762fe4ba0e2d12cbcd459eadedcb7$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"TFunction",t:null,y:null,f:null,__ctor:function(e){this.reset(e)},reset:function(e=0){return this.t=[0],this.y=[e],this.f=[null],this},copyFrom:function(e,t,a){if(this.t=[],this.y=[],this.f=[],null==t&&null==a){for(let t=0;t<e.t.length;t++)this.t.push(e.t[t]),this.y.push(e.y[t]),this.f.push(e.f[t]);return this}null==t&&(t=e.t[0]),null==a&&(a=e.t[e.t.length-1]),t<e.t[0]&&(t=e.t[0]);let i=e.find(t),r=e.find(a);if(null==i)return null;if(null==r)return null;e.t[i]!=t&&(this.set(t,e.getAt(t),e.f[i]),i++);for(let t=i;t<=r;t++)this.set(e.t[t],e.y[t],e.f[t]);if(e.t[r]!=a){let t=(a-e.t[r])/Math.ceil(Math.log(a-e.t[r])),i=this.t[this.t.length-1];for(t<=0&&(t=1),t=a-i;i!=a;)i+t>a&&(t=a-i),i+=t,this.set(float4(i),e.getAt(i),e.f[r])}return this},clone:function(e,t){return(new $9e7762fe4ba0e2d12cbcd459eadedcb7$export$default).copyFrom(this,e,t)},endTime:function(e=0){return this.t[this.t.length-1]+e},startTime:function(e=0){return this.t[0]+e},find:function(e){if(e<this.t[0])return null;const t=this.t.length;for(let a=1;a<t;a++)if(e<this.t[a])return a-1;return t-1},set:function(e,t,a=null){let i=this.find(e);return null!=i&&(this.t[i]==e?(this.y[i]=t,null!=a&&(this.f[i]=a)):(i++,this.t.splice(i,0,e),this.y.splice(i,0,t),this.f.splice(i,0,a)),!0)},get:function(){return this.y[this.y.length-1]},getAt:function(e){let t=this.find(e);if(null==t)return 0;let a=t+1;if(this.t[t]==e||a>=this.t.length||this.y[t]==this.y[a]||null==this.f[t])return this.y[t];if(null==this.f[t])return this.y[t];let i=e,r=this.t[t],n=this.t[a],s=this.y[t],c=this.y[a];return e=(i-r)/(n-r),(e=this.f[t](e))*c+(1-e)*s},integral:function(e=null,t=null,a=0){null==e&&(e=this.t[0]),null==t&&(t=this.t[this.t.length-1]),e<this.t[0]&&(e=this.t[0]);let i=1;if(e>t){let a;a=e,e=t,t=a,i=-1}let r=a;for(let a=e;a<t;){let e=this.find(a);if(null==e)return 0;let i=e+1,n=Math.max(this.t[e],a),s=Math.min(i<this.t.length?this.t[i]:t,t),c=this.getAt(n),o=s-n,f=this.getAt(s)-c;null==this.f[e]?r+=c*o:r+=.5*f*(s+n)-n*f+c*o,a+=o}return i*r},second_integral:function(e=null,t=null,a=0){null==e&&(e=this.t[0]),null==t&&(t=this.t[this.t.length-1]);let i=$9e7762fe4ba0e2d12cbcd459eadedcb7$export$default.Temp1.copyFrom(this,this.t[0],e).integrate(a).integral();return $9e7762fe4ba0e2d12cbcd459eadedcb7$export$default.Temp2.copyFrom(this,this.t[0],t).integrate(a).integral()-i},integrate:function(e=0){let t=[];t.push(e);for(let e=1;e<this.t.length;e++)t.push(t[e-1]+this.integral(this.t[e-1],this.t[e]));return this.y=t,this},accumulate:function(e=0){this.y[0]+=e;for(let e=1;e<this.t.length;e++)this.y[e]+=this.y[e-1];return this},chopLeft:function(e){return this.t.splice(0,e),this.f.splice(0,e),this.y.splice(0,e),this},chopRight:function(e){return this.t.splice(e+1,this.t.length-e-1),this.f.splice(e+1,this.f.length-e-1),this.y.splice(e+1,this.y.length-e-1),this},map:function(e){for(let t=0;t<this.y.length;t++)this.y[t]=e(this.y[t],this.t[t],t);return this},toString:function(e=0){let t="",a=10;const i=function(e,t,a){for(e=e.toString(),null==a&&(a=" "),a=a[0];e.length<t;)e+=a;return e};t+="\n",t+=i(" Time",a)+" "+i(" Value",a)+" "+i(" Integral",a)+"\n",t+=i("",a,"-")+" "+i("",a,"-")+" "+i("",a,"-")+"\n";for(let r=0;r<this.t.length;r++)t+=i(" "+float4(this.t[r]),a)+" "+i(" "+float4(this.y[r]),a)+" "+i(" "+float4(this.integral(this.t[0],this.t[r],e)),a)+"\n";return t}});$9e7762fe4ba0e2d12cbcd459eadedcb7$export$default.Temp1=new $9e7762fe4ba0e2d12cbcd459eadedcb7$export$default,$9e7762fe4ba0e2d12cbcd459eadedcb7$export$default.Temp2=new $9e7762fe4ba0e2d12cbcd459eadedcb7$export$default;const $915b1937740c478df54f3272021d2c1c$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Point2",ux:0,uy:0,x:0,y:0,init:function(e=null,t=null){return this.set(e,t)},downscale:function(){return this.x=downscale(this.ux),this.y=downscale(this.uy),this},clone:function(){return $915b1937740c478df54f3272021d2c1c$export$default.alloc().init(this)},set:function(e,t=null,a=!1){return null===e?(e=0,t=0):null===t?$915b1937740c478df54f3272021d2c1c$export$default.isInstance(e)?(t=e.uy,e=e.ux):(t=upscale(e.y),e=upscale(e.x)):a||(e=upscale(e),t=upscale(t)),this.ux=e,this.uy=t,this.downscale(this)},setX:function(e){return this.ux=upscale(e),this.downscale(this)},setY:function(e){return this.uy=upscale(e),this.downscale(this)},zero:function(){return this.set(0,0)},isZero:function(){return 0==this.x&&0==this.y},equals:function(e,t=null){return null===t?$915b1937740c478df54f3272021d2c1c$export$default.isInstance(e)?(t=e.y,e=e.x):(t=int(e.y),e=int(e.x)):(e=int(e),t=int(t)),this.x==e&&this.y==t},add:function(e,t=null,a=!1){return null===t?$915b1937740c478df54f3272021d2c1c$export$default.isInstance(e)?(t=e.uy,e=e.ux):(t=upscale(e.y),e=upscale(e.x)):a||(e=upscale(e),t=upscale(t)),this.ux+=e,this.uy+=t,this.downscale()},sub:function(e,t,a=!1){return null===t?$915b1937740c478df54f3272021d2c1c$export$default.isInstance(e)?(t=e.uy,e=e.ux):(t=upscale(e.y),e=upscale(e.x)):a||(e=upscale(e),t=upscale(t)),this.ux-=e,this.uy-=t,this.downscale()},toString:function(){return`(${this.x}, ${this.y})`}});$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($915b1937740c478df54f3272021d2c1c$export$default,2048,1024);const $c1c2b815c89b9264ed0e554223c27659$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Bounds2",cx:0,cy:0,x1:0,y1:0,x2:0,y2:0,ucx:0,ucy:0,ux1:0,uy1:0,ux2:0,uy2:0,init:function(e=null,t=null,a=null,i=null,r=!1){return null===e?(this.ux1=this.uy1=this.ux2=this.uy2=this.ucx=this.ucy=0,this.downscale()):null!==t&&null===a?this.set(0,0,0,0).resize(e,t):this.set(e,t,a,i,r)},downscale:function(){return this.x1=downscale(this.ux1),this.y1=downscale(this.uy1),this.x2=downscale(this.ux2),this.y2=downscale(this.uy2),this.cx=downscale(this.ucx),this.cy=downscale(this.ucy),this},trunc:function(){return this.ux1=upscale(this.x1),this.uy1=upscale(this.y1),this.ux2=upscale(this.x2),this.uy2=upscale(this.y2),this.ucx=upscale(this.cx),this.ucy=upscale(this.cy),this},clone:function(){return $c1c2b815c89b9264ed0e554223c27659$export$default.alloc().init(this.ux1,this.uy1,this.ux2,this.uy2,!0)},zero:function(){return this.ux1=0,this.uy1=0,this.ux2=0,this.uy2=0,this.ucx=0,this.ucy=0,this.downscale()},reset:function(){return this.ux1=null,this.uy1=null,this.ux2=null,this.uy2=null,this.ucx=null,this.ucy=null,this.x1=null,this.y1=null,this.x2=null,this.y2=null,this.cx=null,this.cy=null,this},translate:function(e,t=null,a=!1){return null===t?$915b1937740c478df54f3272021d2c1c$export$default.isInstance(e)?(t=e.uy,e=e.ux):(t=upscale(e.y),e=upscale(e.x)):a||(e=upscale(e),t=upscale(t)),this.ux1+=e,this.uy1+=t,this.ux2+=e,this.uy2+=t,this.ucx+=e,this.ucy+=t,this.downscale()},set:function(e,t=null,a=null,i=null,r=!1){return null===t?$c1c2b815c89b9264ed0e554223c27659$export$default.isInstance(e)?(i=e.uy2,a=e.ux2,t=e.uy1,e=e.ux1):(i=upscale(e.y2),a=upscale(e.x2),t=upscale(e.y1),e=upscale(e.x1)):r||(e=upscale(e),t=upscale(t),a=upscale(a),i=upscale(i)),this.ux1=e,this.uy1=t,this.ux2=a,this.uy2=i,this.ucx=e+a>>1,this.ucy=t+i>>1,this.downscale()},add:function(e,t=null,a=null,i=null,r=!1){return null===t?$c1c2b815c89b9264ed0e554223c27659$export$default.isInstance(e)?(i=e.uy2,a=e.ux2,t=e.uy1,e=e.ux1):(i=upscale(e.y2),a=upscale(e.x2),t=upscale(e.y1),e=upscale(e.x1)):r||(e=upscale(e),t=upscale(t),a=upscale(a),i=upscale(i)),this.ux1+=e,this.uy1+=t,this.ux2+=a,this.uy2+=i,this.ucx+=e+a>>1,this.ucy+=t+i>>1,this.downscale()},equals:function(e,t=null,a=null,i=null){return null===t?$c1c2b815c89b9264ed0e554223c27659$export$default.isInstance(e)?(i=e.y2,a=e.x2,t=e.y1,e=e.x1):(i=int(e.y2),a=int(e.x2),t=int(e.y1),e=int(e.x1)):(e=int(e),t=int(t),a=int(a),i=int(i)),e==this.x1&&a==this.x2&&t==this.y1&&i==this.y2},contains:function(e,t=null,a=null,i=null){return null===t?$c1c2b815c89b9264ed0e554223c27659$export$default.isInstance(e)?(i=e.y2,a=e.x2,t=e.y1,e=e.x1):(i=int(e.y2),a=int(e.x2),t=int(e.y1),e=int(e.x1)):(e=int(e),t=int(t),a=int(a),i=int(i)),e==Math.max(this.x1,e)&&t==Math.max(this.y1,t)&&a==Math.min(this.x2,a)&&i==Math.min(this.y2,i)},setAsUnion:function(e,t=null,a=null,i=null){if(null===t){if($c1c2b815c89b9264ed0e554223c27659$export$default.isInstance(e))return this.setAsUnion(e.ux1,e.uy1,!0),this.setAsUnion(e.ux2,e.uy2,!0),this;if($cfea91c9ac660d2876bf91c30bd6a9f3$export$default.isInstance(e))return this.setAsUnion(e.x1,e.y1),this.setAsUnion(e.x2,e.y2),this;$915b1937740c478df54f3272021d2c1c$export$default.isInstance(e)?(t=e.uy,e=e.ux):(t=upscale(e.y),e=upscale(e.x))}else{if(null!==i)return this.setAsUnion(e,t),this.setAsUnion(a,i),this;!0!==a&&(e=upscale(e),t=upscale(t))}return(null===this.ux1||e<this.ux1)&&(this.ux1=e),(null===this.uy1||t<this.uy1)&&(this.uy1=t),(null===this.ux2||e>this.ux2)&&(this.ux2=e),(null===this.uy2||t>this.uy2)&&(this.uy2=t),this.ucx=this.ux1+this.ux2>>1,this.ucy=this.uy1+this.uy2>>1,this.downscale()},intersects:function(e,t=null,a=null,i=null){null===t?$c1c2b815c89b9264ed0e554223c27659$export$default.isInstance(e)?(i=e.y2,a=e.x2,t=e.y1,e=e.x1):(i=int(e.y2),a=int(e.x2),t=int(e.y1),e=int(e.x1)):(e=int(e),t=int(t),a=int(a),i=int(i));let r=Math.max(this.x1,e),n=Math.max(this.y1,t),s=Math.min(this.x2,a),c=Math.min(this.y2,i);return Math.max(0,c-n)*Math.max(0,s-r)>0},setAsIntersection:function(e,t=null,a=null,i=null){return null===t?$c1c2b815c89b9264ed0e554223c27659$export$default.isInstance(e)?(i=e.y2,a=e.x2,t=e.y1,e=e.x1):(i=int(e.y2),a=int(e.x2),t=int(e.y1),e=int(e.x1)):(e=int(e),t=int(t),a=int(a),i=int(i)),this.ux1=upscale(Math.max(this.x1,e)),this.uy1=upscale(Math.max(this.y1,t)),this.ux2=upscale(Math.min(this.x2,a)),this.uy2=upscale(Math.min(this.y2,i)),this.ucx=this.ux1+this.ux2>>1,this.ucy=this.uy1+this.uy2>>1,this.downscale(),Math.max(0,this.uy2-this.uy1)*Math.max(0,this.ux2-this.ux1)>0},resize:function(e,t,a=!1){return e=upscale(e),t=upscale(t),!0===a?(this.ux2=this.ux1+e,this.uy2=this.uy1+t,this.ucx=this.ux1+this.ux2>>1,this.ucy=this.uy1+this.uy2>>1):(e>>=1,t>>=1,this.ux1=this.ucx-e,this.uy1=this.ucy-t,this.ux2=this.ucx+e,this.uy2=this.ucy+t),this.downscale()},resizeBy:function(e,t,a=!1){return e=upscale(e),t=upscale(t),!0===a?(this.ux2+=e,this.uy2+=t,this.ucx=this.ux1+this.ux2>>1,this.ucy=this.uy1+this.uy2>>1):(e>>=1,t>>=1,this.ux1-=e,this.uy1-=t,this.ux2+=e,this.uy2+=t),this.downscale()},width:function(){return this.x2-this.x1},height:function(){return this.y2-this.y1},isForward:function(){return this.ux1<=this.ux2&&this.uy1<=this.uy2},containsPoint:function(e,t,a=0){return e=upscale(e),t=upscale(t),a=upscale(a),this.ux1-a<=e&&e<=this.ux2+a&&this.uy1-a<=t&&t<=this.uy2+a},area:function(e=!1){return e?this.isForward()?(this.y2-this.y1)*(this.x2-this.x1):0:(this.y2-this.y1)*(this.x2-this.x1)},toString:function(){return"("+this.x1+", "+this.y1+", "+this.x2+", "+this.y2+")"},flatten:function(){return[this.ux1,this.uy1,this.ux2,this.uy2]},unflatten:function(e){return this.ux1=e[0],this.uy1=e[1],this.ux2=e[2],this.uy2=e[3],this.ucx=this.ux1+this.ux2>>1,this.ucy=this.uy1+this.uy2>>1,this.downscale()}});$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($c1c2b815c89b9264ed0e554223c27659$export$default,8192,3072);const $18f56a190a3a3ff5c8b7ebba0279c438$export$default={Linear:{IN:function(e){return e},OUT:function(e){return e},IN_OUT:function(e){return e}},Back:{k:1.70158,IN:function(e,t){return void 0===t&&(t=$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Back.k),e*e*((t+1)*e-t)},OUT:function(e,t){return 1-$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Back.IN(1-e,t)},IN_OUT:function(e,t){return e<.5?$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Back.IN(2*e,t)/2:$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Back.OUT(2*(e-.5),t)/2+.5}},Bounce:{getConst:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},IN:function(e){return 1-$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Bounce.getConst(1-e)},OUT:function(e){return $18f56a190a3a3ff5c8b7ebba0279c438$export$default.Bounce.getConst(e)},IN_OUT:function(e){return e<.5?(1-$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Bounce.getConst(1-2*e))/2:$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Bounce.getConst(2*(e-.5))/2+.5}},Circ:{IN:function(e){return 1-Math.sqrt(1-e*e)},OUT:function(e){return 1-$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Circ.IN(1-e)},IN_OUT:function(e){return e<.5?$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Circ.IN(2*e)/2:$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Circ.OUT(2*(e-.5))/2+.5}},Cubic:{IN:function(e){return e*e*e},OUT:function(e){return 1-$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Cubic.IN(1-e)},IN_OUT:function(e){return e<.5?$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Cubic.IN(2*e)/2:$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Cubic.OUT(2*(e-.5))/2+.5}},Expo:{IN:function(e){return Math.pow(2,12*(e-1))},OUT:function(e){return 1-Math.pow(2,-12*e)},IN_OUT:function(e){return(e*=2)<1?Math.pow(2,12*(e-1))/2:(2-Math.pow(2,-12*(e-1)))/2}},Power:{p:12,IN:function(e){return Math.pow(e,$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Power.p)},OUT:function(e){return 1-$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Power.IN(1-e)},IN_OUT:function(e){return e<.5?$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Power.IN(2*e)/2:$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Power.OUT(2*(e-.5))/2+.5}},Quad:{IN:function(e){return e*e},OUT:function(e){return 1-$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Quad.IN(1-e)},IN_OUT:function(e){return e<.5?$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Quad.IN(2*e)/2:$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Quad.OUT(2*(e-.5))/2+.5}},Quartic:{IN:function(e){return e*e*e*e},OUT:function(e){return 1-$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Quartic.IN(1-e)},IN_OUT:function(e){return e<.5?$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Quartic.IN(2*e)/2:$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Quartic.OUT(2*(e-.5))/2+.5}},Quintic:{IN:function(e){return e*e*e*e*e},OUT:function(e){return 1-$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Quintic.IN(1-e)},IN_OUT:function(e){return e<.5?$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Quintic.IN(2*e)/2:$18f56a190a3a3ff5c8b7ebba0279c438$export$default.Quintic.OUT(2*(e-.5))/2+.5}},Sine:{IN:function(e){return 1-Math.sin(1.5708*(1-e))},OUT:function(e){return Math.sin(1.5708*e)},IN_OUT:function(e){return(Math.cos(3.1416*e)-1)/-2}},Step:{IN:function(e){return 1!=e?0:1},OUT:function(e){return 1!=e?0:1},IN_OUT:function(e){return 1!=e?0:1}}},$b3f77e113c0f558ec76d4638522e74c8$var$PARALLEL={init:function(e,t=!1){if(!t)return e.block=$b3f77e113c0f558ec76d4638522e74c8$var$Block.calloc(),void(e.blocks=$9331e791bdadeac9afb7e80808da523d$export$default.calloc());let a;for(;null!=(a=e.block.commands.shift());){let t=$b3f77e113c0f558ec76d4638522e74c8$var$Block.calloc();t.add(a),e.blocks.push(t)}e.block.free(),e.block=null},update:function(e,t,a){if(!1===a.started){for(let e=a.blocks.top;null!==e;e=e.next)e.value.reset(t.time);a.started=!0}let i=t.time,r=0,n=0;for(let t=a.blocks.top;null!==t;t=t.next){let a=t.value.update(e);!0===a?r++:null===a&&n++,t.value.time>i&&(i=t.value.time)}return r+n==a.blocks.length&&(a.started=!1,t.time=i,!0)}},$b3f77e113c0f558ec76d4638522e74c8$var$SERIAL={init:function(e,t=!1){t||(e.block=$b3f77e113c0f558ec76d4638522e74c8$var$Block.calloc())},update:function(e,t,a){!1===a.started&&(a.block.reset(t.time),a.started=!0);let i=a.block.update(e);return!0!==i?i:(a.started=!1,t.time=a.block.time,!0)}},$b3f77e113c0f558ec76d4638522e74c8$var$REPEAT={init:function(e,t=!1){t||(e.block=$b3f77e113c0f558ec76d4638522e74c8$var$Block.calloc())},update:function(e,t,a){!1===a.started&&(a.block.reset(t.time),a._count=a.count,a.started=!0);let i=a.block.update(e);return!0!==i?i:a._count<=1?(a.started=!1,t.time=a.block.time,!0):(a.block.restart(),a._count--,!1)}},$b3f77e113c0f558ec76d4638522e74c8$var$SET={init:function(e,t=!1){},update:function(e,t,a){return e.setValue(a.field,e.getValue(a.field,a.value)),!0}},$b3f77e113c0f558ec76d4638522e74c8$var$RESTART={init:function(e,t=!1){},update:function(e,t,a){return t.restart(),!0}},$b3f77e113c0f558ec76d4638522e74c8$var$WAIT={init:function(e,t=!1){},update:function(e,t,a){return!1===a.started&&(a._duration="string"===$49a0a27d43075b98f896056be628f99a$export$Rin.typeOf(a.duration)?e.getValue(a.duration):a.duration,a.started=!0),!(e.time<t.time+a._duration)&&(a.started=!1,t.time+=a._duration,!0)}},$b3f77e113c0f558ec76d4638522e74c8$var$RANGE={init:function(e,t=!1){},update:function(e,t,a){!1===a.started&&(a._startValue=e.getValue(a.field,a.startValue),a._duration="string"===$49a0a27d43075b98f896056be628f99a$export$Rin.typeOf(a.duration)?e.getValue(a.duration):a.duration,a.started=!0),a._endValue=e.getValue(a.field,a.endValue,a._startValue);let i=1;return e.time<t.time+a._duration&&(i=(e.time-t.time)/a._duration),a.easing&&1!=i?e.setValue(a.field,a.easing(i)*(a._endValue-a._startValue)+a._startValue):e.setValue(a.field,i*(a._endValue-a._startValue)+a._startValue),1==i&&(a.started=!1,t.time+=a._duration,!0)}},$b3f77e113c0f558ec76d4638522e74c8$var$RAND={init:function(e,t=!1){},update:function(e,t,a){!1===a.started&&(a._duration="string"===$49a0a27d43075b98f896056be628f99a$export$Rin.typeOf(a.duration)?e.getValue(a.duration):a.duration,a._last=null,a.started=!0);let r=1;if(e.time<t.time+a._duration&&(r=(e.time-t.time)/a._duration),a.easing&&1!=r?a._cur=int(a.easing(r)*a.count):a._cur=int(r*a.count),a._cur!=a._last){let t=e.getValue(a.field);for(;;){if(int(Math.random()*(a.endValue-a.startValue+1))+a.startValue!=t)break}e.setValue(a.field,i),a._last=a._cur}return 1==r&&(a.started=!1,t.time+=a._duration,!0)}},$b3f77e113c0f558ec76d4638522e74c8$var$RANDT={init:function(e,t=!1){if(!t)return;let a=[];for(let t=0;t<e.count;t++)a.push(t%(e.endValue-e.startValue+1)+e.startValue);for(let t=e.count>>2;t>0;t--){let t=int(Math.random()*e.count),i=int(Math.random()*e.count),r=a[i];a[i]=a[t],a[t]=r}e.table=a},update:function(e,t,a){!1===a.started&&(a._duration="string"===$49a0a27d43075b98f896056be628f99a$export$Rin.typeOf(a.duration)?e.getValue(a.duration):a.duration,a.started=!0);let i,r=1;return e.time<t.time+a._duration&&(r=(e.time-t.time)/a._duration),i=a.easing&&1!=r?a.easing(r)*(a.count-1):r*(a.count-1),e.setValue(a.field,a.table[int((i+a.count)%a.count)]),1==r&&(a.started=!1,t.time+=a._duration,!0)}},$b3f77e113c0f558ec76d4638522e74c8$var$PLAY={init:function(e,t=!1){},update:function(e,t,a){return a.snd.play(),!0}},$b3f77e113c0f558ec76d4638522e74c8$var$EXEC={init:function(e,t=!1){},update:function(e,t,a){!1===a.started&&(a._last=e.time,a.started=!0);let i=e.time-a._last;a._last=e.time;let r=a.fn(i,e.data,e);return!0===r?(a.started=!1,!0):r}},$b3f77e113c0f558ec76d4638522e74c8$var$Block=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Anim_Block",commands:null,first:!0,current:!1,time:0,init:function(){return this.commands=$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),this.reset(0),this},__dtor:function(){this.clear(),this.commands.free()},add:function(e){return this.commands.push(e),e},clone:function(){throw new Error("NOT IMPLEMENTED CLONE ON ANIM")},clear:function(){return this.commands.clear(),this.reset(0),this},reset:function(e){return this.first=!0,this.current=null,this.time=e,this},restart:function(){return this.first=!0,this},isFinished:function(){return!0===this.first&&(this.current=this.commands.top,this.first=!1),null===this.current},update:function(e){for(;!this.isFinished();){let t=this.current.value.update(e,this);if(!0!==t)return t;this.current=this.current.next}return!0}});$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($b3f77e113c0f558ec76d4638522e74c8$var$Block,8192);const $b3f77e113c0f558ec76d4638522e74c8$var$Command=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Anim_Command",op:null,started:!1,field:null,value:null,duration:0,_duration:0,count:0,_count:0,startValue:0,_startValue:0,endValue:0,_endValue:0,easing:null,_cur:null,_last:null,block:null,blocks:null,table:null,snd:null,fn:null,init:function(e){return this.op=e,this.started=!1,this.block=null,this.blocks=null,this.table=null,this.snd=null,this.fn=null,e.init(this,!1),this},__dtor:function(){null!==this.block&&this.block.clear().free(),null!==this.blocks&&this.blocks.clear().free()},ready:function(){this.op.init(this,!0)},update:function(e,t){return this.op.update(e,t,this)}});$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($b3f77e113c0f558ec76d4638522e74c8$var$Command);const $b3f77e113c0f558ec76d4638522e74c8$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Anim",initialData:null,data:null,blockStack:null,cmdStack:null,timeScale:1,block:null,time:0,paused:!1,finished:!1,finishedCallback:null,finishedCallbackHandler:null,finishedCallbackContext:null,init:function(){return this.initialData={},this.data={},this.block=$b3f77e113c0f558ec76d4638522e74c8$var$Block.calloc(),this.blockStack=$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),this.cmdStack=$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),this.reset()},__dtor:function(){this.block.free(),this.blockStack.clear().free(),this.cmdStack.clear().free(),null!==this.finishedCallbackHandler&&this.finishedCallbackHandler.free(),null!==this.finishedCallbackContext&&this.finishedCallbackContext.free()},copyTo:function(e){return e.block=this.block.clone(),e.initialData=this.initialData,e.reset()},onFinished:function(e){return this.finishedCallback=e,this},then:function(e,t=null){return this.finishedCallback!==this.thenCallback&&(this.finishedCallback=this.thenCallback,null===this.finishedCallbackHandler?(this.finishedCallbackHandler=$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),this.finishedCallbackContext=$9331e791bdadeac9afb7e80808da523d$export$default.calloc()):(this.finishedCallbackHandler.reset(),this.finishedCallbackContext.reset())),this.finishedCallbackHandler.push(e),this.finishedCallbackContext.push(t),this},thenCallback:function(){if(!this.finishedCallbackHandler.length)return!1;let e=this.finishedCallbackContext.shift();this.finishedCallbackHandler.shift()(this,e)},clear:function(){return this.blockStack.clear(),this.cmdStack.clear(),this.block.clear(),this.paused=!1,this.finished=!1,this.time=0,this},reset:function(){return this.blockStack.clear(),this.cmdStack.clear(),this.block.reset(0),this.paused=!1,this.finished=!1,this.time=0,Object.assign(this.data,this.initialData),this},initial:function(e){return this.initialData=e,this.reset()},speed:function(e){return this.timeScale=e>0?e:1,this},output:function(e){return this.data=e,this},pause:function(){return this.paused=!0,this},resume:function(){return this.finished=!1,this.paused=!1,this},setValue:function(e,t){let a=this.data;if("string"!=typeof e)if("function"==typeof e)e(this,t);else{let i=0;for(;null!==a&&i<e.length-1;)a=a[e[i++]];a[e[i]]=t}else a[e]=t},getValue:function(e,t=null,a=null){let i=this.data;if("string"!=typeof e)if("function"==typeof e)i=e(this,null);else{let t=0;for(;null!==i&&t<e.length;)i=i[e[t++]]}else i=i[e];if(null===t&&(t=i),null===a&&(a=i),"string"==typeof t)switch(t[0]){case"+":t=a+Number(t.substr(1));break;case"-":t=a-Number(t.substr(1));break;default:t=Number(t)}else"function"==typeof t&&(t=t(i,a,this));return t},update:function(e){if(this.paused||this.block.isFinished())return!0;if(this.time+=e*this.timeScale*$b3f77e113c0f558ec76d4638522e74c8$export$default.timeScale,!0!==this.block.update(this))return!1;let t=this.finished,a=this.block.length,i=this.block;return this.finished=!0,!(!t&&null!==this.finishedCallback&&(!1===this.finishedCallback(this.data,this)&&(this.finishedCallback=null),this.block!==i||this.block.length!=a))||(this.resume(),!1)},prepareFieldName:function(e){return"function"==typeof e?e:-1!=e.indexOf(".")?e.split("."):e},parallel:function(){let e=this.block.add($b3f77e113c0f558ec76d4638522e74c8$var$Command.alloc().init($b3f77e113c0f558ec76d4638522e74c8$var$PARALLEL));return this.blockStack.push(this.block),this.cmdStack.push(e),this.block=e.block,this},serial:function(){let e=this.block.add($b3f77e113c0f558ec76d4638522e74c8$var$Command.alloc().init($b3f77e113c0f558ec76d4638522e74c8$var$SERIAL));return this.blockStack.push(this.block),this.cmdStack.push(e),this.block=e.block,this},repeat:function(e){let t=this.block.add($b3f77e113c0f558ec76d4638522e74c8$var$Command.alloc().init($b3f77e113c0f558ec76d4638522e74c8$var$REPEAT));return t.count=e,this.blockStack.push(this.block),this.cmdStack.push(t),this.block=t.block,this},end:function(){return this.cmdStack.pop().ready(),this.block=this.blockStack.pop(),this},set:function(e,t){let a=this.block.add($b3f77e113c0f558ec76d4638522e74c8$var$Command.alloc().init($b3f77e113c0f558ec76d4638522e74c8$var$SET));return a.field=this.prepareFieldName(e),a.value=t,this},restart:function(){return this.block.add($b3f77e113c0f558ec76d4638522e74c8$var$Command.alloc().init($b3f77e113c0f558ec76d4638522e74c8$var$RESTART)),this},wait:function(e){return this.block.add($b3f77e113c0f558ec76d4638522e74c8$var$Command.alloc().init($b3f77e113c0f558ec76d4638522e74c8$var$WAIT)).duration=e,this},range:function(e,t,a,i,r=null){let n=this.block.add($b3f77e113c0f558ec76d4638522e74c8$var$Command.alloc().init($b3f77e113c0f558ec76d4638522e74c8$var$RANGE));return n.field=this.prepareFieldName(e),n.duration=t,n.startValue=a,n.endValue=i,n.easing=r,this},rand:function(e,t,a,i,r,n=null){let s=this.block.add($b3f77e113c0f558ec76d4638522e74c8$var$Command.alloc().init($b3f77e113c0f558ec76d4638522e74c8$var$RAND));return s.field=this.prepareFieldName(e),s.duration=t,s.count=a,s.startValue=i,s.endValue=r,s.easing=n,this},randt:function(e,t,a,i,r,n){let s=this.block.add($b3f77e113c0f558ec76d4638522e74c8$var$Command.alloc().init($b3f77e113c0f558ec76d4638522e74c8$var$RANDT));return s.field=this.prepareFieldName(e),s.duration=t,s.count=a,s.startValue=i,s.endValue=r,s.easing=n,s.ready(),this},play:function(e){return this.block.add($b3f77e113c0f558ec76d4638522e74c8$var$Command.alloc().init($b3f77e113c0f558ec76d4638522e74c8$var$PLAY)).snd=e,this},exec:function(e){return this.block.add($b3f77e113c0f558ec76d4638522e74c8$var$Command.alloc().init($b3f77e113c0f558ec76d4638522e74c8$var$EXEC)).fn=e,this},_bounds_x1:function(e,t){if(null===t)return e.data.bounds.x1;e.data.translate(int(t)-e.data.bounds.x1,0)},_bounds_y1:function(e,t){if(null===t)return e.data.bounds.y1;e.data.translate(0,int(t)-e.data.bounds.y1)},setX:function(e){return this.set(this._bounds_x1,e)},setY:function(e){return this.set(this._bounds_y1,e)},position:function(e,t){return this.set(this._bounds_x1,e).set(this._bounds_y1,t)},translateX:function(e,t,a){return this.range(this._bounds_x1,e,null,(t<0?"-":"+")+Math.abs(t),a)},translateY:function(e,t,a){return this.range(this._bounds_y1,e,null,(t<0?"-":"+")+Math.abs(t),a)},translate:function(e,t,a,i,r=null){return this.parallel().range(this._bounds_x1,e,null,(t<0?"-":"+")+Math.abs(t),i).range(this._bounds_y1,e,null,(a<0?"-":"+")+Math.abs(a),r||i).end()},moveTo:function(e,t,a,i,r=null){return this.parallel().range(this._bounds_x1,e,null,t,i).range(this._bounds_y1,e,null,a,r||i).end()},moveX:function(e,t,a=null){return this.range(this._bounds_x1,e,null,t,a)},moveY:function(e,t,a=null){return this.range(this._bounds_y1,e,null,t,a)},scaleX:function(e,t,a){return this.range("sx",e,null,t,a)},scaleY:function(e,t,a){return this.range("sy",e,null,t,a)},scale:function(e,t,a,i,r=null){return this.parallel().range("sx",e,null,t,i).range("sy",e,null,a,r||i).end()},rotate:function(e,t,a){return this.range("angle",e,null,(t<0?"-":"+")+Math.abs(t),a)}});$b3f77e113c0f558ec76d4638522e74c8$export$default.timeScale=1,$b3f77e113c0f558ec76d4638522e74c8$export$default.speed=function(e){$b3f77e113c0f558ec76d4638522e74c8$export$default.timeScale=e>0?e:1},$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($b3f77e113c0f558ec76d4638522e74c8$export$default,8192);const $207b59440723904b38982ddc4272b61b$export$default={modules:new $3a1f3760b46e848362e1421ba143903d$export$default,register:function(e){return this.modules.add(e)},unregister:function(e){this.modules.remove(e),this.modules.cleanup()},startup:function(e=null){this.modules.forEachAsync(((e,t)=>{!1!==e.onStartup(t)&&t()}),e)},shutdown:function(e=null){this.modules.forEachAsyncRev(((e,t)=>{!1!==e.onShutdown(t)&&t()}),e)}};$207b59440723904b38982ddc4272b61b$export$default.Module=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Module",priority:5,__ctor:function(){$207b59440723904b38982ddc4272b61b$export$default.register(this)},__dtor:function(){$207b59440723904b38982ddc4272b61b$export$default.unregister(this)},onStartup:function(e){},onShutdown:function(e){}});const $7a341878b2625de6871f03e49d9ff35d$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"GridElement",id:null,bounds:null,flags:0,data:null,container:null,_grid_remove_node:null,remover:null,__ctor:function(e,t,a,i){this.bounds=$c1c2b815c89b9264ed0e554223c27659$export$default.calloc(),this.bounds.translate(e,t),this.bounds.resize(a,i,!0),this.flags=$7a341878b2625de6871f03e49d9ff35d$export$default.ALIVE|$7a341878b2625de6871f03e49d9ff35d$export$default.VISIBLE|$7a341878b2625de6871f03e49d9ff35d$export$default.DIRTY|$7a341878b2625de6871f03e49d9ff35d$export$default.DEPTH_FLAG,this.data=null,this.remover=$b24b690628e515896a9fe69710f34dc4$export$default.alloc().init(this)},__dtor:function(){this.alive(!1),this.remover.exec(),this.remover.free(),this.bounds.free()},setId:function(e){return this.id=e,this},setFlags:function(e){return this.flags|=e,this},clearFlags:function(e){return this.flags&=~e,this},getFlags:function(e,t=null){return null===t?(this.flags&e)===e:(this.flags&e)===t},setData:function(e){return this.data=e,this},getData:function(){return this.data},visible:function(e=null){return null===e?!!(this.flags&$7a341878b2625de6871f03e49d9ff35d$export$default.VISIBLE):(this.flags&=~$7a341878b2625de6871f03e49d9ff35d$export$default.VISIBLE,e&&(this.flags|=$7a341878b2625de6871f03e49d9ff35d$export$default.VISIBLE),this)},alive:function(e=null){return null===e?!!(this.flags&$7a341878b2625de6871f03e49d9ff35d$export$default.ALIVE):(this.flags&=~$7a341878b2625de6871f03e49d9ff35d$export$default.ALIVE,e&&(this.flags|=$7a341878b2625de6871f03e49d9ff35d$export$default.ALIVE),this)},dirty:function(e=null){return null===e?!!(this.flags&$7a341878b2625de6871f03e49d9ff35d$export$default.DIRTY):(this.flags&=~$7a341878b2625de6871f03e49d9ff35d$export$default.DIRTY,e&&(this.flags|=$7a341878b2625de6871f03e49d9ff35d$export$default.DIRTY),this)},depthFlagEnabled:function(e=null){return null===e?!!(this.flags&$7a341878b2625de6871f03e49d9ff35d$export$default.DEPTH_FLAG_ENABLED):(this.flags&=~$7a341878b2625de6871f03e49d9ff35d$export$default.DEPTH_FLAG_ENABLED,e&&(this.flags|=$7a341878b2625de6871f03e49d9ff35d$export$default.DEPTH_FLAG_ENABLED),this)},depthFlag:function(e=null){return null===e?!!(this.flags&$7a341878b2625de6871f03e49d9ff35d$export$default.DEPTH_FLAG):(this.flags&=~$7a341878b2625de6871f03e49d9ff35d$export$default.DEPTH_FLAG,e&&(this.flags|=$7a341878b2625de6871f03e49d9ff35d$export$default.DEPTH_FLAG),this)},remove:function(){return this.remover.exec(),this},sync:function(){return null!==this.container&&this.getFlags($7a341878b2625de6871f03e49d9ff35d$export$default.ALIVE|$7a341878b2625de6871f03e49d9ff35d$export$default.DIRTY)?(this.container.sync(this),this):this},resize:function(e,t){return this.flags|=$7a341878b2625de6871f03e49d9ff35d$export$default.DIRTY,this.bounds.resize(e,t,!0),this},resizeBy:function(e,t){return this.resize(this.bounds.width()+e,this.bounds.height()+t)},translate:function(e,t,a=!1){return this.flags|=$7a341878b2625de6871f03e49d9ff35d$export$default.DIRTY,this.bounds.translate(e,t,a),this},setPosition:function(e,t){return this.translate(upscale(e)-this.bounds.ux1,upscale(t)-this.bounds.uy1,!0)}});$7a341878b2625de6871f03e49d9ff35d$export$default.ALIVE=1,$7a341878b2625de6871f03e49d9ff35d$export$default.VISIBLE=2,$7a341878b2625de6871f03e49d9ff35d$export$default.DIRTY=4,$7a341878b2625de6871f03e49d9ff35d$export$default.DEPTH_FLAG_ENABLED=8,$7a341878b2625de6871f03e49d9ff35d$export$default.DEPTH_FLAG=16,$7a341878b2625de6871f03e49d9ff35d$export$default.USERDEF=256,$7a341878b2625de6871f03e49d9ff35d$export$default.LAST_FLAG=128,$7a341878b2625de6871f03e49d9ff35d$export$default.allocFlag=function(){let e=$7a341878b2625de6871f03e49d9ff35d$export$default.LAST_FLAG;if(1073741824===e)throw new Error("allocFlag: out of bit space to allocate another flag");return e<<=1,$7a341878b2625de6871f03e49d9ff35d$export$default.LAST_FLAG=e,e};const $5455570ea965ce03f28a7753614d671d$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Grid",grid:null,count:0,offsx:0,offsy:0,kx:0,ky:0,stride:0,verifyIntersection:!0,__ctor:function(e,t,a,i=null){e=1<<Math.ceil(Math.log2(e)),t=1<<Math.ceil(Math.log2(t)),this.offsx=e>>1,this.offsy=t>>1,a=Math.floor(Math.log2(a)),null===i&&(i=a),this.kx=a,this.ky=i;let r=e>>a,n=t>>i;this.grid=new Array(r*n).fill(null),this.stride=r},__dtor:function(){this.clear(),this.grid=null},clear:function(){for(let e=0;e<this.grid.length;e++){if(null===this.grid[e])continue;let t;for(;null!==(t=this.grid[e].shift());)t.remover.remove(this._remove,this),t.container=null,dispose(t);this.grid[e].free(),this.grid[e]=null}this.count=0},reset:function(){for(let e=0;e<this.grid.length;e++){if(null===this.grid[e])continue;let t;for(;null!==(t=this.grid[e].shift());)t.remover.remove(this._remove,this),t.container=null;this.grid[e].free(),this.grid[e]=null}this.count=0},add:function(e){if(!$7a341878b2625de6871f03e49d9ff35d$export$default.isInstance(e))throw new Error("argument must be a GridElement");let t=int(e.bounds.y1+this.offsy>>this.ky)*this.stride+int(e.bounds.x1+this.offsx>>this.kx);return!(t<0||t>=this.grid.length)&&(null===this.grid[t]&&(this.grid[t]=$9331e791bdadeac9afb7e80808da523d$export$default.calloc()),this.grid[t].push(e),this.count++,e.container=this,e._grid_remove_node=e.remover.add(this._remove,this,t,this.grid[t].bottom),!0)},_remove:function(e,t,a,i){return t.grid[a].remove(i),t.count--,e.container=null,!1},remove:function(e){return e.remover.execc(this._grid_remove_node),e},sync:function(e){e.clearFlags($7a341878b2625de6871f03e49d9ff35d$export$default.DIRTY);let t=e._grid_remove_node,a=int(e.bounds.y1+this.offsy>>this.ky)*this.stride+int(e.bounds.x1+this.offsx>>this.kx);return a<0||a>=this.grid.length?(e.remover.execc(t),!1):(t.arg1===a||(this.grid[t.arg1].remove(t.arg2),null===this.grid[a]&&(this.grid[a]=$9331e791bdadeac9afb7e80808da523d$export$default.calloc()),this.grid[a].push(e),t.arg1=a,t.arg2=this.grid[a].bottom),!0)},forEachInRegion:function(e,t,a,i,r){let n=(e.y1+this.offsy-(1<<this.ky-1)>>this.ky)*this.stride,s=(e.y2+this.offsy+(1<<this.ky-1)>>this.ky)*this.stride,c=e.x1+this.offsx-(1<<this.kx-1)>>this.kx,o=e.x2+this.offsx+(1<<this.kx-1)>>this.kx,f=this.grid.length-1;n<0&&(n=0),s<0&&(s=0),c<0&&(c=0),o<0&&(o=0),n>f&&(n=f),s>f&&(s=f),c>f&&(c=f),o>f&&(o=f);for(let l=n;l<=s;l+=this.stride)for(let d=c;d<=o;d++){let u=l+d;if(!(u>f||null===this.grid[u]))for(let f=this.grid[u].top;f;f=f.next)if(f.value.getFlags(t,a)&&(!this.verifyIntersection||!(l<=n+1||d<=c+1||l>=s-1||d>=o-1)||f.value.bounds.intersects(e))&&!1===i(f.value,r))return}},selectInRegion:function(e,t,a){let i=(e.y1+this.offsy-(1<<this.ky-1)>>this.ky)*this.stride,r=(e.y2+this.offsy+(1<<this.ky-1)>>this.ky)*this.stride,n=e.x1+this.offsx-(1<<this.kx-1)>>this.kx,s=e.x2+this.offsx+(1<<this.kx-1)>>this.kx,c=this.grid.length-1;i<0&&(i=0),r<0&&(r=0),n<0&&(n=0),s<0&&(s=0),i>c&&(i=c),r>c&&(r=c),n>c&&(n=c),s>c&&(s=c);let o=$9331e791bdadeac9afb7e80808da523d$export$default.calloc();for(let f=i;f<=r;f+=this.stride)for(let l=n;l<=s;l++){let d=f+l;if(!(d>c||null===this.grid[d]))for(let c=this.grid[d].top;c;c=c.next)c.value.getFlags(t,a)&&(this.verifyIntersection&&(f<=i+1||l<=n+1||f>=r-1||l>=s-1)&&!c.value.bounds.intersects(e)||o.push(c.value))}return o},countInRegion:function(e,t,a){let i=(e.y1+this.offsy-(1<<this.ky-1)>>this.ky)*this.stride,r=(e.y2+this.offsy+(1<<this.ky-1)>>this.ky)*this.stride,n=e.x1+this.offsx-(1<<this.kx-1)>>this.kx,s=e.x2+this.offsx+(1<<this.kx-1)>>this.kx,c=this.grid.length-1;i<0&&(i=0),r<0&&(r=0),n<0&&(n=0),s<0&&(s=0),i>c&&(i=c),r>c&&(r=c),n>c&&(n=c),s>c&&(s=c);let o=0;for(let f=i;f<=r;f+=this.stride)for(let l=n;l<=s;l++){let d=f+l;if(!(d>c||null===this.grid[d]))for(let c=this.grid[d].top;c;c=c.next)c.value.getFlags(t,a)&&(this.verifyIntersection&&(f<=i+1||l<=n+1||f>=r-1||l>=s-1)&&!c.value.bounds.intersects(e)||o++)}return o},selectFirst:function(e,t,a){let i=(e.y1+this.offsy-(1<<this.ky-1)>>this.ky)*this.stride,r=(e.y2+this.offsy+(1<<this.ky-1)>>this.ky)*this.stride,n=e.x1+this.offsx-(1<<this.kx-1)>>this.kx,s=e.x2+this.offsx+(1<<this.kx-1)>>this.kx,c=this.grid.length-1;i<0&&(i=0),r<0&&(r=0),n<0&&(n=0),s<0&&(s=0),i>c&&(i=c),r>c&&(r=c),n>c&&(n=c),s>c&&(s=c);for(let o=i;o<=r;o+=this.stride)for(let f=n;f<=s;f++){let l=o+f;if(!(l>c||null===this.grid[l]))for(let c=this.grid[l].top;c;c=c.next)if(c.value.getFlags(t,a)&&(!this.verifyIntersection||!(o<=i+1||f<=n+1||o>=r-1||f>=s-1)||c.value.bounds.intersects(e)))return c.value}return null}}),$165af1ab52f365e7ef649f223d1085b3$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Container",viewportBounds:null,width:0,height:0,zvalue:0,scene:null,flags:0,g:null,elementCount:0,drawCount:0,__ctor:function(e=32768,t=32768){this.width=e,this.height=t,this.flags=$165af1ab52f365e7ef649f223d1085b3$export$default.VISIBLE|$165af1ab52f365e7ef649f223d1085b3$export$default.DEPTH_FLAG},__dtor:function(){},visible:function(e=null){return null===e?!!(this.flags&$165af1ab52f365e7ef649f223d1085b3$export$default.VISIBLE):(this.flags&=~$165af1ab52f365e7ef649f223d1085b3$export$default.VISIBLE,e&&(this.flags|=$165af1ab52f365e7ef649f223d1085b3$export$default.VISIBLE),this)},depthFlag:function(e=null){return null===e?!!(this.flags&$165af1ab52f365e7ef649f223d1085b3$export$default.DEPTH_FLAG):(this.flags&=~$165af1ab52f365e7ef649f223d1085b3$export$default.DEPTH_FLAG,e&&(this.flags|=$165af1ab52f365e7ef649f223d1085b3$export$default.DEPTH_FLAG),this)},setViewportBounds:function(e){return this.viewportBounds=e,this},drawElement:function(e,t){return t.drawCount++,e.draw(t.g)},syncZ:function(e){e.__zvalue=this.zvalue+e._zvalue+e.bounds.y2},sync:function(e){throw new Error("Container::sync not implemented")},clear:function(){throw new Error("Container::clear not implemented")},reset:function(){throw new Error("Container::reset not implemented")},add:function(e){throw new Error("Container::add not implemented")},remove:function(e){throw new Error("Container::remove not implemented")},draw:function(e){if(!this.visible())return;let t=e.pushDepthFlag(this.flags&$165af1ab52f365e7ef649f223d1085b3$export$default.DEPTH_FLAG);e.zvalue=this.zvalue,this.drawCount=0,this.g=e,this._draw(),t&&e.popDepthFlag()},_draw:function(){throw new Error("Container::draw not implemented")}});$165af1ab52f365e7ef649f223d1085b3$export$default.VISIBLE=1,$165af1ab52f365e7ef649f223d1085b3$export$default.DEPTH_FLAG=2;const $77b679f5ef01765d4ffd6be7d74228a2$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Viewport",width:0,height:0,sx:0,sy:0,x:0,y:0,centerRatioX:0,centerRatioY:0,offset:null,worldX1:0,worldY1:0,worldX2:0,worldY2:0,focusFactorX:0,focusFactorY:0,focusRect:null,focusOffsX:0,focusOffsY:0,flags:0,scale:1,globalScale:1,bounds:null,padding:null,focusBounds:null,screenBounds:null,__ctor:function(e,t,a,i,r,n,s,c){this.focusFactorX=null==s?.4:s,this.focusFactorY=null==c?.4:c,this.focusRect=null,this.sx=e,this.sy=t,this.width=a,this.height=i,this.x=0,this.y=0,this.bounds=$c1c2b815c89b9264ed0e554223c27659$export$default.alloc(),this.padding=null,this.focusBounds=$c1c2b815c89b9264ed0e554223c27659$export$default.alloc(),this.screenBounds=$c1c2b815c89b9264ed0e554223c27659$export$default.alloc(),this.offset=$915b1937740c478df54f3272021d2c1c$export$default.alloc(),this.flags=$77b679f5ef01765d4ffd6be7d74228a2$export$default.ENABLED,this.setWorldBounds(-r>>1,-n>>1,r>>1,n>>1),this.updateScreenBounds(),this.updateBounds()},__dtor:function(){this.bounds.free(),this.focusBounds.free(),this.screenBounds.free(),null!==this.padding&&this.padding.free()},enabled:function(e=null){return null===e?!!(this.flags&$77b679f5ef01765d4ffd6be7d74228a2$export$default.ENABLED):(this.flags&=~$77b679f5ef01765d4ffd6be7d74228a2$export$default.ENABLED,e&&(this.flags|=$77b679f5ef01765d4ffd6be7d74228a2$export$default.ENABLED),this)},setWorldBounds:function(e,t,a,i){return this.width>a-e&&(this.width=a-e),this.height>i-t&&(this.height=i-t),this.worldX1=e,this.worldY1=t,this.worldX2=a,this.worldY2=i,this},setPadding:function(e,t=null,a=null,i=null){return null===this.padding&&(this.padding=$c1c2b815c89b9264ed0e554223c27659$export$default.calloc()),this.padding.set(e,t,a,i),this},updateBounds:function(e=!1){let t=this.width>>1,a=this.height>>1,i=t/this.scale,r=a/this.scale,n=this.x-i+this.offset.x,s=this.y-r+this.offset.y,c=this.x+i+this.offset.x,o=this.y+r+this.offset.y;e&&(n<this.worldX1?this.offset.setX(this.worldX1-this.x+i):c>this.worldX2&&this.offset.setX(this.worldX2-this.x-i),s<this.worldY1?this.offset.setY(this.worldY1-this.y+r):o>this.worldY2&&this.offset.setY(this.worldY2-this.y-r),n=this.x-i+this.offset.x,s=this.y-r+this.offset.y,c=this.x+i+this.offset.x,o=this.y+r+this.offset.y),this.bounds.set(n,s,c,o),null!==this.padding&&this.bounds.add(this.padding),this.focusBounds.set(this.x-(this.focusFactorX*t+this.centerRatioX*t)/this.scale,this.y-(this.focusFactorY*a+this.centerRatioY*a)/this.scale,this.x+(this.focusFactorX*t+this.centerRatioX*t)/this.scale,this.y+(this.focusFactorY*a+this.centerRatioY*a)/this.scale)},updateScreenBounds:function(){this.screenBounds.set(this.sx,this.sy,this.sx+this.width,this.sy+this.height)},resize:function(e,t){return this.width=e,this.height=t,this.updateScreenBounds(),this.updateBounds(),this},resizeBy:function(e,t){return this.width+=e,this.height+=t,this.updateScreenBounds(),this.updateBounds(),this},setPosition:function(e,t){return this.x=e,this.y=t,this.offset.set(0,0),this.updateBounds(),this},setOffsets:function(e,t){return this.offset.set(e,t),this.updateBounds(),this},setScale:function(e){return this.scale=e,this.updateScreenBounds(),this.updateBounds(),this},setGlobalScale:function(e){return this.globalScale=e,this},setCenter:function(e,t){return this.centerRatioX=e,this.centerRatioY=t,this},translate:function(e,t,a=!1){return this.offset.add(e,t),this.updateBounds(a),this},setScreenPosition:function(e,t){return this.sx=e,this.sy=t,this.updateScreenBounds(),this},getX:function(e=!1){return this.x+(e?0:this.offset.x)},getY:function(e=!1){return this.y+(e?0:this.offset.y)},getOffsetX:function(){return this.offset.x},getOffsetY:function(){return this.offset.y},getWidth:function(){return this.width},getHeight:function(){return this.height},getBounds:function(){return this.bounds},getScreenBounds:function(){return this.screenBounds},getFocusBounds:function(){return this.focusBounds},focusOn:function(e,t,a=null,i=null,r=null,n=null){null===r&&(r=this.focusFactorX),null===n&&(n=this.focusFactorY),null===a&&(a=e),null===i&&(i=t);let s=this.width>>1,c=this.height>>1,o=this.x-int((r*s+this.centerRatioX*s)/this.scale),f=this.x+int((r*s+this.centerRatioX*s)/this.scale),l=this.y-int((n*c+this.centerRatioY*c)/this.scale),d=this.y+int((n*c+this.centerRatioY*c)/this.scale);o==f&&(e=a=e+a>>1),l==d&&(t=i=t+i>>1);let u=this.x,h=this.y;e<o?u+=e-o:a>f&&(u+=a-f),t<l?h+=t-l:i>d&&(h+=i-d),o=u-s,f=u+s,l=h-c,d=h+c,o<this.worldX1&&(u=this.worldX1+s),f>this.worldX2&&(u=this.worldX2-s),l<this.worldY1&&(h=this.worldY1+c),d>this.worldY2&&(h=this.worldY2-c),this.x=u,this.y=h,this.updateBounds()},update:function(e){null!=this.focusRect&&this.focusOn(this.focusRect.x1,this.focusRect.y1,this.focusRect.x2,this.focusRect.y2)},setFocusRect:function(e,t=0,a=0){return this.focusRect=e,this.focusOffsX=t,this.focusOffsY=a,this.update(0),this},setFocusFactor:function(e,t){return this.focusFactorX=e,this.focusFactorY=void 0===t?e:t,this},applyClip:function(e){e.clip(this.screenBounds.x1,this.screenBounds.y1,this.screenBounds.width(),this.screenBounds.height())},applyTransform:function(e){let t=this.screenBounds.x1+(this.screenBounds.width()>>1),a=this.screenBounds.y1+(this.screenBounds.height()>>1);e.translate(t,a),1!=this.scale&&e.scale(this.scale,this.scale),1!=this.globalScale&&e.scale(this.globalScale,this.globalScale),e.translate(-this.getX(),-this.getY()),e.updateTransform()},toWorldSpace:function(e,t,a=!1){let i=this.screenBounds.x1+(this.screenBounds.width()>>1),r=this.screenBounds.y1+(this.screenBounds.height()>>1);return a?(e=(e-int(i))/this.scale+int(this.getX()),t=(t-int(r))/this.scale+int(this.getY())):(e=(e-i)/this.scale+this.getX(),t=(t-r)/this.scale+this.getY()),{x:e,y:t}},toScreenSpace:function(e,t,a=!1){let i=this.screenBounds.x1+(this.screenBounds.width()>>1),r=this.screenBounds.y1+(this.screenBounds.height()>>1);return a?(e=(e-int(this.getX()))*this.scale+int(i),t=(t-int(this.getY()))*this.scale+int(r)):(e=(e-this.getX())*this.scale+i,t=(t-this.getY())*this.scale+r),{x:e,y:t}}});$77b679f5ef01765d4ffd6be7d74228a2$export$default.ENABLED=1;const $ddb647b88709c8dfd67dabab58120e2a$export$default=$7a341878b2625de6871f03e49d9ff35d$export$default.extend({className:"Element",group:null,img:null,debugBounds:!1,_zvalue:0,__zvalue:0,_alpha:1,_shaderProgram:null,_uniformSetter:null,__ctor:function(e,t,a=null,i=null,r=null){null===a&&(a=i=0),null===i&&(a=(r=a).width,i=r.height),this._super.GridElement.__ctor(e,t,a,i),this.img=null!==r?r.getDrawable():r,this.group=null,this.debugBounds=!1,this._zvalue=0,this.__zvalue=0,this._alpha=1,this._shaderProgram=null},__dtor:function(){null!==this.img&&(dispose(this.img),this.img=null),this._super.GridElement.__dtor()},destroyLater:function(){this.alive()&&(null!==this.container?this.container.scene.disposeLater(this):dispose(this))},alpha:function(e=null){return null===e?this._alpha:(this._alpha=e,this)},zvalue:function(e=null){return null===e?this._zvalue:(this._zvalue=e,this)},shaderProgram:function(e=!1){return!1===e?this._shaderProgram:(this._shaderProgram=e,this)},uniformSetter:function(e){return this._uniformSetter=e,this},draw:function(e){let t=null!==this._shaderProgram&&e.pushShaderProgram(this._shaderProgram),a=!!this.depthFlagEnabled()&&e.pushDepthFlag(this.depthFlag());if(null!==this._shaderProgram&&null!==this._uniformSetter&&null!==e.gl&&this._uniformSetter(this,e.gl,e.getShaderProgram()),e.zvalue=this.__zvalue,1!=this._alpha&&(e.pushAlpha(),e.alpha(this._alpha)),this.render(e),a&&e.popDepthFlag(),t&&e.popShaderProgram(),1!=this._alpha&&e.popAlpha(),$c5794ced0840f4a2f23c1c50dcedc59f$export$default.debugBounds||this.debugBounds){let t=System.displayBuffer2;t.pushMatrix(),t.loadMatrix(e.getMatrix()),t.fillStyle("rgba(0,255,255,0.5)"),t.fillRect(this.bounds.x1,this.bounds.y1,this.bounds.width(),this.bounds.height()),t.popMatrix()}},render:function(e){this.img.draw(e,this.bounds.x1,this.bounds.y1)}}),$ddb647b88709c8dfd67dabab58120e2a$var$Pool=$ddb647b88709c8dfd67dabab58120e2a$export$default.extend({className:"Element",__ctor:function(){},init:function(e,t,a=null,i=null,r=null){return this._super.Element.__ctor(e,t,a,i,r),this}});$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($ddb647b88709c8dfd67dabab58120e2a$var$Pool),$ddb647b88709c8dfd67dabab58120e2a$export$default.Pool=$ddb647b88709c8dfd67dabab58120e2a$var$Pool;const $4a2ddd0887254a2e40ee0a31b6575db9$var$tempPoint=$915b1937740c478df54f3272021d2c1c$export$default.calloc(),$4a2ddd0887254a2e40ee0a31b6575db9$export$default=$ddb647b88709c8dfd67dabab58120e2a$export$default.extend({className:"Group",children:null,ref:null,__ctor:function(e=null){this._super.Element.__ctor(0,0,0,0),this.children=$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),this.bounds.reset(),this.ref=$915b1937740c478df54f3272021d2c1c$export$default.calloc(),this.setId(e)},__dtor:function(){this.clear(),this.children.free(),this.ref.free(),this._super.Element.__dtor()},destroyLater:function(){if(!this.alive())return;let e;for(;null!=(e=this.children.shift());)e.remover.remove(this._remove,this),e.group=null,e.destroyLater();this._super.Element.destroyLater()},clear:function(){let e;for(;null!=(e=this.children.shift());)e.remover.remove(this._remove,this),e.group=null,dispose(e);return this},reset:function(){let e;for(;null!=(e=this.children.shift());)e.remover.remove(this._remove,this),e.group=null;return this},addChild:function(e=null){if(!e)return e;let t=null===this.bounds.x1;return(t||e.bounds.x1<this.bounds.x1)&&this.ltranslate(e.bounds.x1-this.bounds.x1,0),(t||e.bounds.y1<this.bounds.y1)&&this.ltranslate(0,e.bounds.y1-this.bounds.y1),(t||e.bounds.x2>this.bounds.x2)&&this.resizeBy(e.bounds.x2-this.bounds.x2,0),(t||e.bounds.y2>this.bounds.y2)&&this.resizeBy(0,e.bounds.y2-this.bounds.y2),this.children.push(e),null!==e.id&&(this[e.id]=e),e.group=this,e.remover.add(this._remove,this,this.children.bottom),e},_remove:function(e,t,a){return t.children.remove(a),e.group=null,null!==e.id&&(t[e.id]=null),!1},removeChild:function(e){return e&&e.group===this?(e.remover.execf(this._remove,this),e):e},sync:function(){for(let e=this.children.top;e;e=e.next)e.value.sync();return this._super.Element.sync()},ltranslate:function(e,t,a=!1){return this._super.Element.translate(e,t,a)},translate:function(e,t,a=!1){let i=this.bounds.x1,r=this.bounds.y1;this._super.Element.translate(e,t,a),this.ref.add(e,t,a),i=this.bounds.x1-i,r=this.bounds.y1-r;for(let e=this.children.top;e;e=e.next)e.value.translate(i,r);return this},getOffsets:function(e,t,a=!1){$4a2ddd0887254a2e40ee0a31b6575db9$var$tempPoint.set(this.bounds.ux1,this.bounds.uy1,!0);let i=$4a2ddd0887254a2e40ee0a31b6575db9$var$tempPoint.x,r=$4a2ddd0887254a2e40ee0a31b6575db9$var$tempPoint.y;return $4a2ddd0887254a2e40ee0a31b6575db9$var$tempPoint.add(e,t,a),i=$4a2ddd0887254a2e40ee0a31b6575db9$var$tempPoint.x-i,r=$4a2ddd0887254a2e40ee0a31b6575db9$var$tempPoint.y-r,$4a2ddd0887254a2e40ee0a31b6575db9$var$tempPoint.set(i,r),$4a2ddd0887254a2e40ee0a31b6575db9$var$tempPoint.x-=e,$4a2ddd0887254a2e40ee0a31b6575db9$var$tempPoint.y-=t,$4a2ddd0887254a2e40ee0a31b6575db9$var$tempPoint},setFlags:function(e){for(let t=this.children.top;t;t=t.next)t.value.setFlags(e);return this._super.Element.setFlags(e)},clearFlags:function(e){for(let t=this.children.top;t;t=t.next)t.value.clearFlags(e);return this._super.Element.clearFlags(e)},render:function(e){}}),$4a2ddd0887254a2e40ee0a31b6575db9$var$Pool=$4a2ddd0887254a2e40ee0a31b6575db9$export$default.extend({className:"Group",__ctor:function(){},init:function(e=null){return this._super.Group.__ctor(e),this}});$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($4a2ddd0887254a2e40ee0a31b6575db9$var$Pool),$4a2ddd0887254a2e40ee0a31b6575db9$export$default.Pool=$4a2ddd0887254a2e40ee0a31b6575db9$var$Pool;const $c71a3bc6e745875d5097e035813a6806$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Scene",minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,containers:null,viewports:null,viewportBounds:null,groupList:null,groups:null,disposalQueue:null,fupdater:null,updater:null,synchronizer:null,lupdater:null,destroyer:null,dt:0,flags:0,drawCount:0,scene:null,__ctor:function(){this.containers=[],this.viewports=[],this.viewportBounds=$c1c2b815c89b9264ed0e554223c27659$export$default.alloc(),this.groupList=$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),this.groups={},this.disposalQueue=$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),this.fupdater=$b24b690628e515896a9fe69710f34dc4$export$default.alloc().init(this),this.updater=$b24b690628e515896a9fe69710f34dc4$export$default.alloc().init(this),this.synchronizer=$b24b690628e515896a9fe69710f34dc4$export$default.alloc().init(this),this.lupdater=$b24b690628e515896a9fe69710f34dc4$export$default.alloc().init(this),this.destroyer=$b24b690628e515896a9fe69710f34dc4$export$default.alloc().init(this),this.flags=$c71a3bc6e745875d5097e035813a6806$export$default.VISIBLE,this.scene=this},__dtor:function(){let e;for(this.disposeQueued(),this.disposalQueue.free(),this.destroyer.exec(),this.destroyer.free(),this.fupdater.free(),this.updater.free(),this.synchronizer.free(),this.lupdater.free();null!==(e=this.groupList.shift());)e.remover.remove(this._remove,this),e.container=null,dispose(e);for(e=0;e<this.containers.length;e++)this.containers[e]&&(this.containers[e].scene=null,dispose(this.containers[e]),this.containers[e]=null);for(e=0;e<this.viewports.length;e++)this.viewports[e]&&(dispose(this.viewports[e]),this.viewports[e]=null);this.viewportBounds.free(),this.groupList.free()},visible:function(e=null){return null===e?!!(this.flags&$c71a3bc6e745875d5097e035813a6806$export$default.VISIBLE):(this.flags&=~$c71a3bc6e745875d5097e035813a6806$export$default.VISIBLE,e&&(this.flags|=$c71a3bc6e745875d5097e035813a6806$export$default.VISIBLE),this)},setContainer:function(e,t){if(e<0)return this;if(null===t)return this.containers[e].scene=null,this.containers[e]=null,this;if(!$165af1ab52f365e7ef649f223d1085b3$export$default.isInstance(t))throw new Error("Scene: Unable to set container at index "+e+": argument is not a Container");return(null===this.minWidth||t.width<this.minWidth)&&(this.minWidth=t.width),(null===this.minHeight||t.height<this.minHeight)&&(this.minHeight=t.height),(null===this.maxWidth||t.width>this.maxWidth)&&(this.maxWidth=t.width),(null===this.maxHeight||t.height>this.maxHeight)&&(this.maxHeight=t.height),t.scene=this,t.zvalue=1048576*e,this.containers[e]=t,this},getContainer:function(e){return e<0||e>=this.containers.length?null:this.containers[e]},setViewport:function(e,t){if(e<0)return this;if(null!==t&&!$77b679f5ef01765d4ffd6be7d74228a2$export$default.isInstance(t))throw new Error("Scene: Unable to set viewport at index "+e+": argument is not a Viewport.");return this.viewports[e]=t,this},getViewport:function(e){return e<0||e>=this.viewports.length?null:this.viewports[e]},disposeLater:function(e){e.alive()&&(this.disposalQueue.push(e),e.alive(!1))},disposeQueued:function(){let e;for(;null!==(e=this.disposalQueue.shift());)dispose(e)},addGroup:function(e){if(!$4a2ddd0887254a2e40ee0a31b6575db9$export$default.isInstance(e))throw new Error("argument must be a Group");return this.groupList.push(e),null!==e.id&&(this.groups[e.id]=e),e.container=this,e.remover.add(this._removeGroup,this,this.groupList.bottom),!0},_removeGroup:function(e,t,a){return e.container=null,t.groupList.remove(a),null!==e.id&&(t.groups[e.id]=null),!1},removeGroup:function(e){return e.remover.execf(this._remove,this),e},sync:function(e){return!0},draw:function(e){if(this.visible())if(this.drawCount=0,this.viewports.length)for(let t=0;t<this.viewports.length;t++){let a=this.viewports[t];a&&a.enabled()&&($c5794ced0840f4a2f23c1c50dcedc59f$export$default.viewport=a,e.pushClip(),e.pushMatrix(),a.applyClip(e),a.applyTransform(e),this.viewportBounds.set(a.getBounds()),this.drawContainers(e,this.viewportBounds),e.popMatrix(),e.popClip())}else this.drawContainers(e,null)},drawContainers:function(e,t){try{for(let a=0;a<this.containers.length;a++)this.containers[a]&&(this.containers[a].setViewportBounds(t),this.containers[a].draw(e),this.drawCount+=this.containers[a].drawCount)}catch(e){if("FRAME_END"!==e.message)throw e}},updateViewports:function(){for(let e=0;e<this.viewports.length;e++)this.viewports[e]&&this.viewports[e].update(this.dt)},update:function(e){this.dt=e,this.fupdater.exec(),this.updater.exec(),this.disposeQueued(),this.synchronizer.exec(),this.updateViewports(),this.lupdater.exec()}});$c71a3bc6e745875d5097e035813a6806$export$default.VISIBLE=1;const $90e0b89862e5a9d0c6d6cfe755cfd44f$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({className:"Updater",scene:null,list:null,__update:null,__context:null,__ctor:function(e,t=null,a=null){this.list=$9331e791bdadeac9afb7e80808da523d$export$default.calloc(),this.scene=e,this.__update=t,this.__context=a,this.scene.updater.add(this._update,this),this.scene.synchronizer.add(this._sync,this),this.scene.destroyer.add(this._destroy,this)},__dtor:function(){let e;for(this.scene.updater.remove(this._update,this),this.scene.synchronizer.remove(this._sync,this),this.scene.destroyer.remove(this._destroy,this);null!==(e=this.list.shift());)e.remover.remove(this._remove,this);this.list.free()},_destroy:function(e,t){dispose(t)},add:function(e){if(!$ddb647b88709c8dfd67dabab58120e2a$export$default.isInstance(e))throw new Error("argument must be an Element");return this.list.push(e),e.remover.add(this._remove,this,this.list.bottom),!0},_remove:function(e,t,a){return t.list.remove(a),!1},remove:function(e){return e.remover.execf(this._remove,this),e},_sync:function(e,t){for(let e=t.list.top;e;e=e.next)e.value.sync()},_update:function(e,t){t.update(e.dt)},update:function(e){if(null!==this.__update){let t=null;for(let a=this.list.top;a;a=t)t=a.next,this.__update(a.value,e,this.__context)}}});var $11afb610437a3710eee4c4e987daab23$export$default=$165af1ab52f365e7ef649f223d1085b3$export$default.extend({className:"SimpleContainer",list:null,__ctor:function(e,t){this._super.Container.__ctor(e,t),this.list=$9331e791bdadeac9afb7e80808da523d$export$default.calloc()},__dtor:function(){this.clear(),this.list.free(),this._super.Container.__dtor()},sync:function(e){return this.syncZ(e),!0},clear:function(){let e;for(;null!==(e=this.list.shift());)e.remover.remove(this._remove,this),e.container=null,dispose(e);this.elementCount=0},reset:function(){let e;for(;null!==(e=this.list.shift());)e.remover.remove(this._remove,this),e.container=null;this.elementCount=0},add:function(e){if(!$ddb647b88709c8dfd67dabab58120e2a$export$default.isInstance(e))throw new Error("argument must be an Element");return this.list.push(e),this.elementCount++,e.container=this,e.remover.add(this._remove,this,this.list.bottom),this.syncZ(e),!0},_remove:function(e,t,a){return t.list.remove(a),t.elementCount--,e.container=null,!1},remove:function(e){return e.remover.execf(this._remove,this),e},_draw:function(){let e=$7a341878b2625de6871f03e49d9ff35d$export$default.ALIVE|$7a341878b2625de6871f03e49d9ff35d$export$default.VISIBLE;for(let t=this.list.top;t&&(!t.value.getFlags(e)||!1!==this.drawElement(t.value,this));t=t.next);}}),$3199a6c942a7e5178eebb25dca4aec14$export$default=$165af1ab52f365e7ef649f223d1085b3$export$default.extend({className:"GridContainer",grid:null,debugBounds:!1,__ctor:function(e=32768,t=32768,a=64){this._super.Container.__ctor(e,t),this.grid=new $5455570ea965ce03f28a7753614d671d$export$default(e,t,a)},__dtor:function(){this.clear(),this._super.Container.__dtor()},sync:function(e){return this.syncZ(e),this.grid.sync(e)},clear:function(){this.grid.clear()},reset:function(){this.grid.reset()},add:function(e){if(!$ddb647b88709c8dfd67dabab58120e2a$export$default.isInstance(e))throw new Error("argument must be an Element");return!!this.grid.add(e)&&(e.container=this,this.elementCount=this.grid.count,this.syncZ(e),!0)},remove:function(e){return this.grid.remove(e),this.elementCount=this.grid.count,e},_draw:function(){this.grid.forEachInRegion(this.viewportBounds,$7a341878b2625de6871f03e49d9ff35d$export$default.ALIVE|$7a341878b2625de6871f03e49d9ff35d$export$default.VISIBLE,$7a341878b2625de6871f03e49d9ff35d$export$default.ALIVE|$7a341878b2625de6871f03e49d9ff35d$export$default.VISIBLE,this.drawElement,this);let e=this.g;if(!this.debugBounds||null===this.viewportBounds||null!==e.gl)return;let t=(this.viewportBounds.y1+this.grid.offsy-(1<<this.grid.ky-1)>>this.grid.ky)*this.grid.stride,a=(this.viewportBounds.y2+this.grid.offsy+(1<<this.grid.ky-1)>>this.grid.ky)*this.grid.stride,i=this.viewportBounds.x1+this.grid.offsx-(1<<this.grid.kx-1)>>this.grid.kx,r=this.viewportBounds.x2+this.grid.offsx+(1<<this.grid.kx-1)>>this.grid.kx;t=(int(t/this.grid.stride)<<this.grid.ky)-this.grid.offsy,a=(int(a/this.grid.stride)<<this.grid.ky)-this.grid.offsy+(1<<this.grid.ky),i=(i<<this.grid.kx)-this.grid.offsx,r=(r<<this.grid.kx)-this.grid.offsx+(1<<this.grid.kx),e.fillStyle("rgba(0,0,0,0.2)"),e.fillRect(i,t,r-i+1,a-t+1),t=this.viewportBounds.y1,a=this.viewportBounds.y2,i=this.viewportBounds.x1,r=this.viewportBounds.x2,e.lineWidth(1/$cabc4716fe90fb352f6039743eaed35c$export$default.canvasScaleFactor),e.strokeStyle("#000"),e.strokeRect(i,t,r-i+1,a-t+1),e.lineWidth(1/$cabc4716fe90fb352f6039743eaed35c$export$default.canvasScaleFactor),e.strokeStyle("#00f");for(let t=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.viewport.worldY1+this.grid.offsy;t<$c5794ced0840f4a2f23c1c50dcedc59f$export$default.viewport.worldY2+this.grid.offsy;t+=1<<this.grid.ky)for(let a=$c5794ced0840f4a2f23c1c50dcedc59f$export$default.viewport.worldX1+this.grid.offsx;a<$c5794ced0840f4a2f23c1c50dcedc59f$export$default.viewport.worldX2+this.grid.offsx;a+=1<<this.grid.kx)e.strokeRect(a-this.grid.offsx,t-this.grid.offsy,1<<this.grid.kx,1<<this.grid.ky)},forEachInRegion:function(e,t,a,i,r){this.grid.forEachInRegion(e,t,a,i,r)},selectInRegion:function(e,t,a){return this.grid.selectInRegion(e,t,a)},countInRegion:function(e,t,a){return this.grid.countInRegion(e,t,a)},selectFirst:function(e,t,a){return this.grid.selectFirst(e,t,a)}});const $4af5fc1fc3654d5b7c8a994ec4277c43$export$default=$ddb647b88709c8dfd67dabab58120e2a$export$default.extend({className:"Mask",type:0,__ctor:function(e,t,a,i,r){this._super.Element.__ctor(t,a,i,r),this.type=e},draw:function(e){let t=$cabc4716fe90fb352f6039743eaed35c$export$default.displayBuffer2;t.pushMatrix(),t.loadMatrix(e.getMatrix()),t.fillStyle("rgba(255,0,255,0.3)"),t.fillRect(this.bounds.x1,this.bounds.y1,this.bounds.width(),this.bounds.height()),t.popMatrix()}}),$4af5fc1fc3654d5b7c8a994ec4277c43$var$Pool=$4af5fc1fc3654d5b7c8a994ec4277c43$export$default.extend({className:"Mask",__ctor:function(){},init:function(e,t,a,i,r){return this._super.Mask.__ctor(e,t,a,i,r),this}});$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($4af5fc1fc3654d5b7c8a994ec4277c43$var$Pool),$4af5fc1fc3654d5b7c8a994ec4277c43$export$default.Pool=$4af5fc1fc3654d5b7c8a994ec4277c43$var$Pool;const $b664b2e615ac985908f37c542d9ee7e5$export$default=$ddb647b88709c8dfd67dabab58120e2a$export$default.extend({className:"Label",text:null,font:null,_ltext:null,_twidth:null,_theight:null,_align:-1,_valign:-1,_offsx:null,_offsy:null,__ctor:function(e,t,a,i){this._super.Element.__ctor(e,t,4,4),this.text=i,this.font=a},align:function(e){return this._align=e,this._offsx=null,this},valign:function(e){return this._valign=e,this._offsy=null,this},render:function(e){this.text!==this._ltext&&(this._twidth=this.font.measureWidth(this.text),this._theight=this.font.measureHeight(this.text),this._ltext=this.text),null===this._offsx&&(this._align<0?this._offsx=0:0===this._align?this._offsx=-this._twidth>>1:this._offsx=-this._twidth),null===this._offsy&&(this._valign<0?this._offsy=0:0===this._valign?this._offsy=-this._theight>>1:this._offsy=-this._theight),this.font.drawText(e,this.bounds.x1+this._offsx,this.bounds.y1+this._offsy,this.text)}}),$b664b2e615ac985908f37c542d9ee7e5$var$Pool=$b664b2e615ac985908f37c542d9ee7e5$export$default.extend({className:"Label",__ctor:function(){},init:function(e,t,a,i){return this._super.Label.__ctor(e,t,a,i),this}});$ccdbbc32fd9f0a412799511487cd91a1$export$default.attachTo($b664b2e615ac985908f37c542d9ee7e5$var$Pool),$b664b2e615ac985908f37c542d9ee7e5$export$default.Pool=$b664b2e615ac985908f37c542d9ee7e5$var$Pool;var $35ed923298b3cffd909d1e217a705010$export$default=$207b59440723904b38982ddc4272b61b$export$default.Module.create({handlers:null,__ctor:function(){const e=this;this._super.Module.__ctor(),this.handlers=new $3a1f3760b46e848362e1421ba143903d$export$default,this._callOnKeyboardEvent=function(t){return e.callOnKeyboardEvent(t)}},register:function(e){try{this.handlers.add(e),"init"in e&&e.init()}catch(e){throw new Error("KeyboardHandler (register): "+e.message)}return e},unregister:function(e){try{this.handlers.remove(e),this.handlers.cleanup()}catch(e){throw new Error("KeyboardHandler (unregister): "+e.message)}},callOnKeyboardEvent:function(e){return e.onKeyboardEvent(this._action,this._keyCode,this._keyState)},onStartup:function(){$cabc4716fe90fb352f6039743eaed35c$export$default.onKeyboardEvent=(e,t,a)=>{this._action=e,this._keyCode=t,this._keyState=a,this.handlers.forEach(this._callOnKeyboardEvent)}},onShutdown:function(){$cabc4716fe90fb352f6039743eaed35c$export$default.onKeyboardEvent=null}}),$80fe7598813bab8b70bdda84376bf98b$export$default=$207b59440723904b38982ddc4272b61b$export$default.Module.create({handlers:null,__ctor:function(){const e=this;this._super.Module.__ctor(),this.handlers=new $3a1f3760b46e848362e1421ba143903d$export$default,this._callOnPointerEvent=function(t){return e.callOnPointerEvent(t)}},register:function(e){try{this.handlers.add(e),"init"in e&&e.init()}catch(e){throw new Error("PointerHandler (register): "+e.message)}return e},unregister:function(e){try{this.handlers.remove(e),this.handlers.cleanup()}catch(e){throw new Error("PointerHandler (unregister): "+e.message)}},callOnPointerEvent:function(e){return e.onPointerEvent(this._action,this._p,this._pointers)},onStartup:function(){$cabc4716fe90fb352f6039743eaed35c$export$default.onPointerEvent=(e,t,a)=>{this._action=e,this._p=t,this._pointers=a,this.handlers.forEach(this._callOnPointerEvent)}},onShutdown:function(){$cabc4716fe90fb352f6039743eaed35c$export$default.onPointerEvent=null}});const $ed3917ac682376c75cf6afece38cd992$export$default={priority:5,list:[],dummy:{},hoverEnabled:!1,zindexEnabled:!1,lastFrame:0,add:function(e){this.zindexEnabled&&!("zindex"in e)&&(e.zindex=0),-1===this.list.indexOf(e)&&this.list.push(e)},remove:function(e){var t=this.list.indexOf(e);-1!==t&&this.list.splice(t,1)},setHoverEnabled:function(e){this.hoverEnabled=e},setZIndexEnabled:function(e){this.zindexEnabled=e},findTarget:function(e,t,a){if(this.zindexEnabled&&this.lastFrame!=$cabc4716fe90fb352f6039743eaed35c$export$default.frameNumber){let e=this.list[0].zindex;for(let t of this.list){if(t.zindex>e){this.list=this.list.sort(((e,t)=>t.zindex-e.zindex));break}e=t.zindex}this.lastFrame=$cabc4716fe90fb352f6039743eaed35c$export$default.frameNumber}for(let i=0;i<this.list.length;i++)if(this.list[i]&&(null==a||!1!==a(this.list[i]))&&this.list[i].containsPoint(e,t))return this.list[i];return null},filterHover:function(e){return"hover"in e},onPointerEvent:function(e,t,a){let i=!0,r=null;switch(e){case $cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_DOWN:null!=t._ref&&(r=t._ref,t._ref=null,r.pointerDeactivate(t)),r=this.findTarget(t.x,t.y),null!=r&&((t._ref=r).pointerActivate(t),i=!1);break;case $cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_DRAG_START:null!=t._ref&&(i=!1);break;case $cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_DRAG_MOVE:this.hoverEnabled&&(null!=t._refh?t._refh.containsPoint(t.x,t.y)||(r=t._refh,t._refh=null,r.hover(!1,t),r=this.findTarget(t.x,t.y,this.filterHover),null!=r&&(t._refh=r).hover(!0,t)):(r=this.findTarget(t.x,t.y,this.filterHover),null!=r&&(t._refh=r).hover(!0,t))),null!=t._ref?t._ref.containsPoint(t.x,t.y)||1==t._ref.focusLock?(t._ref.pointerUpdate(t.x,t.y,t),i=!1):(r=t._ref,t._ref=null,r.pointerDeactivate(t),r=this.findTarget(t.x,t.y),null!=r&&((t._ref=r).pointerActivate(t),i=!1)):(r=this.findTarget(t.x,t.y),null!=r&&((t._ref=r).pointerActivate(t),i=!1));break;case $cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_MOVE:if(this.hoverEnabled&&(null!=t._refh?t._refh.containsPoint(t.x,t.y)||(r=t._refh,t._refh=null,r.hover(!1,t),r=this.findTarget(t.x,t.y,this.filterHover),null!=r&&(t._refh=r).hover(!0,t)):(r=this.findTarget(t.x,t.y,this.filterHover),null!=r&&(t._refh=r).hover(!0,t))),null==t._ref)break;t._ref.containsPoint(t.x,t.y)||1==t._ref.focusLock?(t._ref.pointerUpdate(t.x,t.y,t),i=!1):(r=t._ref,t._ref=null,r.pointerDeactivate(t));break;case $cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_DRAG_STOP:null!=t._ref&&(i=!1);break;case $cabc4716fe90fb352f6039743eaed35c$export$default.EVT_POINTER_UP:null!=t._ref&&(r=t._ref,t._ref=null,r.pointerDeactivate(t),i=!1)}return i},onKeyboardEvent:function(e,t,a){switch(e){case $cabc4716fe90fb352f6039743eaed35c$export$default.EVT_KEY_DOWN:for(let e=0;e<this.list.length&&(!this.list[e]||!this.list[e].keyboardEvents||!1!==this.list[e].keyDown(t,a));e++);break;case $cabc4716fe90fb352f6039743eaed35c$export$default.EVT_KEY_UP:for(let e=0;e<this.list.length&&(!this.list[e]||!this.list[e].keyboardEvents||!1!==this.list[e].keyUp(t,a));e++);}}};$80fe7598813bab8b70bdda84376bf98b$export$default.register($ed3917ac682376c75cf6afece38cd992$export$default),$35ed923298b3cffd909d1e217a705010$export$default.register($ed3917ac682376c75cf6afece38cd992$export$default);var $b16c78d90a5735557317530efb31b314$export$default=$4a2ddd0887254a2e40ee0a31b6575db9$export$default.extend({focusLock:!1,keyboardEvents:!0,isPressed:!1,wasPressed:!1,unpressedImg:null,pressedImg:null,keyCode:null,hitbox:0,__ctor:function(e,t,a,i,r=null){this._super.Group.__ctor(),this.unpressedImg=i,this.pressedImg=r||i,this.hitbox=new $4af5fc1fc3654d5b7c8a994ec4277c43$export$default(0,t,a,i.width,i.height).visible(!1),this.addChild(this.hitbox),e.add(this.hitbox),e.add(this),$ed3917ac682376c75cf6afece38cd992$export$default.add(this)},__dtor:function(){this._super.Group.__dtor(),$ed3917ac682376c75cf6afece38cd992$export$default.remove(this)},setImage:function(e,t=null){return this.unpressedImg=e,this.pressedImg=t||e,this},setKeyCode:function(e){return this.keyCode=e,this},reset:function(){this.onChange(this.isPressed=!1,this.wasPressed=!1)},render:function(e){this.isPressed?this.pressedImg.draw(e,this.bounds.x1,this.bounds.y1):this.unpressedImg.draw(e,this.bounds.x1,this.bounds.y1)},pointerUpdate:function(e,t){},setStatus:function(e){return this.isPressed&&e||!this.isPressed&&!e||(this.updateStatus(e),this.onChange(this.isPressed,this.wasPressed)),this},updateStatus:function(e=null){return this.wasPressed=this.isPressed,this.isPressed=null===e?this.isPressed:e,this},pointerActivate:function(e){this.setStatus(!0)},pointerDeactivate:function(e){this.setStatus(!1)},containsPoint:function(e,t){return!!this.visible()&&this.hitbox.bounds.containsPoint(e,t)},onChange:function(e,t){e!=t&&(e?this.onButtonDown():this.onButtonUp()),!e&&t&&this.onTap()},keyDown:function(e){if(e===this.keyCode)return this.pointerActivate(),!1},keyUp:function(e,t){if(e===this.keyCode)return this.pointerDeactivate(),!1},onButtonDown:function(){},onButtonUp:function(){},onTap:function(){}}),$52910331a2e2e68437e9ccfbb34ae506$export$default=$4a2ddd0887254a2e40ee0a31b6575db9$export$default.extend({focusLock:!0,keyboardEvents:!0,status:0,lstatus:0,unpressedImg:null,pressedImg:null,unpressedImgInner:null,pressedImgInner:null,angleSteps:0,radiusSteps:0,rdirx:0,rdiry:0,dirx:0,diry:0,magnitude:0,angle:0,frdirx:0,frdiry:0,fdirx:0,fdiry:0,fmagnitude:0,fangle:0,dispx:0,dispy:0,radius:0,maxRadius:0,hitbox:0,__ctor:function(e,t,a,i,r,n,s=null,c=null){this._super.Group.__ctor(),this.unpressedImg=r,this.pressedImg=s||r,this.unpressedImgInner=n,this.pressedImgInner=c||n,this.maxRadius=i,this.hitbox=new $4af5fc1fc3654d5b7c8a994ec4277c43$export$default(0,t,a,r.width,r.height).visible(!1),this.addChild(this.hitbox),e.add(this.hitbox),e.add(this),$ed3917ac682376c75cf6afece38cd992$export$default.add(this)},__dtor:function(){this._super.Group.__dtor(),$ed3917ac682376c75cf6afece38cd992$export$default.remove(this)},setImage:function(e,t=null){return this.unpressedImg=e,this.pressedImg=t||e,this},setImageInner:function(e,t=null){return this.unpressedImgInner=e,this.pressedImgInner=t||e,this},setAngleSteps:function(e){return this.angleSteps=e,this},setRadiusSteps:function(e){return this.radiusSteps=e,this},reset:function(){this.dispx=0,this.dispy=0,this.rdirx=0,this.rdiry=0,this.dirx=0,this.diry=0,this.magnitude=0,this.onChange(this.dirx,this.diry,this.magnitude,this.angle)},render:function(e){this.status?(this.pressedImg.draw(e,this.bounds.x1,this.bounds.y1),this.pressedImgInner.draw(e,this.bounds.x1+this.dispx,this.bounds.y1+this.dispy)):(this.unpressedImg.draw(e,this.bounds.x1,this.bounds.y1),this.unpressedImgInner.draw(e,this.bounds.x1,this.bounds.y1))},pointerUpdate:function(e,t){let a=e-this.bounds.cx,i=t-this.bounds.cy;if(this.angle=Math.atan2(-i,a),this.radius=Math.sqrt(a*a+i*i),this.radius>this.maxRadius&&(this.radius=this.maxRadius),this.angleSteps){let e=2*Math.PI/this.angleSteps;this.angle=int((this.angle+Math.PI+e/2)/e)*e-Math.PI}if(this.radiusSteps){let e=this.maxRadius/this.radiusSteps;this.radius=int((this.radius+e/2)/e)*e}this.rdirx=Math.min(1,Math.max(a/this.maxRadius,-1)),this.rdiry=Math.min(1,Math.max(i/this.maxRadius,-1)),this.dispx=this.radius*Math.cos(this.angle),this.dispy=this.radius*-Math.sin(this.angle),this.radius>0?(this.dirx=this.dispx/this.radius,this.diry=this.dispy/this.radius,this.magnitude=this.radius/this.maxRadius):(this.dirx=0,this.diry=0,this.magnitude=0),this.onChange(this.dirx,this.diry,this.magnitude,this.angle)},pointerActivate:function(e){this.lstatus=this.status,this.status=1,this.pointerUpdate(e.x,e.y)},pointerDeactivate:function(e){this.lstatus=this.status,this.status=0,this.reset()},containsPoint:function(e,t){return!!this.visible()&&this.hitbox.bounds.containsPoint(e,t)},setDirection:function(e,t,a=.1,i=.1){return Math.abs(e)<a&&(e=0),Math.abs(t)<i&&(t=0),this.lstatus=this.status,this.status=0==e&&0==t?0:1,this.pointerUpdate(this.bounds.cx+e*this.maxRadius,this.bounds.cy+t*this.maxRadius),!1},freezeState:function(e=!1){return this.frdirx=e?0!=this.rdirx?this.rdirx:this.frdirx:this.rdirx,this.frdiry=e?0!=this.rdiry?this.rdiry:this.frdiry:this.rdiry,this.fdirx=e?0!=this.dirx?this.dirx:this.fdirx:this.dirx,this.fdiry=e?0!=this.diry?this.diry:this.fdiry:this.diry,this.fmagnitude=e?0!=this.magnitude?this.magnitude:this.fmagnitude:this.magnitude,this.fangle=e?0!=this.angle?this.angle:this.fangle:this.angle,this},keyDown:function(e,t){let a=0,i=0;if(!0===t[$ecb27258662111bab70dd084a4f71ebf$export$default.UP]&&(i=-this.maxRadius),!0===t[$ecb27258662111bab70dd084a4f71ebf$export$default.LEFT]&&(a=-this.maxRadius),!0===t[$ecb27258662111bab70dd084a4f71ebf$export$default.DOWN]&&(i=this.maxRadius),!0===t[$ecb27258662111bab70dd084a4f71ebf$export$default.RIGHT]&&(a=this.maxRadius),e===$ecb27258662111bab70dd084a4f71ebf$export$default.UP||e===$ecb27258662111bab70dd084a4f71ebf$export$default.LEFT||e===$ecb27258662111bab70dd084a4f71ebf$export$default.DOWN||e===$ecb27258662111bab70dd084a4f71ebf$export$default.RIGHT)return a=this.bounds.cx+a,i=this.bounds.cy+i,this.lstatus=this.status,this.status=1,this.pointerUpdate(a,i),!1},keyUp:function(e,t){let a=0,i=0;if(!0===t[$ecb27258662111bab70dd084a4f71ebf$export$default.UP]&&(i=-this.maxRadius),!0===t[$ecb27258662111bab70dd084a4f71ebf$export$default.LEFT]&&(a=-this.maxRadius),!0===t[$ecb27258662111bab70dd084a4f71ebf$export$default.DOWN]&&(i=this.maxRadius),!0===t[$ecb27258662111bab70dd084a4f71ebf$export$default.RIGHT]&&(a=this.maxRadius),e===$ecb27258662111bab70dd084a4f71ebf$export$default.UP||e===$ecb27258662111bab70dd084a4f71ebf$export$default.LEFT||e===$ecb27258662111bab70dd084a4f71ebf$export$default.DOWN||e===$ecb27258662111bab70dd084a4f71ebf$export$default.RIGHT)return this.pointerUpdate(this.bounds.cx+a,this.bounds.cy+i),0===a&&0===i&&(this.lstatus=this.status,this.status=0),!1},onChange:function(e,t,a,i){}}),$a3dd07e1619eee49527834a2575dfaf7$exports={};const $e5eba4110ff3df72a10d17329c1d81db$export$default={initialized:!1,screenWidth:0,screenHeight:0,renderer:null,time:0,dt:0,options:{gl:!0,log:!1,antialias:!1,background:"#000",orientation:"automatic",screenWidth:null,screenHeight:null,fps:144,minFps:10},init:function(e){return new Promise(((t,a)=>{if(this.initialized)return t();Object.assign(this.options,e),$8c2ed76c3be599228cd92e613ce51103$export$default.init({pixelated:!this.antialias}),$cabc4716fe90fb352f6039743eaed35c$export$default.init(this.options),$cabc4716fe90fb352f6039743eaed35c$export$default.updateQueueAdd({update:function(e){$e5eba4110ff3df72a10d17329c1d81db$export$default.time=$cabc4716fe90fb352f6039743eaed35c$export$default.frameTime,$e5eba4110ff3df72a10d17329c1d81db$export$default.dt=e}}),$207b59440723904b38982ddc4272b61b$export$default.startup((function(){$cabc4716fe90fb352f6039743eaed35c$export$default.start(),$e5eba4110ff3df72a10d17329c1d81db$export$default.screenWidth=$cabc4716fe90fb352f6039743eaed35c$export$default.screenWidth,$e5eba4110ff3df72a10d17329c1d81db$export$default.screenHeight=$cabc4716fe90fb352f6039743eaed35c$export$default.screenHeight,$e5eba4110ff3df72a10d17329c1d81db$export$default.renderer=$cabc4716fe90fb352f6039743eaed35c$export$default.renderer,$e5eba4110ff3df72a10d17329c1d81db$export$default.initialized=!0,!0===$e5eba4110ff3df72a10d17329c1d81db$export$default.options.log&&$4ca05bce8e5796b66097460c15da00c9$export$default.enable(),t()}))}))}},$1422277838a45a7c026d466d9d585c16$export$default={SCENE_MAIN:0,SCENE_HUD:1,LAYER_BG0:0,LAYER_BG1:1,LAYER_BG2:2,LAYER_MAIN:3,LAYER_FG0:4,LAYER_FG1:5,LAYER_FG2:6,LAYER_MASK:7,LAYER_HUD_BG:0,LAYER_HUD_FG:1,_scenes:[],activeScene:null,_viewports:[],activeViewport:null,activeContainer:null,activeGroup:null,lastGroup:null,lastElement:null,bounds:$c1c2b815c89b9264ed0e554223c27659$export$default.calloc(),init:function(e=32768,t=32768,a=null){null===a&&(a=Math.max(e,t)/512),a<32&&(a=32),this.bounds.zero().resize(e,t),this.createScene($1422277838a45a7c026d466d9d585c16$export$default.SCENE_MAIN),this.setContainer($1422277838a45a7c026d466d9d585c16$export$default.LAYER_BG0,new $3199a6c942a7e5178eebb25dca4aec14$export$default(e,t,a)),this.setContainer($1422277838a45a7c026d466d9d585c16$export$default.LAYER_BG1,new $3199a6c942a7e5178eebb25dca4aec14$export$default(e,t,a)),this.setContainer($1422277838a45a7c026d466d9d585c16$export$default.LAYER_BG2,new $3199a6c942a7e5178eebb25dca4aec14$export$default(e,t,a)),this.setContainer($1422277838a45a7c026d466d9d585c16$export$default.LAYER_MAIN,new $3199a6c942a7e5178eebb25dca4aec14$export$default(e,t,a)),this.setContainer($1422277838a45a7c026d466d9d585c16$export$default.LAYER_FG0,new $3199a6c942a7e5178eebb25dca4aec14$export$default(e,t,a)),this.setContainer($1422277838a45a7c026d466d9d585c16$export$default.LAYER_FG1,new $3199a6c942a7e5178eebb25dca4aec14$export$default(e,t,a)),this.setContainer($1422277838a45a7c026d466d9d585c16$export$default.LAYER_FG2,new $3199a6c942a7e5178eebb25dca4aec14$export$default(e,t,a)),this.setContainer($1422277838a45a7c026d466d9d585c16$export$default.LAYER_MASK,new $3199a6c942a7e5178eebb25dca4aec14$export$default(e,t,a)),this.getContainer($1422277838a45a7c026d466d9d585c16$export$default.LAYER_MASK).visible(!1),this.createViewport(0),this.createScene($1422277838a45a7c026d466d9d585c16$export$default.SCENE_HUD),this.setContainer($1422277838a45a7c026d466d9d585c16$export$default.LAYER_HUD_BG,new $11afb610437a3710eee4c4e987daab23$export$default($e5eba4110ff3df72a10d17329c1d81db$export$default.screenWidth,$e5eba4110ff3df72a10d17329c1d81db$export$default.screenHeight)),this.setContainer($1422277838a45a7c026d466d9d585c16$export$default.LAYER_HUD_FG,new $11afb610437a3710eee4c4e987daab23$export$default($e5eba4110ff3df72a10d17329c1d81db$export$default.screenWidth,$e5eba4110ff3df72a10d17329c1d81db$export$default.screenHeight))},createScene:function(e){this._scenes[e]&&($cabc4716fe90fb352f6039743eaed35c$export$default.queueRemove(this._scenes[e]),$parcel$global.dispose(this._scenes[e])),this._scenes[e]=new $c71a3bc6e745875d5097e035813a6806$export$default,$cabc4716fe90fb352f6039743eaed35c$export$default.queueAdd(this._scenes[e]),this.selectScene(e)},getScene:function(e=null){return null===e?this.activeScene:e<0||e>=this._scenes.length?null:this._scenes[e]},selectScene:function(e){return!(e<0||e>=this._scenes.length||!this._scenes[e])&&(this.activeScene=this._scenes[e],this.activeContainer=null,!0)},createViewport:function(e){if(null===this.activeScene)throw new Error("createViewport: use `selectScene` first to select the active scene.");this._viewports[e]&&($parcel$global.dispose(this._viewports[e]),this.activeScene.setViewport(e,null)),this._viewports[e]=new $77b679f5ef01765d4ffd6be7d74228a2$export$default(0,0,$e5eba4110ff3df72a10d17329c1d81db$export$default.screenWidth,$e5eba4110ff3df72a10d17329c1d81db$export$default.screenHeight,this.activeScene.maxWidth,this.activeScene.maxHeight,0,0),this.activeScene.setViewport(e,this._viewports[e]),this.selectViewport(e)},getViewport:function(e=null){return null===e?this.activeViewport:e<0||e>=this._viewports.length?null:this._viewports[e]},selectViewport:function(e){return!(e<0||e>=this._viewports.length||!this._viewports[e])&&(this.activeViewport=this._viewports[e],!0)},setContainer:function(e,t){if(null===this.activeScene)throw new Error("setContainer: use `selectScene` first to select the active scene.");return this.activeScene.setContainer(e,t),t},getContainer:function(e=null,t=!1){if(null===e){if(null===this.activeContainer&&t)throw new Error("getContainer: container index not specified and default container not set.");return this.activeContainer}if(null===this.activeScene)throw new Error("getContainer: use `selectScene` first to select the active scene.");let a=this.activeScene.getContainer(e);if(null===a&&t)throw new Error("getContainer: container index out of bounds.");return a},selectContainer:function(e){return this.activeContainer=this.getContainer(e,!0),null!==this.activeContainer},createGroup:function(e=null){if(null===this.activeScene)throw new Error("createGroup: use selectScene first to select the active scene.");return this.activeGroup=$4a2ddd0887254a2e40ee0a31b6575db9$export$default.Pool.alloc().init(e),this.activeScene.addGroup(this.activeGroup),this.activeGroup},endGroup:function(e=null,t=null){return null!==e&&this.activeGroup.translate(e,t),this.lastGroup=this.activeGroup,this.activeGroup=null,this.lastGroup.sync()},createElement:function(e,t,a,i=null,r=null){"string"!=typeof e&&(r=i,i=a,a=t,t=e,e=null);let n=this.getContainer(r),s=$ddb647b88709c8dfd67dabab58120e2a$export$default.Pool.alloc().init(t,a,i);return n.add(s.setId(e)),null!==this.activeGroup&&this.activeGroup.addChild(s),this.lastElement=s,s},createMask:function(e,t=null,a=null,i=null,r=null,n=null,s=null){"string"!=typeof e&&(s=n,n=r,r=i,i=a,a=t,t=e,e=null);let c=this.getContainer(s||$1422277838a45a7c026d466d9d585c16$export$default.LAYER_MASK);if(null===a){if(null===this.activeGroup)throw new Error("createMask: create a group first to use automatic masks");a=this.activeGroup.bounds.x1,i=this.activeGroup.bounds.y1,r=this.activeGroup.bounds.width(),n=this.activeGroup.bounds.height()}let o=$4af5fc1fc3654d5b7c8a994ec4277c43$export$default.Pool.alloc().init(t,a,i,r,n);return c.add(o.setId(e)),null!==this.activeGroup&&this.activeGroup.addChild(o),o},createLabel:function(e,t,a,i,r,n=null){"string"!=typeof e&&(n=r,r=i,i=a,a=t,t=e,e=null);let s=this.getContainer(n),c=$b664b2e615ac985908f37c542d9ee7e5$export$default.Pool.alloc().init(t,a,i,r);return s.add(c.setId(e)),null!==this.activeGroup&&this.activeGroup.addChild(c),this.lastElement=c,c},createUpdater:function(e=null,t=null){if(null===this.activeScene)throw new Error("createUpdater: use selectScene first to select the active scene.");return new $90e0b89862e5a9d0c6d6cfe755cfd44f$export$default(this.activeScene,e,t)}},$b88a0f3d43c562b107873a1a234d5d7e$export$default={},$be190108e7e5eded85f0df5fd9569fc6$export$default={load:function(e=null){return new Promise((function(t,a){$8c2ed76c3be599228cd92e613ce51103$export$default.load($b88a0f3d43c562b107873a1a234d5d7e$export$default,(function(t,a,i){e&&e(i)}),(function(){t()}))}))},get:function(e){return $b88a0f3d43c562b107873a1a234d5d7e$export$default[e]},__resIdMustNotExist:function(e){if(e in $b88a0f3d43c562b107873a1a234d5d7e$export$default)throw new Error("Resource identifier `"+e+"` is already in use")},placeholder:function(e,t,a,i){return this.__resIdMustNotExist(e),$b88a0f3d43c562b107873a1a234d5d7e$export$default[e]={type:"object",wrapper:"Placeholder",color:t,width:a,height:i}},image:function(e,t,a=null){return this.__resIdMustNotExist(e),$b88a0f3d43c562b107873a1a234d5d7e$export$default[e]={type:"image",wrapper:"Drawable",src:t,pixelated:null,...a}},spritesheet:function(e,t,a,i,r=0,n=null,s=null){return this.__resIdMustNotExist(e),$b88a0f3d43c562b107873a1a234d5d7e$export$default[e]={type:"image",wrapper:"Spritesheet",src:t,pixelated:null,config:{frameWidth:a,frameHeight:i,numFrames:r,...n},...s}},animation:function(e,t,a,i,r=0,n=null,s=null){return this.__resIdMustNotExist(e),$b88a0f3d43c562b107873a1a234d5d7e$export$default[e]={type:"image",wrapper:"SpritesheetAnimation",src:t,config:{frameWidth:a,frameHeight:i,numFrames:r,...n},anim:{def:null,fps:15,seq:{}},...s,fps:function(e){return this.anim.fps=e,this},seq:function(e,t,a,i=null){return this.anim.seq[e]={loop:t,group:a},null!==i&&(this.anim.seq[e].fps=i),this},def:function(e){return this.anim.def=e,this}}},spritefont:function(e,t,a,i,r,n=null,s=null){return this.__resIdMustNotExist(e),$b88a0f3d43c562b107873a1a234d5d7e$export$default[e]={type:"image",wrapper:"SpriteFont",src:t,font:{charWidth:a,charHeight:i,charset:r,...n},...s}},json:function(e,t,a=null){return this.__resIdMustNotExist(e),$b88a0f3d43c562b107873a1a234d5d7e$export$default[e]={type:"json",src:t,...a}},data:function(e,t,a=null){return this.__resIdMustNotExist(e),$b88a0f3d43c562b107873a1a234d5d7e$export$default[e]={type:"data",src:t,...a}},text:function(e,t,a=null){return this.__resIdMustNotExist(e),$b88a0f3d43c562b107873a1a234d5d7e$export$default[e]={type:"text",src:t,...a}}},$aacd3558e8e9ca1354b0d1183ba5d855$export$default=$49a0a27d43075b98f896056be628f99a$export$Class.extend({sticks:null,buttons:null,scene:null,container:null,_visible:!0,__ctor:function(e,t){this.sticks={},this.buttons={},this.scene=e,this.layer=e.getContainer(t),this.layer.depthFlag(!1)},addStick:function(e,t,a,i,r,n=0){0==n&&(n=i.width-r.width);let s=new $52910331a2e2e68437e9ccfbb34ae506$export$default(this.layer,t,a,n,i,r);return this.sticks[e]=s,this[e]=s,s},addButton:function(e,t,a,i,r=null){let n=new $b16c78d90a5735557317530efb31b314$export$default(this.layer,t,a,i,r);return this.buttons[e]=n,this[e]=n,n},visible:function(e=null){if(null===e)return this._visible;this._visible=e;for(let t in this.sticks)this.sticks[t].visible(e);for(let t in this.buttons)this.buttons[t].visible(e);return this},showMasks:function(e){for(let t in this.sticks)this.sticks[t].hitbox.visible(e);for(let t in this.buttons)this.buttons[t].hitbox.visible(e);return this}}),$a4ae765c3dc98a0352a37bbdea65ab3e$export$default={_gamepads:[],activeGamepad:null,createGamepad:function(e,t=null){if(null===$1422277838a45a7c026d466d9d585c16$export$default.activeScene)throw new Error("input.createGamepad: use world.selectScene first to select the active scene.");return this._gamepads[e]=new $aacd3558e8e9ca1354b0d1183ba5d855$export$default($1422277838a45a7c026d466d9d585c16$export$default.activeScene,null!==t?t:$1422277838a45a7c026d466d9d585c16$export$default.LAYER_HUD_FG),this},getGamepad:function(e){return e<0||e>=this._gamepads.length?null:this._gamepads[e]||null},selectGamepad:function(e){return this.activeGamepad=this.getGamepad(e),!0},debugGamepad:function(e,t){if(null!==e)this._gamepads[e].debug(t);else for(let e=0;e<this._gamepads.length;e++)this._gamepads[e]&&this.debugGamepad(e,t)},stick:function(e,t,a,i,r,n=0){if(null===this.activeGamepad)throw new Error("input.addStick: use input.selectGamepad first to select the active gamepad.");return this.activeGamepad.addStick(e,t,a,i,r,n)},button:function(e,t,a,i,r=null){if(null===this.activeGamepad)throw new Error("input.addButton: use input.selectGamepad first to select the active gamepad.");return this.activeGamepad.addButton(e,t,a,i,r)}},$0566a7d2aa90378ab389e9885ad3bbac$export$default={ACTION_TRUNCATE:1,ACTION_CALLBACK:2,CONTACT_LEFT:1,CONTACT_RIGHT:2,CONTACT_TOP:4,CONTACT_BOTTOM:8,FLAG_EXCLUDE:$7a341878b2625de6871f03e49d9ff35d$export$default.allocFlag(),futureBounds:$c1c2b815c89b9264ed0e554223c27659$export$default.calloc(),intersectionRect:$c1c2b815c89b9264ed0e554223c27659$export$default.calloc(),tempRect:$c1c2b815c89b9264ed0e554223c27659$export$default.calloc(),rules:{},scene:null,maskLayer:null,fupdater:null,lupdater:null,flagsAnd:0,flagsValue:0,truncated:!1,destroyed:!1,flags:0,numFlags:0,group:null,mask:null,collisionItem:null,offs:null,m_dx:0,m_dy:0,dx:0,dy:0,enable:function(e=null){this.scene=$1422277838a45a7c026d466d9d585c16$export$default.getScene(),this.maskLayer=$1422277838a45a7c026d466d9d585c16$export$default.getContainer(e||$1422277838a45a7c026d466d9d585c16$export$default.LAYER_MASK),this.flagsAnd=$7a341878b2625de6871f03e49d9ff35d$export$default.ALIVE|$7a341878b2625de6871f03e49d9ff35d$export$default.VISIBLE|$0566a7d2aa90378ab389e9885ad3bbac$export$default.FLAG_EXCLUDE,this.flagsValue=$7a341878b2625de6871f03e49d9ff35d$export$default.ALIVE|$7a341878b2625de6871f03e49d9ff35d$export$default.VISIBLE,this.scene.fupdater.add(this.update,this),this.fupdater=$b24b690628e515896a9fe69710f34dc4$export$default.alloc().init(this),this.lupdater=$b24b690628e515896a9fe69710f34dc4$export$default.alloc().init(this)},disable:function(){this.scene.fupdater.remove(this.update,this),this.maskLayer=null,this.fupdater.free(),this.lupdater.free()},update:function(e,t){t.fupdater.exec(),t.lupdater.exec()},later:{run:function(e,t,a,i,r){$0566a7d2aa90378ab389e9885ad3bbac$export$default.fupdater.add(this._run,e,t,a,i,r)},setVisible:function(e,t){$0566a7d2aa90378ab389e9885ad3bbac$export$default.fupdater.add(this._setVisible,e,t)},setFlags:function(e,t){$0566a7d2aa90378ab389e9885ad3bbac$export$default.fupdater.add(this._setFlags,e,t)},clearFlags:function(e,t){$0566a7d2aa90378ab389e9885ad3bbac$export$default.fupdater.add(this._clearFlags,e,t)},_run:function(e,t,a,i,r,n){return a(e,t,i,r,n),!1},_setVisible:function(e,t,a){return t.visible(a),!1},_setFlags:function(e,t,a){return t.setFlags(a),!1},_clearFlags:function(e,t,a){return t.clearFlags(a),!1}},add:function(e,t,a,i=null,r=null){"function"==typeof a&&(r=i,i=a,a=$0566a7d2aa90378ab389e9885ad3bbac$export$default.ACTION_CALLBACK),e in this.rules||(this.rules[e]={rules:{}}),this.rules[e].rules[t]={action:a,callback:i,context:r}},loadContactFlags:function(e,t){return this.flags=0,this.numFlags=0,e.x1==t.x1&&(this.flags|=$0566a7d2aa90378ab389e9885ad3bbac$export$default.CONTACT_LEFT,this.numFlags++),e.x2==t.x2&&(this.flags|=$0566a7d2aa90378ab389e9885ad3bbac$export$default.CONTACT_RIGHT,this.numFlags++),e.y1==t.y1&&(this.flags|=$0566a7d2aa90378ab389e9885ad3bbac$export$default.CONTACT_TOP,this.numFlags++),e.y2==t.y2&&(this.flags|=$0566a7d2aa90378ab389e9885ad3bbac$export$default.CONTACT_BOTTOM,this.numFlags++),this.flags},truncate:function(){1==this.numFlags||0!=this.dx&&0!=this.dy||(0==this.dx?this.flags&=12:this.flags&=3,this.numFlags=1),1!=this.numFlags&&this.intersectionRect.width()!=this.intersectionRect.height()&&(this.intersectionRect.width()>this.intersectionRect.height()?this.flags&=12:this.flags&=3,this.numFlags=1),1!=this.numFlags&&(1&this.flags&&this.dx<=0&&(this.flags&=-2,this.numFlags--),2&this.flags&&this.dx>=0&&(this.flags&=-3,this.numFlags--),4&this.flags&&this.dy<=0&&(this.flags&=-5,this.numFlags--),8&this.flags&&this.dy>=0&&(this.flags&=-9,this.numFlags--)),1!=this.numFlags?(this.tempRect.set(this.mask.bounds).translate(this.offs.x+this.dx,0),0==this.maskLayer.countInRegion(this.tempRect,this.flagsAnd,this.flagsValue)?this.dy=0:(this.tempRect.set(this.mask.bounds).translate(0,this.offs.y+this.dy),0==this.maskLayer.countInRegion(this.tempRect,this.flagsAnd,this.flagsValue)?this.dx=0:(console.log($cabc4716fe90fb352f6039743eaed35c$export$default.frameNumber+": MOVEMENT ISSUE "+this.mask.type.toString(16)),this.dx=0,this.dy=0))):(1&this.flags?this.dx=this.collisionItem.bounds.x1-this.mask.bounds.x2:2&this.flags&&(this.dx=this.collisionItem.bounds.x2-this.mask.bounds.x1),4&this.flags?this.dy=this.collisionItem.bounds.y1-this.mask.bounds.y2:8&this.flags&&(this.dy=this.collisionItem.bounds.y2-this.mask.bounds.y1)),this.truncated=!0},commit:function(e=!1){this.group.alive()&&(0==this.dx&&0==this.dy&&null!==this.m_dx&&null!==this.m_dy||((null===this.m_dx||Math.abs(this.dx)<Math.abs(this.m_dx))&&(this.m_dx=this.dx),(null===this.m_dy||Math.abs(this.dy)<Math.abs(this.m_dy))&&(this.m_dy=this.dy),this.dx=0,this.dy=0),!0===e&&(0==this.m_dx&&0==this.m_dy||this.group.translate(this.m_dx,this.m_dy),this.group.clearFlags($0566a7d2aa90378ab389e9885ad3bbac$export$default.FLAG_EXCLUDE)))},translate:function(e,t,a,i){if(this.group=e,this.mask=t,this.truncated=!1,this.destroyed=!1,this.m_dx=null,this.m_dy=null,this.dx=a=downscalef(upscale(a)),this.dy=i=downscalef(upscale(i)),!this.maskLayer)return this.commit(!0);let r=this.rules[t.type];if(!r)return this.commit(!0);this.offs=e.getOffsets(this.dx,this.dy),this.futureBounds.set(t.bounds).translate(this.offs.x+this.dx,this.offs.y+this.dy),e.setFlags($0566a7d2aa90378ab389e9885ad3bbac$export$default.FLAG_EXCLUDE);let n=this.maskLayer.selectInRegion(this.futureBounds,this.flagsAnd,this.flagsValue);if(0===n.length)return n.free(),this.commit(!0);for(;this.collisionItem=n.shift(),null!==this.collisionItem;){let e=r.rules[this.collisionItem.type];if(e)if(this.intersectionRect.set(this.collisionItem.bounds).setAsIntersection(this.futureBounds),this.loadContactFlags(this.intersectionRect,this.collisionItem.bounds),this.flags){switch(this.dx=a,this.dy=i,e.action){case $0566a7d2aa90378ab389e9885ad3bbac$export$default.ACTION_TRUNCATE:this.truncate();break;case $0566a7d2aa90378ab389e9885ad3bbac$export$default.ACTION_CALLBACK:e.callback(t,this.collisionItem,e.context)}if(!t.alive()){this.destroyed=!0;break}this.commit()}else console.log($cabc4716fe90fb352f6039743eaed35c$export$default.frameNumber+": "+t.type.toString(16)+" INSIDE OF "+this.collisionItem.type.toString(16))}n.free(),this.commit(!0)},check:function(e,t){this.translate(e,t,0,0)}},$a3dd07e1619eee49527834a2575dfaf7$export$sys=$e5eba4110ff3df72a10d17329c1d81db$export$default;$parcel$export($a3dd07e1619eee49527834a2575dfaf7$exports,"sys",(function(){return $a3dd07e1619eee49527834a2575dfaf7$export$sys}));const $a3dd07e1619eee49527834a2575dfaf7$export$world=$1422277838a45a7c026d466d9d585c16$export$default;$parcel$export($a3dd07e1619eee49527834a2575dfaf7$exports,"world",(function(){return $a3dd07e1619eee49527834a2575dfaf7$export$world}));const $a3dd07e1619eee49527834a2575dfaf7$export$r=$b88a0f3d43c562b107873a1a234d5d7e$export$default;$parcel$export($a3dd07e1619eee49527834a2575dfaf7$exports,"r",(function(){return $a3dd07e1619eee49527834a2575dfaf7$export$r}));const $a3dd07e1619eee49527834a2575dfaf7$export$res=$be190108e7e5eded85f0df5fd9569fc6$export$default;$parcel$export($a3dd07e1619eee49527834a2575dfaf7$exports,"res",(function(){return $a3dd07e1619eee49527834a2575dfaf7$export$res}));const $a3dd07e1619eee49527834a2575dfaf7$export$input=$a4ae765c3dc98a0352a37bbdea65ab3e$export$default;$parcel$export($a3dd07e1619eee49527834a2575dfaf7$exports,"input",(function(){return $a3dd07e1619eee49527834a2575dfaf7$export$input}));const $a3dd07e1619eee49527834a2575dfaf7$export$collider=$0566a7d2aa90378ab389e9885ad3bbac$export$default;$parcel$export($a3dd07e1619eee49527834a2575dfaf7$exports,"collider",(function(){return $a3dd07e1619eee49527834a2575dfaf7$export$collider}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Class=$49a0a27d43075b98f896056be628f99a$export$Class;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Class",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Class}));const $0c9c00c2409eb95b5e4d849b566b4428$export$globals=$c5794ced0840f4a2f23c1c50dcedc59f$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"globals",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$globals}));const $0c9c00c2409eb95b5e4d849b566b4428$export$System=$cabc4716fe90fb352f6039743eaed35c$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"System",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$System}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Timer=$b82d452f2e3484b177bea709fd7b4383$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Timer",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Timer}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Random=$883e395d0b2123d7f53561ada8782bc4$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Random",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Random}));const $0c9c00c2409eb95b5e4d849b566b4428$export$KeyCodes=$ecb27258662111bab70dd084a4f71ebf$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"KeyCodes",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$KeyCodes}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Canvas=$3c56105c2000e8ab7d1a19dceac231fb$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Canvas",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Canvas}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Perf=$363800ec3de62fddc1d9a5e33a6b17dc$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Perf",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Perf}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Log=$4ca05bce8e5796b66097460c15da00c9$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Log",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Log}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Shader=$e16e0ad9a75d38a76c35e0b8847ef4a3$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Shader",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Shader}));const $0c9c00c2409eb95b5e4d849b566b4428$export$ShaderProgram=$472c416a359bf27a8e7b264fa919be0f$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"ShaderProgram",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$ShaderProgram}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Framebuffer=$e0af888fbe72678addd891879b080a5a$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Framebuffer",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Framebuffer}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Wrappers=$c300508ff8318f231a03f90d08d1052b$exports;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Wrappers",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Wrappers}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Resources=$8c2ed76c3be599228cd92e613ce51103$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Resources",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Resources}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Recycler=$ccdbbc32fd9f0a412799511487cd91a1$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Recycler",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Recycler}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Linkable=$8581dd2a4034ebdbe37300f3afba0093$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Linkable",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Linkable}));const $0c9c00c2409eb95b5e4d849b566b4428$export$List=$9331e791bdadeac9afb7e80808da523d$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"List",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$List}));const $0c9c00c2409eb95b5e4d849b566b4428$export$PriorityQueue=$3a1f3760b46e848362e1421ba143903d$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"PriorityQueue",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$PriorityQueue}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Handler=$b24b690628e515896a9fe69710f34dc4$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Handler",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Handler}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Matrix=$3e5498a08e31fe3580cca1707752773a$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Matrix",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Matrix}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Rect=$cfea91c9ac660d2876bf91c30bd6a9f3$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Rect",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Rect}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Vec2=$fe31f04e32686e924bb665d33d1abcbf$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Vec2",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Vec2}));const $0c9c00c2409eb95b5e4d849b566b4428$export$TFunction=$9e7762fe4ba0e2d12cbcd459eadedcb7$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"TFunction",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$TFunction}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Bounds2=$c1c2b815c89b9264ed0e554223c27659$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Bounds2",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Bounds2}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Point2=$915b1937740c478df54f3272021d2c1c$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Point2",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Point2}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Easing=$18f56a190a3a3ff5c8b7ebba0279c438$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Easing",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Easing}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Anim=$b3f77e113c0f558ec76d4638522e74c8$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Anim",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Anim}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Boot=$207b59440723904b38982ddc4272b61b$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Boot",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Boot}));const $0c9c00c2409eb95b5e4d849b566b4428$export$GridElement=$7a341878b2625de6871f03e49d9ff35d$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"GridElement",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$GridElement}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Grid=$5455570ea965ce03f28a7753614d671d$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Grid",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Grid}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Scene=$c71a3bc6e745875d5097e035813a6806$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Scene",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Scene}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Viewport=$77b679f5ef01765d4ffd6be7d74228a2$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Viewport",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Viewport}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Updater=$90e0b89862e5a9d0c6d6cfe755cfd44f$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Updater",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Updater}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Container=$165af1ab52f365e7ef649f223d1085b3$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Container",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Container}));const $0c9c00c2409eb95b5e4d849b566b4428$export$SimpleContainer=$11afb610437a3710eee4c4e987daab23$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"SimpleContainer",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$SimpleContainer}));const $0c9c00c2409eb95b5e4d849b566b4428$export$GridContainer=$3199a6c942a7e5178eebb25dca4aec14$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"GridContainer",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$GridContainer}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Group=$4a2ddd0887254a2e40ee0a31b6575db9$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Group",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Group}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Element=$ddb647b88709c8dfd67dabab58120e2a$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Element",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Element}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Mask=$4af5fc1fc3654d5b7c8a994ec4277c43$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Mask",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Mask}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Label=$b664b2e615ac985908f37c542d9ee7e5$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Label",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Label}));const $0c9c00c2409eb95b5e4d849b566b4428$export$KeyboardHandler=$35ed923298b3cffd909d1e217a705010$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"KeyboardHandler",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$KeyboardHandler}));const $0c9c00c2409eb95b5e4d849b566b4428$export$PointerHandler=$80fe7598813bab8b70bdda84376bf98b$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"PointerHandler",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$PointerHandler}));const $0c9c00c2409eb95b5e4d849b566b4428$export$ScreenControls=$ed3917ac682376c75cf6afece38cd992$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"ScreenControls",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$ScreenControls}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Button=$b16c78d90a5735557317530efb31b314$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Button",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Button}));const $0c9c00c2409eb95b5e4d849b566b4428$export$Stick=$52910331a2e2e68437e9ccfbb34ae506$export$default;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"Stick",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$Stick}));var $0c9c00c2409eb95b5e4d849b566b4428$export$default=$a3dd07e1619eee49527834a2575dfaf7$exports;$parcel$export($0c9c00c2409eb95b5e4d849b566b4428$exports,"default",(function(){return $0c9c00c2409eb95b5e4d849b566b4428$export$default}));var _default=froxel=$0c9c00c2409eb95b5e4d849b566b4428$exports})();