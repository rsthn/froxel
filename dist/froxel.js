var $parcel$global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function $parcel$export(e,t,a,i){Object.defineProperty(e,t,{get:a,set:i,enumerable:!0,configurable:!0})}var $parcel$modules={},$parcel$inits={},parcelRequire=$parcel$global.parcelRequire3a43;null==parcelRequire&&(parcelRequire=function(e){if(e in $parcel$modules)return $parcel$modules[e].exports;if(e in $parcel$inits){var t=$parcel$inits[e];delete $parcel$inits[e];var a={id:e,exports:{}};return $parcel$modules[e]=a,t.call(a.exports,a,a.exports),a.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i},parcelRequire.register=function(e,t){$parcel$inits[e]=t},$parcel$global.parcelRequire3a43=parcelRequire),parcelRequire.register("3CL91",(function(module,exports){function $parcel$export(e,t,a,i){Object.defineProperty(e,t,{get:a,set:i,enumerable:!0,configurable:!0})}$parcel$export(module.exports,"Rinn",(()=>$9ffb7151b8b2d038$export$eefcfe56efaaa57d)),$parcel$export(module.exports,"Class",(()=>$9ffb7151b8b2d038$export$4c85e640eb41c31b)),$parcel$export(module.exports,"Schema",(()=>$9ffb7151b8b2d038$export$19342e026b58ebb7)),$parcel$export(module.exports,"Template",(()=>$9ffb7151b8b2d038$export$14416b8d99d47caa));var $parcel$global1="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==$parcel$global?$parcel$global:{},$parcel$modules={},$parcel$inits={},parcelRequire=$parcel$global1.parcelRequire25d2;null==parcelRequire&&(parcelRequire=function(e){if(e in $parcel$modules)return $parcel$modules[e].exports;if(e in $parcel$inits){var t=$parcel$inits[e];delete $parcel$inits[e];var a={id:e,exports:{}};return $parcel$modules[e]=a,t.call(a.exports,a,a.exports),a.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i},parcelRequire.register=function(e,t){$parcel$inits[e]=t},$parcel$global1.parcelRequire25d2=parcelRequire),parcelRequire.register("4VREF",(function(module,exports){$parcel$export(module.exports,"default",(()=>$39761b0dd175036e$export$2e2bcd8739ae039));var $fMUO11=parcelRequire("fMUO1"),$cAEYe=parcelRequire("cAEYe"),$39761b0dd175036e$export$2e2bcd8739ae039={_getref:function(value,obj){return"string"==typeof value?("#"==value.substr(0,1)?value=obj.get(value.substr(1)):"@"==value.substr(0,1)&&(value=obj[value.substr(1)]),"string"==typeof value?eval(value):value):value},type:function(e,t,a,i){switch(t){case"int":if(i=parseInt(i),isNaN(i))throw new Error(t);break;case"float":if(i=parseFloat(i),isNaN(i))throw new Error(t);break;case"string":i=null==i?"":i.toString();break;case"bit":if(!0===i||!1===i){i=i?1:0;break}if(i=parseInt(i),isNaN(i))throw new Error(t);i=i?1:0;break;case"array":if("array"==$fMUO11.default.typeOf(i))break;if(null==i){i=[];break}throw new Error(t);case"bool":if("true"===i||!0===i){i=!0;break}if("false"===i||!1===i){i=!1;break}throw new Error(t)}return i},model:function(e,t,a,i){var r=this._getref(t,e);if(!r)throw new Error(t);return i?r.ensure(i):new r},cls:function(e,t,a,i){var r=this._getref(t,e);return i?$fMUO11.default.ensureTypeOf(r,i):new r},arrayof:function(e,t,a,i){var r=this._getref(t,e);if(i||(i=[]),!r||"array"!=$fMUO11.default.typeOf(i))throw new Error(t);for(var n=0;n<i.length;n++)i[n]=$fMUO11.default.ensureTypeOf(r,i[n]);return i},arraynull:function(e,t,a,i){var r=!1;if("object"==$fMUO11.default.typeOf(t)&&(t.remove&&(r=t.remove),t=t.value),t)return i;if("array"!=$fMUO11.default.typeOf(i))throw new Error(t);for(var n=0;n<i.length;n++)if(null==i[n]){if(!r)throw new Error(t);i.splice(n--,1)}return i},arraycompliant:function(e,t,a,i){var r=!1;if("object"==$fMUO11.default.typeOf(t)&&(t.remove&&(r=t.remove),t=t.value),!t)return i;if("array"!=$fMUO11.default.typeOf(i))throw new Error(t);for(var n=0;n<i.length;n++)if(null!=i[n]&&!i[n].isCompliant()){if(!r)throw new Error(t);i.splice(n--,1)}return i},required:function(e,t,a,i){if(null==i)throw new Error(t?"":"null");if("array"===$fMUO11.default.typeOf(i)){if(0==i.length)throw new Error(t?"":"null")}else if(0==i.toString().length)throw new Error(t?"":"null");return i},minlen:function(e,t,a,i){if(i.toString().length<t)throw new Error(t);return i},maxlen:function(e,t,a,i){if(i.toString().length>t)throw new Error(t);return i},minval:function(e,t,a,i){if(parseFloat(i)<t)throw new Error(t);return i},maxval:function(e,t,a,i){if(parseFloat(i)>t)throw new Error(t);return i},mincount:function(e,t,a,i){if("array"!=$fMUO11.default.typeOf(i)||i.length<t)throw new Error(t);return i},maxcount:function(e,t,a,i){if("array"!=$fMUO11.default.typeOf(i)||i.length>t)throw new Error(t);return i},pattern:function(e,t,a,i){if(!$cAEYe.default[t].test(i.toString()))throw new Error(t);return i},inset:function(e,t,a,i){if("array"!=$fMUO11.default.typeOf(t)){if(!new RegExp("^("+t.toString()+")$").test(i.toString()))throw new Error(t);return i}if(-1==t.indexOf(i.toString()))throw new Error(t.join("|"));return i},upper:function(e,t,a,i){return t?i.toString().toUpperCase():i},lower:function(e,t,a,i){return t?i.toString().toLowerCase():i}}})),parcelRequire.register("fMUO1",(function(e,t){$parcel$export(e.exports,"default",(()=>i));const a={};var i=a;a.invokeLater=function(e){e&&setTimeout((function(){e()}),10)},a.wait=function(e){return new Promise((function(t,a){setTimeout(t,e)}))},a.typeOf=function(e){return e instanceof Array?"array":null===e?"null":(typeof e).toString().toLowerCase()},a.isArrayOrObject=function(e){switch(a.typeOf(e)){case"array":case"object":return!0}return!1},a.clone=function(e){let t=a.typeOf(e);if("array"===t){t=[];for(let i=0;i<e.length;i++)t.push(a.clone(e[i]))}else if("object"===t){if("clone"in e&&"function"==typeof e.clone)return e.clone();t={};for(let i in e)t[i]=a.clone(e[i])}else t=e;return t},a.merge=function(e,...t){if("array"==a.typeOf(e))for(let i=0;i<t.length;i++){let r=t[i];if("array"!=a.typeOf(r))e.push(r);else for(let t=0;t<r.length;t++)e.push(a.clone(r[t]))}else if("object"==a.typeOf(e))for(let i=0;i<t.length;i++){let r=t[i];if("object"==a.typeOf(r))for(let t in r)a.isArrayOrObject(r[t])?t in e?a.merge(e[t],r[t]):e[t]=a.clone(r[t]):e[t]=r[t]}return e},a.override=function(e,...t){for(let a=0;a<t.length;a++)for(let i in t[a])e[i]=t[a][i];return e},a.partialCompare=function(e,t){if(null==e||null==t)return!1;if(e===t)return!0;for(var a in t)if(e[a]!=t[a])return!1;return!0},a.arrayFind=function(e,t,a){for(var i=0;e&&i<e.length;i++)if(this.partialCompare(e[i],t))return a?e[i]:i;return!!a&&null},a.isInstanceOf=function(e,t){return!(!e||!t||"object"!=typeof e)&&(e instanceof t||"isInstanceOf"in e&&e.isInstanceOf(t))},a.indexOf=function(e,t,a=!1){if(a){for(let a=0;a<e.length;a++)if(e[a]===t)return a;return-1}for(let a in e)if(e[a]===t)return a;return-1},a.escape=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},a.ensureTypeOf=function(e,t){return!t||!e||t instanceof e||t.isInstanceOf&&e.prototype.className&&t.isInstanceOf(e.prototype.className)?t:new e(t)},a.serialize=function(e){return JSON.stringify(e)},a.deserialize=function(e){return JSON.parse(e)},a.hookAppend=function(e,t,a,i=!0){const r=e[t];return e[t]=i?function(...e){if(!1!==r.apply(this,e))return a.apply(this,e)}:function(...e){return r.apply(this,e),a.apply(this,e)},{unhook:function(){e[t]=r}}},a.hookPrepend=function(e,t,a,i=!0){const r=e[t];return e[t]=i?function(...e){if(!1!==a.apply(this,e))return r.apply(this,e)}:function(...e){return a.apply(this,e),r.apply(this,e)},{unhook:function(){e[t]=r}}}})),parcelRequire.register("cAEYe",(function(e,t){$parcel$export(e.exports,"default",(()=>a));var a={email:/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)+$/i,url:/^[\w-]+:\/\/[\w-]+(\.\w+)+.*$/,urlNoProt:/^[\w-]+(\.\w+)+.*$/,name:/^[-A-Za-z0-9_.]+$/,uname:/^['\pL\pN ]+$/,text:/^[^&<>{}]*$/,utext:/^([\r\n\pL\pN\pS &!@#$%*\[\]()_+=;',.\/?:"~-]+)$/}}));var $fMUO1=parcelRequire("fMUO1"),$fMUO1=parcelRequire("fMUO1");
//!class Class
const $2394d727dfd6a212$var$Class=function(){};$2394d727dfd6a212$var$Class._class=$2394d727dfd6a212$var$Class,$2394d727dfd6a212$var$Class._super={},$2394d727dfd6a212$var$Class.prototype.className="Class",$2394d727dfd6a212$var$Class.prototype.__ctor=function(){},$2394d727dfd6a212$var$Class.prototype.__dtor=function(){},$2394d727dfd6a212$var$Class.prototype.isInstanceOf=function(e){return null!==e&&("function"==typeof e?e=e.prototype.className:"string"!=typeof e&&(e=e.__proto__.className),this.className===e||this._super.hasOwnProperty(e))},$2394d727dfd6a212$var$Class.instanceOf=function(e,t){return null!==e&&null!==t&&e.isInstanceOf(t)},$2394d727dfd6a212$var$Class.prototype._initSuperRefs=function(){let e=this.constructor._super,t={};const a=this;for(let i in e){let r={},n=e[i].prototype;for(let e in n)"function"===$fMUO1.default.typeOf(n[e])&&(r[e]=function(e){return function(t,i,r,n,s,o,l,c,h,f,u){return e.call(a,t,i,r,n,s,o,l,c,h,f,u)}}(n[e]));t[i]=r}this._super=t},$2394d727dfd6a212$var$Class.inherit=function(e){let t=this._class,a=t._super,i=t._class;if("function"===$fMUO1.default.typeOf(e)){for(let a in e._class)/^[A-Z]/.test(a)||(t[a]=e._class[a]);$fMUO1.default.override(t.prototype,e._class.prototype),$fMUO1.default.override(a,e._class._super),e._class.prototype.className&&(a[e._class.prototype.className]=e._class)}else $fMUO1.default.override(t.prototype,e);return t._super=a,t._class=i,t},$2394d727dfd6a212$var$Class.prototype._extend=function(e,t){if(0===t.length)return e;const a=function(...e){this._initSuperRefs(),this.__ctor.apply(this,e)};a._class=a,a._super={},$2394d727dfd6a212$var$Class.inherit.call(a,e),delete a.prototype.className;for(let e=0;e<t.length;e++)a.inherit(t[e]);return delete a._super.Class,"classInit"in a.prototype&&a.prototype.classInit(),a.isInstance=function(e){return $fMUO1.default.isInstanceOf(e,a)},a},$2394d727dfd6a212$var$Class.extend=function(...e){return this._class.prototype._extend(this,e)},$2394d727dfd6a212$var$Class.create=function(e){return new(this.extend(e))},$2394d727dfd6a212$var$Class.mutate=function(e,t,a=null){let i=new e;for(let a in e.prototype)t.hasOwnProperty(a)||(t[a]=e.prototype[a]);for(let e in i)t.hasOwnProperty(e)||(t[e]=i[e]);if(t._super)for(let a in t._super)for(let i in t._super[a])t._super[a][i]=e.prototype.constructor._super[a].prototype[i].bind(t);if(null!==a)for(let e in a)t[e]=a[e];return t};var $2394d727dfd6a212$export$2e2bcd8739ae039=$2394d727dfd6a212$var$Class,$fMUO1=parcelRequire("fMUO1"),$13eda5a5dec8010f$export$2e2bcd8739ae039=$2394d727dfd6a212$export$2e2bcd8739ae039.extend({className:"Event",source:null,name:null,args:null,_async:!1,list:null,next:null,ret:null,original:null,i:-1,__ctor:function(e,t,a,i,r,n){this.source=e,this.name=a,this.args=i,this.cbHandler=r,this.cbContext=n,this.list=t,this.reset()},reset:function(){return this.next=null,this.ret=[],this._async=!1,this.i=-1,this},setSource:function(e){return this.source=e,this},wait:function(){return this._async=!0,this},resume:function(){for(this._async=!1;!(this._async||++this.i>=this.list.length);)if(!this.list[this.i].silent)if("string"==$fMUO1.default.typeOf(this.list[this.i].handler)){if(this.list[this.i].context){if(!this.list[this.i].context[this.list[this.i].handler])continue;if(!1===this.list[this.i].context[this.list[this.i].handler](this,this.args,this.list[this.i].data))break}else if(!1===$parcel$global1[this.list[this.i].handler].call(null,this,this.args,this.list[this.i].data))break}else if(!1===this.list[this.i].handler.call(this.list[this.i].context,this,this.args,this.list[this.i].data))break;return this._async||(this.i>=this.list.length&&this.next&&this.next.resume(),this.cbHandler&&this.cbHandler.call(this.cbContext)),this},from:function(e){return this.original=e,this},enqueue:function(e){if(!e)return this;var t;for(t=this;null!=t.next;t=t.next);return t.next=e,e.from(this),this}}),$c43adaf9cb6d6dd3$export$2e2bcd8739ae039=$2394d727dfd6a212$export$2e2bcd8739ae039.extend({className:"EventDispatcher",listeners:null,namespace:null,__ctor:function(){this.listeners={}},setNamespace:function(e){return this.namespace=e,this},addEventListener:function(e,t,a,i){var r=(e=e.split(":"))[e.length-1],n=e.length>1?e[0]:null;return this.listeners[r]||(this.listeners[r]=[]),this.listeners[r].push({ns:n,handler:t,context:a,data:i,silent:0}),this},removeEventListener:function(e,t,a){var i=(e=e.split(":"))[e.length-1],r=e.length>1?e[0]:null;if("*"==i)for(var n in this.listeners)for(var s=this.listeners[n],o=0;o<s.length;o++){var l=!0;t&&(l=l&&s[o].handler===t),a&&(l=l&&s[o].context===a),r&&(l=l&&s[o].ns==r),l&&s.splice(o--,1)}else{if(!this.listeners[i])return this;for(s=this.listeners[i],o=0;o<s.length;o++)l=!0,t&&(l=l&&s[o].handler===t),a&&(l=l&&s[o].context===a),r&&(l=l&&s[o].ns==r),l&&s.splice(o--,1)}return this},prepareEvent:function(e,t,a,i){var r=[],n=(e=e.split(":"))[e.length-1],s=e.length>1?e[0]:null;this.listeners[n]&&(r=r.concat(this.listeners[n])),this.listeners["*"]&&(r=r.concat(this.listeners["*"]));for(var o=0;o<r.length;o++)r[o].silent&&r.splice(o--,1);if(s)for(o=0;o<r.length;o++)r[o].ns!=s&&r.splice(o--,1);return new $13eda5a5dec8010f$export$2e2bcd8739ae039(this,r,n,t,a,i)},silence:function(e,t){var a=(e=e.split(":"))[e.length-1],i=e.length>1?e[0]:null;if(t=!1===t?-1:1,"*"==a)for(var r in this.listeners)for(var n=this.listeners[r],s=0;s<n.length;s++)i&&n[s].ns!=i||(n[s].silent+=t);else{if(!this.listeners[a])return this;for(n=this.listeners[a],s=0;s<n.length;s++)i&&n[s].ns!=i||(n[s].silent+=t)}return this},dispatchEvent:function(e,t,a,i){return this.prepareEvent(this.namespace?this.namespace+":"+e:e,t,a,i).resume()}}),$fMUO1=parcelRequire("fMUO1"),$4VREF=parcelRequire("4VREF");let $4dfa0622e14576ea$var$_Model=$c43adaf9cb6d6dd3$export$2e2bcd8739ae039.extend({className:"Model",defaults:null,constraints:null,data:null,changedList:null,_silent:0,_level:0,__ctor:function(e,t){if(this._super.EventDispatcher.__ctor(),this.data={},null!=t)this.reset(t,!1);else{let e=null;if(!this.defaults&&this.constraints){e={};for(let t in this.constraints){let a=this.constraints[t];null!==a.def&&void 0!==a.def?"function"==typeof a.def?e[t]=a.def():e[t]=a.def:e[t]=null}}this.reset(e)}this.init(),null!=e&&this.set(e,!0),this.constraints&&this.update(),this.ready()},reset:function(e,t){if(!this.defaults){if(!e||"object"!==$fMUO1.default.typeOf(e)&&"function"!==$fMUO1.default.typeOf(e))return this;this.defaults=e}return"function"===$fMUO1.default.typeOf(this.defaults)?this.data=this.defaults():this.data=$fMUO1.default.clone(this.defaults),!1===t||!1===e?this:this.update(null,!0)},init:function(){},ready:function(){},silent:function(e){return this._silent+=e?1:-1,this},_validate:function(e,t){if(!this.constraints||!this.constraints[e])return t;var a=this.constraints[e],i=t;for(var r in a)if($4dfa0622e14576ea$var$_Model.Constraints[r])try{i=$4dfa0622e14576ea$var$_Model.Constraints[r](this,a[r],e,i)}catch(t){if("null"==t.message)break;throw new Error(`Constraint [${r}:${a[r]}] failed on property '${e}'.`)}return i},_set:function(e,t){if(!this.constraints||!this.constraints[e])return this.data[e]=t,t;var a=this.constraints[e],i=(this.data[e],t);for(var r in a)if($4dfa0622e14576ea$var$_Model.Constraints[r])try{i=$4dfa0622e14576ea$var$_Model.Constraints[r](this,a[r],e,i)}catch(a){if("null"==a.message)break;this._silent||this.dispatchEvent("constraintError",{constraint:r,message:a.message,name:e,value:t});break}return this.data[e]=i},_propertyEvent:function(e,t,a,i){var r={name:e,old:t,value:a,level:this._level},n=this.dispatchEvent("propertyChanging",r);i?this.data[e]=r.value:r.value=this._set(e,r.value),null!=n&&n.ret.length&&!1===n.ret[0]||(this.dispatchEvent("propertyChanged."+e,r),this.dispatchEvent("propertyChanged",r),this.changedList.push(e))},set:function(){var e=arguments.length,t=!1,a=!1;if((e>2||2==e&&"object"==$fMUO1.default.typeOf(arguments[0]))&&"boolean"==$fMUO1.default.typeOf(arguments[e-1])&&!1===(t=arguments[--e])&&(a=!0),0==this._level&&(this.changedList=[]),this._level++,2==e)(this.data[arguments[0]]!==arguments[1]||t)&&(this._silent||a?this._set(arguments[0],arguments[1]):this._propertyEvent(arguments[0],this.data[arguments[0]],this._validate(arguments[0],arguments[1])));else for(var i in arguments[0])(this.data[i]!==arguments[0][i]||t)&&(this._silent||a?this._set(i,arguments[0][i]):this._propertyEvent(i,this.data[i],this._validate(i,arguments[0][i])));return--this._level||!this.changedList.length||a||this._silent||this.dispatchEvent("modelChanged",{fields:this.changedList}),this},has:function(e){return e in this.data},get:function(e,t){return 0==arguments.length||!1===e?this.data:1==arguments.length&&!0===e?this.flatten():2==arguments.length&&void 0===this.data[e]?t:this.data[e]},getInt:function(e,t){return 2==arguments.length&&void 0===this.data[e]?t:parseInt(this.data[e])},getFloat:function(e,t){return 2==arguments.length&&void 0===this.data[e]?t:parseFloat(this.data[e])},getBool:function(e,t){return"true"===(e=2==arguments.length&&void 0===this.data[e]?t:this.data[e])||!0===e||"false"!==e&&!1!==e&&!!parseInt(e)},getReference:function(e){var t=this;return{get:function(){return t.get(e)},set:function(a){t.set(e,a)}}},constraint:function(e,t,a){if(3==arguments.length||2==arguments.length||1==arguments.length&&"object"==$fMUO1.default.typeOf(e)){switch(this.constraints===this.constructor.prototype.constraints&&(this.constraints=$fMUO1.default.clone(this.constraints)),arguments.length){case 1:$fMUO1.default.override(this.constraints,e);break;case 2:$fMUO1.default.override(this.constraints[e],t);break;case 3:this.constraints[e][t]=a}return this}return e?this.constraints[e]:this},flatten:function(e,t){if(e)return null==(r=this.flatten(!1,!0))?null:(r.class=this.classPath,r);if(!this.constraints&&!this.defaults)return this.data;if(!this.isCompliant())return{};var a=this.constraints,i=this.defaults?"function"==$fMUO1.default.typeOf(this.defaults)?this.defaults():this.defaults:this.constraints,r={};for(var n in this.data)if(n in i){if(a&&a[n]){var s=a[n];if(s.model){r[n]=this.data[n]?this.data[n].flatten(t):null;continue}if(s.arrayof){r[n]=[];for(var o=0;o<this.data[n].length;o++)r[n][o]=this.data[n][o]?this.data[n][o].flatten(t):null;continue}if(s.cls){r[n]=this.data[n]?this.data[n].flatten():null;continue}}r[n]=this.data[n]}return r},remove:function(e,t){if("array"==$fMUO1.default.typeOf(e)){for(var a=0;a<e.length;a++)delete this.data[e[a]];!1===t||this._silent||this.dispatchEvent("propertyRemoved",{fields:e})}else delete this.data[e],!1===t||this._silent||this.dispatchEvent("propertyRemoved",{fields:[e]})},update:function(e,t){if(this._silent)return this;if(0==this._level&&(this.changedList=[]),this._level++,e&&"string"==$fMUO1.default.typeOf(e))this._propertyEvent(e,this.data[e],this.data[e],t);else if(e&&"array"==$fMUO1.default.typeOf(e))for(var a of e)this._propertyEvent(a,this.data[a],this.data[a],t);else for(var a in this.data)this._propertyEvent(a,this.data[a],this.data[a],t);return--this._level||this._silent||0==this.changedList.length&&!0!==e||this.dispatchEvent("modelChanged",{fields:this.changedList}),this},validate:function(e){if(!this.constraints)return this;if(e&&"string"==$fMUO1.default.typeOf(e))this._set(e,this.data[e]);else for(var t in this.data)e&&-1==$fMUO1.default.indexOf(e,t)||this._set(t,this.data[t]);return this},isCompliant:function(){if(!this.constraints)return!0;try{for(var e in this.data)this._validate(e,this.data[e]);return!0}catch(e){}return!1},observe:function(e,t,a){this.addEventListener("propertyChanged."+e,t,a)},unobserve:function(e,t,a){this.removeEventListener("propertyChanged."+e,t,a)},watch:function(e,t){1==(e=e.split(":")).length&&(e[1]=e[0],e[0]="watch"),this.addEventListener(e[0]+":propertyChanged."+e[1],(function(e,a){t(a.value,a,e)}))},unwatch:function(e){1==(e=e.split(":")).length&&(e[1]=e[0],e[0]="watch"),this.removeEventListener(e[0]+":propertyChanged."+e[1])},trigger:function(e,t=null){return this.set(e,t,!0)},toString:function(){return $fMUO1.default.serialize(this.get(!0))}});$4dfa0622e14576ea$var$_Model.Constraints=$4VREF.default;var $4dfa0622e14576ea$export$2e2bcd8739ae039=$4dfa0622e14576ea$var$_Model,$fMUO1=parcelRequire("fMUO1"),$0890bed8a163f087$export$2e2bcd8739ae039=$4dfa0622e14576ea$export$2e2bcd8739ae039.extend({className:"ModelList",itemt:$4dfa0622e14576ea$export$2e2bcd8739ae039,contents:null,itemId:null,nextId:null,defaults:{contents:null},constraints:{contents:{type:"array",arrayof:"@itemt"}},__ctor:function(...e){this.itemId=[],this.nextId=0,this._super.Model.__ctor(...e)},ready:function(){this._eventGroup="ModelList_"+Date.now()+":modelChanged",this.contents=this.data.contents},_bind:function(e,t){return t&&t.addEventListener&&t.addEventListener(this._eventGroup,this._onItemEvent,this,e),t},_unbind:function(e){return e&&e.removeEventListener&&e.removeEventListener(this._eventGroup),e},_onItemEvent:function(e,t,a){this.prepareEvent("itemChanged",{id:a,item:e.source}).from(e).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume()},length:function(){return this.data.contents.length},clear:function(){for(var e=0;e<this.data.contents;e++)this._unbind(this.data.contents[e]);return this.itemId=[],this.nextId=0,this.contents=this.data.contents=[],this.prepareEvent("itemsCleared").enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),this},setData:function(e){if(this.clear(),!e)return this;for(var t=0;t<e.length;t++){var a=$fMUO1.default.ensureTypeOf(this.itemt,e[t]);this.itemId.push(this.nextId++),this.data.contents.push(a),this._bind(this.nextId-1,a)}return this.prepareEvent("itemsChanged").enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),this},getData:function(){return this.data.contents},getAt:function(e){return e<0||e>=this.data.contents.length?null:this.data.contents[e]},removeAt:function(e){if(e<0||e>=this.data.contents.length)return null;let t=this.data.contents.splice(e,1)[0],a=this.itemId.splice(e,1)[0];return this._unbind(t),this.prepareEvent("itemRemoved",{id:a,item:t}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),t},setAt:function(e,t){return!(e<0||e>=this.data.contents.length||(t=$fMUO1.default.ensureTypeOf(this.itemt,t),this._unbind(this.data.contents[e]),this.data.contents[e]=t,this._bind(this.itemId[e],t),this.prepareEvent("itemChanged",{id:this.itemId[e],item:t}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),0))},updateAt:function(e){return!(e<0||e>=this.data.contents.length||(this.prepareEvent("itemChanged",{id:this.itemId[e],item:this.data.contents[e]}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),0))},push:function(e){return e&&"object"!=$fMUO1.default.typeOf(e)?null:(e=$fMUO1.default.ensureTypeOf(this.itemt,e),this.itemId.push(this.nextId++),this.data.contents.push(e),this._bind(this.nextId-1,e),this.prepareEvent("itemAdded",{id:this.itemId[this.itemId.length-1],item:e,position:"tail"}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),e)},pop:function(){return this._unbind(this.data.contents.pop())},unshift:function(e){return e&&"object"!=$fMUO1.default.typeOf(e)?null:(e=$fMUO1.default.ensureTypeOf(this.itemt,e),this.itemId.unshift(this.nextId++),this.data.contents.unshift(e),this._bind(this.nextId-1,e),this.prepareEvent("itemAdded",{id:this.itemId[0],item:e,position:"head"}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),e)},shift:function(){return this._unbind(this.data.contents.shift())},find:function(e,t=!1){for(var a=this.data.contents,i=0;i<a.length;i++)if($fMUO1.default.partialCompare(a[i].data,e))return t?a[i]:i;return t?null:-1}}),$fMUO1=parcelRequire("fMUO1");let $2710795e2347ba2a$var$Schema={Type:function(e){let t={flatten:function(e,t){return e},unflatten:function(e,t){return e}};return e?$fMUO1.default.override(t,e):t},String:function(){return $2710795e2347ba2a$var$Schema.Type({flatten:function(e,t){return null!=e?e.toString():null},unflatten:function(e,t){return null!=e?e.toString():null}})},Integer:function(){return $2710795e2347ba2a$var$Schema.Type({flatten:function(e,t){return~~e},unflatten:function(e,t){return~~e}})},Number:function(e){return $2710795e2347ba2a$var$Schema.Type({_precision:e,_round:!1,precision:function(e){return this._precision=~~e,this},flatten:function(e,t){return e=parseFloat(e),this._precision>0&&(e=~~(e*Math.pow(10,this._precision))/Math.pow(10,this._precision)),e},unflatten:function(e,t){return parseFloat(e)}})},Bool:function(e){return $2710795e2347ba2a$var$Schema.Type({_compact:e,compact:function(e){return this._compact=e,this},flatten:function(e,t){return e=~~e,this._compact?e>0?1:0:e>0},unflatten:function(e,t){return!!~~e}})},SharedString:function(){return $2710795e2347ba2a$var$Schema.Type({flatten:function(e,t){return null==e?0:(e=e.toString(),"strings"in t||(t.index={},t.strings=[]),e in t.index||(t.strings.push(e),t.index[e]=t.strings.length),t.index[e])},unflatten:function(e,t){return null==e||0==e?null:t.strings[~~e-1]}})},Array:function(e){return $2710795e2347ba2a$var$Schema.Type({itemType:e,_debug:!1,_filter:null,debug:function(e){return this._debug=e,this},of:function(e){return this.itemType=e,this},filter:function(e){return this._filter=e,this},flatten:function(e,t){if(null==e)return null;let a=[];for(let i=0;i<e.length;i++)this._filter&&!this._filter(e[i],i)||a.push(this.itemType.flatten(e[i],t));return a},unflatten:async function(e,t){if(null==e)return null;let a=[];for(let i=0;i<e.length;i++)a.push(await this.itemType.unflatten(e[i],t));return a}})},Object:function(){return $2710795e2347ba2a$var$Schema.Type({properties:[],property:function(e,t,a=null){return this.properties.push({name:e,source:e,type:t,defvalue:a}),this},propertyAlias:function(e,t,a,i=null){return this.properties.push({name:e,source:t,type:a,defvalue:i}),this},flatten:function(e,t){if(null==e)return null;let a;if(!0===t.symbolic){a={};for(let i=0;i<this.properties.length;i++)this.properties[i].source in e?a[this.properties[i].name]=this.properties[i].type.flatten(e[this.properties[i].source],t):a[this.properties[i].name]=this.properties[i].type.flatten(this.properties[i].defvalue,t)}else{a=[];for(let i=0;i<this.properties.length;i++)this.properties[i].source in e?a.push(this.properties[i].type.flatten(e[this.properties[i].source],t)):a.push(this.properties[i].type.flatten(this.properties[i].defvalue,t))}return a},unflatten:async function(e,t){if(null==e)return null;let a={};if(!0===t.symbolic)for(let i=0;i<this.properties.length;i++)a[this.properties[i].name]=await this.properties[i].type.unflatten(this.properties[i].name in e?e[this.properties[i].name]:this.properties[i].defvalue,t);else for(let i=0;i<this.properties.length;i++)a[this.properties[i].name]=await this.properties[i].type.unflatten(i in e?e[i]:this.properties[i].defvalue,t);return a}})},Class:function(e){return $2710795e2347ba2a$var$Schema.Type({_constructor:e,constructor:function(e){return this._constructor=e,this},flatten:function(e,t){return null==e?null:e.flatten(t)},unflatten:async function(e,t){return null==e?null:await(new this._constructor).unflatten(e,t)}})},Property:function(e,t){return $2710795e2347ba2a$var$Schema.Type({property:e,type:t,name:function(e){return this.property=e,this},is:function(e){return this.type=e,this},flatten:function(e,t){if(null==e)return null;let a;return!0===t.symbolic?(a={},a[this.property]=this.type.flatten(e[this.property],t)):a=this.type.flatten(e[this.property],t),a},unflatten:async function(e,t){if(null==e)return null;let a={};return!0===t.symbolic?a[this.property]=await this.type.unflatten(e[this.property],t):a[this.property]=await this.type.unflatten(e,t),a}})},Map:function(){return $2710795e2347ba2a$var$Schema.Type({flatten:function(e,t){if(null==e)return null;if(!0===t.symbolic)return e;let a=[];for(let t in e)a.push(t),a.push(e[t]);return a},unflatten:function(e,t){if(null==e)return null;if(!0===t.symbolic)return e;let a={};for(let t=0;t<e.length;t+=2)a[e[t]]=e[t+1];return a}})},Selector:function(){return $2710795e2347ba2a$var$Schema.Type({conditions:[],value:null,when:function(e,t){return this.conditions.push([t=>t===e,t]),this},with:function(e){return this.value=e,this},flatten:function(e,t){if(null==e)return null;for(let a of this.conditions)if(!0===a[0](this.value))return a[1].flatten(e,t);return null},unflatten:async function(e,t){if(null==e)return null;for(let a of this.conditions)if(!0===a[0](this.value))return await a[1].unflatten(e,t);return null}})}};var $2710795e2347ba2a$export$2e2bcd8739ae039=$2710795e2347ba2a$var$Schema,$32651d5f38a8a64c$export$2e2bcd8739ae039=$2394d727dfd6a212$export$2e2bcd8739ae039.extend({className:"Flattenable",typeSchema:null,flatten:function(e){return this.typeSchema.flatten(this,e)},unflatten:async function(e,t){return Object.assign(this,await this.typeSchema.unflatten(e,t)),await this.onUnflattened(),this},onUnflattened:async function(){}}),$fMUO1=parcelRequire("fMUO1"),$2bcce06113365814$export$2e2bcd8739ae039=$32651d5f38a8a64c$export$2e2bcd8739ae039.extend({className:"Collection",itemTypeSchema:null,items:null,__ctor:function(e){e||(e=this.itemTypeSchema),e&&(this.typeSchema=$2710795e2347ba2a$export$2e2bcd8739ae039.Property("items").is($2710795e2347ba2a$export$2e2bcd8739ae039.Array().of(e))),this.reset()},onUnflattened:function(){let e=this.items;this.reset();for(let t of e)this.add(t)},itemsReferenceChanged:function(){},reset:function(){return this.items=[],this.itemsReferenceChanged(),this},clear:function(){var e=this.items;this.reset();for(var t=0;t<e.length;t++)this.onItemRemoved(e[t],0);return this},sort:function(e,t){return"function"!=typeof e?this.items.sort((function(a,i){return(a[e]<=i[e]?-1:1)*(!0===t?-1:1)})):this.items.sort(e),this},findItem:function(e,t){if(!this.items)return null;for(var a=0;a<this.items.length;a++)if((!t||!$fMUO1.default.partialCompare(this.items[a],t))&&$fMUO1.default.partialCompare(this.items[a],e))return this.items[a];return null},getItems:function(){return this.items},length:function(){return this.items.length},isEmpty:function(){return!this.items.length},indexOf:function(e){return this.items.indexOf(e)},getAt:function(e,t=!1){return e<0&&1==t&&(e+=this.items.length),e>=0&&e<this.items.length?this.items[e]:null},first:function(){return this.getAt(0)},last:function(){return this.getAt(-1,!0)},addAt:function(e,t){if(!t||!this.onBeforeItemAdded(t))return this;if(e<0&&(e=0),e>this.items.length&&(e=this.items.length),0==e)this.items.unshift(t);else if(e==this.items.length)this.items.push(t);else{var a=this.items.splice(0,e);a.push(t),this.items=a.concat(this.items),this.itemsReferenceChanged()}return this.onItemAdded(t),this},unshift:function(e){return this.addAt(0,e)},push:function(e){return this.addAt(this.items.length,e)},add:function(e){return this.push(e)},removeAt:function(e,t=!1){if(e<0&&1==t&&(e+=this.items.length),e<0||e>=this.items.length)return null;var a=this.items[e];return this.items.splice(e,1),this.onItemRemoved(a,e),a},pop:function(e){return this.removeAt(-1,!0)},shift:function(e){return this.removeAt(0)},remove:function(e){return this.removeAt(this.indexOf(e))},forEach:function(e){if(this.isEmpty())return this;for(var t=0;t<this.items.length&&!1!==e(this.items[t],t,this);t++);return this},forEachCall:function(e,...t){if(this.isEmpty())return this;for(var a=0;a<this.items.length&&!1!==this.items[a][e](...t);a++);return this},forEachRev:function(e){if(this.isEmpty())return this;for(var t=this.items.length-1;t>=0&&!1!==e(this.items[t],t,this);t--);return this},forEachRevCall:function(e,...t){if(this.isEmpty())return this;for(var a=this.items.length-1;a>=0&&!1!==this.items[a][e](...t);a--);return this},onBeforeItemAdded:function(e){return!0},onItemAdded:function(e){},onItemRemoved:function(e){}}),$fMUO1=parcelRequire("fMUO1");let $d261ccdafdfe12a9$var$Template={strict:!1,parseTemplate:function(e,t,a,i=!1,r=1){let n="string",s=null,o=0,l=0,c="",h=[],f=h,u=!1;function d(e,i){if("template"==e?i=$d261ccdafdfe12a9$var$Template.parseTemplate(i,t,a,!0,0):"parse"==e?(i=$d261ccdafdfe12a9$var$Template.parseTemplate(i,t,a,!1,0),e="base-string","array"==$fMUO1.default.typeOf(i)&&(e=i[0].type,i=i[0].data)):"parse-trim-merge"==e?i=$d261ccdafdfe12a9$var$Template.parseTemplate(i.trim().split("\n").map((e=>e.trim())).join("\n"),t,a,!1,0):"parse-merge"==e?i=$d261ccdafdfe12a9$var$Template.parseTemplate(i,t,a,!1,0):"parse-merge-alt"==e&&(i=$d261ccdafdfe12a9$var$Template.parseTemplate(i,"{","}",!1,0)),"parse-merge"==e||"parse-merge-alt"==e||"parse-trim-merge"==e)for(let e=0;e<i.length;e++)h.push(i[e]);else h.push({type:e,data:i});u&&(f.push(h=[]),u=!1)}!0===i&&(e=e.trim(),n="identifier",o=10,f.push(h=[])),e+="\0";for(let i=0;i<e.length;i++)if("\\"!=e[i]){switch(o){case 0:"\0"==e[i]?s="string":e[i]==t&&"<"==e[i+1]?(o=1,l=1,s="string",n="parse-merge"):e[i]==t&&"@"==e[i+1]?(o=1,l=1,s="string",n="parse-trim-merge",i++):e[i]==t&&":"==e[i+1]?(o=12,l=1,s="string",n="string",i++):e[i]==t?(o=1,l=1,s="string",n="template"):c+=e[i];break;case 1:if("\0"==e[i])throw new Error("Parse error: Unexpected end of template");if(e[i]==a){if(l--,l<0)throw new Error("Parse error: Unmatched "+a);if(0==l){o=0,s=n;break}}else e[i]==t&&l++;c+=e[i];break;case 10:if("\0"==e[i]){s=n;break}if("."==e[i]){d(n,c),d("access","."),n="identifier",c="";break}if(null!=e[i].match(/[\t\n\r\f\v ]/)){for(s=n,n="identifier",u=!0;null!=e[i].match(/[\t\n\r\f\v ]/);)i++;i--;break}if(e[i]==t&&"<"==e[i+1]){c&&(s=n),o=11,l=1,n="parse-merge";break}if(e[i]==t&&"@"==e[i+1]){c&&(s=n),o=11,l=1,n="parse-trim-merge",i++;break}if('"'==e[i]){c&&(s=n),o=14,l=1,n="parse-merge";break}if("'"==e[i]){c&&(s=n),o=15,l=1,n="parse-merge";break}if("`"==e[i]){c&&(s=n),o=16,l=1,n="parse-merge-alt";break}if(e[i]==t&&":"==e[i+1]){c&&(s=n),o=13,l=1,n="string",i++;break}if(e[i]==t){c&&d(n,c),o=11,l=1,c="",n="parse",c+=e[i];break}"identifier"!=n&&(d(n,c),c="",n="identifier"),c+=e[i];break;case 11:if("\0"==e[i])throw new Error("Parse error: Unexpected end of template");if(e[i]==a){if(l--,l<0)throw new Error("Parse error: Unmatched "+a);if(0==l&&(o=10,"parse-merge"==n||"parse-merge-alt"==n||"parse-trim-merge"==n))break}else e[i]==t&&l++;c+=e[i];break;case 12:if("\0"==e[i])throw new Error("Parse error: Unexpected end of template");if(e[i]==a){if(l--,l<0)throw new Error("Parse error: Unmatched "+a);if(0==l){0!=c.length&&"<"!=c[0]&&"["!=c[0]&&" "!=c[0]&&(c=t+c+a),o=0,s=n;break}}else e[i]==t&&l++;c+=e[i];break;case 13:if("\0"==e[i])throw new Error("Parse error: Unexpected end of template");if(e[i]==a){if(l--,l<0)throw new Error("Parse error: Unmatched "+a);if(0==l){"<"!=c[0]&&"["!=c[0]&&" "!=c[0]&&(c=t+c+a),o=10;break}}else e[i]==t&&l++;c+=e[i];break;case 14:if("\0"==e[i])throw new Error("Parse error: Unexpected end of template");if('"'==e[i]){if(l--,l<0)throw new Error('Parse error: Unmatched "');if(0==l&&(o=10,"parse-merge"==n||"parse-merge-alt"==n||"parse-trim-merge"==n))break}c+=e[i];break;case 15:if("\0"==e[i])throw new Error("Parse error: Unexpected end of template");if("'"==e[i]){if(l--,l<0)throw new Error("Parse error: Unmatched '");if(0==l&&(o=10,"parse-merge"==n||"parse-merge-alt"==n||"parse-trim-merge"==n))break}c+=e[i];break;case 16:if("\0"==e[i])throw new Error("Parse error: Unexpected end of template");if("`"==e[i]){if(l--,l<0)throw new Error("Parse error: Unmatched `");if(0==l&&(o=10,"parse-merge"==n||"parse-merge-alt"==n||"parse-trim-merge"==n))break}c+=e[i]}s&&(d(s,c),s=c="")}else c+="\\",c+=e[++i];if(!i){let e=0;for(;e<f.length&&"string"==f[e].type&&""==f[e].data;)f.splice(e,1);for(e=f.length-1;e>0&&"string"==f[e].type&&""==f[e].data;)f.splice(e--,1);0==f.length&&f.push({type:"string",data:""})}return r&&function e(t){if("object"==typeof t){if(t instanceof Array)for(let a=0;a<t.length;a++)e(t[a]);else t.data=e(t.data);return t}for(let e=0;e<t.length;e++)if("\\"==t[e]){let a=t[e+1];switch(a){case"n":a="\n";break;case"r":a="\r";break;case"f":a="\f";break;case"v":a="\v";break;case"t":a="\t";break;case"s":a="s";break;case'"':a='"';break;case"'":a="'"}t=t.substr(0,e)+a+t.substr(e+2)}return t}(f),f},parse:function(e){return this.parseTemplate(e.trim(),"[","]",!1)},clean:function(e){for(let t=0;t<e.length;t++)"template"!=e[t].type&&(e.splice(t,1),t--);return e},expand:function(e,t,a="text",i="base-string"){let r=[];if("var"==i){let a=!0,i=!1,n=t,s=null,o=!0,l="";for(let r=0;r<e.length&&null!=t;r++)switch(e[r].type){case"identifier":case"string":l+=e[r].data,s=null;break;case"template":s=this.expand(e[r].data,n,"arg","template"),l+="object"!=typeof s?s:"";break;case"base-string":l+=this.expand(e[r].data,n,"arg","base-string"),s=null;break;case"access":if(s&&"object"==typeof s)t=s;else{for(""==l&&(l="this");;)if("!"==l[0])l=l.substr(1),a=!1;else{if("$"!=l[0])break;l=l.substr(1),i=!0}if("this"!=l&&null!=t){let e=t;null===(t=l in t?t[l]:null)&&o&&l in $d261ccdafdfe12a9$var$Template.functions&&(t=$d261ccdafdfe12a9$var$Template.functions[l](null,null,e)),o=!1}}l=""}for(;""!=l;)if("!"==l[0])l=l.substr(1),a=!1;else{if("$"!=l[0])break;l=l.substr(1),i=!0}if("this"!=l){let a=!1;if(null!=t?l in t?t=t[l]:(a=!0,t=null):a=!0,a&&1==e.length&&1==$d261ccdafdfe12a9$var$Template.strict)throw new Error("Expression function `"+l+"` not found.")}"string"==typeof t&&(a&&(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),i&&(t='"'+t+'"')),r.push(t)}if("varref"==a){let a=t,i=null,r=!0,n="";for(let s=0;s<e.length&&null!=t;s++)switch(e[s].type){case"identifier":case"string":n+=e[s].data,i=null;break;case"template":i=this.expand(e[s].data,a,"arg","template"),n+="object"!=typeof i?i:"";break;case"base-string":n+=this.expand(e[s].data,a,"arg","base-string"),i=null;break;case"access":if(i&&"object"==typeof i)t=i;else{for(""==n&&(n="this");;)if("!"==n[0])n=n.substr(1);else{if("$"!=n[0])break;n=n.substr(1)}if("this"!=n&&null!=t){let e=t;null===(t=n in t?t[n]:null)&&r&&n in $d261ccdafdfe12a9$var$Template.functions&&(t=$d261ccdafdfe12a9$var$Template.functions[n](null,null,e)),r=!1}}n=""}for(;""!=n;)if("!"==n[0])n=n.substr(1);else{if("$"!=n[0])break;n=n.substr(1)}return"this"!=n?[t,n]:null}if("fn"==i){var n=[];if(n.push($d261ccdafdfe12a9$var$Template.expand(e[0],t,"text","base-string")),"_"+n[0]in $d261ccdafdfe12a9$var$Template.functions&&(n[0]="_"+n[0]),!(n[0]in $d261ccdafdfe12a9$var$Template.functions)){if(1==$d261ccdafdfe12a9$var$Template.strict)throw new Error("Expression function `"+n[0]+"` not found.");return`(Unknown: ${n[0]})`}if("_"==n[0][0])return $d261ccdafdfe12a9$var$Template.functions[n[0]](e,t);for(let a=1;a<e.length;a++)n.push($d261ccdafdfe12a9$var$Template.expand(e[a],t,"arg","base-string"));r.push($d261ccdafdfe12a9$var$Template.functions[n[0]](n,e,t))}if("template"==i){if(1==e.length){if(1==e[0].length&&"string"==e[0][0].type)return e[0][0].data;if(1==e[0].length&&"identifier"==e[0][0].type){let i=e[0][0].data;if(i in $d261ccdafdfe12a9$var$Template.functions||"_"+i in $d261ccdafdfe12a9$var$Template.functions)return $d261ccdafdfe12a9$var$Template.expand(e,t,a,"fn")}return $d261ccdafdfe12a9$var$Template.expand(e[0],t,a,"var")}return $d261ccdafdfe12a9$var$Template.expand(e,t,a,"fn")}if("base-string"==i){let i=-1;for(let n of e){let s=null;switch(i++,n.type){case"template":s=$d261ccdafdfe12a9$var$Template.expand(n.data,t,a,"template");break;case"string":case"identifier":s=n.data;break;case"base-string":s=$d261ccdafdfe12a9$var$Template.expand(n.data,t,a,"base-string")}"void"!=a&&("last"==a&&i!=e.length-1||r.push(s))}}if("obj"==a)return r;if("last"==a)return"Rose\\Arry"==typeOf(r)&&(r=r[0]),r;if("void"==a)return null;if("arg"==a)return"array"==$fMUO1.default.typeOf(r)?1!=r.length?r.join(""):r[0]:r;if("text"==a&&"array"==$fMUO1.default.typeOf(r)){let e=t=>null!=t&&"object"==typeof t?"map"in t?t.map(e).join(""):"join"in t?t.join(""):t.toString():t;r=r.map(e).join("")}return r},compile:function(e){return e=$d261ccdafdfe12a9$var$Template.parse(e),function(t=null,a="text"){return $d261ccdafdfe12a9$var$Template.expand(e,t||{},a)}},eval:function(e,t=null,a="text"){return e=$d261ccdafdfe12a9$var$Template.parse(e),$d261ccdafdfe12a9$var$Template.expand(e,t||{},a)},value:function(e,t=null){return"array"!=$fMUO1.default.typeOf(e)?e:$d261ccdafdfe12a9$var$Template.expand(e,t||{},"arg")},register:function(e,t){$d261ccdafdfe12a9$var$Template.functions[e]=t},call:function(e,t,a=null){return e in $d261ccdafdfe12a9$var$Template.functions?$d261ccdafdfe12a9$var$Template.functions[e](t,null,a):null},getNamedValues:function(e,t,a=1,i=!0){let r={},n=0;for(;a<e.length;a+=2){let s=$d261ccdafdfe12a9$var$Template.expand(e[a],t,"arg");n||(n=s.startsWith(":")?1:s.endsWith(":")?2:3),1==n?s=s.substr(1):2==n&&(s=s.substr(0,s.length-1)),r[s]=i?$d261ccdafdfe12a9$var$Template.expand(e[a+1],t,"arg"):e[a+1]}return r}};$d261ccdafdfe12a9$var$Template.functions={global:function(e){return globalThis},null:function(e){return null},true:function(e){return!0},false:function(e){return!1},len:function(e){return e[1].toString().length},int:function(e){return~~e[1]},str:function(e){return e[1].toString()},float:function(e){return parseFloat(e[1])},chr:function(e){return String.fromCharCode(e[1])},ord:function(e){return e[1].toString().charCodeAt(0)},not:function(e){return!e[1]},neg:function(e){return-e[1]},abs:function(e){return Math.abs(e[1])},and:function(e){for(let t=1;t<e.length;t++)if(!e[t])return!1;return!0},or:function(e){for(let t=1;t<e.length;t++)if(~~e[t])return!0;return!1},eq:function(e){return e[1]==e[2]},ne:function(e){return e[1]!=e[2]},lt:function(e){return e[1]<e[2]},le:function(e){return e[1]<=e[2]},gt:function(e){return e[1]>e[2]},ge:function(e){return e[1]>=e[2]},isnotnull:function(e){return!!e[1]},isnull:function(e){return!e[1]},iszero:function(e){return 0==parseInt(e[1])},"eq?":function(e){return e[1]==e[2]},"ne?":function(e){return e[1]!=e[2]},"lt?":function(e){return e[1]<e[2]},"le?":function(e){return e[1]<=e[2]},"gt?":function(e){return e[1]>e[2]},"ge?":function(e){return e[1]>=e[2]},"notnull?":function(e){return!!e[1]},"null?":function(e){return!e[1]},"zero?":function(e){return 0==parseInt(e[1])},typeof:function(e){return $fMUO1.default.typeOf(e[1])},"*":function(e){let t=e[1];for(let a=2;a<e.length;a++)t*=e[a];return t},"/":function(e){let t=e[1];for(let a=2;a<e.length;a++)t/=e[a];return t},"+":function(e){let t=e[1];for(let a=2;a<e.length;a++)t-=-e[a];return t},"-":function(e){let t=e[1];for(let a=2;a<e.length;a++)t-=e[a];return t},mul:function(e){let t=e[1];for(let a=2;a<e.length;a++)t*=e[a];return t},div:function(e){let t=e[1];for(let a=2;a<e.length;a++)t/=e[a];return t},sum:function(e){let t=e[1];for(let a=2;a<e.length;a++)t-=-e[a];return t},sub:function(e){let t=e[1];for(let a=2;a<e.length;a++)t-=e[a];return t},mod:function(e){let t=e[1];for(let a=2;a<e.length;a++)t%=e[a];return t},pow:function(e){let t=e[1];for(let a=2;a<e.length;a++)t=Math.pow(t,e[a]);return t},dump:function(e){return JSON.stringify(e[1])},_set:function(e,t){for(let a=1;a+1<e.length;a+=2){let i=$d261ccdafdfe12a9$var$Template.value(e[a+1],t);if(e[a].length>1){let r=$d261ccdafdfe12a9$var$Template.expand(e[a],t,"varref");null!=r&&(r[0][r[1]]=i)}else t[$d261ccdafdfe12a9$var$Template.value(e[a],t)]=i}return""},_unset:function(e,t){for(let a=1;a<e.length;a++)if(e[a].length>1){let i=$d261ccdafdfe12a9$var$Template.expand(e[a],t,"varref");null!=i&&delete i[0][i[1]]}else delete t[$d261ccdafdfe12a9$var$Template.value(e[a],t)];return null},trim:function(e){return e[1]?"object"==typeof e[1]?e[1].map((e=>e.trim())):e[1].trim():""},upper:function(e){return e[1]?"object"==typeof e[1]?e[1].map((e=>e.toUpperCase())):e[1].toUpperCase():""},lower:function(e){return e[1]?"object"==typeof e[1]?e[1].map((e=>e.toLowerCase())):e[1].toLowerCase():""},substr:function(e){let t=e[e.length-1].toString(),a=0,i=null;return 4==e.length?(a=~~e[1],i=~~e[2]):(a=~~e[1],i=null),a<0&&(a+=t.length),i<0&&(i+=t.length),null===i&&(i=t.length-a),t.substr(a,i)},replace:function(e){return e[3].split(e[1]).join(e[2])},nl2br:function(e){return e[1]?"object"==typeof e[1]?e[1].map((e=>e.replace(/\n/g,"<br/>"))):e[1].replace(/\n/g,"<br/>"):""},"%":function(e){e.shift();var t=e.shift();let a="";for(let i=0;i<e.length;i++)if("array"==$fMUO1.default.typeOf(e[i])){a+=`<${t}>`;for(let t=0;t<e[i].length;t++)a+=e[i][t];a+=`</${t}>`}else a+=`<${t}>${e[i]}</${t}>`;return a},"%%":function(e){e.shift();var t=e.shift();let a="",i="";for(let t=0;t<e.length;t+=2)t+1<e.length?a+=` ${e[t]}="${e[t+1]}"`:i=e[t];return i?`<${t}${a}>${i}</${t}>`:`<${t}${a}/>`},join:function(e){return e[2]&&"array"==$fMUO1.default.typeOf(e[2])?e[2].join(e[1]):""},split:function(e){return e[2]&&"string"==typeof e[2]?e[2].split(e[1]):[]},keys:function(e){return e[1]&&"object"==typeof e[1]?Object.keys(e[1]):[]},values:function(e){return e[1]&&"object"==typeof e[1]?Object.values(e[1]):[]},_each:function(e,t){let a=$d261ccdafdfe12a9$var$Template.expand(e[1],t,"arg"),i=$d261ccdafdfe12a9$var$Template.expand(e[2],t,"arg"),r="",n=0;if(!i)return r;for(let s in i)t[a]=i[s],t[a+"##"]=n++,t[a+"#"]=s,r+=$d261ccdafdfe12a9$var$Template.expand(e[3],t,"text");return delete t[a],delete t[a+"##"],delete t[a+"#"],r},_foreach:function(e,t){let a=$d261ccdafdfe12a9$var$Template.expand(e[1],t,"arg"),i=$d261ccdafdfe12a9$var$Template.expand(e[2],t,"arg"),r=0;if(!i)return null;for(let n in i)t[a]=i[n],t[a+"##"]=r++,t[a+"#"]=n,$d261ccdafdfe12a9$var$Template.expand(e[3],t,"text");return delete t[a],delete t[a+"##"],delete t[a+"#"],null},"_?":function(e,t){return $d261ccdafdfe12a9$var$Template.expand(e[1],t,"arg")?$d261ccdafdfe12a9$var$Template.expand(e[2],t,"arg"):e.length>3?$d261ccdafdfe12a9$var$Template.expand(e[3],t,"arg"):""},"_??":function(e,t){return $d261ccdafdfe12a9$var$Template.expand(e[1],t,"arg")||$d261ccdafdfe12a9$var$Template.expand(e[2],t,"arg")},_if:function(e,t){for(let a=0;a<e.length;a+=3){if("else"==$d261ccdafdfe12a9$var$Template.expand(e[a],t,"arg"))return $d261ccdafdfe12a9$var$Template.expand(e[a+1],t,"text");if($d261ccdafdfe12a9$var$Template.expand(e[a+1],t,"arg"))return $d261ccdafdfe12a9$var$Template.expand(e[a+2],t,"text")}return""},_switch:function(e,t){let a=$d261ccdafdfe12a9$var$Template.expand(e[1],t,"arg");for(let i=2;i<e.length;i+=2){let r=$d261ccdafdfe12a9$var$Template.expand(e[i],t,"arg");if(r==a||"default"==r)return $d261ccdafdfe12a9$var$Template.expand(e[i+1],t,"text")}return""},_break:function(e,t){throw new Error("EXC_BREAK")},_continue:function(e,t){throw new Error("EXC_CONTINUE")},_repeat:function(e,t){if(e.length<3||1!=(1&e.length))return"(`repeat`: Wrong number of parameters)";let a=$d261ccdafdfe12a9$var$Template.value(e[1],t),i=null,r=0,n=null,s=null;for(let a=2;a<e.length-1;a+=2)switch($d261ccdafdfe12a9$var$Template.value(e[a],t).toLowerCase()){case"from":r=parseFloat($d261ccdafdfe12a9$var$Template.value(e[a+1],t));break;case"to":n=parseFloat($d261ccdafdfe12a9$var$Template.value(e[a+1],t));break;case"count":i=parseFloat($d261ccdafdfe12a9$var$Template.value(e[a+1],t));break;case"step":s=parseFloat($d261ccdafdfe12a9$var$Template.value(e[a+1],t))}let o=e[e.length-1],l=[];if(null!==n)if(null===s&&(s=r>n?-1:1),s<0)for(let e=r;e>=n;e+=s)try{t[a]=e,l.push($d261ccdafdfe12a9$var$Template.value(o,t))}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}else for(let e=r;e<=n;e+=s)try{t[a]=e,l.push($d261ccdafdfe12a9$var$Template.value(o,t))}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}else if(null!==i){null===s&&(s=1);for(let e=r;i>0;i--,e+=s)try{t[a]=e,l.push($d261ccdafdfe12a9$var$Template.value(o,t))}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}}else{null===s&&(s=1);for(let e=r;;e+=s)try{t[a]=e,l.push($d261ccdafdfe12a9$var$Template.value(o,t))}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}}return delete t[a],l},_for:function(e,t){if(e.length<3||1!=(1&e.length))return"(`for`: Wrong number of parameters)";let a=$d261ccdafdfe12a9$var$Template.value(e[1],t),i=null,r=0;to=null;let n=null;for(let a=2;a<e.length-1;a+=2)switch(value=$d261ccdafdfe12a9$var$Template.value(e[a],t),value.toLowerCase()){case"from":r=parseFloat($d261ccdafdfe12a9$var$Template.value(e[a+1],t));break;case"to":to=parseFloat($d261ccdafdfe12a9$var$Template.value(e[a+1],t));break;case"count":i=parseFloat($d261ccdafdfe12a9$var$Template.value(e[a+1],t));break;case"step":n=parseFloat($d261ccdafdfe12a9$var$Template.value(e[a+1],t))}let s=e[e.length-1];if(null!==to)if(null===n&&(n=r>to?-1:1),n<0)for(let e=r;e>=to;e+=n)try{t[a]=e,$d261ccdafdfe12a9$var$Template.value(s,t)}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}else for(let e=r;e<=to;e+=n)try{t[a]=e,$d261ccdafdfe12a9$var$Template.value(s,t)}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}else if(null!==i){null===n&&(n=1);for(let e=r;i>0;i--,e+=n)try{t[a]=e,$d261ccdafdfe12a9$var$Template.value(s,t)}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}}else{null===n&&(n=1);for(let e=r;;e+=n)try{t[a]=e,$d261ccdafdfe12a9$var$Template.value(s,t)}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}}return delete t[a],null},_loop:function(e,t){if(e.length<2)return"(`loop`: Wrong number of parameters)";let a=e[1];for(;;)try{$d261ccdafdfe12a9$var$Template.value(a,t)}catch(e){let t=e.message;if("EXC_BREAK"==t)break;if("EXC_CONTINUE"==t)continue;throw e}return null},_echo:function(e,t){let a="";for(let i=1;i<e.length;i++)a+=$d261ccdafdfe12a9$var$Template.expand(e[i],t,"arg");return console.log(a),""},"_#":function(e,t){let a=[];for(let i=1;i<e.length;i++)a.push($d261ccdafdfe12a9$var$Template.expand(e[i],t,"arg"));return a},"_##":function(e,t){let a=[];for(let t=1;t<e.length;t++)a.push(e[t]);return a},"_&":function(e,t){return $d261ccdafdfe12a9$var$Template.getNamedValues(e,t,1,!0)},"_&&":function(e,t){return $d261ccdafdfe12a9$var$Template.getNamedValues(e,t,1,!1)},contains:function(e,t,a){let i=e[1];if("object"!=typeof i)return a.err="Argument is not a Map",!1;let r="";for(let t=2;t<e.length;t++)e[t]in i||(r+=", "+e[t]);return""==r||(a.err=r.substr(1),!1)},has:function(e,t,a){let i=e[2];return"object"==$fMUO1.default.typeOf(i)&&e[1]in i},_map:function(e,t){let a=$d261ccdafdfe12a9$var$Template.expand(e[1],t,"arg"),i=$d261ccdafdfe12a9$var$Template.expand(e[2],t,"arg");if(!i)return i;let r="array"==$fMUO1.default.typeOf(i),n=r?[]:{},s=0;for(let o in i)t[a]=i[o],t[a+"##"]=s++,t[a+"#"]=o,r?n.push($d261ccdafdfe12a9$var$Template.expand(e[3],t,"arg")):n[o]=$d261ccdafdfe12a9$var$Template.expand(e[3],t,"arg");return delete t[a],delete t[a+"##"],delete t[a+"#"],n},_filter:function(e,t){let a=$d261ccdafdfe12a9$var$Template.expand(e[1],t,"arg"),i=$d261ccdafdfe12a9$var$Template.expand(e[2],t,"arg");if(!i)return i;let r="array"==$fMUO1.default.typeOf(i),n=r?[]:{},s=0;for(let o in i)t[a]=i[o],t[a+"##"]=s++,t[a+"#"]=o,~~$d261ccdafdfe12a9$var$Template.expand(e[3],t,"arg")&&(r?n.push(i[o]):n[o]=i[o]);return delete t[a],delete t[a+"##"],delete t[a+"#"],n},expand:function(e,t,a){return $d261ccdafdfe12a9$var$Template.expand($d261ccdafdfe12a9$var$Template.parseTemplate(e[1],"{","}"),3==e.length?e[2]:a)},_call:function(e,t){let a=$d261ccdafdfe12a9$var$Template.expand(e[1],t,"varref");if(!a||"function"!=typeof a[0][a[1]])throw new Error("Expression is not a function: "+$d261ccdafdfe12a9$var$Template.expand(e[1],t,"obj").map((e=>null==e?".":e)).join(""));let i=[];for(let a=2;a<e.length;a++)i.push($d261ccdafdfe12a9$var$Template.value(e[a],t));return a[0][a[1]](...i)}};var $d261ccdafdfe12a9$export$2e2bcd8739ae039=$d261ccdafdfe12a9$var$Template;const $9ffb7151b8b2d038$export$eefcfe56efaaa57d=$fMUO1.default,$9ffb7151b8b2d038$export$4c85e640eb41c31b=$2394d727dfd6a212$export$2e2bcd8739ae039,$9ffb7151b8b2d038$export$d61e24a684f9e51=$13eda5a5dec8010f$export$2e2bcd8739ae039,$9ffb7151b8b2d038$export$ec8b666c5fe2c75a=$c43adaf9cb6d6dd3$export$2e2bcd8739ae039,$9ffb7151b8b2d038$export$a1edc412be3e1841=$4dfa0622e14576ea$export$2e2bcd8739ae039,$9ffb7151b8b2d038$export$59eced47f477f85a=$0890bed8a163f087$export$2e2bcd8739ae039,$9ffb7151b8b2d038$export$19342e026b58ebb7=$2710795e2347ba2a$export$2e2bcd8739ae039,$9ffb7151b8b2d038$export$3a9581c9ade29768=$32651d5f38a8a64c$export$2e2bcd8739ae039,$9ffb7151b8b2d038$export$fb8073518f34e6ec=$2bcce06113365814$export$2e2bcd8739ae039,$9ffb7151b8b2d038$export$14416b8d99d47caa=$d261ccdafdfe12a9$export$2e2bcd8739ae039}));var $3CL91=parcelRequire("3CL91"),$3CL91=parcelRequire("3CL91");const $42e4702e58ec5fce$var$XOR=(e,t)=>2147483647&(e^t),$42e4702e58ec5fce$var$SHR=(e,t)=>e>>>t&2147483647,$42e4702e58ec5fce$var$SHL=(e,t)=>e<<t&2147483647
//!class Random
,$42e4702e58ec5fce$var$Random=$3CL91.Class.extend({state:null,index:0,seed:0,count:0,__ctor:function(e=3672614355){this.setSeed(e)},setSeed:function(e){this.seed=e,this.index=0,this.count=0,this.state=[2784440588,4017298675,4202185506,2016738353,3652155411,3732450579,2017408024,2853319030,2266821841,1933651883,3135686416,116864129,2299580181,2457663507,3170337615,1945506195];for(let e=0;e<this.state.length;e++)this.state[e]=$42e4702e58ec5fce$var$XOR(this.state[e],this.seed);return this},nextInt32:function(){let e,t,a,i;return this.count=this.count+1&2147483647,e=this.state[this.index],a=this.state[this.index+13&15],t=$42e4702e58ec5fce$var$XOR($42e4702e58ec5fce$var$XOR($42e4702e58ec5fce$var$XOR(e,a),$42e4702e58ec5fce$var$SHL(e,16)),$42e4702e58ec5fce$var$SHL(a,15)),a=this.state[this.index+9&15],a=$42e4702e58ec5fce$var$XOR(a,$42e4702e58ec5fce$var$SHR(a,11)),e=this.state[this.index]=$42e4702e58ec5fce$var$XOR(t,a),i=$42e4702e58ec5fce$var$XOR(e,3661901092&$42e4702e58ec5fce$var$SHL(e,5)),this.index=this.index+15&15,e=this.state[this.index],this.state[this.index]=$42e4702e58ec5fce$var$XOR($42e4702e58ec5fce$var$XOR($42e4702e58ec5fce$var$XOR($42e4702e58ec5fce$var$XOR($42e4702e58ec5fce$var$XOR(e,t),i),$42e4702e58ec5fce$var$SHL(e,2)),$42e4702e58ec5fce$var$SHL(t,18)),$42e4702e58ec5fce$var$SHL(a,28)),2147483647&this.state[this.index]},nextInt16:function(){return 65535&this.nextInt32()},nextInt8:function(){return 255&this.nextInt32()},nextFloat:function(){return this.nextInt32()/2147483647}});var $42e4702e58ec5fce$export$2e2bcd8739ae039=$42e4702e58ec5fce$var$Random,
//!enum KeyCode
$87a32fa215803424$export$2e2bcd8739ae039={BACKSPACE:8,
//!BACKSPACE
TAB:9,
//!TAB
ENTER:13,
//!ENTER
SHIFT:16,
//!SHIFT
CTRL:17,
//!CTRL
ESC:27,
//!ESC
SPACE:32,
//!SPACE
PGUP:33,
//!PGUP
PGDN:34,
//!PGDN
END:35,
//!END
HOME:36,
//!HOME
INS:45,
//!INS
DEL:46,
//!DEL
LEFT:37,
//!LEFT
UP:38,
//!UP
RIGHT:39,
//!RIGHT
DOWN:40,
//!DOWN
NUM_PLUS:107,
//!NUM_PLUS
NUM_MINUS:109,
//!NUM_MINUS
NUM_ASTERISK:106,
//!NUM_ASTERISK
NUM_SLASH:111,
//!NUM_SLASH
NUM_DOT:110,
//!NUM_DOT
NUM_0:96,
//!NUM_0
NUM_1:97,
//!NUM_1
NUM_2:98,
//!NUM_2
NUM_3:99,
//!NUM_3
NUM_4:100,
//!NUM_4
NUM_5:101,
//!NUM_5
NUM_6:102,
//!NUM_6
NUM_7:103,
//!NUM_7
NUM_8:104,
//!NUM_8
NUM_9:105,
//!NUM_9
D0:48,
//!D0
D1:49,
//!D1
D2:50,
//!D2
D3:51,
//!D3
D4:52,
//!D4
D5:53,
//!D5
D6:54,
//!D6
D7:55,
//!D7
D8:56,
//!D8
D9:57,
//!D9
A:65,
//!A
B:66,
//!B
C:67,
//!C
D:68,
//!D
E:69,
//!E
F:70,
//!F
G:71,
//!G
H:72,
//!H
I:73,
//!I
J:74,
//!J
K:75,
//!K
L:76,
//!L
M:77,
//!M
N:78,
//!N
O:79,
//!O
P:80,
//!P
Q:81,
//!Q
R:82,
//!R
S:83,
//!S
T:84,
//!T
U:85,
//!U
V:86,
//!V
W:87,
//!W
X:88,
//!X
Y:89,
//!Y
Z:90},$3CL91=parcelRequire("3CL91"),$3CL91=parcelRequire("3CL91");const $cac8b143592e7d73$var$recyclingFacilities={};let $cac8b143592e7d73$var$totalPreallocated=0;const $cac8b143592e7d73$var$Recycler={};$parcel$global.Recycler=$cac8b143592e7d73$var$Recycler;var $cac8b143592e7d73$export$2e2bcd8739ae039=$cac8b143592e7d73$var$Recycler;
//!namespace Recycler
$cac8b143592e7d73$var$Recycler.attachTo=function(e,t=8192,a=null){if(!e.prototype.className)throw new Error("Unable to attach recycler methods to an unnamed class.");if(!("__dtor"in e.prototype))throw new Error("Recycler: Class "+e.prototype.className+" requires `__dtor` method.");if(!("init"in e.prototype))throw new Error("Recycler: Class "+e.prototype.className+" requires `init` method.");null===a&&(a=int(.375*t)),$cac8b143592e7d73$var$recyclingFacilities[e.prototype.className]=e,e.recyclerPool=[],e.recyclerPoolMax=t,e.prototype.objectId=0,e.prototype.objectRefs=0,e.recyclerNextObjectId=0,e.recyclerCreated=0,e.recyclerRecycled=0,e.recyclerMissed=0,e.recyclerLength=0,e.recyclerActive=0;let i=!1;e.preallocate=function(t=null){if(i)return;let r=null===t?a:Math.min(t,a);for(let t=0;t<r;t++)e.recyclerPool.push(new e),e.recyclerLength++,$cac8b143592e7d73$var$totalPreallocated++;i=!0},e.allocate=function(){let t;return this.recyclerLength?(t=this.recyclerPool[--this.recyclerLength],e.recyclerRecycled++):(t=new e,e.recyclerCreated++),e.recyclerActive++,t.objectId=++this.recyclerNextObjectId,t.objectRefs=1,this.recyclerNextObjectId&=2147483647,t},e.alloc=function(t=null,a=null,i=null,r=null,n=null,s=null,o=null,l=null,c=null,h=null){return e.allocate().init(t,a,i,r,n,s,o,l,c,h)},e.prototype.free=function(){return this.objectId<0?this:0==this.objectId?(console.error("ERROR: Already released instance of "+e.prototype.className),this):(--this.objectRefs>0||(this.__dtor(),this.objectId=0,e.recyclerLength>=t?e.recyclerMissed++:e.recyclerPool[e.recyclerLength++]=this,e.recyclerActive--),this)},e.prototype.lockInstance=function(e){return this.objectId=Math.abs(this.objectId),e&&(this.objectId=-this.objectId),this},e.prototype.instanceRef=function(e=1){return this.objectRefs+=e,this}},$cac8b143592e7d73$var$Recycler.showStats=function(e=null){let t=$cac8b143592e7d73$var$recyclingFacilities;if(console.log("Total Preallocated: "+$cac8b143592e7d73$var$totalPreallocated),!0!==e){if(null!==e){if("string"==typeof e){let t=$cac8b143592e7d73$var$recyclingFacilities[e];return void console.debug(e+": "+(t.recyclerCreated/t.recyclerPoolMax*100).toFixed(1)+"%  =>  overhead="+t.recyclerCreated+", active="+t.recyclerActive+", array="+t.recyclerPool.length+", recycled="+t.recyclerRecycled+", in-recycler="+t.recyclerLength+", missed="+t.recyclerMissed+", space="+(t.recyclerPoolMax-t.recyclerLength))}t=e}console.group("Recycling Facilities");for(let e in t){let a=t[e];console.debug(e+": "+(a.recyclerCreated/a.recyclerPoolMax*100).toFixed(1)+"%  =>  overhead="+a.recyclerCreated+", active="+a.recyclerActive+", array="+a.recyclerPool.length+", recycled="+a.recyclerRecycled+", in-recycler="+a.recyclerLength+", missed="+a.recyclerMissed+", space="+(a.recyclerPoolMax-a.recyclerLength))}console.groupEnd()}else{console.group("Recycling Facilities");for(let e in t){let a=t[e];a.recyclerCreated&&console.debug(e+": "+(a.recyclerCreated/a.recyclerPoolMax*100).toFixed(1)+"%  =>  overhead="+a.recyclerCreated+", active="+a.recyclerActive+", array="+a.recyclerPool.length+", recycled="+a.recyclerRecycled+", in-recycler="+a.recyclerLength+", missed="+a.recyclerMissed+", space="+(a.recyclerPoolMax-a.recyclerLength))}console.groupEnd()}},$cac8b143592e7d73$var$Recycler.createPool=function(e,t=8192,a=null){const i=e.prototype.className;if(!i)throw new Error("Unable to create pool sub-class on an unnamed class.");const r=e.extend({className:e.prototype.className,__ctor:function(){},init:function(e=null,t=null,a=null,r=null,n=null,s=null,o=null,l=null,c=null,h=null){return this._super[i].__ctor(e,t,a,r,n,s,o,l,c,h),this}});return $cac8b143592e7d73$var$Recycler.attachTo(r,t,a),e.Pool=r,e},$cac8b143592e7d73$var$Recycler.preallocate=function(e=null){$cac8b143592e7d73$var$totalPreallocated=0;for(let t in $cac8b143592e7d73$var$recyclingFacilities)$cac8b143592e7d73$var$recyclingFacilities[t].preallocate(e);return $cac8b143592e7d73$var$totalPreallocated};
//![import "./recycler"]
//!class Linkable
const $a220fff115a0570f$var$Linkable=$3CL91.Class.extend({className:"Linkable",prev:null,next:null,value:null,__ctor:function(e){this.value=e,this.clear()},__dtor:function(){this.unlink()},clear:function(){return this.next=this.prev=null,this},linkAfter:function(e){this.prev=e,this.next=e?e.next:null,e&&(e.next&&(e.next.prev=this),e.next=this)},linkBefore:function(e){this.prev=e?e.prev:null,this.next=e,e&&(e.prev&&(e.prev.next=this),e.prev=this)},unlink:function(){return this.prev&&(this.prev.next=this.next),this.next&&(this.next.prev=this.prev),this.clear()}});
//!/class
//!namespace Linkable
//!namespace Pool
$cac8b143592e7d73$export$2e2bcd8739ae039.createPool($a220fff115a0570f$var$Linkable,16384,6144);var $a220fff115a0570f$export$2e2bcd8739ae039=$a220fff115a0570f$var$Linkable;
//![import "./linkable"]
//![import "./recycler"]
//!class List
const $c73414f3aa8cd9da$var$List=$3CL91.Class.extend({className:"List",top:null,bottom:null,length:0,__ctor:function(){this.top=null,this.bottom=null,this.length=0},__dtor:function(){this.reset()},clone:function(){let e=$c73414f3aa8cd9da$var$List.Pool.alloc();for(let t=this.top;t;t=t.next)e.push($3CL91.Rinn.clone(t.value));return e},clear:function(){let e,t;for(e=this.top;e;e=t)t=e.next,dispose(e.free().value);return this.top=this.bottom=null,this.length=0,this},reset:function(){let e,t;for(e=this.top;null!=e;e=t)t=e.next,e.free();return this.top=this.bottom=null,this.length=0,this},first:function(){return null!==this.top?this.top.value:null},last:function(){return null!==this.bottom?this.bottom.value:null},getAt:function(e){let t=null;for(t=this.top;t&&e-- >0;t=t.next);return null!=t?t.value:null},getNodeAt:function(e){let t=null;for(t=this.top;t&&e--;t=t.next);return t},sgetNode:function(e){for(let t=this.top;t;t=t.next)if(t.value===e)return t;return null},remove:function(e){return null==e||$a220fff115a0570f$export$2e2bcd8739ae039.isInstance(e)||(e=this.sgetNode(e)),e?(e.prev||(this.top=e.next),e.next||(this.bottom=e.prev),this.length--,e.free().value):null},insertBefore:function(e,t){if(!e)return this;let a=$a220fff115a0570f$export$2e2bcd8739ae039.Pool.alloc(t);return a.linkBefore(e),e==this.top&&(this.top=a),this.length++,t},insertAfter:function(e,t){if(!e)return this;let a=$a220fff115a0570f$export$2e2bcd8739ae039.Pool.alloc(t);return a.linkAfter(e),e==this.bottom&&(this.bottom=a),this.length++,t},unshift:function(e){let t=$a220fff115a0570f$export$2e2bcd8739ae039.Pool.alloc(e);return t.linkBefore(this.top),this.bottom||(this.bottom=t),this.top=t,this.length++,e},shift:function(){let e=this.top;return e?((this.top=e.next)||(this.bottom=null),this.length--,e.free().value):null},push:function(e){let t=$a220fff115a0570f$export$2e2bcd8739ae039.Pool.alloc(e);return t.linkAfter(this.bottom),this.top||(this.top=t),this.bottom=t,this.length++,e},pop:function(){let e=this.bottom;return e?((this.bottom=e.prev)||(this.top=null),this.length--,e.free().value):null},append:function(e){for(let t=e.top;t;t=t.next)this.push(t.value);return this},forEach:function(e,t=null){let a;for(let i=this.top;i;i=a)if(a=i.next,!1===e(i.value,i,this,t))return!1;return!0},forEachRev:function(e,t=null){let a;for(let i=this.bottom;i;i=a)if(a=i.prev,!1===e(i.value,i,this,t))return!1;return!0},find:function(e,t=null){for(let a=this.top;a;a=a.next)if(e(a.value,t))return a.value;return null},filter:function(e,t=null){let a=$c73414f3aa8cd9da$var$List.Pool.alloc();for(let i=this.top;i;i=i.next)e(i.value,t)&&a.push(i.value);return a},toArray:function(){let e=[];for(let t=this.top;t;t=t.next)e.push(t.value);return e}});
//!/class
//!namespace List
//!namespace Pool
$cac8b143592e7d73$export$2e2bcd8739ae039.createPool($c73414f3aa8cd9da$var$List,16384,6144);var $c73414f3aa8cd9da$export$2e2bcd8739ae039=$c73414f3aa8cd9da$var$List;
//!class Timer
const $445264d030762d7a$var$Timer=function(e,t,a){this.callback=a,this.interval=t,this.vsync=e,this.handle=null,this.isRunning=!1,this.startTime=0,this.rTime=0,this.sTime=0,this.lTime=0,this.tDelta=0,this._onTimeout=()=>{this.onTimeout()},this._onTimeout_b=()=>{this.runNow()}};$445264d030762d7a$var$Timer.prototype.onTimeout=function(){if(!this.isRunning)return;this.rTime=hrnow()-this.startTime;let e=this.rTime-(this.sTime+this.interval);e<0?this.runAfter(-e):(this.sTime+=this.interval*(1+int(e/this.interval)),this.tDelta=e<0?this.interval:this.rTime-this.lTime,this.lTime=this.rTime,this.runAfter(this.sTime+this.interval-(hrnow()-this.startTime)),this.callback(this.tDelta,this))},$445264d030762d7a$var$Timer.prototype.start=function(e=!1,t=1){this.isRunning||(this.startTime=hrnow(),this.isRunning=!0,this.sTime=0,this.lTime=0,this.onStarted(),e&&this.callback(0,this),this.runAfter(this.interval*t))},$445264d030762d7a$var$Timer.prototype.runAfter=function(e){this.vsync?requestAnimationFrame(this._onTimeout_b):(this.handle&&clearTimeout(this.handle),this.handle=setTimeout(this._onTimeout,e))},$445264d030762d7a$var$Timer.prototype.runNow=function(){this.handle&&clearTimeout(this.handle),this.handle=setTimeout(this._onTimeout,0)},$445264d030762d7a$var$Timer.prototype.stop=function(){this.isRunning&&(this.handle&&(clearTimeout(this.handle),this.handle=null),this.isRunning=!1,this.onStopped())},$445264d030762d7a$var$Timer.prototype.onStarted=function(){},$445264d030762d7a$var$Timer.prototype.onStopped=function(){};var $445264d030762d7a$export$2e2bcd8739ae039=$445264d030762d7a$var$Timer,$3CL91=parcelRequire("3CL91"),$3CL91=parcelRequire("3CL91"),$3CL91=parcelRequire("3CL91");
//![import "../utils/recycler"]
//!class Vec2
const $21edd9058bfa8ef7$var$Vec2=$3CL91.Class.extend({className:"Vec2",x:0,y:0,__ctor:function(e=null,t=null){return this.set(e,t)},clone:function(){return $21edd9058bfa8ef7$var$Vec2.Pool.alloc(this)},set:function(e,t=null){if(null===e)e=0,t=0;else if(null===t){let a=e;e=a.x,t=a.y}return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},zero:function(){return this.set(0,0)},isZero:function(){return 0==this.x&&0==this.y},equals:function(e,t=null){if(null===t){let a=e;e=a.x,t=a.y}return this.x==e&&this.y==t},neg:function(){return this.x=-this.x,this.y=-this.y,this},inv:function(){return this.x=1/this.x,this.y=1/this.y,this},abs:function(){return this.x=this.x<0?-this.x:this.x,this.y=this.y<0?-this.y:this.y,this},translate:function(e,t=null){if(null===t){let a=e;e=a.x,t=a.y}return this.x+=e,this.y+=t,this},rotate:function(e,t=0,a=0){let i=(this.x-t)*Math.cos(e)+(this.y-a)*Math.sin(e),r=(this.y-a)*Math.cos(e)-(this.x-t)*Math.sin(e);return this.x=i+t,this.y=r+a,this},add:function(e,t=null){if(null===t){let a=e;e=a.x,t=a.y}return this.x+=e,this.y+=t,this},sub:function(e,t=null){if(null===t){let a=e;e=a.x,t=a.y}return this.x-=e,this.y-=t,this},scale:function(e,t=null){if(null===t)if($21edd9058bfa8ef7$var$Vec2.isInstance(e)){let a=e;e=a.x,t=a.y}else t=e;return this.x*=e,this.y*=t,this},floor:function(){return this.x=int(this.x),this.y=int(this.y),this},fract:function(){return this.x=this.x-int(this.x),this.y=this.y-int(this.y),this},dot:function(e,t=null){if(null===t){let a=e;e=a.x,t=a.y}return this.x*e+this.y*t},magnitude:function(e=!1){return e?this.x*this.x+this.y*this.y:Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.isZero()?this:this.scale(1/this.magnitude())},majorAxis:function(){return Math.abs(this.x)>Math.abs(this.y)?this.y=0:this.x=0,this},minorAxis:function(){return Math.abs(this.x)<Math.abs(this.y)?this.y=0:this.x=0,this},sign:function(){return this.x=this.x?this.x<0?-1:1:0,this.y=this.y?this.y<0?-1:1:0,this},toString:function(){return`(${this.x}, ${this.y})`}});
//!/class
//!namespace Vec2
//!namespace Pool
$cac8b143592e7d73$export$2e2bcd8739ae039.createPool($21edd9058bfa8ef7$var$Vec2,4096,2048);var $21edd9058bfa8ef7$export$2e2bcd8739ae039=$21edd9058bfa8ef7$var$Vec2;
//![import "../utils/recycler"]
//![import "./vec2"]
const $ffcd6f0a38d315dc$var$temp=new Float32Array(9).fill(0),$ffcd6f0a38d315dc$var$temp2=new Float32Array(9).fill(0),$ffcd6f0a38d315dc$var$Matrix=$3CL91.Class.extend({className:"Matrix",data:null,__ctor:function(e=null){null===this.data&&(this.data=new Float32Array(9)),null!==e?this.set(e):this.identity()},zero:function(){return this.data.fill(0),this},fill:function(e){return this.data.fill(e),this},set:function(e){if($ffcd6f0a38d315dc$var$Matrix.isInstance(e))for(let t=0;t<9;t++)this.data[t]=e.data[t];else for(let t=0;t<9;t++)this.data[t]=e[t];return this},identity:function(e=null){return null===e&&(e=this.data),e.fill(0),e[0]=e[4]=e[8]=1,this},scalef:function(e){for(let t=0;t<9;t++)this.data[t]*=e;return this},clone:function(){return $ffcd6f0a38d315dc$var$Matrix.Pool.alloc(this)},append:function(e){e instanceof $ffcd6f0a38d315dc$var$Matrix&&(e=e.data);for(let e=0;e<9;e++)$ffcd6f0a38d315dc$var$temp[e]=this.data[e];return this.data[0]=e[0]*$ffcd6f0a38d315dc$var$temp[0]+e[1]*$ffcd6f0a38d315dc$var$temp[3]+e[2]*$ffcd6f0a38d315dc$var$temp[6],this.data[1]=e[0]*$ffcd6f0a38d315dc$var$temp[1]+e[1]*$ffcd6f0a38d315dc$var$temp[4]+e[2]*$ffcd6f0a38d315dc$var$temp[7],this.data[2]=e[0]*$ffcd6f0a38d315dc$var$temp[2]+e[1]*$ffcd6f0a38d315dc$var$temp[5]+e[2]*$ffcd6f0a38d315dc$var$temp[8],this.data[3]=e[3]*$ffcd6f0a38d315dc$var$temp[0]+e[4]*$ffcd6f0a38d315dc$var$temp[3]+e[5]*$ffcd6f0a38d315dc$var$temp[6],this.data[4]=e[3]*$ffcd6f0a38d315dc$var$temp[1]+e[4]*$ffcd6f0a38d315dc$var$temp[4]+e[5]*$ffcd6f0a38d315dc$var$temp[7],this.data[5]=e[3]*$ffcd6f0a38d315dc$var$temp[2]+e[4]*$ffcd6f0a38d315dc$var$temp[5]+e[5]*$ffcd6f0a38d315dc$var$temp[8],this.data[6]=e[6]*$ffcd6f0a38d315dc$var$temp[0]+e[7]*$ffcd6f0a38d315dc$var$temp[3]+e[8]*$ffcd6f0a38d315dc$var$temp[6],this.data[7]=e[6]*$ffcd6f0a38d315dc$var$temp[1]+e[7]*$ffcd6f0a38d315dc$var$temp[4]+e[8]*$ffcd6f0a38d315dc$var$temp[7],this.data[8]=e[6]*$ffcd6f0a38d315dc$var$temp[2]+e[7]*$ffcd6f0a38d315dc$var$temp[5]+e[8]*$ffcd6f0a38d315dc$var$temp[8],this},translate:function(e,t){if(0==e&&0==t)return this;for(let e=0;e<9;e++)$ffcd6f0a38d315dc$var$temp[e]=this.data[e];return this.data[6]=e*$ffcd6f0a38d315dc$var$temp[0]+t*$ffcd6f0a38d315dc$var$temp[3]+$ffcd6f0a38d315dc$var$temp[6],this.data[7]=e*$ffcd6f0a38d315dc$var$temp[1]+t*$ffcd6f0a38d315dc$var$temp[4]+$ffcd6f0a38d315dc$var$temp[7],this.data[8]=e*$ffcd6f0a38d315dc$var$temp[2]+t*$ffcd6f0a38d315dc$var$temp[5]+$ffcd6f0a38d315dc$var$temp[8],this},rotate:function(e){if(0==e)return this;this.identity($ffcd6f0a38d315dc$var$temp2);let t=Math.cos(e),a=Math.sin(e);return $ffcd6f0a38d315dc$var$temp2[0]=t,$ffcd6f0a38d315dc$var$temp2[1]=-a,$ffcd6f0a38d315dc$var$temp2[3]=a,$ffcd6f0a38d315dc$var$temp2[4]=t,this.append($ffcd6f0a38d315dc$var$temp2)},scale:function(e,t){return 1==e&&1==t?this:(this.identity($ffcd6f0a38d315dc$var$temp2),$ffcd6f0a38d315dc$var$temp2[0]=e,$ffcd6f0a38d315dc$var$temp2[4]=t,this.append($ffcd6f0a38d315dc$var$temp2))},applyTo:function(e,t=null){if(null===t){const a=e;e=a.x,t=a.y}let a=this.data[0]*e+this.data[3]*t+this.data[6],i=this.data[1]*e+this.data[4]*t+this.data[7];return $21edd9058bfa8ef7$export$2e2bcd8739ae039.Pool.alloc(a,i)},transpose:function(){$ffcd6f0a38d315dc$var$temp.fill(0);for(let e=0;e<3;e++)for(let t=0;t<3;t++)$ffcd6f0a38d315dc$var$temp[3*e+t]=this.data[3*t+e];for(let e=0;e<9;e++)this.data[e]=$ffcd6f0a38d315dc$var$temp[e];return this},det:function(){return this.data[0]*(this.data[4]*this.data[8]-this.data[5]*this.data[7])-this.data[1]*(this.data[3]*this.data[8]-this.data[5]*this.data[6])+this.data[2]*(this.data[3]*this.data[7]-this.data[4]*this.data[6])},adj:function(){throw new Error("NOT IMPLEMENTED")},inverse:function(){let e=this.det();return e?this.adj().scalef(1/e):null},toString:function(){return`[${this.data[0]}, ${this.data[3]}, ${this.data[6]}]\n[${this.data[1]}, ${this.data[4]}, ${this.data[7]}]\n[${this.data[2]}, ${this.data[5]}, ${this.data[8]}]\n`}});$ffcd6f0a38d315dc$var$Matrix.loadIdentity=function(e){e.fill(0),e[0]=e[4]=e[8]=1},
//!/class
//!namespace Matrix
//!namespace Pool
$cac8b143592e7d73$export$2e2bcd8739ae039.createPool($ffcd6f0a38d315dc$var$Matrix,4096,1024);var $ffcd6f0a38d315dc$export$2e2bcd8739ae039=$ffcd6f0a38d315dc$var$Matrix,$3CL91=parcelRequire("3CL91"),$3CL91=parcelRequire("3CL91");
//!namespace glx
//!enum BufferTarget
//!/enum
//!enum BufferUsage
//!STATIC_DRAW
//!DYNAMIC_DRAW
//!STREAM_DRAW
//!STATIC_READ
//!DYNAMIC_READ
//!STREAM_READ
//!STATIC_COPY
//!DYNAMIC_COPY
//!STREAM_COPY
//!/enum
//!/namespace
//!class glx
const $8056ec6610d6f975$var$glx={BufferTarget:{},BufferUsage:{},gl:null,setContext:function(e){return this.gl=e,this.BufferTarget.ARRAY_BUFFER=this.gl.ARRAY_BUFFER,this.BufferTarget.ELEMENT_ARRAY_BUFFER=this.gl.ELEMENT_ARRAY_BUFFER,this.BufferTarget.COPY_READ_BUFFER=this.gl.COPY_READ_BUFFER,this.BufferTarget.COPY_WRITE_BUFFER=this.gl.COPY_WRITE_BUFFER,this.BufferTarget.TRANSFORM_FEEDBACK_BUFFER=this.gl.TRANSFORM_FEEDBACK_BUFFER,this.BufferTarget.UNIFORM_BUFFER=this.gl.UNIFORM_BUFFER,this.BufferTarget.PIXEL_PACK_BUFFER=this.gl.PIXEL_PACK_BUFFER,this.BufferTarget.PIXEL_UNPACK_BUFFER=this.gl.PIXEL_UNPACK_BUFFER,this.BufferUsage.STATIC_DRAW=this.gl.STATIC_DRAW,this.BufferUsage.DYNAMIC_DRAW=this.gl.DYNAMIC_DRAW,this.BufferUsage.STREAM_DRAW=this.gl.STREAM_DRAW,this.BufferUsage.STATIC_READ=this.gl.STATIC_READ,this.BufferUsage.DYNAMIC_READ=this.gl.DYNAMIC_READ,this.BufferUsage.STREAM_READ=this.gl.STREAM_READ,this.BufferUsage.STATIC_COPY=this.gl.STATIC_COPY,this.BufferUsage.DYNAMIC_COPY=this.gl.DYNAMIC_COPY,this.BufferUsage.STREAM_COPY=this.gl.STREAM_COPY,this},getParameter:function(e){return this.gl.getParameter(this.gl[e])},getFloat32Array:function(e,t,a){if(0===t&&a===e.length&&e instanceof Float32Array)return e;let i=new Float32Array(a);for(let r=0;r<a;r++)i[r]=e[r+t];return i},createBufferFrom:function(e,t=null,a=null,i=null,r=null){t=t??$8056ec6610d6f975$var$glx.BufferTarget.ARRAY_BUFFER,a=a??$8056ec6610d6f975$var$glx.BufferUsage.STATIC_DRAW;let n=this.gl.createBuffer();return this.gl.bindBuffer(t,n),this.gl.bufferData(t,this.getFloat32Array(e,i??0,r??e.length),a),n}};var//!/class
$8056ec6610d6f975$export$2e2bcd8739ae039=$8056ec6610d6f975$var$glx;
//!class glsl
const $3d37cfb473d35ef0$var$glsl={snippets:{},set:function(e,t){this.snippets[e]=t},get:function(e){return this.snippets.hasOwnProperty(e)?this.snippets[e]:""},replace:function(e,t){e=e.split("\n");for(let a=0;a<e.length;a++){let i=e[a].trim();if(i.startsWith("//@use ")){let r="";for(let e of i.substring(7).split(","))e=e.trim(),t.hasOwnProperty(e)||(t[e]=!0,r+=$3d37cfb473d35ef0$var$glsl.replace($3d37cfb473d35ef0$var$glsl.get(e),t)+"\n");e[a]=r}}return e.join("\n")},process:function(e){return-1===(e=e.trim()).indexOf("precision")&&(e="precision highp float;\n"+e),-1===e.indexOf("#version")&&(e="#version 300 es\n"+e),this.replace(e,{})}};var//!/class
$3d37cfb473d35ef0$export$2e2bcd8739ae039=$3d37cfb473d35ef0$var$glsl;$3d37cfb473d35ef0$var$glsl.set("vert-defs","\n\tuniform mat3 m_transform;\n\tuniform mat3 m_quad;\n\tuniform mat3 m_texture;\n\tuniform vec4 v_resolution;\n\tuniform vec4 v_frame_size;\n\tuniform float f_scale;\n\tuniform float f_time;\n\tuniform float f_depth;\n\n\tin vec3 location;\n\tout vec2 texcoords;\n"),$3d37cfb473d35ef0$var$glsl.set("frag-defs","\n\tuniform vec4 v_resolution;\n\tuniform vec4 v_frame_size;\n\tuniform float f_scale;\n\tuniform float f_time;\n\tuniform float f_alpha;\n\tuniform sampler2D texture0;\n\n\tin vec2 texcoords;\n\tout vec4 color;\n"),$3d37cfb473d35ef0$var$glsl.set("invertX","\n\tvec2 invertX (vec2 value) {\n\t\treturn value * vec2(-1.0, 1.0);\n\t}\n"),$3d37cfb473d35ef0$var$glsl.set("invertY","\n\tvec2 invertY (vec2 value) {\n\t\treturn value * vec2(1.0, -1.0);\n\t}\n"),$3d37cfb473d35ef0$var$glsl.set("norm","\n\tfloat norm (float value) {\n\t\treturn (value + 1.0) * 0.5;\n\t}\n\n\tvec2 norm (vec2 value) {\n\t\treturn (value + 1.0) * 0.5;\n\t}\n\n\tvec3 norm (vec3 value) {\n\t\treturn (value + 1.0) * 0.5;\n\t}\n"),$3d37cfb473d35ef0$var$glsl.set("snorm","\n\tfloat snorm (float value) {\n\t\treturn value * 2.0 - 1.0;\n\t}\n\n\tvec2 snorm (vec2 value) {\n\t\treturn value * 2.0 - 1.0;\n\t}\n\n\tvec3 snorm (vec3 value) {\n\t\treturn value * 2.0 - 1.0;\n\t}\n"),$3d37cfb473d35ef0$var$glsl.set("location2d","\n\t//@use invertY, snorm\n\n\tvec4 location2d (vec3 location, float depth)\n\t{\n\t\tvec2 loc = vec2(m_transform * m_quad * location) / v_resolution.xy;\n\t\treturn vec4(invertY(snorm(loc)), depth/16777216.0, 1.0);\n\t}\n"),$3d37cfb473d35ef0$var$glsl.set("frameTexCoords","\n\tflat out vec2 v_frame_offset;\n\n\tvec2 frameTexCoords (vec3 location) {\n\t\tv_frame_offset = vec2(m_texture[2][0], m_texture[2][1]);\n\t\treturn mat2(m_texture * m_quad) * location.xy / (v_frame_size.xy * v_frame_size.zw);\n\t}\n"),$3d37cfb473d35ef0$var$glsl.set("frameTex","\n\tflat in vec2 v_frame_offset;\n\n\tvec4 frameTex (vec2 texcoords) {\n\t\treturn texture(texture0, fract(texcoords)*v_frame_size.xy + v_frame_offset);\n\t}\n"),$3d37cfb473d35ef0$var$glsl.set("rand","\n\tfloat rand (vec2 value) {\n\t\treturn fract(sin(dot(value, vec2(12.9898, 78.233))) * 43758.5453);\n\t}\n"),$3d37cfb473d35ef0$var$glsl.set("align","\n\tfloat align (float value, float step) {\n\t\treturn floor(value/step)*step;\n\t}\n"),$3d37cfb473d35ef0$var$glsl.set("sqwave","\n\tfloat sqwave (float time, float period, float dcycle) {\n\t\treturn step(mod(time, period) - dcycle*period, 0.0);\n\t}\n"),$3d37cfb473d35ef0$var$glsl.set("mask","\n\tfloat mask (float alpha) {\n\t\treturn 1.0 - step(alpha, 0.0);\n\t}\n\n\tfloat mask (vec4 color) {\n\t\treturn 1.0 - step(color.a, 0.0);\n\t}\n");
//![import "./glx"]
//![import "./glsl"]
//!class Shader
const $70b12fe29b3755e8$var$Shader=$3CL91.Class.extend({id:null,type:0,shaderId:null,__ctor:function(e,t=null,a=null){null===a&&null!==t&&"string"==typeof t&&(a=t,t=null),null===t&&(t=e,e=null),$70b12fe29b3755e8$var$Shader.put(this.id=e,this),this.type=t,this.shaderId=null,null!==a&&this.compile(a)},__dtor:function(){$8056ec6610d6f975$export$2e2bcd8739ae039.gl.deleteShader(this.shaderId),$70b12fe29b3755e8$var$Shader.remove(this.id)},compile:function(e){let t=$8056ec6610d6f975$export$2e2bcd8739ae039.gl;this.shaderId=t.createShader(this.type===$70b12fe29b3755e8$var$Shader.Type.VERTEX?t.VERTEX_SHADER:this.type===$70b12fe29b3755e8$var$Shader.Type.FRAGMENT?t.FRAGMENT_SHADER:t.GEOMETRY_SHADER),e=$3d37cfb473d35ef0$export$2e2bcd8739ae039.process(e),t.shaderSource(this.shaderId,e),t.compileShader(this.shaderId);let a=t.getShaderInfoLog(this.shaderId);if(a)throw console.error(e.split("\n").map(((e,t)=>t+": "+e)).join("\n")),new Error((this.id?"["+this.id+"] ":"")+a);return this}});
//!/class
$70b12fe29b3755e8$var$Shader.shaders={},$70b12fe29b3755e8$var$Shader.put=function(e,t){e&&(this.shaders[e]=t)},$70b12fe29b3755e8$var$Shader.get=function(e){return this.shaders[e]},$70b12fe29b3755e8$var$Shader.remove=function(e){delete this.shaders[e]},
//!namespace Shader
//!enum Type
$70b12fe29b3755e8$var$Shader.Type={VERTEX:0,
//!VERTEX
FRAGMENT:1,
//!FRAGMENT
GEOMETRY:2};var//!/enum
$70b12fe29b3755e8$export$2e2bcd8739ae039=$70b12fe29b3755e8$var$Shader;
//![import "./shader"]
//![import "./globals"]
//![import "./glx"]
//!class ShaderProgram
const $00b4569a92b7ec96$var$ShaderProgram=$3CL91.Class.extend({locations:null,id:null,shaders:null,programId:null,__ctor:function(e=null){this.id=e,this.shaders=[],this.programId=null,this.locations={},this._uniformSetter=null,$00b4569a92b7ec96$var$ShaderProgram.put(e,this)},__dtor:function(){let e=$8056ec6610d6f975$export$2e2bcd8739ae039.gl;if(!e)return this;e.deleteProgram(this.programId),$00b4569a92b7ec96$var$ShaderProgram.remove(this.id)},uniformSetter:function(e){return this._uniformSetter=e,this},attach:function(e){if("string"==typeof e&&(e=$70b12fe29b3755e8$export$2e2bcd8739ae039.get(e)),!e)throw new Error("Unable to attach shader, argument is null.");return this.shaders.push(e),this},bindLocations:function(){$8056ec6610d6f975$export$2e2bcd8739ae039.gl.bindAttribLocation(this.programId,0,"location")},getAttribLocation:function(e){return this.locations.hasOwnProperty(e)||(this.locations[e]=$8056ec6610d6f975$export$2e2bcd8739ae039.gl.getAttribLocation(this.programId,e)),this.locations[e]},getUniformLocation:function(e){return this.locations.hasOwnProperty(e)||(this.locations[e]=$8056ec6610d6f975$export$2e2bcd8739ae039.gl.getUniformLocation(this.programId,e)),this.locations[e]},getUniformBlockLocation:function(e){return this.locations.hasOwnProperty(e)||(this.locations[e]=$8056ec6610d6f975$export$2e2bcd8739ae039.gl.getUniformBlockIndex(this.programId,e)),this.locations[e]},getUniformBlockSize:function(e){return"string"==typeof e&&(e=this.getUniformBlockLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.getActiveUniformBlockParameter(this.programId,e,$8056ec6610d6f975$export$2e2bcd8739ae039.gl.UNIFORM_BLOCK_DATA_SIZE)},createUniformBlockBuffer:function(e){"string"==typeof e&&(e=this.getUniformBlockLocation(e));let t=this.getUniformBlockSize(e),a=$8056ec6610d6f975$export$2e2bcd8739ae039.createBufferFrom(new Float32Array(t).fill(0),$8056ec6610d6f975$export$2e2bcd8739ae039.BufferTarget.UNIFORM_BUFFER,$8056ec6610d6f975$export$2e2bcd8739ae039.BufferUsage.DYNAMIC_DRAW);$8056ec6610d6f975$export$2e2bcd8739ae039.gl.bindBufferBase($8056ec6610d6f975$export$2e2bcd8739ae039.BufferTarget.UNIFORM_BUFFER,0,a)},preloadLocations:function(){this.getUniformLocation("f_time"),this.getUniformLocation("f_scale"),this.getUniformLocation("m_transform"),this.getUniformLocation("m_texture"),this.getUniformLocation("m_quad"),this.getUniformLocation("v_resolution"),this.getUniformLocation("v_frame_size"),this.getUniformLocation("f_depth"),this.getUniformLocation("f_alpha"),this.getUniformLocation("v_base_color"),this.getUniformLocation("texture0"),this.getAttribLocation("location")},link:function(){let e=$8056ec6610d6f975$export$2e2bcd8739ae039.gl;if(!e)return this;this.programId=e.createProgram();for(let t of this.shaders)e.attachShader(this.programId,t.shaderId);return this.bindLocations(),e.linkProgram(this.programId),this.preloadLocations(),this},activate:function(){let e=$8056ec6610d6f975$export$2e2bcd8739ae039.gl;e&&(e.useProgram(this.programId),null!==this._uniformSetter&&this._uniformSetter(this,e))},getStatus:function(){let e=$8056ec6610d6f975$export$2e2bcd8739ae039.gl;return!e||e.getProgramParameter(this.programId,e.LINK_STATUS)},getError:function(){let e=$8056ec6610d6f975$export$2e2bcd8739ae039.gl;return e?null===this.programId?"Program has not been linked.":e.getProgramInfoLog(this.programId):""},uniform1f:function(e,t){return"string"==typeof e&&(e=this.getUniformLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.uniform1f(e,t),this},uniform1fv:function(e,t){return"string"==typeof e&&(e=this.getUniformLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.uniform1fv(e,t),this},uniform1i:function(e,t){return"string"==typeof e&&(e=this.getUniformLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.uniform1i(e,t),this},uniform1iv:function(e,t){return"string"==typeof e&&(e=this.getUniformLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.uniform1iv(e,t),this},uniform2f:function(e,t,a){return"string"==typeof e&&(e=this.getUniformLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.uniform2f(e,t,a),this},uniform2fv:function(e,t){return"string"==typeof e&&(e=this.getUniformLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.uniform2fv(e,t),this},uniform2i:function(e,t,a){return"string"==typeof e&&(e=this.getUniformLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.uniform2i(e,t,a),this},uniform2iv:function(e,t){return"string"==typeof e&&(e=this.getUniformLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.uniform2iv(e,t),this},uniform3f:function(e,t,a,i){return"string"==typeof e&&(e=this.getUniformLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.uniform3f(e,t,a,i),this},uniform3fv:function(e,t){return"string"==typeof e&&(e=this.getUniformLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.uniform3fv(e,t),this},uniform3i:function(e,t,a,i){return"string"==typeof e&&(e=this.getUniformLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.uniform3i(e,t,a,i),this},uniform3iv:function(e,t){return"string"==typeof e&&(e=this.getUniformLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.uniform3iv(e,t),this},uniform4f:function(e,t,a,i,r){return"string"==typeof e&&(e=this.getUniformLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.uniform4f(e,t,a,i,r),this},uniform4fv:function(e,t){return"string"==typeof e&&(e=this.getUniformLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.uniform4fv(e,t),this},uniform4i:function(e,t,a,i,r){return"string"==typeof e&&(e=this.getUniformLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.uniform4i(e,t,a,i,r),this},uniform4iv:function(e,t){return"string"==typeof e&&(e=this.getUniformLocation(e)),$8056ec6610d6f975$export$2e2bcd8739ae039.gl.uniform4iv(e,t),this}});$00b4569a92b7ec96$var$ShaderProgram.programs={},$00b4569a92b7ec96$var$ShaderProgram.create=function(e,t){let a=null,i=null,r=null,n=null,s=null,o=null,l=null;for(let e of t.split("\n")){let t=e.trim();if(t.startsWith("//")){if(t=t.split(" ").map((e=>e.trim())),"//@vert"===t[0]){t.length>1&&(i=t[1]),null===a&&(a=[]),l=a;continue}if("//@frag"===t[0]){t.length>1&&(n=t[1]),null===r&&(r=[]),l=r;continue}if("//@geom"===t[0]){t.length>1&&(o=t[1]),null===s&&(s=[]),l=s;continue}}null!==l&&l.push(e)}let c=new $00b4569a92b7ec96$var$ShaderProgram(e);if(null!==a&&(a=a.join("\n").trim()),null!==r&&(r=r.join("\n").trim()),null!==s&&(s=s.join("\n").trim()),null!==a&&0===a.length){if(a=$70b12fe29b3755e8$export$2e2bcd8739ae039.get(i),null===a)throw new Error("Vertex shader not found: "+i)}else null!==a&&0!==a.length||(a=null);if(null!==r&&0===r.length){if(r=$70b12fe29b3755e8$export$2e2bcd8739ae039.get(n),null===r)throw new Error("Fragment shader not found: "+n)}else null!==r&&0!==r.length||(r=null);if(null!==s&&0===s.length){if(s=$70b12fe29b3755e8$export$2e2bcd8739ae039.get(o),null===s)throw new Error("Geometry shader not found: "+o)}else null!==s&&0!==s.length||(s=null);return null===a&&(a=$70b12fe29b3755e8$export$2e2bcd8739ae039.get("def-vert")),null===r&&(r=$70b12fe29b3755e8$export$2e2bcd8739ae039.get("def-frag")),null!==a&&"string"==typeof a&&(a=new $70b12fe29b3755e8$export$2e2bcd8739ae039(i,$70b12fe29b3755e8$export$2e2bcd8739ae039.Type.VERTEX,a)),null!==r&&"string"==typeof r&&(r=new $70b12fe29b3755e8$export$2e2bcd8739ae039(n,$70b12fe29b3755e8$export$2e2bcd8739ae039.Type.FRAGMENT,r)),null!==s&&"string"==typeof s&&(s=new $70b12fe29b3755e8$export$2e2bcd8739ae039(o,$70b12fe29b3755e8$export$2e2bcd8739ae039.Type.GEOMETRY,s)),null!==a&&c.attach(a),null!==r&&c.attach(r),null!==s&&c.attach(s),c.link()},$00b4569a92b7ec96$var$ShaderProgram.put=function(e,t){e&&(this.programs[e]=t)},$00b4569a92b7ec96$var$ShaderProgram.get=function(e){return this.programs[e]},$00b4569a92b7ec96$var$ShaderProgram.remove=function(e){delete this.programs[e]};var $00b4569a92b7ec96$export$2e2bcd8739ae039=$00b4569a92b7ec96$var$ShaderProgram,$3CL91=parcelRequire("3CL91"),//!namespace Texture
//!/namespace
//!class Texture
$c5d53d63ad830c04$export$2e2bcd8739ae039=$3CL91.Class.extend({className:"Texture",textureId:null,width:0,height:0,targetWidth:0,targetHeight:0,rscale:1,filter:"LINEAR",wrap:"CLAMP_TO_EDGE",mipmap:0,allocated:!1,__ctor:function(e,t,a=null,i=null){this.textureId=null,this.width=e,this.height=t,this.targetWidth=a??e,this.targetHeight=i??t,this.rscale=this.width/this.targetWidth,this.filter="LINEAR",this.wrap="CLAMP_TO_EDGE",this.mipmap=0},bind:function(){const e=$8056ec6610d6f975$export$2e2bcd8739ae039.gl;return null===this.textureId&&(this.textureId=e.createTexture()),e.bindTexture(e.TEXTURE_2D,this.textureId),!1===this.allocated&&(this.allocated=null,this.allocate()),e},allocate:function(){if(!0===this.allocated)return this;const e=this.bind();return this.mipmap>0?e.texStorage2D(e.TEXTURE_2D,this.mipmap,e.RGBA8,this.width,this.height):e.texStorage2D(e.TEXTURE_2D,1,e.RGBA8,this.width,this.height),this.allocated=!0,e},applyFilter:function(e=null){const t=e??this.bind();return this.mipmap>0?"NEAREST"===this.filter?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)):"NEAREST"===this.filter?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)),this},applyWrap:function(e=null){const t=e??this.bind();return"REPEAT"===this.wrap?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)):"MIRRORED_REPEAT"===this.wrap?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.MIRRORED_REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.MIRRORED_REPEAT)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),this},setFilter:function(e){return this.filter=e,null!==this.textureId&&this.applyFilter(),this},setWrap:function(e){return this.wrap=e,null!==this.textureId&&this.applyWrap(),this},setMipmap:function(e){if(this.mipmap=e,null!==this.textureId&&!0===this.allocated&&this.mipmap>0){const e=this.bind();e.generateMipmap(e.TEXTURE_2D)}return this},upload:function(e,t=0,a=0){const i=this.bind();return i.texSubImage2D(i.TEXTURE_2D,0,t,a,Math.min(e.width,this.width),Math.min(e.height,this.height),i.RGBA,i.UNSIGNED_BYTE,e),this.mipmap>0&&i.generateMipmap(i.TEXTURE_2D),this.applyFilter(i),this.applyWrap(i),this}});
//![import "../math/matrix"]
//![import "./system"]
//![import "../utils/list"]
//![import "./shader-program"]
//![import "./shader"]
//![import "./globals"]
//![import "./log"]
//![import "./glx"]
//![import "./texture"]
//!namespace Canvas
//!type Options =
//!/type
//!/namespace
//!class Canvas
const $ea6ab44f7f06a4a9$var$Canvas=function(e=null){let t={elem:null,gl:!1,background:"#000000",width:0,height:0,hidden:!0,absolute:!1,antialias:!1,...e};const a=!$parcel$global.document;null==t.elem?(this.elem=a?$3CL91.Rinn.clone($ea6ab44f7f06a4a9$var$Canvas.passThruCanvas):$parcel$global.document.createElement("canvas"),$parcel$global.document&&1!=t.hidden&&($parcel$global.document.body.appendChild(this.elem),!0===t.absolute&&(this.elem.style.position="absolute",this.elem.style.left="0",this.elem.style.top="0"))):this.elem=t.elem,this.elem.getContext&&(!0!==t.gl||a?(this.context=this.elem.getContext("2d",{desynchronized:!1}),this.gl=null):(this.gl=this.elem.getContext("webgl2",{desynchronized:!1,preserveDrawingBuffer:!1,alpha:!1,stencil:!0}),$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.gl=this.gl,$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.shaderProgram=null,$8056ec6610d6f975$export$2e2bcd8739ae039.setContext(this.gl),this.context=null,$70a42a4582ac5be9$export$2e2bcd8739ae039.write($8056ec6610d6f975$export$2e2bcd8739ae039.getParameter("VERSION")+", "+$8056ec6610d6f975$export$2e2bcd8739ae039.getParameter("SHADING_LANGUAGE_VERSION"))),this.matrixStack=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.alphaStack=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.depthFlagStack=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.shaderProgramStack=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.matr=$ffcd6f0a38d315dc$export$2e2bcd8739ae039.Pool.alloc(),this.transform=$ffcd6f0a38d315dc$export$2e2bcd8739ae039.Pool.alloc(),this._globalScale=1,this._alpha=1,this._depthFlag=!0,this.updateTransform(),this.strokeStyle("#fff"),this.fillStyle("#fff"),t.width&&t.height&&this.resize(t.width,t.height),null!==this.gl&&this.initGl(),this.antialias=t.antialias,this.setBackground(t.background))};$ea6ab44f7f06a4a9$var$Canvas.passThruCanvas={parentNode:null,imageSmoothingEnabled:!0,style:{},width:960,height:540,getContext:function(e){return this},pushClip:function(){},popClip:function(){},scale:function(e,t){},rotate:function(e){},translate:function(e,t){},setTransform:function(e,t,a,i,r,n){},updateTransform:function(){},toDataURL:function(e,t){return""},beginPath:function(){},moveTo:function(e,t){},closePath:function(){},lineTo:function(){},rect:function(e,t,a,i){},fill:function(){},stroke:function(){},fillRect:function(e,t,a,i){},strokeRect:function(e,t,a,i){},clip:function(){},quadraticCurveTo:function(e,t,a,i){},bezierCurveTo:function(e,t,a,i,r,n){},arc:function(e,t,a,i,r,n){},arcTo:function(e,t,a,i,r){},fillText:function(e,t,a,i){},strokeText:function(e,t,a,i){},measureText:function(e){return{width:0}},createImageData:function(e,t){return{width:e,height:t}},getImageData:function(e,t,a,i){return{width:a,height:i,data:[]}},putImageData:function(e,t,a){},drawImage:function(e,t=0,a=0,i=null,r=null,n=null,s=null,o=null,l=null,c=null,h=null,f=null,u=null){},getBoundingClientRect:function(){return{left:0,top:0}}},$ea6ab44f7f06a4a9$var$Canvas.prototype.initGl=function(){let e=this.gl;if(this.glFWrapProgram=new $00b4569a92b7ec96$export$2e2bcd8739ae039("fwrap"),new $70b12fe29b3755e8$export$2e2bcd8739ae039("fwrap-vert",$70b12fe29b3755e8$export$2e2bcd8739ae039.Type.VERTEX,"\n\t\tuniform mat3 m_transform;\n\t\tuniform mat3 m_quad;\n\t\tuniform mat3 m_texture;\n\t\tuniform vec4 v_resolution;\n\t\tuniform vec4 v_frame_size;\n\t\tuniform float f_depth;\n\n\t\tin vec3 location;\n\t\tout vec2 texcoords;\n\n\t\t//@use location2d, frameTexCoords\n\n\t\tvoid main () {\n\t\t\tgl_Position = location2d (location, f_depth);\n\t\t\ttexcoords = frameTexCoords(location);\n\t\t}\n\t"),new $70b12fe29b3755e8$export$2e2bcd8739ae039("fwrap-frag",$70b12fe29b3755e8$export$2e2bcd8739ae039.Type.FRAGMENT,"\n\t\tuniform sampler2D texture0;\n\t\tuniform vec4 v_frame_size;\n\t\tuniform float f_alpha;\n\n\t\tin vec2 texcoords;\n\t\tout vec4 color;\n\n\t\t//@use frameTex\n\n\t\tvoid main () {\n\t\t\tcolor = frameTex(texcoords) * f_alpha;\n\t\t\tif (color.a == 0.0) discard;\n\t\t}\n\t"),this.glDefaultProgram=new $00b4569a92b7ec96$export$2e2bcd8739ae039("def"),new $70b12fe29b3755e8$export$2e2bcd8739ae039("def-vert",$70b12fe29b3755e8$export$2e2bcd8739ae039.Type.VERTEX,"\n\t\tuniform mat3 m_transform;\n\t\tuniform mat3 m_quad;\n\t\tuniform mat3 m_texture;\n\t\tuniform vec4 v_resolution;\n\t\tuniform float f_depth;\n\n\t\tin vec3 location;\n\t\tout vec2 texcoords;\n\n\t\t//@use location2d\n\n\t\tvoid main ()\n\t\t{\n\t\t\tgl_Position = location2d (location, f_depth);\n\t\t\ttexcoords = vec2(m_texture * location);\n\t\t}\n\t"),new $70b12fe29b3755e8$export$2e2bcd8739ae039("def-frag",$70b12fe29b3755e8$export$2e2bcd8739ae039.Type.FRAGMENT,"\n\t\tuniform sampler2D texture0;\n\t\tuniform float f_alpha;\n\n\t\tin vec2 texcoords;\n\t\tout vec4 color;\n\n\t\tvoid main() {\n\t\t\tcolor = texture(texture0, texcoords) * f_alpha;\n\t\t\tif (color.a == 0.0) discard;\n\t\t}\n\t"),this.glBlitProgram=new $00b4569a92b7ec96$export$2e2bcd8739ae039("blit"),new $70b12fe29b3755e8$export$2e2bcd8739ae039("blit-vert",$70b12fe29b3755e8$export$2e2bcd8739ae039.Type.VERTEX,"\n\t\tuniform vec4 v_resolution;\n\t\tuniform mat3 m_quad;\n\t\tuniform mat3 m_texture;\n\n\t\tin vec3 location;\n\t\tout vec2 texcoords;\n\n\t\t//@use snorm\n\n\t\tvoid main() {\n\t\t\tgl_Position = vec4(snorm(vec2(m_quad * location) / v_resolution.xy), 0.0, 1.0);\n\t\t\ttexcoords = vec2(m_texture * location);\n\t\t}\n\t"),new $70b12fe29b3755e8$export$2e2bcd8739ae039("blit-frag",$70b12fe29b3755e8$export$2e2bcd8739ae039.Type.FRAGMENT,"\n\t\tuniform sampler2D texture0;\n\t\tin vec2 texcoords;\n\t\tout vec4 color;\n\n\t\tvoid main() {\n\t\t\tcolor = texture(texture0, texcoords);\n\t\t}\n\t"),this.glDefaultProgram.attach("def-vert"),this.glDefaultProgram.attach("def-frag"),this.glFWrapProgram.attach("fwrap-vert"),this.glFWrapProgram.attach("fwrap-frag"),this.glBlitProgram.attach("blit-vert"),this.glBlitProgram.attach("blit-frag"),this.glDefaultProgram.link(),this.glFWrapProgram.link(),this.glBlitProgram.link(),!this.glDefaultProgram.getStatus())throw new Error(this.glDefaultProgram.getAllErrors());if(!this.glFWrapProgram.getStatus())throw new Error(this.glFWrapProgram.getAllErrors());if(!this.glBlitProgram.getStatus())throw new Error(this.glBlitProgram.getAllErrors());this.setShaderProgram($00b4569a92b7ec96$export$2e2bcd8739ae039.get("def")),this.vao0=e.createVertexArray(),e.bindVertexArray(this.vao0),$8056ec6610d6f975$export$2e2bcd8739ae039.createBufferFrom([0,0,1,0,1,1,1,0,1,1,1,1],$8056ec6610d6f975$export$2e2bcd8739ae039.BufferTarget.ARRAY_BUFFER,$8056ec6610d6f975$export$2e2bcd8739ae039.BufferUsage.STATIC_DRAW),e.vertexAttribPointer($f2e6a81a3fe74b9a$export$2e2bcd8739ae039.shaderProgram.getAttribLocation("location"),3,e.FLOAT,e.FALSE,3*Float32Array.BYTES_PER_ELEMENT,0*Float32Array.BYTES_PER_ELEMENT),e.enableVertexAttribArray($f2e6a81a3fe74b9a$export$2e2bcd8739ae039.shaderProgram.getAttribLocation("location")),e.clearColor(0,0,0,1),e.enable(e.DEPTH_TEST),e.clearDepth(0),e.depthFunc(e.GEQUAL),e.disable(e.DITHER),e.enable(e.BLEND),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this.m_quad=new Float32Array(9).fill(0),this.m_texture=new Float32Array(9).fill(0),this.v_resolution=new Float32Array(4).fill(0),this.zvalue=0,$ffcd6f0a38d315dc$export$2e2bcd8739ae039.loadIdentity(this.m_quad),$ffcd6f0a38d315dc$export$2e2bcd8739ae039.loadIdentity(this.m_texture),this.drawImage=function(e,t,a,i,r,n,s,o,l,c=null,h=null,f=null,u=null){if(!e.textureId)return;let d=this.gl,$=$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.shaderProgram;null===c&&(c=e.width,h=e.height),null===f&&(f=e.targetWidth,u=e.targetHeight),$.uniform4fv("v_resolution",this.v_resolution),$.uniform1f("f_time",$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.time),$.uniform1f("f_scale",this._globalScale),$.uniform1f("f_alpha",this._alpha),this.activeTextureId===e.textureId&&this.activeShader===$||(d.activeTexture(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,e.textureId),$.uniform1i("texture0",0),$.uniform4f("v_frame_size",f*e.rscale/c,u*e.rscale/h,f,u),this.activeTextureId=e.textureId,this.activeShader=$),this.m_quad[0]=o,this.m_quad[4]=l,this.m_quad[6]=n,this.m_quad[7]=s,this.m_texture[0]=i/c,this.m_texture[4]=r/h,this.m_texture[6]=t/c,this.m_texture[7]=a/h,d.uniformMatrix3fv($.getUniformLocation("m_transform"),!1,this.transform.data),d.uniformMatrix3fv($.getUniformLocation("m_quad"),!1,this.m_quad),d.uniformMatrix3fv($.getUniformLocation("m_texture"),!1,this.m_texture),d.uniform1f($.getUniformLocation("f_depth"),this.zvalue),d.drawArrays(d.TRIANGLE_STRIP,0,4)},this.drawRect=function(e,t,a,i,r=null){let n=this.gl,s=$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.shaderProgram;s.uniform4fv("v_resolution",this.v_resolution),s.uniform1f("f_time",$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.time),s.uniform1f("f_scale",this._globalScale),s.uniform1f("f_alpha",this._alpha),this.activeTextureId=null,this.m_quad[0]=a,this.m_quad[4]=i,this.m_quad[6]=e,this.m_quad[7]=t,this.m_texture[0]=1,this.m_texture[4]=1,this.m_texture[6]=0,this.m_texture[7]=0,n.uniformMatrix3fv(s.getUniformLocation("m_transform"),!1,this.transform.data),n.uniformMatrix3fv(s.getUniformLocation("m_quad"),!1,this.m_quad),n.uniformMatrix3fv(s.getUniformLocation("m_texture"),!1,this.m_texture),n.uniform1f(s.getUniformLocation("f_depth"),this.zvalue),n.drawArrays(n.TRIANGLE_STRIP,0,4)}},$ea6ab44f7f06a4a9$var$Canvas.prototype.prepareImage=function(e){$3CL91.Class.mutate($c5d53d63ad830c04$export$2e2bcd8739ae039,e,{width:e.width,height:e.height}).upload(e)},$ea6ab44f7f06a4a9$var$Canvas.prototype.createTexture=function(e,t,a="NEAREST",i=0){return console.log("createTexture"),new $c5d53d63ad830c04$export$2e2bcd8739ae039(e,t).setFilter(a).setMipmap(i).allocate()},$ea6ab44f7f06a4a9$var$Canvas.prototype.applyConfig=function(){0==this.antialias?(null!=this.context&&(this.context.imageSmoothingEnabled=!1),this.elem.style.imageRendering="crisp-edges"):(null!=this.context&&(this.context.imageSmoothingEnabled=!0),this.elem.style.imageRendering="auto")},$ea6ab44f7f06a4a9$var$Canvas.prototype.dispose=function(){this.elem.parentNode&&this.elem.parentNode.removeChild(this.elem),this.matrixStack.free(),this.alphaStack.free(),this.depthFlagStack.free(),this.shaderProgramStack.free(),this.matr=null,this.context=null,this.elem=null},$ea6ab44f7f06a4a9$var$Canvas.prototype.setBackground=function(e){if(this.elem.style.background=e,this.backgroundColor=e,null!==this.gl){if(7!=e.length)throw new Error("Canvas.setBackground: color parameter should be CSS-style hex-rgb with 6 digits.");let t=parseInt(e.substr(1,2),16)/255,a=parseInt(e.substr(3,2),16)/255,i=parseInt(e.substr(5,2),16)/255;this.gl.clearColor(t,a,i,1)}},$ea6ab44f7f06a4a9$var$Canvas.prototype.resize=function(e,t){let a=this.elem.getBoundingClientRect();e||(e=a.width),t||(t=a.height),this.elem.width=e,this.elem.height=t,this.width=this.elem.width,this.height=this.elem.height,this._width=int(this.width/this._globalScale),this._height=int(this.height/this._globalScale);let i=this.gl;return null!=i&&(i.enable(i.SCISSOR_TEST),i.scissor(0,0,this.width,this.height),i.viewport(0,0,this.width,this.height),this.v_resolution&&(this.v_resolution[0]=this.width,this.v_resolution[1]=this.height,this.v_resolution[2]=this.width,this.v_resolution[3]=this.height)),this.applyConfig(),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.globalScale=function(e){return this._globalScale=e,this._width=int(this.width/this._globalScale),this._height=int(this.height/this._globalScale),this.loadIdentity(),this.scale(e,e),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.flipped=function(e){return e?(this._width=int(this.height/this._globalScale),this._height=int(this.width/this._globalScale)):(this._width=int(this.width/this._globalScale),this._height=int(this.height/this._globalScale)),null!=this.gl&&this.v_resolution&&(this.v_resolution[0]=this.width,this.v_resolution[1]=this.height,this.v_resolution[2]=e?this.height:this.width,this.v_resolution[3]=e?this.width:this.height),this.isFlipped=e,this},$ea6ab44f7f06a4a9$var$Canvas.prototype.pushClip=function(){return this},$ea6ab44f7f06a4a9$var$Canvas.prototype.popClip=function(){return null!=this.gl&&this.gl.scissor(0,0,this.width,this.height),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.toDataUrl=function(e="image/png",t=null){return this.elem.toDataURL(e,t)},$ea6ab44f7f06a4a9$var$Canvas.prototype.toPngBase64=function(){return this.elem.toDataURL("image/png").substr(22)},$ea6ab44f7f06a4a9$var$Canvas.prototype._contextAttribute=function(e,t=null){if(this.context)return null!==t?(this.context[e]=t,this):this.context[e]},$ea6ab44f7f06a4a9$var$Canvas.prototype.fillStyle=function(e){return this._contextAttribute("fillStyle",e)},$ea6ab44f7f06a4a9$var$Canvas.prototype.strokeStyle=function(e){return this._contextAttribute("strokeStyle",e)},$ea6ab44f7f06a4a9$var$Canvas.prototype.lineCap=function(e){return this._contextAttribute("lineCap",e)},$ea6ab44f7f06a4a9$var$Canvas.prototype.lineJoin=function(e){return this._contextAttribute("lineJoin",e)},$ea6ab44f7f06a4a9$var$Canvas.prototype.lineWidth=function(e){return this._contextAttribute("lineWidth",e)},$ea6ab44f7f06a4a9$var$Canvas.prototype.miterLimit=function(e){return this._contextAttribute("miterLimit",e)},$ea6ab44f7f06a4a9$var$Canvas.prototype.shadowColor=function(e){return this._contextAttribute("shadowColor",e)},$ea6ab44f7f06a4a9$var$Canvas.prototype.shadowOffsetX=function(e){return this._contextAttribute("shadowOffsetX",e)},$ea6ab44f7f06a4a9$var$Canvas.prototype.shadowOffsetY=function(e){return this._contextAttribute("shadowOffsetY",e)},$ea6ab44f7f06a4a9$var$Canvas.prototype.shadowBlur=function(e){return this._contextAttribute("shadowBlur",e)},$ea6ab44f7f06a4a9$var$Canvas.prototype.font=function(e){return this._contextAttribute("font",e)},$ea6ab44f7f06a4a9$var$Canvas.prototype.textAlign=function(e){return this._contextAttribute("textAlign",e)},$ea6ab44f7f06a4a9$var$Canvas.prototype.textBaseline=function(e){return this._contextAttribute("textBaseline",e)},$ea6ab44f7f06a4a9$var$Canvas.prototype.globalAlpha=function(e=null){return null===e?this._alpha:(this._alpha=e,this.alpha(1))},$ea6ab44f7f06a4a9$var$Canvas.prototype.globalCompositeOperation=function(e){return this._contextAttribute("globalCompositeOperation",e)},$ea6ab44f7f06a4a9$var$Canvas.prototype.updateTransform=function(){return this.setTransform(this.matr.data[0],this.matr.data[1],this.matr.data[3],this.matr.data[4],this.matr.data[6],this.matr.data[7]),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.setTransform=function(e,t,a,i,r,n){return null===this.context?(this.transform.data[0]=e,this.transform.data[1]=t,this.transform.data[2]=0,this.transform.data[3]=a,this.transform.data[4]=i,this.transform.data[5]=0,this.transform.data[6]=int(r),this.transform.data[7]=int(n),this.transform.data[8]=1,this):(this.context.setTransform(e,t,a,i,int(r),int(n)),this)},$ea6ab44f7f06a4a9$var$Canvas.prototype.fillRect=function(e,t,a,i){return this.context.fillRect(e,t,a,i),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.strokeRect=function(e,t,a,i){return this.context.strokeRect(e,t,a,i),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.clearRect=function(e,t,a,i){return this.context.clearRect(e,t,a,i),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.beginPath=function(){return this.context.beginPath(),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.moveTo=function(e,t){return this.context.moveTo(e,t),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.closePath=function(){return this.context.closePath(),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.lineTo=function(e,t){return this.context.lineTo(e,t),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.rect=function(e,t,a,i){return this.context.rect(e,t,a,i),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.fill=function(e=null){return e&&this.fillStyle(e),this.context.fill(),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.stroke=function(e=null){return e&&this.strokeStyle(e),this.context.stroke(),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.clip=function(e,t,a,i){return null!==this.gl&&(e*=this._globalScale,t*=this._globalScale,a*=this._globalScale,i*=this._globalScale,this.isFlipped?this.gl.scissor(this.width-t-i-1,this.height-e-a-1,i,a):this.gl.scissor(e,this.height-t-i-1,a,i)),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.quadraticCurveTo=function(e,t,a,i){return this.context.quadraticCurveTo(e,t,a,i),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.bezierCurveTo=function(e,t,a,i,r,n){return this.context.bezierCurveTo(e,t,a,i,r,n),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.arc=function(e,t,a,i,r,n){return this.context.arc(e,t,a,i,r,n),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.arcTo=function(e,t,a,i,r){return this.context.arcTo(e,t,a,i,r),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.fillText=function(e,t,a,i=1e3){return this.context.fillText(e,t,a,i),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.strokeText=function(e,t,a,i=1e3){return this.context.strokeText(e,t,a,i),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.measureText=function(e){return this.context.measureText(e).width},$ea6ab44f7f06a4a9$var$Canvas.prototype.createImageData=function(e,t){return this.context.createImageData(e,t)},$ea6ab44f7f06a4a9$var$Canvas.prototype.getImageData=function(e,t,a,i){return this.context.getImageData(e,t,a,i)},$ea6ab44f7f06a4a9$var$Canvas.prototype.putImageData=function(e,t,a){return this.context.putImageData(e,t,a),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.drawImage=function(e,t=0,a=0,i=null,r=null,n=null,s=null,o=null,l=null){if(null===i)this.context.drawImage(e,int(t),int(a));else if(null===n)this.context.drawImage(e,int(t),int(a),int(i),int(r));else{let c=int(i),h=int(r);if(!c||!h)return this;let f=int(o),u=int(l);if(!f||!u)return this;this.context.drawImage(e,int(t),int(a),c,h,int(n),int(s),f,u)}return this},$ea6ab44f7f06a4a9$var$Canvas.prototype.clear=function(e=null){return null!=this.gl?(this.gl.clear(this.gl.STENCIL_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.COLOR_BUFFER_BIT),this.activeTextureId=null,this):(e?this.globalCompositeOperation("source-over").globalAlpha(1).fillStyle(!0!==e?e:this.backgroundColor).fillRect(0,0,this._width,this._height):(this.elem.width=this.width,this.applyConfig()),this.updateTransform(),this)},$ea6ab44f7f06a4a9$var$Canvas.prototype.start=function(){},$ea6ab44f7f06a4a9$var$Canvas.prototype.end=function(){},$ea6ab44f7f06a4a9$var$Canvas.prototype.flush=function(){this.gl},$ea6ab44f7f06a4a9$var$Canvas.prototype.blit=function(e,t,a,i=null){let r=this.gl;null!==r&&(i=i||this.glBlitProgram,this.setShaderProgram(i),r.disable(r.DEPTH_TEST),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,e),i.uniform1i("texture0",0),i.uniform4fv("v_resolution",this.v_resolution),i.uniform1f("f_time",$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.time),i.uniform1f("f_scale",this._globalScale),i.uniform1f("f_alpha",this._alpha),this.m_quad[0]=this.width,this.m_quad[4]=this.height,this.m_quad[6]=0,this.m_quad[7]=0,this.m_texture[0]=this.width/t,this.m_texture[4]=this.height/a,this.m_texture[6]=0,this.m_texture[7]=0,r.uniformMatrix3fv(i.getUniformLocation("m_quad"),!1,this.m_quad),r.uniformMatrix3fv(i.getUniformLocation("m_texture"),!1,this.m_texture),r.drawArrays(r.TRIANGLE_STRIP,0,4),this.setShaderProgram($00b4569a92b7ec96$export$2e2bcd8739ae039.get("def")),r.enable(r.DEPTH_TEST))},$ea6ab44f7f06a4a9$var$Canvas.prototype.reset=function(e=!1){return this.fillStyle("#000000").strokeStyle("#000000").lineCap("butt").lineJoin("miter").lineWidth("1").miterLimit("10").shadowColor("#000000").shadowOffsetX("0").shadowOffsetY("0").shadowBlur("0").globalAlpha("1.0").globalCompositeOperation("source-over"),e&&this.beginPath().closePath(),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.pushMatrix=function(){return this.matrixStack.push(this.matr),this.matr=this.matr.clone(),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.popMatrix=function(){return this.matr.free(),this.matr=this.matrixStack.pop(),this.updateTransform()},$ea6ab44f7f06a4a9$var$Canvas.prototype.alpha=function(e){return this._alpha*=e,this.context&&null===this.gl&&(this.context.globalAlpha=this._alpha),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.pushAlpha=function(){return this.alphaStack.push(this.globalAlpha()),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.popAlpha=function(){return this.globalAlpha(this.alphaStack.pop()),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.setDepthFlag=function(e){let t=this.gl;null!==t&&(e?(t.enable(t.DEPTH_TEST),this._depthFlag=!0):(t.disable(t.DEPTH_TEST),this._depthFlag=!1))},$ea6ab44f7f06a4a9$var$Canvas.prototype.getDepthFlag=function(){return this._depthFlag},$ea6ab44f7f06a4a9$var$Canvas.prototype.pushDepthFlag=function(e=null){if(null!==e)return(e=!!e)!==this._depthFlag&&(this.depthFlagStack.push(this._depthFlag),this.setDepthFlag(e),!0);this.depthFlagStack.push(this._depthFlag)},$ea6ab44f7f06a4a9$var$Canvas.prototype.popDepthFlag=function(){this.setDepthFlag(this.depthFlagStack.pop())},$ea6ab44f7f06a4a9$var$Canvas.prototype.setShaderProgram=function(e){null!==this.gl&&($f2e6a81a3fe74b9a$export$2e2bcd8739ae039.shaderProgram=e,$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.shaderProgram.activate())},$ea6ab44f7f06a4a9$var$Canvas.prototype.getShaderProgram=function(){return $f2e6a81a3fe74b9a$export$2e2bcd8739ae039.shaderProgram},$ea6ab44f7f06a4a9$var$Canvas.prototype.pushShaderProgram=function(e=null){if(null!==e)return e!==$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.shaderProgram&&(this.shaderProgramStack.push($f2e6a81a3fe74b9a$export$2e2bcd8739ae039.shaderProgram),this.setShaderProgram(e),!0);this.shaderProgramStack.push($f2e6a81a3fe74b9a$export$2e2bcd8739ae039.shaderProgram)},$ea6ab44f7f06a4a9$var$Canvas.prototype.popShaderProgram=function(){this.setShaderProgram(this.shaderProgramStack.pop())},$ea6ab44f7f06a4a9$var$Canvas.prototype.loadIdentity=function(){return this.matr.identity(),this.updateTransform()},$ea6ab44f7f06a4a9$var$Canvas.prototype.loadMatrix=function(e){return this.matr.set(e),this.updateTransform()},$ea6ab44f7f06a4a9$var$Canvas.prototype.getMatrix=function(e=!1){return e?this.matr.clone():this.matr},$ea6ab44f7f06a4a9$var$Canvas.prototype.appendMatrix=function(e){return this.matr.append(e),this.updateTransform()},$ea6ab44f7f06a4a9$var$Canvas.prototype.scale=function(e,t,a=!1){return a?(this.context.scale(e,t),this):(this.matr.scale(e,t),this.updateTransform())},$ea6ab44f7f06a4a9$var$Canvas.prototype.rotate=function(e,t=!1){return t?(this.context.rotate(e),this):(this.matr.rotate(e),this.updateTransform())},$ea6ab44f7f06a4a9$var$Canvas.prototype.translate=function(e,t,a=!1){return a?(this.context.translate(e,t),this):(this.matr.translate(e,t),this.updateTransform())},$ea6ab44f7f06a4a9$var$Canvas.prototype.ellipse=function(e,t,a,i){var r=a/2*.5522848,n=i/2*.5522848,s=e+a-1,o=t+i-1,l=e+a/2,c=t+i/2;return this.beginPath().moveTo(e,c),this.bezierCurveTo(e,c-n,l-r,t,l,t),this.bezierCurveTo(l+r,t,s,c-n,s,c),this.bezierCurveTo(s,c+n,l+r,o,l,o),this.bezierCurveTo(l-r,o,e,c+n,e,c),this.closePath(),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.circle=function(e,t,a,i){return this.beginPath(),this.arc(e,t,a,0,2*Math.PI),this.closePath(),i&&this.stroke(i),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.line=function(e,t,a,i,r){return this.beginPath(),this.moveTo(e,t),this.lineTo(a,i),this.closePath(),r&&this.stroke(r),this},$ea6ab44f7f06a4a9$var$Canvas.prototype.enablePointerEvents=function(){if(this.pointerHandler)return this;this.pointerScale={sx:1,sy:1},this.pointerOffset={x:0,y:0};var e=this,t={action:"",buttons:0,lbuttons:0,x:0,y:0,containedBy:function(e,t,a,i){return this.x>=e&&this.x<=e+a-1&&this.y>=t&&this.y<=t+i-1}};return this.pointerHandlers=[],this.pointerHandler=function(a,i){var r=this.elem.getBoundingClientRect();t.action=a,t.buttons=i.buttons,t.x=t.rx=int(i.clientX-r.left),t.y=t.ry=int(i.clientY-r.top),t.x=(t.x-e.pointerOffset.x-0*e.pointerScale.sx)/e.pointerScale.sx,t.y=(t.y-e.pointerOffset.y-0*e.pointerScale.sy)/e.pointerScale.sy,t.dragging=!1,t.buttons&&!t.lbuttons&&(t.sx=t.x,t.sy=t.y,t.ldx=t.ldy=0),t.buttons&&t.lbuttons&&(t.dragging=!0,t.dx=t.x-t.sx,t.dy=t.y-t.sy,t.ddx=t.dx-t.ldx,t.ddy=t.dy-t.ldy,t.ldx=t.dx,t.ldy=t.dy),t.lbuttons=t.buttons;for(var n=0;n<this.pointerHandlers.length&&!1!==this.pointerHandlers[n][1](t,this.pointerHandlers[n][2]);n++);},this.elem.onmousedown=function(t){e.pointerHandler("DOWN",t)},this.elem.onmouseup=function(t){e.pointerHandler("UP",t)},this.elem.onmousemove=function(t){e.pointerHandler("MOVE",t)},this},$ea6ab44f7f06a4a9$var$Canvas.prototype.setPointerScale=function(e,t){return this.pointerScale={sx:e,sy:t},this},$ea6ab44f7f06a4a9$var$Canvas.prototype.setPointerOffset=function(e,t){return this.pointerOffset={x:e,y:t},this},$ea6ab44f7f06a4a9$var$Canvas.prototype.addPointerHandler=function(e,t){return this.enablePointerEvents(),this.pointerHandlers.push([this.pointerHandlers.length+"_"+int(1e6*Math.random()),e,t]),this.pointerHandlers[this.pointerHandlers.length-1][0]},$ea6ab44f7f06a4a9$var$Canvas.prototype.removePointerHandler=function(e){if(this.pointerHandlers)for(var t=0;t<this.pointerHandlers.length;t++)if(this.pointerHandlers[t][0]==e){this.pointerHandlers.splice(t,1);break}},$ea6ab44f7f06a4a9$var$Canvas.renderImage=function(e,t,a,i){let r=new $ea6ab44f7f06a4a9$var$Canvas({hidden:!0,width:e,height:t,antialias:$041013b7ee2c8fb5$export$2e2bcd8739ae039.options.antialias});a(r);let n=r.toDataUrl(),s=new Image;s.onload=()=>{s.filter=$041013b7ee2c8fb5$export$2e2bcd8739ae039.options.antialias?"LINEAR":"NEAREST",s.rscale=1,s.targetWidth=e,s.targetHeight=t,$041013b7ee2c8fb5$export$2e2bcd8739ae039.renderer.prepareImage(s),i(s,n)},s.src=n,r.dispose()},$ea6ab44f7f06a4a9$var$Canvas.renderImageMipmap=function(e,t,a,i,r){let n=new $ea6ab44f7f06a4a9$var$Canvas({hidden:!0,width:t,height:a,antialias:$041013b7ee2c8fb5$export$2e2bcd8739ae039.options.antialias});i(n);let s=n.toDataUrl(),o=new Image;o.onload=()=>{o.filter=$041013b7ee2c8fb5$export$2e2bcd8739ae039.options.antialias?"LINEAR":"NEAREST",o.rscale=1,o.targetWidth=t,o.targetHeight=a,o.mipmap=e,$041013b7ee2c8fb5$export$2e2bcd8739ae039.renderer.prepareImage(o),r(o,s)},o.src=s,n.dispose()};var $ea6ab44f7f06a4a9$export$2e2bcd8739ae039=$ea6ab44f7f06a4a9$var$Canvas;
//![import "./keycode"]
//![import "../utils/list"]
//![import "../utils/linkable"]
//![import "./timer"]
//![import "./canvas"]
//![import "./globals"]
const $041013b7ee2c8fb5$var$System={
//!namespace System
//!enum KeyboardEventType
KeyboardEventType:{KEY_DOWN:1,KEY_UP:2},
//!/enum
//!enum PointerEventType
PointerEventType:{POINTER_DOWN:16,POINTER_UP:17,POINTER_MOVE:18,POINTER_DRAG_START:19,POINTER_DRAG_MOVE:20,POINTER_DRAG_STOP:21,POINTER_WHEEL:22}};
//!/enum
//!type KeyboardState =
//!/type
//!type Pointer =
//!/type
//!type Options =
//!/type
//!/namespace
//!class System
Object.assign($041013b7ee2c8fb5$var$System,{flags:{renderingEnabled:!1,renderingPaused:!1},defaultOptions:{background:"#000000",gl:!0,log:!1,overdraw:!1,antialias:!0,orientation:0,fps:144,minFps:15,vsync:!0,screenWidth:null,screenHeight:null,extraScaleFactor:1,maxScaleFactor:null,fullscreen:!1},screenWidth:0,screenHeight:0,orientation:0,offsX:0,offsY:0,devicePixelRatio:1,backingStoreRatio:1,canvasPixelRatio:1,canvasScaleFactor:1,scaleFactor:1,initialMatrix:null,renderer:null,displayBuffer2:null,displayBuffer3:null,tempDisplayBuffer:null,keyState:{time:0,shift:!1,ctrl:!1,alt:!1,keyCode:0},pointers:{},updateQueue:null,drawQueue:null,timeScale:1,frameInterval:0,fixedFrameInterval:0,maxFrameInterval:0,frameDelta:0,frameTime:0,frameNumber:0,perf:{startTime:0,lastTime:0,numFrames:0,numSamples:0,updateTimeTotal:0,drawTimeTotal:0,extraTimeTotal:0,fps:0,averageFps:0,averageUpdateTime:0,averageDrawTime:0,averageExtraTime:0},init:function(e=null){let t=this,a={...this.defaultOptions,...e};this.options=a,!1!==this.options.preallocate&&(!0===this.options.preallocate?$cac8b143592e7d73$export$2e2bcd8739ae039.preallocate():$cac8b143592e7d73$export$2e2bcd8739ae039.preallocate(this.options.preallocate)),a.screenWidth&&a.screenHeight&&"default"==a.orientation&&(a.orientation=a.screenWidth>a.screenHeight?"landscape":"portrait"),this.orientation=a.orientation,this.updateQueue=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.drawQueue=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.frameInterval=1e3/a.fps,this.maxFrameInterval=1e3/a.minFps,$parcel$global.onresize=function(){t.onWindowResized()},this.frameTimer=new $445264d030762d7a$export$2e2bcd8739ae039(a.vsync,this.frameInterval,(e=>this.onFrame(e))),this.renderer=new $ea6ab44f7f06a4a9$export$2e2bcd8739ae039({gl:a.gl,elem:null,absolute:!0,hidden:!1,antialias:a.antialias,background:a.background}),this.displayBuffer2=new $ea6ab44f7f06a4a9$export$2e2bcd8739ae039({gl:!1,elem:null,absolute:!0,hidden:!1,antialias:a.antialias,background:"none"}),this.displayBuffer2.elem.style.pointerEvents="none",this.displayBuffer3=new $ea6ab44f7f06a4a9$export$2e2bcd8739ae039({gl:!1,elem:null,absolute:!0,hidden:!1,antialias:a.antialias,background:"none"}),this.displayBuffer3.elem.style.pointerEvents="none",this.tempDisplayBuffer=new $ea6ab44f7f06a4a9$export$2e2bcd8739ae039({hidden:!0,antialias:a.antialias}).resize(640,480);let i=this.renderer.elem;this.devicePixelRatio=$parcel$global.devicePixelRatio||1,this.backingStoreRatio=!0===a.gl?1:this.renderer.context.webkitBackingStorePixelRatio||this.renderer.context.mozBackingStorePixelRatio||this.renderer.context.msBackingStorePixelRatio||this.renderer.context.oBackingStorePixelRatio||this.renderer.context.backingStorePixelRatio||1,this.canvasPixelRatio=this.devicePixelRatio/this.backingStoreRatio,$041013b7ee2c8fb5$var$System.onWindowResized(!0),$parcel$global.onkeydown=function(e){if(e.target===$parcel$global.document.body){if(t.keyState[e.keyCode])return!1;switch(t.keyState[e.keyCode]=!0,t.keyState.keyCode=e.keyCode,t.keyState.startTime=hrnow(),e.keyCode){case 16:t.keyState.shift=!0;break;case 17:t.keyState.ctrl=!0;break;case 18:t.keyState.alt=!0}return t.keyState.ctrl&&e.keyCode==$87a32fa215803424$export$2e2bcd8739ae039.TAB?(t.keyState[e.keyCode]=!1,!0):!1!==t.onKeyboardEvent(t.KeyboardEventType.KEY_DOWN,e.keyCode,t.keyState)&&void 0}},$parcel$global.onkeyup=function(e){if(e.target===$parcel$global.document.body){if(!t.keyState[e.keyCode])return!1;switch(t.keyState[e.keyCode]=!1,t.keyState.endTime=hrnow(),t.keyState.keyCode=e.keyCode,e.keyCode){case 16:t.keyState.shift=!1;break;case 17:t.keyState.ctrl=!1;break;case 18:t.keyState.alt=!1}return!1!==t.onKeyboardEvent(t.KeyboardEventType.KEY_UP,e.keyCode,t.keyState)&&void 0}};const r=function(e,t){return $041013b7ee2c8fb5$var$System.reverseRender?int($041013b7ee2c8fb5$var$System.screenWidth-1-(t-$041013b7ee2c8fb5$var$System.offsY)/$041013b7ee2c8fb5$var$System.canvasScaleFactor):int((e-$041013b7ee2c8fb5$var$System.offsX)/$041013b7ee2c8fb5$var$System.canvasScaleFactor)},n=function(e,t){return $041013b7ee2c8fb5$var$System.reverseRender?int((e-$041013b7ee2c8fb5$var$System.offsX)/$041013b7ee2c8fb5$var$System.canvasScaleFactor):int((t-$041013b7ee2c8fb5$var$System.offsY)/$041013b7ee2c8fb5$var$System.canvasScaleFactor)};"ontouchstart"in $parcel$global?(i.ontouchstart=function(e){e.preventDefault();let t=e.changedTouches;for(let e=0;e<t.length;e++){$041013b7ee2c8fb5$var$System.pointers[t[e].identifier]||($041013b7ee2c8fb5$var$System.pointers[t[e].identifier]={id:t[e].identifier,isActive:!1,isDragging:!1,sx:0,sy:0,x:0,y:0,dx:0,dy:0,button:0,wheelDelta:0,wheelAccum:0});let a=$041013b7ee2c8fb5$var$System.pointers[t[e].identifier];a.isActive=!0,a.isDragging=!1,a.button=1,a.startTime=hrnow(),a.x=a.sx=r(t[e].clientX,t[e].clientY),a.y=a.sy=n(t[e].clientX,t[e].clientY),$041013b7ee2c8fb5$var$System.onPointerEvent($041013b7ee2c8fb5$var$System.PointerEventType.POINTER_DOWN,a,$041013b7ee2c8fb5$var$System.pointers)}return!1},i.ontouchend=function(e){e.preventDefault();let t=e.changedTouches;for(let e=0;e<t.length;e++){if(!$041013b7ee2c8fb5$var$System.pointers[t[e].identifier])continue;let a=$041013b7ee2c8fb5$var$System.pointers[t[e].identifier];a.endTime=hrnow(),a.deltaTime=a.endTime-a.startTime,a.x=r(t[e].clientX,t[e].clientY),a.y=n(t[e].clientX,t[e].clientY),a.isDragging&&$041013b7ee2c8fb5$var$System.onPointerEvent($041013b7ee2c8fb5$var$System.PointerEventType.POINTER_DRAG_STOP,a,$041013b7ee2c8fb5$var$System.pointers),$041013b7ee2c8fb5$var$System.onPointerEvent($041013b7ee2c8fb5$var$System.PointerEventType.POINTER_UP,a,$041013b7ee2c8fb5$var$System.pointers),a.isActive=!1,a.isDragging=!1,a.button=0}return!1},i.ontouchcancel=function(e){e.preventDefault();let t=e.changedTouches;for(let e=0;e<t.length;e++){if(!$041013b7ee2c8fb5$var$System.pointers[t[e].identifier])continue;let a=$041013b7ee2c8fb5$var$System.pointers[t[e].identifier];a.x=r(t[e].clientX,t[e].clientY),a.y=n(t[e].clientX,t[e].clientY),$041013b7ee2c8fb5$var$System.onPointerEvent(a.isDragging?$041013b7ee2c8fb5$var$System.PointerEventType.POINTER_DRAG_STOP:$041013b7ee2c8fb5$var$System.PointerEventType.POINTER_UP,a,$041013b7ee2c8fb5$var$System.pointers),a.isActive=!1,a.isDragging=!1,a.button=0}return!1},i.ontouchmove=function(e){e.preventDefault();let t=e.changedTouches;for(let e=0;e<t.length;e++){if(!$041013b7ee2c8fb5$var$System.pointers[t[e].identifier])continue;let a=$041013b7ee2c8fb5$var$System.pointers[t[e].identifier];a.isActive&&!a.isDragging&&($041013b7ee2c8fb5$var$System.onPointerEvent($041013b7ee2c8fb5$var$System.PointerEventType.POINTER_DRAG_START,a,$041013b7ee2c8fb5$var$System.pointers),a.isDragging=!0),a.x=r(t[e].clientX,t[e].clientY),a.y=n(t[e].clientX,t[e].clientY),a.dx=a.x-a.sx,a.dy=a.y-a.sy,$041013b7ee2c8fb5$var$System.onPointerEvent(a.isDragging?$041013b7ee2c8fb5$var$System.PointerEventType.POINTER_DRAG_MOVE:$041013b7ee2c8fb5$var$System.PointerEventType.POINTER_MOVE,a,$041013b7ee2c8fb5$var$System.pointers)}return!1}):(i.oncontextmenu=function(e){return e.preventDefault(),!1},i.onwheel=function(e){e.preventDefault(),$041013b7ee2c8fb5$var$System.pointers[0]||($041013b7ee2c8fb5$var$System.pointers[0]={id:0,isActive:!1,isDragging:!1,sx:0,sy:0,x:0,y:0,dx:0,dy:0,button:0,wheelDelta:0,wheelAccum:0});let t=$041013b7ee2c8fb5$var$System.pointers[0];return t.x=r(e.clientX,e.clientY),t.y=n(e.clientX,e.clientY),t.wheelDelta=e.deltaY,t.wheelAccum+=e.deltaY,$041013b7ee2c8fb5$var$System.onPointerEvent($041013b7ee2c8fb5$var$System.PointerEventType.POINTER_WHEEL,t,$041013b7ee2c8fb5$var$System.pointers),!1},i.onmousedown=function(e){e.preventDefault(),$041013b7ee2c8fb5$var$System.pointers[0]||($041013b7ee2c8fb5$var$System.pointers[0]={id:0,isActive:!1,isDragging:!1,sx:0,sy:0,x:0,y:0,dx:0,dy:0,button:0,wheelDelta:0,wheelAccum:0});let t=$041013b7ee2c8fb5$var$System.pointers[0];return t.isActive=!0,t.isDragging=!1,t.button=e.which,t.x=t.sx=r(e.clientX,e.clientY),t.y=t.sy=n(e.clientX,e.clientY),$041013b7ee2c8fb5$var$System.onPointerEvent($041013b7ee2c8fb5$var$System.PointerEventType.POINTER_DOWN,t,$041013b7ee2c8fb5$var$System.pointers),!1},i.onmouseup=function(e){if(e.preventDefault(),!$041013b7ee2c8fb5$var$System.pointers[0])return!1;let t=$041013b7ee2c8fb5$var$System.pointers[0];t.x=r(e.clientX,e.clientY),t.y=n(e.clientX,e.clientY),t.isDragging&&$041013b7ee2c8fb5$var$System.onPointerEvent($041013b7ee2c8fb5$var$System.PointerEventType.POINTER_DRAG_STOP,t,$041013b7ee2c8fb5$var$System.pointers),$041013b7ee2c8fb5$var$System.onPointerEvent($041013b7ee2c8fb5$var$System.PointerEventType.POINTER_UP,t,$041013b7ee2c8fb5$var$System.pointers),t.isActive=!1,t.isDragging=!1,t.button=0},i.onmousemove=function(e){if(e.preventDefault(),!$041013b7ee2c8fb5$var$System.pointers[0])return!1;let t=$041013b7ee2c8fb5$var$System.pointers[0];return t.isActive&&!t.isDragging&&($041013b7ee2c8fb5$var$System.onPointerEvent($041013b7ee2c8fb5$var$System.PointerEventType.POINTER_DRAG_START,t,$041013b7ee2c8fb5$var$System.pointers),t.isDragging=!0),t.x=r(e.clientX,e.clientY),t.y=n(e.clientX,e.clientY),t.dx=t.x-t.sx,t.dy=t.y-t.sy,$041013b7ee2c8fb5$var$System.onPointerEvent(t.isDragging?$041013b7ee2c8fb5$var$System.PointerEventType.POINTER_DRAG_MOVE:$041013b7ee2c8fb5$var$System.PointerEventType.POINTER_MOVE,t,$041013b7ee2c8fb5$var$System.pointers),!1}),!0===a.log&&$70a42a4582ac5be9$export$2e2bcd8739ae039.enable()},time:function(){return this.frameTime},start:function(){this.onWindowResized(),this.flags.renderingPaused=!1,this.frameTimer.start()},stop:function(){this.flags.renderingPaused=!0,this.frameTimer.stop()},pause:function(){this.flags.renderingPaused=!0},resume:function(){this.flags.renderingPaused=!1,this.resetPerf()},onFrame:function(e){let t,a=hrnow();e>this.maxFrameInterval&&(e=this.maxFrameInterval),0!==this.fixedFrameInterval&&(e=this.fixedFrameInterval),this.flags.renderingEnabled&&!this.flags.renderingPaused?(e*=this.timeScale,this.frameDelta=e/1e3,this.frameTime+=this.frameDelta,$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.time=this.frameTime,this.frameNumber++,t=hrnow(),this.update(this.frameDelta),this.perf.updateTimeTotal+=hrnow()-t,t=hrnow(),this.draw(),this.perf.drawTimeTotal+=hrnow()-t,this.perf.lastTime=a,this.perf.numFrames++,(e=this.perf.lastTime-this.perf.startTime)>1e3&&(this.perf.fps=int(1e3*this.perf.numFrames/e),this.perf.averageFps=int((this.perf.averageFps*this.perf.numSamples+this.perf.fps)/(this.perf.numSamples+1)),this.perf.averageUpdateTime=int((this.perf.averageUpdateTime*this.perf.numSamples+1e3*this.perf.updateTimeTotal/this.perf.numFrames)/(this.perf.numSamples+1)),this.perf.averageDrawTime=int((this.perf.averageDrawTime*this.perf.numSamples+1e3*this.perf.drawTimeTotal/this.perf.numFrames)/(this.perf.numSamples+1)),this.perf.averageExtraTime=int((this.perf.averageExtraTime*this.perf.numSamples+1e3*this.perf.extraTimeTotal/this.perf.numFrames)/(this.perf.numSamples+1)),this.perf.numSamples++,this.perf.startTime=a,this.perf.lastTime=a,this.perf.numFrames=0,this.perf.updateTimeTotal=0,this.perf.drawTimeTotal=0,this.perf.extraTimeTotal=0)):this.draw()},onWindowResized:function(e=!1){if("document"in $parcel$global)this.options.fullscreen?(this._screenWidth=int($parcel$global.screen.width),this._screenHeight=int($parcel$global.screen.height)):(this._screenWidth=$parcel$global.innerWidth,this._screenHeight=$parcel$global.innerHeight);else if(this._screenWidth=this.options.screenWidth,this._screenHeight=this.options.screenHeight,null==this.options.screenWidth&&null==this.options.screenHeight)throw new Error("At least one screen dimension must be specified in headless mode.");this._screenWidth<this._screenHeight&&"landscape"==this.orientation||this._screenWidth>this._screenHeight&&"portrait"==this.orientation?(this.screenWidth=this._screenHeight,this.screenHeight=this._screenWidth,this.reverseRender=!0):(this.screenWidth=this._screenWidth,this.screenHeight=this._screenHeight,this.reverseRender=!1);let t=this.options.screenWidth,a=this.options.screenHeight;null!==t&&null!==a||(null===t&&null===a?(t=this.screenWidth,a=this.screenHeight):null===t?t=int(.5+this.screenWidth*(this.options.screenHeight/this.screenHeight)):null===a&&(a=int(.5+this.screenHeight*(this.options.screenWidth/this.screenWidth))));let i=t,r=a;"automatic"===this.orientation&&i&&r&&(i>r&&this.screenWidth<this.screenHeight||i<r&&this.screenWidth>this.screenHeight)&&(i=r,r=t),this.canvasScaleFactor=1,i&&r?this.canvasScaleFactor=Math.min(this.screenWidth/i,this.screenHeight/r):i?this.canvasScaleFactor=this.screenWidth/i:r&&(this.canvasScaleFactor=this.screenHeight/r);let n=this.screenWidth,s=this.screenHeight;if(i&&(this.screenWidth=i),r&&(this.screenHeight=r),this.offsX=int(.5*(n-this.screenWidth*this.canvasScaleFactor)),this.offsY=int(.5*(s-this.screenHeight*this.canvasScaleFactor)),this.reverseRender){let e=this.offsX;this.offsX=this.offsY,this.offsY=e}this.scaleFactor=this.canvasScaleFactor*this.canvasPixelRatio,this.scaleFactor=int(.7+this.scaleFactor),this.options.maxScaleFactor>0&&this.scaleFactor>this.options.maxScaleFactor&&(this.scaleFactor=this.options.maxScaleFactor),this.flags.renderingEnabled=!1,"document"in $parcel$global&&($parcel$global.document.body.style.backgroundColor=this.renderer.backgroundColor),this.reverseRender?(this.renderer.resize(this.screenHeight*this.scaleFactor,this.screenWidth*this.scaleFactor),this.renderer.elem.style.width=int(this.screenHeight*this.canvasScaleFactor+.5)+"px",this.renderer.elem.style.height=int(this.screenWidth*this.canvasScaleFactor+.5)+"px",this.displayBuffer2.resize(this.screenHeight*this.scaleFactor,this.screenWidth*this.scaleFactor),this.displayBuffer2.elem.style.width=int(this.screenHeight*this.canvasScaleFactor+.5)+"px",this.displayBuffer2.elem.style.height=int(this.screenWidth*this.canvasScaleFactor+.5)+"px",this.displayBuffer3.resize(s,n),this.displayBuffer3.elem.style.width=s+"px",this.displayBuffer3.elem.style.height=n+"px"):(this.renderer.resize(this.screenWidth*this.scaleFactor,this.screenHeight*this.scaleFactor),this.renderer.elem.style.width=int(this.screenWidth*this.canvasScaleFactor+.5)+"px",this.renderer.elem.style.height=int(this.screenHeight*this.canvasScaleFactor+.5)+"px",this.displayBuffer2.resize(this.screenWidth*this.scaleFactor,this.screenHeight*this.scaleFactor),this.displayBuffer2.elem.style.width=int(this.screenWidth*this.canvasScaleFactor+.5)+"px",this.displayBuffer2.elem.style.height=int(this.screenHeight*this.canvasScaleFactor+.5)+"px",this.displayBuffer3.resize(n,s),this.displayBuffer3.elem.style.width=n+"px",this.displayBuffer3.elem.style.height=s+"px"),this.renderer.elem.style.marginLeft=this.offsX+"px",this.renderer.elem.style.marginTop=this.offsY+"px",this.displayBuffer2.elem.style.marginLeft=this.offsX+"px",this.displayBuffer2.elem.style.marginTop=this.offsY+"px",this.renderer.loadIdentity(),this.displayBuffer2.loadIdentity(),this.displayBuffer3.loadIdentity(),1!=this.scaleFactor&&(this.renderer.globalScale(this.scaleFactor),this.displayBuffer2.globalScale(this.scaleFactor)),this.reverseRender?(this.renderer.rotate(Math.PI/2),this.renderer.translate(-this.screenWidth,0),this.renderer.flipped(!0),this.displayBuffer2.rotate(Math.PI/2),this.displayBuffer2.translate(-this.screenWidth,0),this.displayBuffer2.flipped(!0),this.displayBuffer3.rotate(Math.PI/2),this.displayBuffer3.translate(-n,0),this.displayBuffer3.flipped(!0)):(this.renderer.flipped(!1),this.displayBuffer2.flipped(!1),this.displayBuffer3.flipped(!1)),this.scaleFactor*=this.options.extraScaleFactor,this.options.maxScaleFactor>0&&this.scaleFactor>this.options.maxScaleFactor&&(this.scaleFactor=this.options.maxScaleFactor),this.integerScaleFactor=int(this.scaleFactor+.5),this.resetPerf(),this.initialMatrix&&this.initialMatrix.free(),this.initialMatrix=this.renderer.getMatrix(!0),1!=e&&(this.flags.renderingEnabled=!0,this.onCanvasResized(this.screenWidth,this.screenHeight))},onCanvasResized:function(e,t){},resetPerf:function(){this.perf.startTime=hrnow(),this.perf.lastTime=hrnow(),this.perf.numFrames=0,this.perf.updateTimeTotal=0,this.perf.drawTimeTotal=0,this.perf.extraTimeTotal=0,this.perf.numSamples=0,this.perf.fps=0,this.perf.averageFps=0,this.perf.averageUpdateTime=0,this.perf.averageDrawTime=0,this.perf.averageExtraTime=0},updateQueueAdd:function(e){return this.updateQueue.push(e),this.updateQueue.bottom},updateQueueRemove:function(e){this.updateQueue.remove($a220fff115a0570f$export$2e2bcd8739ae039.isInstance(e)?e:this.updateQueue.sgetNode(e))},drawQueueAdd:function(e){return this.drawQueue.push(e),this.drawQueue.bottom},drawQueueRemove:function(e){this.drawQueue.remove($a220fff115a0570f$export$2e2bcd8739ae039.isInstance(e)?e:this.drawQueue.sgetNode(e))},queueAdd:function(e){this.updateQueue.push(e),this.drawQueue.push(e)},queueRemove:function(e){this.updateQueue.remove(this.updateQueue.sgetNode(e)),this.drawQueue.remove(this.drawQueue.sgetNode(e))},update:function(e){try{let t;for(let a=this.updateQueue.top;a;a=t)t=a.next,!1===a.value.update(e)&&this.updateQueueRemove(a)}catch(e){throw $041013b7ee2c8fb5$var$System.stop(),e}},draw:function(){null!==this.renderer.gl&&this.renderer.start(),this.options.overdraw||(this.renderer.clear(),this.displayBuffer2.clear(),this.displayBuffer3.clear());try{let e;for(let t=this.drawQueue.top;t;t=e)e=t.next,t.value.draw(this.renderer);null!==this.renderer.gl&&(this.renderer.flush(),this.renderer.end())}catch(e){throw $041013b7ee2c8fb5$var$System.stop(),e}},interpolate:function(e,t,a,i,r){let n={},s={},o=0;for(let t in e)n[t]=0,s[t]=e[t],o++;let l={update:function(l){for(let r in n){if(n[r]==a[r])continue;n[r]+=l,n[r]>=a[r]&&(n[r]=a[r],o--);let c=i[r](n[r]/a[r]);s[r]=(1-c)*e[r]+c*t[r]}if(r(s,0==o),0==o)return!1}};$041013b7ee2c8fb5$var$System.updateQueueAdd(l),l.update(0)},onKeyboardEvent:function(e,t,a){return!0},onPointerEvent:function(e,t,a){return!0}});var//!/class
$041013b7ee2c8fb5$export$2e2bcd8739ae039=$041013b7ee2c8fb5$var$System;
//![import "./system"]
//![import "../utils/list"]
//!namespace Log
const $70a42a4582ac5be9$var$Log={enabled:!1,paused:!1,maxsize:30,data:$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),count:0,debugEcho:!1,color:"#fff",background:"#cf266a",vars:{},write:function(e){for(this.data.push(e),this.count++;this.data.length>this.maxsize;)this.data.shift();this.debugEcho&&console.debug(this.count+": "+e)},clear:function(){this.data.reset(),this.count=0},enable:function(e=0,t=0,a=9.5,i=!0,r=!0){if(this.enabled)return;this.enabled=!0,i||(t-=16);let n=t;$041013b7ee2c8fb5$export$2e2bcd8739ae039.drawQueueAdd({draw:function(){if($70a42a4582ac5be9$var$Log.paused)return;let s=hrnow();const o=$041013b7ee2c8fb5$export$2e2bcd8739ae039.displayBuffer3;o.font("bold "+a+"pt Monospace"),o.textBaseline("top");let l="";t=n,!1!==i&&0!=$041013b7ee2c8fb5$export$2e2bcd8739ae039.perf.fps&&(l="fps: "+$041013b7ee2c8fb5$export$2e2bcd8739ae039.perf.fps+"/"+$041013b7ee2c8fb5$export$2e2bcd8739ae039.perf.averageFps+", update: "+$041013b7ee2c8fb5$export$2e2bcd8739ae039.perf.averageUpdateTime+", draw: "+$041013b7ee2c8fb5$export$2e2bcd8739ae039.perf.averageDrawTime+", extra: "+$041013b7ee2c8fb5$export$2e2bcd8739ae039.perf.averageExtraTime,$70a42a4582ac5be9$var$Log.background&&(o.fillStyle($70a42a4582ac5be9$var$Log.background),o.fillRect(e-3,t-1,o.measureText(l)+6,a+5)),o.fillStyle($70a42a4582ac5be9$var$Log.color),o.fillText(l,e,t)),l="";for(let e in $70a42a4582ac5be9$var$Log.vars)l+=e+": "+$70a42a4582ac5be9$var$Log.vars[e]+"  ";""!==l&&(t+=24,$70a42a4582ac5be9$var$Log.background&&(o.fillStyle($70a42a4582ac5be9$var$Log.background),o.fillRect(e-3,t-1,o.measureText(l)+6,a+5)),o.fillStyle($70a42a4582ac5be9$var$Log.color),o.fillText(l,e,t));let c=0;for(let i=$70a42a4582ac5be9$var$Log.data.top;i;i=i.next,c++)l=(r?"#"+($70a42a4582ac5be9$var$Log.count-$70a42a4582ac5be9$var$Log.data.length+c+1)+": ":"> ")+i.value,$70a42a4582ac5be9$var$Log.background&&(o.fillStyle($70a42a4582ac5be9$var$Log.background),o.fillRect(e-3,t-1+7+(a+5)*(c+1)-1,o.measureText(l)+6,a+5)),o.fillStyle($70a42a4582ac5be9$var$Log.color),o.fillText(l,e,t-1+7+(a+5)*(c+1));s=hrnow()-s,$041013b7ee2c8fb5$export$2e2bcd8739ae039.perf.drawTimeTotal-=s,$041013b7ee2c8fb5$export$2e2bcd8739ae039.perf.extraTimeTotal+=s}})},pause:function(){this.paused=!0},resume:function(){this.paused=!1}};var $70a42a4582ac5be9$export$2e2bcd8739ae039=$70a42a4582ac5be9$var$Log;
//![import "./random"]
//![import "./log"]
//![import "../flow/viewport"]
//!namespace globals
const $f2e6a81a3fe74b9a$var$globals={gl:null,shaderProgram:null,time:0,viewport:null,debugBounds:!1,debugMasks:!1,rand0:new $42e4702e58ec5fce$export$2e2bcd8739ae039,rand1:new $42e4702e58ec5fce$export$2e2bcd8739ae039,rand2:new $42e4702e58ec5fce$export$2e2bcd8739ae039};var $f2e6a81a3fe74b9a$export$2e2bcd8739ae039=$f2e6a81a3fe74b9a$var$globals;
//!/namespace
//!declare global
$parcel$global.px=function(e){return e*C.SCALE},$parcel$global.dispose=function(e){if(null!==e&&"object"==typeof e)return"free"in e?e.free():"dispose"in e?e.dispose():void("__dtor"in e&&e.__dtor())},"AudioContext"in $parcel$global?($parcel$global.audioContext=new AudioContext({latencyHint:"interactive",sampleRate:44100}),$70a42a4582ac5be9$export$2e2bcd8739ae039.write("AudioContext: baseLatency="+~~(1e3*$parcel$global.audioContext.baseLatency)+" ms")):$parcel$global.audioContext=null,$parcel$global.fetchd=function(e,t){return new Promise(((a,i)=>{t||(t={}),"responseType"in t||(t.responseType="arraybuffer");let r=new XMLHttpRequest;r.open("GET",e,!0);for(let e in t)r[e]=t[e];r.onload=function(){a(r.response)},r.onerror=function(){i("Unable to fetch specified resource.")},r.send()}))},$parcel$global.fetchAudioBuffer=function(e){return new Promise(((t,a)=>{$parcel$global.audioContext?fetchd(e).then((e=>audioContext.decodeAudioData(e))).then((e=>t(e))).catch((e=>a(e))):a("AudioContext is not available.")}))},$parcel$global.int=function(e){return e>>0},$parcel$global.bool=function(e){return!0===e||!1===e?e:"true"==e||"false"!=e&&!!e},$parcel$global.float=function(e){return parseFloat(e)},$parcel$global.float2=function(e){return int(100*e)/100},$parcel$global.float3=function(e){return int(1e3*e)/1e3},$parcel$global.float4=function(e){return int(1e4*e)/1e4},$parcel$global.rad=function(e){return e*Math.PI/180},$parcel$global.deg=function(e){return e/Math.PI*180},$parcel$global.rand=function(){return $f2e6a81a3fe74b9a$var$globals.rand0.nextInt16()},$parcel$global.randf=function(){return $f2e6a81a3fe74b9a$var$globals.rand0.nextFloat()},$parcel$global.randrf=function(e,t){let a=$f2e6a81a3fe74b9a$var$globals.rand0.nextFloat();return a*t+(1-a)*e},$parcel$global.randr=function(e,t){let a=$f2e6a81a3fe74b9a$var$globals.rand0.nextFloat();return Math.round(a*t+(1-a)*e)},$parcel$global.randt=function(e,t,a,i=!0){let r=[],n=e;for(let i=0;i<a;i++,n++)r.push(n),n+1>t&&(n=e-1);const s=a>>>1;for(let t=0;t<s;t++){e=randr(t+1,a-1);let i=r[t];r[t]=r[e],r[e]=i}if(!i)return r;let o=a-1;for(let e=1;e<a;e++){if(r[e]!==r[e-1])continue;for(;r[e]===r[o];)--o<0&&(o=a-1,console.log("!!"));let t=r[e];r[e]=r[o],r[o]=t}return r},$parcel$global.randtf=function(e,t,a){for(var i=[],r=0;r<a;r++)i.push(randrf(e,t));return i},$parcel$global.hrnow=function(){return performance.now()},$parcel$global.randvar=function(e,t){return function(){return randr(e,t)}},$parcel$global.randitem=function(e,t=null,a=null){return null===t&&(t=0),null===a&&(a=e.length-1),function(){return e[randr(t,a)]}},$parcel$global.getLineSegmentIntersection=function(e,t,a,i,r,n,s,o){if(e==r&&t==n&&a==s&&i==o)return 0;var l=i-t,c=a-e,h=o-n,f=s-r;if(0==l&&0==h){if(t!=n)return 2;var u=Math.max(e,r);return u>Math.min(a,s)?2:(u-e)/c}if(0==c&&0==f){if(e!=r)return 2;var d=Math.max(t,n);return d>Math.min(i,o)?2:(d-t)/l}if(0==c)return 0>(p=(h*(e-r)+f*(n-t))/(f*l))||p>1||0>($=(e-r)/f)||$>1?2:p;var $,p,b=h*c-f*l;return 0==b||0>($=(l*(r-e)+c*(t-n))/b)||$>1||0>(p=(f*$+r-e)/c)||p>1?2:p},$parcel$global.lineSegmentIntersects=function(e,t,a,i,r,n,s,o){let l=getLineSegmentIntersection(e,t,a,i,r,n,s,o);return l>=0&&l<=1},$parcel$global.rotatePoint=function(e,t,a,i=0,r=0){return{x:i+(t-i)*Math.cos(e)+(a-r)*Math.sin(e),y:r+(a-r)*Math.cos(e)-(t-i)*Math.sin(e)}},$parcel$global.stepValue=function(e,t,a,i){return Math.round(i*(e-t)/(a-t))/i*(a-t)+t},$parcel$global.alignValue=function(e,t){return Math.round(e/t)*t},$parcel$global.FIXED_POINT_BITS=8,$parcel$global.upscale=function(e){return e*(1<<FIXED_POINT_BITS)>>0},$parcel$global.downscale=function(e){return e>>FIXED_POINT_BITS},$parcel$global.downscalef=function(e){return e/(1<<FIXED_POINT_BITS)},$parcel$global.falign=function(e){return downscalef(upscale(e))},$parcel$global.fract=function(e){return e-~~e},$parcel$global.absmin=function(e,t){return Math.abs(e)<Math.abs(t)?e:t},$parcel$global.absmax=function(e,t){return Math.abs(e)>Math.abs(t)?e:t},$parcel$global.repeat=function(e,t){let a="";for(;t-- >0;)a+=e;return a},$parcel$global.lpad=function(e,t,a="0"){return e=e.toString(),repeat(a.charAt(0),t-e.length)+e},$parcel$global.rpad=function(e,t,a="0"){return(e=e.toString())+repeat(a.charAt(0),t-e.length)},$parcel$global.norm=function(e){return.5*(e+1)},$parcel$global.snorm=function(e){return 2*e-1},$parcel$global.clamp=function(e,t=0,a=1){return e<t?t:e>a?a:e},$parcel$global.map=function(e,t,a,i,r){return(e-t)*(r-i)/(a-t)+i},$parcel$global.mix=function(e,t,a){return e*(1-a)+t*a};
//!class Perf
const $66e5219664536ce1$var$Perf=function(e,t=null){this.data=[],this.accumSize=e,this.expectedValue=t,this.lastFeed=0,this.lastUpdate=0,this.stdSum=0,this.stdCount=0};var $66e5219664536ce1$export$2e2bcd8739ae039=$66e5219664536ce1$var$Perf;$66e5219664536ce1$var$Perf.prototype.begin=function(){this.startTime=performance.now()},$66e5219664536ce1$var$Perf.prototype.end=function(){this.feed(performance.now()-this.startTime)},$66e5219664536ce1$var$Perf.prototype.feed=function(e){this.data.push(e),this.lastFeed++,this.data.length==this.accumSize&&(this.report(),this.data=[])},$66e5219664536ce1$var$Perf.prototype.update=function(){let e=null,t=null,a=0,i=0;for(let i=0;i<this.data.length;i++)e=null===e?this.data[i]:Math.min(e,this.data[i]),t=null===t?this.data[i]:Math.max(t,this.data[i]),a+=this.data[i];a/=this.data.length;let r=null!==this.expectedValue?this.expectedValue:a;for(let e=0;e<this.data.length;e++)i+=Math.pow(this.data[e]-r,2);return i=Math.sqrt(i/this.data.length),this.stdSum+=i,this.stdCount++,this.min=e,this.max=t,this.avg=a,this.std=i,this.lastUpdate=this.lastFeed,this},$66e5219664536ce1$var$Perf.prototype.report=function(e=255){let t="";return this.lastUpdate!=this.lastFeed&&this.update(),e&$66e5219664536ce1$var$Perf.Flags.SAMPLES&&(t+="n: "+this.stdCount),e&$66e5219664536ce1$var$Perf.Flags.MIN&&(t+=(""!=t?", ":"")+"min: "+this.min),e&$66e5219664536ce1$var$Perf.Flags.MAX&&(t+=(""!=t?", ":"")+"max: "+this.max),e&$66e5219664536ce1$var$Perf.Flags.AVG&&(t+=(""!=t?", ":"")+"avg: "+this.avg.toFixed(2)),e&$66e5219664536ce1$var$Perf.Flags.EXPECTED&&(t+=(""!=t?", ":"")+(void 0!==this.expectedValue?"e: "+this.expectedValue:"")),e&$66e5219664536ce1$var$Perf.Flags.STDDEV&&(t+=(""!=t?", ":"")+"stddev: "+this.std.toFixed(2)),e&$66e5219664536ce1$var$Perf.Flags.AVG_STDDEV&&(t+=(""!=t?", ":"")+"avg_stddev: "+(this.stdSum/this.stdCount).toFixed(2)),t},
//!/class
//!namespace Perf
//!enum Flags
$66e5219664536ce1$var$Perf.Flags={SAMPLES:1,
//!SAMPLES
MIN:2,
//!MIN
MAX:4,
//!MAX
AVG:8,
//!AVG
EXPECTED:16,
//!EXPECTED
STDDEV:32,
//!STDDEV
AVG_STDDEV:64,
//!AVG_STDDEV
ALL:255};//!/enum
var $3CL91=parcelRequire("3CL91");
//![import "./globals"]
//![import "./system"]
const $0f93bc736e8cef65$var$Framebuffer=$3CL91.Class.extend({framebufferId:null,attachments:null,attachmentTypes:null,width:0,height:0,drawBuffers:null,drawBufferIds:null,__ctor:function(e=null,t=null){null!==$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.gl&&(null===$0f93bc736e8cef65$var$attachmentPointIds[0]&&$0f93bc736e8cef65$var$initAttachmentPointIds($f2e6a81a3fe74b9a$export$2e2bcd8739ae039.gl),this.framebufferId=$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.gl.createFramebuffer(),this.drawBuffers=[],this.drawBufferIds=[],this.width=e||$041013b7ee2c8fb5$export$2e2bcd8739ae039.renderer.width,this.height=t||$041013b7ee2c8fb5$export$2e2bcd8739ae039.renderer.height,this.attachments=new Array($0f93bc736e8cef65$var$Framebuffer.MAX_ATTACHMENT_POINTS).fill(null),this.attachmentTypes=new Array($0f93bc736e8cef65$var$Framebuffer.MAX_ATTACHMENT_POINTS).fill(null))},__dtor:function(){let e=$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.gl;if(null!==e){for(let t=0;t<this.attachments.length;t++)null!==this.attachments[t]&&(this.attachmentTypes[t]===$0f93bc736e8cef65$var$Framebuffer.TEXTURE?e.deleteTexture(this.attachments[t]):e.deleteRenderbuffer(this.attachments[t]));e.deleteFramebuffer(this.frameBufferId)}},attach:function(e,t,a=null){let i=$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.gl;if(null===i)return;null===a&&(a=e<$0f93bc736e8cef65$var$Framebuffer.DEPTH?$0f93bc736e8cef65$var$Framebuffer.TEXTURE:$0f93bc736e8cef65$var$Framebuffer.RENDERBUFFER),this.attachments[e]=t,this.attachmentTypes[e]=a,e<$0f93bc736e8cef65$var$Framebuffer.DEPTH&&-1===this.drawBuffers.indexOf(e)&&(this.drawBuffers.push(e),this.drawBufferIds.push($0f93bc736e8cef65$var$attachmentPointIds[e]));let r=i.getParameter(i.FRAMEBUFFER_BINDING);switch(i.bindFramebuffer(i.FRAMEBUFFER,this.framebufferId),a){case $0f93bc736e8cef65$var$Framebuffer.TEXTURE:i.framebufferTexture2D(i.FRAMEBUFFER,$0f93bc736e8cef65$var$attachmentPointIds[e],i.TEXTURE_2D,t,0);break;case $0f93bc736e8cef65$var$Framebuffer.RENDERBUFFER:i.framebufferRenderbuffer(i.FRAMEBUFFER,$0f93bc736e8cef65$var$attachmentPointIds[e],i.RENDERBUFFER,t)}i.bindFramebuffer(i.FRAMEBUFFER,r)},createColorBuffer:function(e,t=null,a=null){let i=$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.gl;if(null===i)return null;null===t&&(t=this.width),null===a&&(a=this.height);let r=i.createTexture();return i.bindTexture(i.TEXTURE_2D,r),i.texStorage2D(i.TEXTURE_2D,1,i.RGBA8,t,a),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),this.attach(e,r),r},createDepthBuffer:function(e=null,t=null){let a=$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.gl;if(null===a)return null;null===e&&(e=this.width),null===t&&(t=this.height);let i=a.createRenderbuffer();return a.bindRenderbuffer(a.RENDERBUFFER,i),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT24,e,t),this.attach($0f93bc736e8cef65$var$Framebuffer.DEPTH,i),i},createStencilBuffer:function(e=null,t=null){let a=$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.gl;if(null===a)return null;null===e&&(e=this.width),null===t&&(t=this.height);let i=a.createTexture();return a.bindTexture(a.TEXTURE_2D,i),a.texStorage2D(a.TEXTURE_2D,1,a.DEPTH_STENCIL,e,t),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),this.attach($0f93bc736e8cef65$var$Framebuffer.DEPTH_STENCIL,i),i},getTexture:function(e){return this.attachmentTypes[e]!==$0f93bc736e8cef65$var$Framebuffer.TEXTURE?null:this.attachments[e]},getRenderBuffer:function(e){return this.attachmentTypes[e]!==$0f93bc736e8cef65$var$Framebuffer.RENDERBUFFER?null:this.attachments[e]},bind:function(){let e=$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.gl;null!==e&&(e.bindFramebuffer(e.FRAMEBUFFER,this.framebufferId),e.drawBuffers(this.drawBufferIds),e.viewport(0,0,this.width,this.height))},unbind:function(){let e=$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.gl;null!==e&&(e.bindFramebuffer(e.FRAMEBUFFER,null),e.drawBuffers($0f93bc736e8cef65$var$defaultDrawBuffers),e.viewport(0,0,$041013b7ee2c8fb5$export$2e2bcd8739ae039.renderer.width,$041013b7ee2c8fb5$export$2e2bcd8739ae039.renderer.height))},isComplete:function(){let e=$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.gl;if(null===e)return!0;let t=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,this.framebufferId);let a=e.checkFramebufferStatus(e.FRAMEBUFFER);return e.bindFramebuffer(e.FRAMEBUFFER,t),a===e.FRAMEBUFFER_COMPLETE}});$0f93bc736e8cef65$var$Framebuffer.TEXTURE=1,$0f93bc736e8cef65$var$Framebuffer.RENDERBUFFER=2,$0f93bc736e8cef65$var$Framebuffer.COLOR0=0,$0f93bc736e8cef65$var$Framebuffer.COLOR1=1,$0f93bc736e8cef65$var$Framebuffer.COLOR2=2,$0f93bc736e8cef65$var$Framebuffer.COLOR3=3,$0f93bc736e8cef65$var$Framebuffer.COLOR4=4,$0f93bc736e8cef65$var$Framebuffer.COLOR5=5,$0f93bc736e8cef65$var$Framebuffer.COLOR6=6,$0f93bc736e8cef65$var$Framebuffer.COLOR7=7,$0f93bc736e8cef65$var$Framebuffer.DEPTH=8,$0f93bc736e8cef65$var$Framebuffer.STENCIL=9,$0f93bc736e8cef65$var$Framebuffer.DEPTH_STENCIL=10,$0f93bc736e8cef65$var$Framebuffer.MAX_ATTACHMENT_POINTS=11;const $0f93bc736e8cef65$var$attachmentPointIds=new Array($0f93bc736e8cef65$var$Framebuffer.MAX_ATTACHMENT_POINTS).fill(null),$0f93bc736e8cef65$var$defaultDrawBuffers=new Array(1).fill(null),$0f93bc736e8cef65$var$initAttachmentPointIds=function(e){$0f93bc736e8cef65$var$defaultDrawBuffers[0]=e.BACK,$0f93bc736e8cef65$var$attachmentPointIds[$0f93bc736e8cef65$var$Framebuffer.COLOR0]=e.COLOR_ATTACHMENT0,$0f93bc736e8cef65$var$attachmentPointIds[$0f93bc736e8cef65$var$Framebuffer.COLOR1]=e.COLOR_ATTACHMENT1,$0f93bc736e8cef65$var$attachmentPointIds[$0f93bc736e8cef65$var$Framebuffer.COLOR2]=e.COLOR_ATTACHMENT2,$0f93bc736e8cef65$var$attachmentPointIds[$0f93bc736e8cef65$var$Framebuffer.COLOR3]=e.COLOR_ATTACHMENT3,$0f93bc736e8cef65$var$attachmentPointIds[$0f93bc736e8cef65$var$Framebuffer.COLOR4]=e.COLOR_ATTACHMENT4,$0f93bc736e8cef65$var$attachmentPointIds[$0f93bc736e8cef65$var$Framebuffer.COLOR5]=e.COLOR_ATTACHMENT5,$0f93bc736e8cef65$var$attachmentPointIds[$0f93bc736e8cef65$var$Framebuffer.COLOR6]=e.COLOR_ATTACHMENT6,$0f93bc736e8cef65$var$attachmentPointIds[$0f93bc736e8cef65$var$Framebuffer.COLOR7]=e.COLOR_ATTACHMENT7,$0f93bc736e8cef65$var$attachmentPointIds[$0f93bc736e8cef65$var$Framebuffer.DEPTH]=e.DEPTH_ATTACHMENT,$0f93bc736e8cef65$var$attachmentPointIds[$0f93bc736e8cef65$var$Framebuffer.STENCIL]=e.STENCIL_ATTACHMENT,$0f93bc736e8cef65$var$attachmentPointIds[$0f93bc736e8cef65$var$Framebuffer.DEPTH_STENCIL]=e.DEPTH_STENCIL_ATTACHMENT};var $0f93bc736e8cef65$export$2e2bcd8739ae039=$0f93bc736e8cef65$var$Framebuffer,$fb16f2790102e0ed$exports={};$parcel$export($fb16f2790102e0ed$exports,"Drawable",(()=>$fb16f2790102e0ed$export$f35845279390eafd)),$parcel$export($fb16f2790102e0ed$exports,"Custom",(()=>$fb16f2790102e0ed$export$922ad9063d3cdee8)),$parcel$export($fb16f2790102e0ed$exports,"Spritesheet",(()=>$fb16f2790102e0ed$export$674d2eb4debbef0c)),$parcel$export($fb16f2790102e0ed$exports,"SpritesheetAnimation",(()=>$fb16f2790102e0ed$export$7faa71ea66a694bb)),$parcel$export($fb16f2790102e0ed$exports,"SpriteFont",(()=>$fb16f2790102e0ed$export$e1896ac0c4970221)),$parcel$export($fb16f2790102e0ed$exports,"Sound",(()=>$fb16f2790102e0ed$export$85990f0f98a390bb)),$parcel$export($fb16f2790102e0ed$exports,"SoundArray",(()=>$fb16f2790102e0ed$export$bc40a15752ef9732));var $3CL91=parcelRequire("3CL91");
//!class Drawable
const $0752c36c8a8a94fd$var$Drawable=$3CL91.Class.extend({className:"Drawable",resource:null,width:0,height:0,sx:0,sy:0,swidth:0,sheight:0,__ctor:function(e=null,t=null,a=null){if($3CL91.Rinn.isInstanceOf(e,$0752c36c8a8a94fd$var$Drawable)){let i=e;this.resource=i.resource,this.width=t??i.width,this.height=a??i.height,this.sx=i.sx,this.sy=i.sy,this.swidth=i.swidth,this.sheight=i.sheight}else this.resource=e,this.sx=0,this.sy=0,this.resource?(this.width=t??e.targetWidth,this.height=a??e.targetHeight,this.swidth=e.width,this.sheight=e.height):(this.width=t,this.height=a,this.swidth=t,this.sheight=a)},getDrawable:function(){return this},getImage:function(){return this.resource},getTexture:function(){return this.resource},resize:function(e,t){return e=null!==e?!0===e||e:this.width,t=null!==t?!0===t||t:this.height,!0===e?e=t*(this.width/this.height):!0===t&&(t=e*(this.height/this.width)),this.width=e,this.height=t,this},draw:function(e,t,a,i=null,r=null){i=i??this.width,r=r??this.height,this.drawf(e,this.sx,this.sy,this.swidth,this.sheight,t,a,i,r)},drawf:function(e,t,a,i,r,n,s,o,l,c=null,h=null){e.drawImage(this.resource,t,a,i,r,n,s,o,l,null,null,c??o,h??l)},render:function(e,t){this.draw(e,t.bounds.x1,t.bounds.y1,t.bounds.width(),t.bounds.height())}}),$0752c36c8a8a94fd$var$NineSlice=$0752c36c8a8a94fd$var$Drawable.extend({className:"DrawableNineSlice",ss:null,startingIndex:0,__ctor:function(e,t){if(this._super.Drawable.__ctor(e),null===e||!$3CL91.Class.instanceOf(e,"Spritesheet"))throw new Error("NineSlice: spritesheet required");this.ss=e,this.startingIndex=t},__dtor:function(){dispose(this.ss)},getTexture:function(){return this.ss.getTexture()},draw:function(e,t,a,i,r){const n=this.startingIndex;let s=this.ss.getFrame(n+0).width,o=this.ss.getFrame(n+2).width,l=this.ss.getFrame(n+1).width,c=this.ss.getFrame(n+0).height,h=this.ss.getFrame(n+6).height,f=this.ss.getFrame(n+3).height,u=int((i-s-o)/l),d=int((r-c-h)/f),$=t,p=a;this.ss.getFrame(n+0).draw(e,$,p),this.ss.getFrame(n+2).draw(e,$+s+u*l,p),this.ss.getFrame(n+6).draw(e,$,p+c+d*f),this.ss.getFrame(n+8).draw(e,$+s+u*l,p+c+d*f);for(let t=0;t<u;t++)this.ss.getFrame(n+1).draw(e,$+s+t*l,p),this.ss.getFrame(n+7).draw(e,$+s+t*l,p+c+d*f);for(let t=0;t<d;t++)this.ss.getFrame(n+3).draw(e,$,p+c+t*f),this.ss.getFrame(n+5).draw(e,$+s+u*l,p+c+t*f);for(let t=0;t<d;t++)for(let a=0;a<u;a++)this.ss.getFrame(n+4).draw(e,$+s+a*l,p+c+t*f)}});Recycler.createPool($0752c36c8a8a94fd$var$NineSlice,512);const $0752c36c8a8a94fd$var$Repeated=$0752c36c8a8a94fd$var$Drawable.extend({className:"DrawableRepeated",drawable:null,__ctor:function(e){this._super.Drawable.__ctor(e),this.drawable=e},__dtor:function(){dispose(this.drawable)},drawf:function(e,t,a,i,r,n,s,o,l,c=null,h=null){this.drawable.drawf(e,t,a,i,r,n,s,o,l,this.width,this.height)}});Recycler.createPool($0752c36c8a8a94fd$var$Repeated,512);const $0752c36c8a8a94fd$var$Clipped=$0752c36c8a8a94fd$var$Drawable.extend({className:"DrawableClipped",drawable:null,__ctor:function(e){this._super.Drawable.__ctor(e),this.drawable=e},__dtor:function(){dispose(this.drawable)},draw:function(e,t,a,i=null,r=null){let n=this.getTexture();i=i??this.width,r=r??this.height,this.drawable.drawf(e,this.drawable.sx,this.drawable.sy,i*n.rscale,r*n.rscale,t,a,i,r)}});Recycler.createPool($0752c36c8a8a94fd$var$Clipped,512);const $0752c36c8a8a94fd$var$Centered=$0752c36c8a8a94fd$var$Drawable.extend({className:"DrawableCentered",drawable:null,offsX:0,offsY:0,__ctor:function(e,t,a){this._super.Drawable.__ctor(e),this.drawable=e,this.offsX=t,this.offsY=a},__dtor:function(){dispose(this.drawable)},draw:function(e,t,a,i=null,r=null){i=i??this.width,r=r??this.height,this.drawable.draw(e,t+this.offsX+.5*(i-this.width),a+this.offsY+.5*(r-this.height),this.width,this.height)}});Recycler.createPool($0752c36c8a8a94fd$var$Centered,512);const $0752c36c8a8a94fd$var$Static=$0752c36c8a8a94fd$var$Drawable.extend({className:"DrawableStatic",drawable:null,offsX:0,offsY:0,__ctor:function(e,t,a){this._super.Drawable.__ctor(e),this.drawable=e,this.offsX=t,this.offsY=a},__dtor:function(){dispose(this.drawable)},draw:function(e,t,a,i=null,r=null){this.drawable.draw(e,t+this.offsX,a+this.offsY,i,r)}});Recycler.createPool($0752c36c8a8a94fd$var$Static,512);const $0752c36c8a8a94fd$var$Group=$0752c36c8a8a94fd$var$Drawable.extend({className:"DrawableGroup",list:null,__ctor:function(e){this._super.Drawable.__ctor(),this.list=e,this.width=0,this.height=0;for(let e=0;e<this.list.length;e++)this.list[e].width>this.width&&(this.width=this.list[e].width),this.list[e].height>this.height&&(this.height=this.list[e].height);this.swidth=this.width,this.sheight=this.height},__dtor:function(){if(null!==this.list){for(let e=0;e<this.list.length;e++)dispose(this.list[e]);this.list=null}},draw:function(e,t,a,i=null,r=null){for(let n=0;n<this.list.length;n++)this.list[n].draw(e,t,a,i,r)},render:function(e,t){for(let a=0;a<this.list.length;a++)this.list[a].render(e,t)}});Recycler.createPool($0752c36c8a8a94fd$var$Group,512);const $0752c36c8a8a94fd$var$MirrorX=$0752c36c8a8a94fd$var$Drawable.extend({className:"DrawableMirrorX",drawable:null,__ctor:function(e){this._super.Drawable.__ctor(e),this.drawable=e},__dtor:function(){dispose(this.drawable)},drawf:function(e,t,a,i,r,n,s,o,l,c=null,h=null){e.pushMatrix(),e.translate(n+o,s),e.scale(-1,1),this.drawable.drawf(e,t,a,i,r,0,0,o,l,c,h),e.popMatrix()}});Recycler.createPool($0752c36c8a8a94fd$var$MirrorX,512);const $0752c36c8a8a94fd$var$MirrorY=$0752c36c8a8a94fd$var$Drawable.extend({className:"DrawableMirrorY",drawable:null,__ctor:function(e){this._super.Drawable.__ctor(e),this.drawable=e},__dtor:function(){dispose(this.drawable)},drawf:function(e,t,a,i,r,n,s,o,l,c=null,h=null){e.pushMatrix(),e.translate(n,s+l),e.scale(1,-1),this.drawable.drawf(e,t,a,i,r,0,0,o,l,c,h),e.popMatrix()}});Recycler.createPool($0752c36c8a8a94fd$var$MirrorY,512),$0752c36c8a8a94fd$var$Drawable.nineSlice=function(e,t=0){return $0752c36c8a8a94fd$var$NineSlice.Pool.alloc(e,t)},$0752c36c8a8a94fd$var$Drawable.prototype.nineSlice=function(e=0){return $0752c36c8a8a94fd$var$NineSlice.Pool.alloc(this,e)},$0752c36c8a8a94fd$var$Drawable.repeated=function(e){return $0752c36c8a8a94fd$var$Repeated.Pool.alloc(e)},$0752c36c8a8a94fd$var$Drawable.prototype.repeated=function(){return $0752c36c8a8a94fd$var$Repeated.Pool.alloc(this)},$0752c36c8a8a94fd$var$Drawable.clipped=function(e){return $0752c36c8a8a94fd$var$Clipped.Pool.alloc(e)},$0752c36c8a8a94fd$var$Drawable.prototype.clipped=function(){return $0752c36c8a8a94fd$var$Clipped.Pool.alloc(this)},$0752c36c8a8a94fd$var$Drawable.centered=function(e,t,a){return $0752c36c8a8a94fd$var$Centered.Pool.alloc(e,t,a)},$0752c36c8a8a94fd$var$Drawable.prototype.centered=function(e,t){return $0752c36c8a8a94fd$var$Centered.Pool.alloc(this,e,t)},$0752c36c8a8a94fd$var$Drawable.static=function(e,t,a){return $0752c36c8a8a94fd$var$Static.Pool.alloc(e,t,a)},$0752c36c8a8a94fd$var$Drawable.prototype.static=function(e,t){return $0752c36c8a8a94fd$var$Static.Pool.alloc(this,e,t)},$0752c36c8a8a94fd$var$Drawable.group=function(...e){return $0752c36c8a8a94fd$var$Group.Pool.alloc(e)},$0752c36c8a8a94fd$var$Drawable.mirrorX=function(e){return $0752c36c8a8a94fd$var$MirrorX.Pool.alloc(e)},$0752c36c8a8a94fd$var$Drawable.prototype.mirrorX=function(){return $0752c36c8a8a94fd$var$MirrorX.Pool.alloc(this)},$0752c36c8a8a94fd$var$Drawable.mirrorY=function(e){return $0752c36c8a8a94fd$var$MirrorY.Pool.alloc(e)},$0752c36c8a8a94fd$var$Drawable.prototype.mirrorY=function(){return $0752c36c8a8a94fd$var$MirrorY.Pool.alloc(this)},
//!/class
//!namespace Drawable
//!namespace Pool
Recycler.createPool($0752c36c8a8a94fd$var$Drawable,512);var $0752c36c8a8a94fd$export$2e2bcd8739ae039=$0752c36c8a8a94fd$var$Drawable,$b1048ee260d224f3$export$2e2bcd8739ae039=$0752c36c8a8a94fd$export$2e2bcd8739ae039.extend({className:"DrawableResource",r:null,__ctor:function(e){if("image"!==e.type)throw new Error("Resource is not an image.");this._super.Drawable.__ctor(e.data,e.width,e.height),this.r=e,this.r.wrapper=this}}),//![import "../system/canvas"]
$ccc7f3c7c919d669$export$2e2bcd8739ae039=$0752c36c8a8a94fd$export$2e2bcd8739ae039.extend({className:"DrawableCustom",__ctor:function(e){if("object"!=e.type)throw new Error("Resource is not an object.");this._super.Drawable.__ctor(null,e.width,e.height),this.r=e,this.r.wrapper=this},init:function(e){$ea6ab44f7f06a4a9$export$2e2bcd8739ae039.renderImage(this.r.width,this.r.height,(e=>{null!==this.r.draw&&"function"==typeof this.r.draw?this.r.draw(e,this.r):(e.fillStyle(this.r.color),e.fillRect(0,0,this.r.width,this.r.height))}),(t=>{this.resource=t,this.swidth=this.resource.width,this.sheight=this.resource.height,e()}))}});const $d130f4d327069d4b$var$FrameDrawable=$0752c36c8a8a94fd$export$2e2bcd8739ae039.extend({spritesheet:null,frameIndex:0,__ctor:function(e,t,a,i,r,n,s,o=null,l=null){this._super.Drawable.__ctor(null,o??e.width,l??e.height),this.spritesheet=e,this.frameIndex=t,this.sx=i,this.sy=r,this.swidth=n,this.sheight=s,this.resource=a}});var $d130f4d327069d4b$export$2e2bcd8739ae039=$0752c36c8a8a94fd$export$2e2bcd8739ae039.extend({className:"Spritesheet",frameCache:null,numFrames:0,frameWidth:0,frameHeight:0,__ctor:function(e){if(this._super.Drawable.__ctor(),"image"!=e.type&&"images"!=e.type)throw new Error("Resource is not a sprite sheet.");let t,a,i,r;if("image"==e.type){if(!(e.config.sheetWidth||e.config.numFrames&&e.config.frameWidth||e.config.coords))throw new Error(e.resName+": required `sheetWidth` or `numFrames` with `frameWidth` or `coords` array.");e.config.sheetWidth||(e.config.sheetWidth=e.width),e.config.frameHeight||(e.config.frameHeight=e.data.height),t=e.data.width/e.config.sheetWidth,a=e.width/e.config.sheetWidth}else e.config||(e.config={}),e.config.frameWidth||(e.config.frameWidth=e.data[0].width),e.config.frameHeight||(e.config.frameHeight=e.data[0].height),t=e.data[0].data.width/e.config.frameWidth,a=e.data[0].width/e.config.frameWidth;this.frameWidth=e.config.frameWidth*t,this.frameHeight=e.config.frameHeight*t,this.width=e.config.frameWidth*a,this.height=e.config.frameHeight*a,"image"==e.type?(i=int(e.data.width/this.frameWidth),r=Math.ceil(e.data.height/this.frameHeight),e.config.coords?this.numFrames=e.config.coords.length:this.numFrames=e.config.numFrames||i*r):(i=r=0,this.numFrames=e.data.length),this.r=e,this.r.wrapper=this,this.frameCache={};for(let e=0;e<this.numFrames;e++){let r;r=this.r.config.coords?new $d130f4d327069d4b$var$FrameDrawable(this,e,this.r.data,this.r.config.coords[e][0]*t,this.r.config.coords[e][1]*t,this.r.config.coords[e][2]*t,this.r.config.coords[e][3]*t,this.r.config.coords[e][2]*a,this.r.config.coords[e][3]*a):0!=this.numCols?new $d130f4d327069d4b$var$FrameDrawable(this,e,this.r.data,e%i*this.frameWidth,int(e/i)*this.frameHeight,this.frameWidth,this.frameHeight):new $d130f4d327069d4b$var$FrameDrawable(this,e,this.r.data[e].data,0,0,this.frameWidth,this.frameHeight),this.frameCache[e]=r}},getFrame:function(e){if(e<0||e>=this.numFrames)throw new Error("frameIndex out of range");return this.frameCache[e]},getTexture:function(){return this.getFrame(0).getTexture()},getDrawable:function(){return this.getFrame(0)}});parcelRequire("3CL91");const $6ad2cffd9d1b5ee6$export$c35d437ae5945fcd=$0752c36c8a8a94fd$export$2e2bcd8739ae039.extend({className:"Animation",seq:null,seq_i:0,n_seq:null,queue:null,fps:0,frameDuration:0,time:0,frameNumber:-1,finished:!1,_paused:!1,finishedCallback:null,finishedCallbackHandler:null,finishedCallbackContext:null,frameCallback:null,__ctor:function(e,t,a){this._super.Drawable.__ctor(e.getTexture(),e.width,e.height),this.anim=e,this.queue=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.seq=t,this.seq_i=0,this.n_seq=null,this.frameNumber=-1,this.finished=!1,this._paused=!1,this.finishedCallback=null,this.finishedCallbackHandler=null,this.finishedCallbackContext=null,this.frameCallback=null,this.fps=a,this.setFps(this.seq.fps||this.fps)},__dtor:function(){this.queue.free(),this.finishedCallbackHandler&&this.finishedCallbackHandler.free(),this.finishedCallbackContext&&this.finishedCallbackContext.free()},setFps:function(e){return this.frameDuration=1/e,this.time=0,this},paused:function(e=null){return null===e?this._paused:(this._paused=e,this)},initialDelay:function(e){return this.time=-e,this},onFinished:function(e){return this.finishedCallback=e,this},then:function(e,t=null){return!1===e&&this.finishedCallback===this.thenCallback&&(this.finishedCallbackHandler.clear(),this.finishedCallbackContext.clear()),e?(this.finishedCallback!==this.thenCallback&&(this.finishedCallback=this.thenCallback,this.finishedCallbackHandler=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.finishedCallbackContext=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc()),this.finishedCallbackHandler.push(e),this.finishedCallbackContext.push(t),this):this},thenCallback:function(){if(!this.finishedCallbackHandler.length)return!1;let e=this.finishedCallbackContext.shift();this.finishedCallbackHandler.shift()(this,e)},onFrame:function(e){return this.frameCallback=e,this},setFrame:function(e){return this.seq_i=int(e)%this.seq.group.length,this},getFrame:function(e){return!0===e?this.seq_i/(this.seq.group.length-1):this.seq_i},getLength:function(){return this.seq.group.length},drawf:function(e,t,a,i,r,n,s,o,l,c=null,h=null){if(this._paused||(this.time+=this.frameNumber===$041013b7ee2c8fb5$export$2e2bcd8739ae039.frameNumber?0:$041013b7ee2c8fb5$export$2e2bcd8739ae039.frameDelta),this.time<0)return void(this.frameNumber=$041013b7ee2c8fb5$export$2e2bcd8739ae039.frameNumber);if(null!==this.n_seq&&this.frameNumber!==$041013b7ee2c8fb5$export$2e2bcd8739ae039.frameNumber&&(this.seq=this.n_seq,this.seq_i=0,this.n_seq=null,this.time=0,this.finished=!1,this.setFps(this.seq.fps||this.fps)),this.time>=this.frameDuration&&this.frameNumber!==$041013b7ee2c8fb5$export$2e2bcd8739ae039.frameNumber&&!this.finished){const e=this.seq_i;this.time-=this.frameDuration,this.seq_i++,this.seq_i===this.seq.group.length&&(this.seq.loop?this.seq_i=0:(this.finished=!0,this.finishedCallback&&!1===this.finishedCallback(this)&&(this.finishedCallback=null)),this.queue.length&&this.use(this.queue.shift(),!0)),this.frameCallback&&!1===this.frameCallback(e,this.seq.group.length-1,this)&&(this.frameCallback=null)}let f=this.seq.group[this.seq_i===this.seq.group.length?this.seq_i-1:this.seq_i];for(let t=0;t<f.length;t++){let a=this.anim.getFrame(f[t]);a.drawf(e,a.sx,a.sy,a.swidth,a.sheight,n,s,o,l,c,h)}this.frameNumber=$041013b7ee2c8fb5$export$2e2bcd8739ae039.frameNumber},getTexture:function(){return this.anim.getTexture()},getDrawable:function(){return this},advance:function(){this.paused(!1),this.draw(null,0,0)},getSequenceName:function(){return null===this.n_seq?this.seq.name:this.n_seq.name},use:function(e,t=!1){return!(this.seq.name===e&&!this.finished&&!0!==t)&&(this.n_seq=this.anim.a.seq[e],this.finished=!1,!0)},play:function(e,t=!1){return this.use(e,t),this},setQueue:function(e){if(!$c73414f3aa8cd9da$export$2e2bcd8739ae039.isInstance(e))throw new Error("setQueue: Parameter must be an instance of List");null!=this.queue&&this.queue.clear().free(),this.queue=e,this.use(this.queue.shift(),!0)},enqueue:function(e,t=!1){let a=this.seq,i=this.queue.length>0?this.queue[this.queue.length-1]:a.name;return a.name===e&&a.loop?this:i!==e||t?a.loop||this.finished?(this.use(e,!0),this):(this.queue.push(e),this):this}});$cac8b143592e7d73$export$2e2bcd8739ae039.createPool($6ad2cffd9d1b5ee6$export$c35d437ae5945fcd);var $6ad2cffd9d1b5ee6$export$2e2bcd8739ae039=$d130f4d327069d4b$export$2e2bcd8739ae039.extend({className:"SpritesheetAnimation",defaultDrawable:null,sharedAnim:null,r:null,a:null,__ctor:function(e){if(!e.anim)throw new Error("Animation descriptors not found.");this._super.Spritesheet.__ctor(e),this.r=e,this.r.wrapper=this;let t=this.a=this.r.anim;if(t.initialized)return;if(t.def||(t.def="def"),t.seq||(t.seq={}),!t.seq[t.def]&&("def"==t.def||"defloop"==t.def)){let e={loop:"def"!=t.def,group:[]};for(let t=0;t<this.numFrames;t++)e.group.push([t]);t.seq[t.def]=e}if(!t.seq[t.def])throw new Error("Undefined default sequence: "+t.def);t.fps||(t.fps=25),t.def=t.seq[t.def];let a=0;for(let e in t.seq)if(t.seq[e].name=e,t.seq[e].loop||(t.seq[e].loop=!1),"string"==typeof t.seq[e].group){let i,r,n;if(-1!=t.seq[e].group.indexOf(" ")){i=t.seq[e].group.split(" "),t.seq[e].group=[];for(let a in i)t.seq[e].group.push([int(i[a])])}else if(-1!=t.seq[e].group.indexOf("-"))if(n=t.seq[e].group.split("-"),i=int(n[0]),r=int(n[1]),t.seq[e].group=[],i<r)for(n=i;n<=r;n++)t.seq[e].group.push([n]);else for(n=i;n>=r;n--)t.seq[e].group.push([n]);else for(i=int(t.seq[e].group),t.seq[e].group=[];i--;)t.seq[e].group.push([a++]);t.seq[e].count=t.seq[e].group.length}t.initialized=!0},getSharedAnimation:function(e=null){return null===this.sharedAnim?(this.sharedAnim=$6ad2cffd9d1b5ee6$export$c35d437ae5945fcd.Pool.alloc(this,e?this.a.seq[e]:this.a.def,this.a.fps),this.sharedAnim.lockInstance(!0),this.sharedAnim):this.sharedAnim.play(e||this.a.def.name)},getAnimation:function(e=null,t=null){return $6ad2cffd9d1b5ee6$export$c35d437ae5945fcd.Pool.alloc(this,e?this.a.seq[e]:this.a.def,t||this.a.fps)},getSequence:function(e){return this.a.seq[e]},getDrawable:function(){return null===this.defaultDrawable&&(this.defaultDrawable=this.getAnimation()),this.defaultDrawable}}),$3CL91=parcelRequire("3CL91"),//![import "../system/canvas"]
$084a5e00ca877bf8$export$2e2bcd8739ae039=$3CL91.Class.extend({__ctor:function(e){if("image"!=e.type||!e.font)throw new Error("Resource is not a sprite font.");e.font.sheetWidth||(e.font.sheetWidth=e.width);let t=e.data.width/e.font.sheetWidth,a=e.width/e.font.sheetWidth;this.r_charWidth=e.font.charWidth*t,this.r_charHeight=e.font.charHeight*t,this.charWidth=e.font.charWidth*a,this.charHeight=e.font.charHeight*a,this.paddingX=(e.font.paddingX||0)*a,this.paddingY=(e.font.paddingY||0)*a,this.spacingX=(e.font.spacingX||0)*a,this.spacingY=(e.font.spacingY||0)*a,this.reverseDraw=e.font.reverseDraw||!1;let i=int(e.font.sheetWidth/e.font.charWidth);this.r=e,this.r.wrapper=this;let r=e.font.charset.length,n=0,s=0;for(this.charTable={};n<r;){let t=0;for(let a=0;a<i&&n<r;a++){let a=e.font.charset[n++];this.charTable[a]={hidden:!1,x:t,y:s,charWidth:this.charWidth,r_charWidth:this.r_charWidth,spacingX:0},t+=this.r_charWidth}s+=this.r_charHeight}if(" "in this.charTable||(this.charTable[" "]={hidden:!0,charWidth:int(2*(this.charWidth+this.paddingX)/3),r_charWidth:this.r_charWidth,spacingX:0}),e.font.widths){r=e.font.widths.length;for(let t=0;t<r;t+=2){let i=e.font.widths[t+1]*a,r=e.font.widths[t];"number"==typeof r&&(r=String.fromCharCode(r));for(let e=0;e<r.length;e++)r[e]in this.charTable&&(this.charTable[r[e]].spacingX=i-this.charTable[r[e]].charWidth)}}},drawText:function(e,t,a,i){let r=i.length,n=-2*this.paddingX+this.spacingX;if(t-=this.paddingX,a-=this.paddingY,this.reverseDraw){for(let e=0;e<r-1;e++){let a=this.charTable[i[e]];a&&(t+=a.charWidth+n)}for(let s=r-1;s>=0;s--){let r=this.charTable[i[s]];r&&(r.hidden||e.drawImage(this.r.data,r.x,r.y,r.r_charWidth,this.r_charHeight,t,a,r.charWidth,this.charHeight,null,null,r.charWidth,this.charHeight),t-=r.charWidth+n+r.spacingX)}}else for(let s=0;s<r;s++){let r=this.charTable[i[s]];r&&(r.hidden||e.drawImage(this.r.data,r.x,r.y,r.r_charWidth,this.r_charHeight,t,a,r.charWidth,this.charHeight,null,null,r.charWidth,this.charHeight),t+=r.charWidth+n+r.spacingX)}},measureWidth:function(e){let t=e.length,a=0,i=-2*this.paddingX+this.spacingX;for(let r=0;r<t;r++){let t=this.charTable[e[r]];t&&(a+=t.charWidth+i+t.spacingX)}return a},measureHeight:function(e){return this.charHeight-2*this.paddingY+this.spacingY}});$ea6ab44f7f06a4a9$export$2e2bcd8739ae039.prototype.drawText=function(e,t,a,i){e.drawText(this,t,a,i)},$ea6ab44f7f06a4a9$export$2e2bcd8739ae039.prototype.drawTextAligned=function(e,t,a,i,r,n,s,o){0==n?t+=i-e.measureWidth(o)>>1:n<0?t=t-n-1:n>0&&(t=t+i-n+1-e.measureWidth(o)),0==s?a+=r-e.measureHeight(o)>>1:s<0?a=a-s-1:s>0&&(a=a+r-s+1-e.measureHeight(o)),e.drawText(this,t,a,o)},$ea6ab44f7f06a4a9$export$2e2bcd8739ae039.prototype.drawTextAligned2=function(e,t,a,i,r){this.drawTextAligned(e,t.x1,t.y1,t.width(),t.height(),a,i,r)};var $3CL91=parcelRequire("3CL91"),$3CL91=parcelRequire("3CL91");const $fe89a08f3d52be1f$var$Resources={};let $fe89a08f3d52be1f$var$reported=!1;
//!namespace Resources
//!type ConfigOptions =
//!/type
//!/namespace
//!class Resources
Object.assign($fe89a08f3d52be1f$var$Resources,{integerScalingEnabled:!0,pixelated:!1,filter:"LINEAR",original:!1,config:function(e){null!==e&&Object.assign(this,e)},load:function(e,t,a,i,r){if(!i){i=Object.keys(e);for(let t in i)"__loaded"in e[i[t]]||(e[i[t]].__clone=$3CL91.Rinn.clone(e[i[t]]));r=0}for(;r<i.length&&"__loaded"in e[i[r]];)r++;if(t&&t(r,i.length,r/i.length,r<i.length?i[r]:null),r==i.length)return void(a&&a(e));let n,s,o,l,c,h=e[i[r]];switch(h.resName=i[r],h.type){case"image":h.data=new Image,h.data.onload=async function(){const n=h.data.width/h.data.height;h.scale&&(h.width=int(h.data.width*h.scale),h.height=int(h.data.height*h.scale)),h.hasOwnProperty("extraScale")||(h.extraScale=0),h.width||h.height?h.width&&!h.height?h.height=int(h.width/n):!h.width&&h.height&&(h.width=int(n*h.height)):(h.width=h.data.width,h.height=h.data.height),h.hasOwnProperty("filter")||(h.filter=h.hasOwnProperty("pixelated")&&!0===h.pixelated?"NEAREST":$fe89a08f3d52be1f$var$Resources.filter),h.hasOwnProperty("pixelated")||(h.pixelated=$fe89a08f3d52be1f$var$Resources.pixelated),h.hasOwnProperty("original")||(h.original=$fe89a08f3d52be1f$var$Resources.original),h.data.width==h.width&&h.data.height==h.height&&0==h.extraScale||!0===h.original||(h.data=await $fe89a08f3d52be1f$var$Resources.resizeImage(h,h.width*(h.extraScale+(h.pixelated?$041013b7ee2c8fb5$export$2e2bcd8739ae039.integerScaleFactor:$041013b7ee2c8fb5$export$2e2bcd8739ae039.scaleFactor)),h.height*(h.extraScale+(h.pixelated?$041013b7ee2c8fb5$export$2e2bcd8739ae039.integerScaleFactor:$041013b7ee2c8fb5$export$2e2bcd8739ae039.scaleFactor)),h.pixelated,!0)),h.rscale=h.data.width/h.width,h.data.rscale=h.rscale,h.data.filter=h.filter,h.data.targetWidth=h.width,h.data.targetHeight=h.height,h.hasOwnProperty("mipmap")&&h.mipmap>0&&(h.data.mipmap=h.mipmap),$041013b7ee2c8fb5$export$2e2bcd8739ae039.tempDisplayBuffer.drawImage(h.data,0,0),$041013b7ee2c8fb5$export$2e2bcd8739ae039.renderer.prepareImage(h.data),$fe89a08f3d52be1f$var$Resources.onLoaded(e,i[r],(()=>{$fe89a08f3d52be1f$var$Resources.load(e,t,a,i,r+1)}))},h.data.onerror=function(){console.error("Error: Unable to load: "+h.resName)},h.data.src=h.src+"?r="+Math.random();break;case"images":if(n=h.src,s=n.indexOf("#"),o=n.lastIndexOf("#"),l=o-s+1,-1==s)return void console.error("Unable to load: "+h.resName+"\nError: The 'src' attribute requires one or more '#' marks.");if(!h.count)return void console.error("Unable to load: "+h.resName+"\nError: The 'count' attribute was not found.");h._i=0,h.data=[],c=function(){if(h._i==h.count)return void $fe89a08f3d52be1f$var$Resources.onLoaded(e,i[r],(()=>{$fe89a08f3d52be1f$var$Resources.load(e,t,a,i,r+1)}));let n={type:"image",width:h.width,height:h.height,scale:h.scale};n.src=h.src.substr(0,s)+(h._i++/Math.pow(10,l)).toFixed(l).substr(2)+h.src.substr(o+1),n.data=new Image,n.resName=h.resName+"#"+(h._i-1),t&&t(r,i.length,r/i.length+(h._i-1)/h.count*(1/i.length),h.resName+"/"+(h._i-1)),n.data.onload=async function(){let e=n.data.width/n.data.height;n.scale&&(n.width=int(n.data.width*n.scale),n.height=int(n.data.height*n.scale)),n.width||n.height?n.width&&!n.height?n.height=int(n.width/e):!n.width&&n.height&&(n.width=int(e*n.height)):(n.width=n.data.width,n.height=n.data.height),1==h._i&&(h.owidth=n.data.width,h.oheight=n.data.height,h.hasOwnProperty("filter")||(h.filter=h.hasOwnProperty("pixelated")&&!0===h.pixelated?"NEAREST":$fe89a08f3d52be1f$var$Resources.filter),h.hasOwnProperty("pixelated")||(h.pixelated=$fe89a08f3d52be1f$var$Resources.pixelated),h.hasOwnProperty("original")||(h.original=$fe89a08f3d52be1f$var$Resources.original)),n.pixelated=h.pixelated,n.filter=h.filter,n.original=h.original,n.data.width==n.width&&n.data.height==n.height||!0===n.original||(n.data=await $fe89a08f3d52be1f$var$Resources.resizeImage(n,n.width*(h.pixelated?$041013b7ee2c8fb5$export$2e2bcd8739ae039.integerScaleFactor:$041013b7ee2c8fb5$export$2e2bcd8739ae039.scaleFactor),n.height*(n.pixelated?$041013b7ee2c8fb5$export$2e2bcd8739ae039.integerScaleFactor:$041013b7ee2c8fb5$export$2e2bcd8739ae039.scaleFactor),n.pixelated,!0)),n.rscale=n.data.width/n.width,n.data.rscale=n.rscale,n.data.filter=n.filter,n.data.targetWidth=n.width,n.data.targetHeight=n.height,h.hasOwnProperty("mipmap")&&h.mipmap>0&&(n.data.mipmap=h.mipmap),1==h._i&&(h.width=n.width,h.height=n.height,h.rscale=n.rscale),$041013b7ee2c8fb5$export$2e2bcd8739ae039.tempDisplayBuffer.drawImage(n.data,0,0),$041013b7ee2c8fb5$export$2e2bcd8739ae039.renderer.prepareImage(n.data),h.data.push(n),c()},n.data.onerror=function(){console.error("Error: Unable to load: "+n.resName)},n.data.src=n.src+"?r="+Math.random()},c();break;case"audio":if(h.track||(h.track="sfx"),$parcel$global.plugins&&$parcel$global.plugins.NativeAudio&&"sfx"==h.track){$fe89a08f3d52be1f$var$reported||($70a42a4582ac5be9$export$2e2bcd8739ae039.write("ENGINE_NATIVEAUDIO"),$fe89a08f3d52be1f$var$reported=!0),h.engine=$fb16f2790102e0ed$exports.Sound.ENGINE_NATIVEAUDIO,h.data="snd_"+r,$parcel$global.plugins.NativeAudio.preloadSimple(h.data,h.src,(function(){$fe89a08f3d52be1f$var$Resources.onLoaded(e,i[r],(()=>{$fe89a08f3d52be1f$var$Resources.load(e,t,a,i,r+1)}))}),(function(e){console.error("Error: Unable to load (sfx): "+h.resName+"\n"+e)}));break}if($parcel$global.audioContext){$fe89a08f3d52be1f$var$reported||($70a42a4582ac5be9$export$2e2bcd8739ae039.write("ENGINE_WEBAUDIO"),$fe89a08f3d52be1f$var$reported=!0),h.engine=$fb16f2790102e0ed$exports.Sound.ENGINE_WEBAUDIO,fetchAudioBuffer(h.src+"?r="+Math.random()).then((n=>{h.data=n,$fe89a08f3d52be1f$var$Resources.onLoaded(e,i[r],(()=>{$fe89a08f3d52be1f$var$Resources.load(e,t,a,i,r+1)}))})).catch((e=>{console.error("Error: Unable to load: "+h.resName+"\n"+e)}));break}$fe89a08f3d52be1f$var$reported||($70a42a4582ac5be9$export$2e2bcd8739ae039.write("ENGINE_HTML5"),$fe89a08f3d52be1f$var$reported=!0),h.data=new Audio,h.engine=$fb16f2790102e0ed$exports.Sound.ENGINE_HTML5,h.data.oncanplaythrough=function(){$fe89a08f3d52be1f$var$Resources.onLoaded(e,i[r],(()=>{$fe89a08f3d52be1f$var$Resources.load(e,t,a,i,r+1)}))},h.data.onerror=function(){console.error("Error: Unable to load: "+h.resName)},h.data.src=h.src+"?r="+Math.random();break;case"audios":if(n=h.src,s=n.indexOf("#"),o=n.lastIndexOf("#"),l=o-s+1,-1==s)return void console.error("Unable to load: "+h.resName+"\nError: The 'src' attribute requires one or more '#' marks.");if(!h.count)return void console.error("Unable to load: "+h.resName+"\nError: The 'count' attribute was not found.");h._i=0,h.data=[],c=function(){if(h._i==h.count)return void $fe89a08f3d52be1f$var$Resources.onLoaded(e,i[r],(()=>{$fe89a08f3d52be1f$var$Resources.load(e,t,a,i,r+1)}));let n={type:"audio",track:h.track};return n.src=h.src.substr(0,s)+(h._i++/Math.pow(10,l)).toFixed(l).substr(2)+h.src.substr(o+1),n.resName=h.resName+"#"+(h._i-1),n.track||(n.track="sfx"),$parcel$global.plugins&&$parcel$global.plugins.NativeAudio&&"sfx"==n.track?(n.engine=$fb16f2790102e0ed$exports.Sound.ENGINE_NATIVEAUDIO,n.data="snd_"+r+"_"+h._i,void $parcel$global.plugins.NativeAudio.preloadSimple(n.data,n.src,(function(){h.data.push(n),c()}),(function(e){console.error("Error: Unable to load (sfx): "+n.resName+"\n"+e)}))):$parcel$global.audioContext?(n.engine=$fb16f2790102e0ed$exports.Sound.ENGINE_WEBAUDIO,void fetchAudioBuffer(n.src+"?r="+Math.random()).then((e=>{n.data=e,h.data.push(n),c()})).catch((e=>{console.error("Error: Unable to load: "+n.resName+"\n"+e)}))):(n.data=new Audio,n.engine=$fb16f2790102e0ed$exports.Sound.ENGINE_HTML5,n.data.oncanplaythrough=function(){h.data.push(n),c()},n.data.onerror=function(){console.error("Error: Unable to load: "+n.resName)},void(n.data.src=n.src+"?r="+Math.random()))},c();break;case"json":fetchd(h.src+"?r="+Math.random(),{responseType:"json"}).then((function(n){h.data=n,$fe89a08f3d52be1f$var$Resources.onLoaded(e,i[r],(()=>{$fe89a08f3d52be1f$var$Resources.load(e,t,a,i,r+1)}))})).catch((function(e){console.error("Error: Unable to load: "+h.resName+"\n"+e)}));break;case"data":fetchd(h.src+"?r="+Math.random()).then((function(n){h.data=n,$fe89a08f3d52be1f$var$Resources.onLoaded(e,i[r],(()=>{$fe89a08f3d52be1f$var$Resources.load(e,t,a,i,r+1)}))})).catch((function(e){console.error("Error: Unable to load: "+h.resName+"\n"+e)}));break;case"text":fetchd(h.src+"?r="+Math.random()).then((function(n){h.data=String.fromCharCode.apply(null,new Uint8Array(n)),$fe89a08f3d52be1f$var$Resources.onLoaded(e,i[r],(()=>{$fe89a08f3d52be1f$var$Resources.load(e,t,a,i,r+1)}))})).catch((function(e){console.error("Error: Unable to load: "+h.resName+"\n"+e)}));break;case"object":h.data={},$fe89a08f3d52be1f$var$Resources.onLoaded(e,i[r],(()=>{$fe89a08f3d52be1f$var$Resources.load(e,t,a,i,r+1)}))}},unload:function(e){throw new Error("IMPLEMENTED UNLOAD!")},onLoaded:function(e,t,a){let i=e[t];i.wrapper&&i.wrapper in $fb16f2790102e0ed$exports?(e[t]=new $fb16f2790102e0ed$exports[i.wrapper](i),"init"in e[t]?e[t].init((()=>{e[t].__loaded=!0,a()})):(e[t].__loaded=!0,a())):a()},loadImage:function(e){return new Promise(((t,a)=>{const i=new Image;i.onload=()=>t(i),i.onerror=()=>a(new Error("Unable to load image")),i.src=e}))},resizeImage:async function(e,t,a,i,r){let n=e.data.width,s=e.data.height;if(t=int(t),a=int(a),n==t&&s==a)return e.data;if(!this.integerScalingEnabled&&i&&(i=null),i){if(int(t/n)>0){let i=int(t/n+.9),r=(t=i*n)/n,o=(a=i*s)/s,l=new $ea6ab44f7f06a4a9$export$2e2bcd8739ae039({hidden:!0,antialias:!1}).resize(t,a),c=new $ea6ab44f7f06a4a9$export$2e2bcd8739ae039({hidden:!0,antialias:!1}).resize(n,s);c.drawImage(e.data,0,0);for(let e=0;e<s;e++){let t=c.getImageData(0,e,n,1).data,a=0;for(let i=0;i<n&&a<t.length;i++,a+=4)l.fillStyle("rgba("+t[a]+","+t[a+1]+","+t[a+2]+","+t[a+3]/255+")"),l.fillRect(i*r,e*o,r,o)}return c.dispose(),await this.loadImage(l.toDataUrl())}return this.resizeImage(e,t,a,null,r)}{let o=new $ea6ab44f7f06a4a9$export$2e2bcd8739ae039({hidden:!0,antialias:i=null!==i}).resize(n,s);for(o.drawImage(e.data,0,0);;){let e=n>>1,r=s>>1;if(e<=t||r<=a)break;let l=new $ea6ab44f7f06a4a9$export$2e2bcd8739ae039({hidden:!0,antialias:i}).resize(e,r);l.drawImage(o.elem,0,0,e,r),o.dispose(),n=e,s=r,o=l}let l=new $ea6ab44f7f06a4a9$export$2e2bcd8739ae039({hidden:!0,antialias:i}).resize(t,a);return l.drawImage(o.elem,0,0,t,a),o.dispose(),r&&dispose(e.data),await this.loadImage(l.toDataUrl())}},flipImageHorz:function(e){let t=new $ea6ab44f7f06a4a9$export$2e2bcd8739ae039({hidden:!0}).resize(e.data.width,e.data.height);return t.translate(e.data.width,0),t.scale(-1,1),t.drawImage(e.data,0,0),t.elem},flipImageVert:function(e){let t=new $ea6ab44f7f06a4a9$export$2e2bcd8739ae039({hidden:!0}).resize(e.data.width,e.data.height);return t.translate(0,e.data.height),t.scale(1,-1),t.drawImage(e.data,0,0),t.elem},showDownload:function(e,t){let a=document.createElement("a");a.href=t,a.style.display="none",a.download=e,a.target="_blank",document.body.appendChild(a),a.click(),document.body.removeChild(a)},showFilePicker:function(e,t,a){let i=document.createElement("input");i.type="file",i.accept=t,i.style.display="none",i.multiple=e,document.body.appendChild(i),i.onchange=function(){a(i.files)},document.body.onfocus=function(){document.body.onfocus=null,document.body.removeChild(i)},i.click()},loadAsDataURL:function(e,t){let a=new FileReader;a.onload=function(e){t(e.target.result)},a.readAsDataURL(e)},loadAsText:function(e,t){let a=new FileReader;a.onload=function(e){t(e.target.result)},a.readAsText(e)},loadAsArrayBuffer:function(e,t){let a=new FileReader;a.onload=function(e){t(e.target.result)},a.readAsArrayBuffer(e)},loadAllAsDataURL:function(e,t){let a=[];if(!e||!e.length)return void t(a);let i=function(r){r!=e.length?$fe89a08f3d52be1f$var$Resources.loadAsDataURL(e[r],(function(t){a.push({name:e[r].name,size:e[r].size,url:t}),i(r+1)})):t(a)};i(0)}});var//!/class
$fe89a08f3d52be1f$export$2e2bcd8739ae039=$fe89a08f3d52be1f$var$Resources;
//![import "./resources"]
const $90fa62f30432a965$var$Sound=$3CL91.Class.extend({r:null,__ctor:function(e){if("audio"!=e.type)throw new Error("Resource is not audio.");this.r=e,this.r.wrapper=this,this.track=$90fa62f30432a965$var$Sound[this.r.track.toUpperCase()]},play:function(e,t){return $90fa62f30432a965$var$Sound.play(this,e,t)},playLoop:function(e,t){return $90fa62f30432a965$var$Sound.playLoop(this,e,t)}});$90fa62f30432a965$var$Sound.ENGINE_HTML5=1,$90fa62f30432a965$var$Sound.ENGINE_WEBAUDIO=2,$90fa62f30432a965$var$Sound.ENGINE_NATIVEAUDIO=3,Object.assign($90fa62f30432a965$var$Sound,{MASTER:{enabled:!0,volume:1},SFX:{enabled:!0,volume:1},MUSIC:{enabled:!0,volume:.8},VOICE:{enabled:!0,volume:1},MAX_POOL_SIZE:100,pool:[],active:[],register:function(e){e.registered||(e.registered=!0,this.active.push(e))},unregister:function(e){if(e.registered){e.registered=!1;var t=$90fa62f30432a965$var$Sound.active.indexOf(e);-1!=t&&$90fa62f30432a965$var$Sound.active.splice(t,1)}},updateNode:function(e,t){switch(e.snd.r.engine){case $90fa62f30432a965$var$Sound.ENGINE_WEBAUDIO:return this.updateNode_webaudio(e,t);case $90fa62f30432a965$var$Sound.ENGINE_NATIVEAUDIO:return this.updateNode_nativeaudio(e,t)}return this.updateNode_audio(e,t)},alloc_webaudio:function(e){e.gainNode=audioContext.createGain(),e.gainNode.gain.value=0,e.gainNode.connect(audioContext.destination),e.res=audioContext.createBufferSource(),e.res.buffer=e.snd.r.data,e.res.loop=!1,e.res.connect(e.gainNode),e.res.node=e},free_webaudio:function(e){e.res&&(e.gainNode.disconnect(),e.res=null,e.gainNode=null)},alloc_nativeaudio:function(e){e.res=!0},free_nativeaudio:function(e){e.res=!1},alloc_audio:function(e){return this.pool.length?item=this.pool.pop():item=e.cloneNode(),item._src=e.src,item},free_audio:function(e){this.pool.length!=this.MAX_POOL_SIZE&&this.pool.push(e)},updateNode_webaudio:function(e,t){if(!e)return null;var a=$90fa62f30432a965$var$Sound.MASTER.volume*e.snd.track.volume*e.volume;switch(t){case"play":if(e.playing)break;e.res||$90fa62f30432a965$var$Sound.alloc_webaudio(e),e.playTime=hrnow(),e.playing=!0,e.pause=!1,e.res.onended=$90fa62f30432a965$var$Sound.onended_webaudio,e.gainNode.gain.value=a;try{e.res.start(0,e.startTime/1e3)}catch(t){return $90fa62f30432a965$var$Sound.free_webaudio(e),null}$90fa62f30432a965$var$Sound.register(e);break;case"setvolume":if(!e.res)break;e.gainNode.gain.value=a;break;case"stop":if(!e.playing&&e.paused){e.startTime=0,e.paused=!1,$90fa62f30432a965$var$Sound.free_webaudio(e),e.callback&&e.callback();break}if(!e.res)break;e.startTime=0,e.playing=!1,e.pause=!1,e.res.onended=null,$90fa62f30432a965$var$Sound.unregister(e),e.res.stop(),$90fa62f30432a965$var$Sound.free_webaudio(e),e.callback&&e.callback();break;case"pause":if(!e.playing||!e.res)break;e.startTime+=hrnow()-e.playTime,e.playing=!1,e.pause=!0,e.res.onended=null,$90fa62f30432a965$var$Sound.unregister(e),e.res.stop(),$90fa62f30432a965$var$Sound.free_webaudio(e);break;case"softstop":if(!e.playing&&e.paused){e.startTime=0,e.paused=!1;break}if(!e.playing||!e.res)break;e.startTime=0,e.playing=!1,e.pause=!1,e.res.loop=!1}return e},onended_webaudio:function(e){var t=e.currentTarget.node;if(t.playing&&0!=t.loop)return $90fa62f30432a965$var$Sound.free_webaudio(t),-1!=t.loop&&t.loop--,t.startTime=0,t.playing=!1,t.pause=!1,void $90fa62f30432a965$var$Sound.updateNode_webaudio(t,"play");t.res.onended=null,t.res.volume=0,$90fa62f30432a965$var$Sound.updateNode_webaudio(t,"stop")},updateNode_nativeaudio:function(e,t){if(!e)return null;switch(t){case"play":if(e.playing)break;e.res||$90fa62f30432a965$var$Sound.alloc_nativeaudio(e),e.playing=!0,e.pause=!1;try{$parcel$global.plugins.NativeAudio.play(e.snd.r.data,null,null,(function(){$90fa62f30432a965$var$Sound.onended_nativeaudio(e)}))}catch(t){return $90fa62f30432a965$var$Sound.free_nativeaudio(e),null}$90fa62f30432a965$var$Sound.register(e);break;case"setvolume":case"pause":case"softstop":break;case"stop":if(!e.res)break;e.playing=!1,e.pause=!1,$90fa62f30432a965$var$Sound.unregister(e),$parcel$global.plugins.NativeAudio.stop(e.snd.r.data,null),$90fa62f30432a965$var$Sound.free_nativeaudio(e),e.callback&&e.callback()}return e},onended_nativeaudio:function(e){$90fa62f30432a965$var$Sound.updateNode_nativeaudio(e,"stop")},updateNode_audio:function(e,t){if(!e)return null;var a=$90fa62f30432a965$var$Sound.MASTER.volume*e.snd.track.volume*e.volume;switch(t){case"play":if(e.playing)break;e.res||(e.res=$90fa62f30432a965$var$Sound.alloc_audio(e.snd.r.data),e.res.node=e,e.res.src=e.res._src),e.playTime=hrnow(),e.playing=!0,e.pause=!1,e.res.onended=$90fa62f30432a965$var$Sound.onended_audio,e.res.currentTime=e.startTime/1e3,e.res.volume=a;try{e.res.play()}catch(t){return $90fa62f30432a965$var$Sound.free_audio(e.res),e.res=null,null}$90fa62f30432a965$var$Sound.register(e);break;case"setvolume":if(!e.res)break;e.res.volume=a;break;case"stop":if(!e.playing&&e.paused){e.startTime=0,e.paused=!1,$90fa62f30432a965$var$Sound.free_audio(e.res),e.res=null,e.callback&&e.callback();break}if(!e.res)break;e.startTime=0,e.playing=!1,e.pause=!1,$90fa62f30432a965$var$Sound.unregister(e),e.res.pause(),$90fa62f30432a965$var$Sound.free_audio(e.res),e.res=null,e.callback&&e.callback();break;case"pause":if(!e.playing||!e.res)break;e.startTime+=hrnow()-e.playTime,e.playing=!1,e.pause=!0,$90fa62f30432a965$var$Sound.unregister(e),e.res.pause();break;case"softstop":if(!e.playing&&e.paused){e.startTime=0,e.paused=!1;break}if(!e.playing||!e.res)break;e.startTime=0,e.playing=!1,e.pause=!1}return e},onended_audio:function(e){var t=e.currentTarget.node;if(t.playing&&0!=t.loop)return-1!=t.loop&&t.loop--,t.startTime=0,t.playing=!1,t.pause=!1,void $90fa62f30432a965$var$Sound.updateNode_audio(t,"play");t.res.onended=null,t.res.volume=0,$90fa62f30432a965$var$Sound.updateNode_audio(t,"stop")},enableTrack:function(e){e&&(e.enabled=!0)},disableTrack:function(e){e&&(e.enabled=!1)},setVolume:function(e,t){e&&(e.volume=t)},createNode:function(e,t){var a={};return a.startVolume=t,a.volume=t,a.snd=e,a.loop=0,a.playing=!1,a.paused=!1,a.startTime=0,a.playTime=0,a.callback=null,a.timer=null,a.res=null,a},play:function(e,t,a){if(!this.MASTER.enabled||!e||!e.track.enabled)return null;a=null!=a?a:1;var i=this.createNode(e,a);return i.callback=t,this.updateNode(i,"play")},playLoop:function(e,t,a){if(!this.MASTER.enabled||!e||!e.track.enabled)return null;a=null!=a?a:1;var i=this.createNode(e,a);return i.callback=t,i.loop=-1,this.updateNode(i,"play")},stop:function(e,t){return e?(t&&!0!==t&&(e.callback=t),this.updateNode(e,!0===t?"stop":"softstop")):null},pause:function(e){return e?this.updateNode(e,"pause"):null},resume:function(e){return e?this.updateNode(e,"play"):null},fadeOut:function(e,t,a){if(e)if(e.playing&&!e.timer){var i=hrnow();e.startVolume=e.volume,e.timer=setInterval((function(){var r=(hrnow()-i)/t;r>1&&(r=1),e.volume=e.startVolume*(1-r),$90fa62f30432a965$var$Sound.updateNode(e,"setvolume"),1==r&&(clearInterval(e.timer),e.timer=null,!0===a?$90fa62f30432a965$var$Sound.updateNode(e,"stop"):$90fa62f30432a965$var$Sound.updateNode(e,"pause"),a&&!0!==a&&a())}),50)}else a&&a()},fadeIn:function(e,t,a){if(e)if(e.playing||e.timer)a&&a();else{var i=hrnow();e.volume=0,this.updateNode(e,"play"),e.timer=setInterval((function(){var r=(hrnow()-i)/t;r>1&&(r=1),e.volume=e.startVolume*r,$90fa62f30432a965$var$Sound.updateNode(e,"setvolume"),1==r&&(clearInterval(e.timer),e.timer=null,a&&a())}),50)}}}),$fe89a08f3d52be1f$export$2e2bcd8739ae039.Audio=function(e,t=null){return{type:"audio",wrapper:"Sound",src:e,...t}};var $90fa62f30432a965$export$2e2bcd8739ae039=$90fa62f30432a965$var$Sound,$3CL91=parcelRequire("3CL91"),//![import "./sound.js"]
$08892f6abacbb6ce$export$2e2bcd8739ae039=$3CL91.Class.extend({r:null,__ctor:function(e){if("audios"!=e.type)throw new Error("Resource is not audios.");this.r=e,this.r.wrapper=this,this.r.track||(this.r.track="sfx"),this.r.mode||(this.r.mode="random"),this.track=$90fa62f30432a965$export$2e2bcd8739ae039[this.r.track.toUpperCase()],this.sounds=[],this.lastIndex=-1;for(var t=0;t<this.r.data.length;t++)this.sounds.push(new $90fa62f30432a965$export$2e2bcd8739ae039(Object.assign(this.r.data[t],{track:this.r.track})))},getRandomSound:function(){return"random"==this.r.mode?this.sounds[randr(0,this.sounds.length-1)]:(this.lastIndex=++this.lastIndex%this.sounds.length,this.sounds[this.lastIndex])},play:function(e,t){return $90fa62f30432a965$export$2e2bcd8739ae039.play(this.getRandomSound(),e,t)},playLoop:function(e,t){return $90fa62f30432a965$export$2e2bcd8739ae039.playLoop(this.getRandomSound(),e,t)},playAt:function(e,t,a){return $90fa62f30432a965$export$2e2bcd8739ae039.play(this.sounds[e%this.sounds.length],t,a)},playLoopAt:function(e,t,a){return $90fa62f30432a965$export$2e2bcd8739ae039.playLoop(this.sounds[e%this.sounds.length],t,a)}});const $fb16f2790102e0ed$export$f35845279390eafd=$b1048ee260d224f3$export$2e2bcd8739ae039,$fb16f2790102e0ed$export$922ad9063d3cdee8=$ccc7f3c7c919d669$export$2e2bcd8739ae039,$fb16f2790102e0ed$export$674d2eb4debbef0c=$d130f4d327069d4b$export$2e2bcd8739ae039,$fb16f2790102e0ed$export$7faa71ea66a694bb=$6ad2cffd9d1b5ee6$export$2e2bcd8739ae039,$fb16f2790102e0ed$export$e1896ac0c4970221=$084a5e00ca877bf8$export$2e2bcd8739ae039,$fb16f2790102e0ed$export$85990f0f98a390bb=$90fa62f30432a965$export$2e2bcd8739ae039,$fb16f2790102e0ed$export$bc40a15752ef9732=$08892f6abacbb6ce$export$2e2bcd8739ae039;var $3CL91=parcelRequire("3CL91"),//!class PriorityQueue
$fa388e5ba5a88cdf$export$2e2bcd8739ae039=$3CL91.Class.extend({className:"PriorityQueue",queue:null,queueKeys:null,order:null,__ctor:function(){this.queue={},this.queueKeys=[]},add:function(e){return null==e?null:("priority"in e||(e.priority=50),e.priority in this.queue||(this.queue[e.priority]={is_dirty:!1,list:[]},this.queueKeys.push(e.priority),this.order=Object.keys(this.queue).sort(((e,t)=>e-t))),-1===this.queue[e.priority].list.indexOf(e)&&this.queue[e.priority].list.push(e),e)},remove:function(e){if(null==e)return null;if("priority"in e||(e.priority=50),!(e.priority in this.queue))return e;let t=this.queue[e.priority].list.indexOf(e);return-1===t||(this.queue[e.priority].is_dirty=!0,this.queue[e.priority].list[t]=null),e},cleanup:function(){for(let e=0;e<this.queueKeys.length;e++){let t=this.queue[this.queueKeys[e]];if(t.is_dirty){for(let e=0;e<t.list.length;e++)null==t.list[e]&&t.list.splice(e--,1);t.is_dirty=!1}}},forEach:function(e){let t=!1,a=!1;for(let i=0;!a&&i<this.order.length;i++){let r=this.queue[this.order[i]].list;for(let i=0;!a&&i<r.length;i++)null!=r[i]&&!1===e(r[i])&&(a=!0),null==r[i]&&(t=!0)}t&&this.cleanup()},forEachRev:function(e){let t=!1,a=!1;for(let i=this.order.length-1;!a&&i>=0;i--){let r=this.queue[this.order[i]].list;for(let i=r.length-1;!a&&i>=0;i--)null!=r[i]&&!1===e(r[i])&&(a=!0),null==r[i]&&(t=!0)}t&&this.cleanup()},forEachAsync:function(e,t=null){let a=this,i=!1,r=!1,n=-1,s=-1,o=null,l=function(){s++,!r&&s<o.length?(null!=o[s]&&!1===e(o[s],l)&&(r=!0),null==o[s]&&(i=!0),r&&l()):c()},c=function(){n++,!r&&n<a.order.length?(o=a.queue[a.order[n]].list,s=-1,l()):(i&&a.cleanup(),t&&t())};c()},forEachRevAsync:function(e){alert("NOT IMPLEMENTED: forEachRevAsync")}}),$3CL91=parcelRequire("3CL91"),$3CL91=parcelRequire("3CL91");
//![import "./recycler"]
//!class Callback
const $5ad24c3b3c533f1c$var$Callback=$3CL91.Class.extend({className:"Callback",callback:null,arg0:null,arg1:null,arg2:null,arg3:null,arg4:null,arg5:null,prev:null,next:null,__ctor:function(e,t=null,a=null,i=null,r=null,n=null,s=null){this.callback=e,this.arg0=t,this.arg1=a,this.arg2=i,this.arg3=r,this.arg4=n,this.arg5=s,this.prev=null,this.next=null},__dtor:function(){this.callback=null,this.arg0=null,this.arg1=null,this.arg2=null,this.arg3=null,this.arg4=null,this.arg5=null,this.prev=null,this.next=null},isEqual:function(e=null,t=null,a=null,i=null,r=null,n=null,s=null){return null!==e&&$5ad24c3b3c533f1c$var$Callback.isInstance(e)?e===this:(null===e||this.callback===e)&&((null===t||this.arg0===t)&&((null===a||this.arg1===a)&&((null===i||this.arg2===i)&&((null===r||this.arg3===r)&&((null===n||this.arg4===n)&&(null===s||this.arg5===s))))))},exec:function(e){return null===this.callback||this.callback(e,this.arg0,this.arg1,this.arg2,this.arg3,this.arg4,this.arg5)}});
//!/class
//!namespace Callback
//!namespace Pool
$cac8b143592e7d73$export$2e2bcd8739ae039.createPool($5ad24c3b3c533f1c$var$Callback,16384,6144);var $5ad24c3b3c533f1c$export$2e2bcd8739ae039=$5ad24c3b3c533f1c$var$Callback;
//![import "./recycler"]
//![import "./callback"]
//!class Handler
const $4d8bfc31fa3d230f$var$Handler=$3CL91.Class.extend({className:"Handler",host:null,top:null,bottom:null,__ctor:function(e=null){return this.host=e,this.top=null,this.bottom=null,this},__dtor:function(){this.remove()},add:function(e,t=null,a=null,i=null,r=null,n=null,s=null){let o=$5ad24c3b3c533f1c$export$2e2bcd8739ae039.isInstance(e)?e:$5ad24c3b3c533f1c$export$2e2bcd8739ae039.Pool.alloc(e,t,a,i,r,n,s);return o.prev=this.bottom,null!==this.bottom&&(this.bottom.next=o),this.bottom=o,null===this.top&&(this.top=o),o},unlink:function(e){return e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),this.top===e&&(this.top=e.next),this.bottom===e&&(this.bottom=e.prev),e.prev=null,e.next=null,dispose(e),this},remove:function(e=null,t=null,a=null,i=null,r=null,n=null,s=null){if(null!==e&&$5ad24c3b3c533f1c$export$2e2bcd8739ae039.isInstance(e))return this.unlink(e),this;let o=this.top;for(;null!==o;){let l=o.next;o.isEqual(e,t,a,i,r,n,s)&&this.unlink(o),o=l}return this},find:function(e,t=null,a=null,i=null,r=null,n=null,s=null){let o=this.top;for(;null!==o;){if(o.isEqual(e,t,a,i,r,n,s))return o;o=o.next}return null},exec:function(e=null){let t=this.top;for(e=e??this.host;null!==t;){let a=t.next,i=t.exec(e);if(null===i)break;!1===i&&this.unlink(t),t=a}},execf:function(e=null,t=null,a=null,i=null,r=null,n=null,s=null){let o=this.top;for(;null!==o;){let l=o.next;if(o.isEqual(e,t,a,i,r,n,s)){!1===o.exec(this.host)&&this.unlink(o);break}o=l}},execc:function(e,t=null){!1===e.exec(t??this.host)&&this.unlink(e)}});
//!/class
//!namespace Handler
//!namespace Pool
$cac8b143592e7d73$export$2e2bcd8739ae039.createPool($4d8bfc31fa3d230f$var$Handler,16384,6144);var $4d8bfc31fa3d230f$export$2e2bcd8739ae039=$4d8bfc31fa3d230f$var$Handler,$3CL91=parcelRequire("3CL91");
//![import "../utils/recycler"]
//![import "./vec2"]
//!class Rect
const $75f7867f0ec445c4$var$Rect=$3CL91.Class.extend({className:"Rect",cx:0,cy:0,x1:0,y1:0,x2:0,y2:0,__ctor:function(e=null,t=null,a=null,i=null){return null===e?(this.x1=this.y1=this.x2=this.y2=this.cx=this.cy=0,this):null===a?(this.set(0,0,0,0),this.resize(e,t),this):this.set(e,t,a,i)},__dtor:function(){},clone:function(){return $75f7867f0ec445c4$var$Rect.Rool.alloc(this.x1,this.y1,this.x2,this.y2)},zero:function(){return this.cx=0,this.cy=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this},reset:function(){return this.cx=null,this.cy=null,this.x1=null,this.y1=null,this.x2=null,this.y2=null,this},extendWithPoint:function(e,t=null){if(null===t){const a=e;e=a.x,t=a.y}return(null===this.x1||e<this.x1)&&(this.x1=e),(null===this.y1||t<this.y1)&&(this.y1=t),(null===this.x2||e>this.x2)&&(this.x2=e),(null===this.y2||t>this.y2)&&(this.y2=t),this.cx=(this.x1+this.x2)/2,this.cy=(this.y1+this.y2)/2,this},translate:function(e,t){return this.x1+=e,this.y1+=t,this.x2+=e,this.y2+=t,this.cx+=e,this.cy+=t,this},centerAt:function(e,t,a=!1){return 1==a&&(e=this.x1+e*(this.x2-this.x1),t=this.y1+t*(this.y2-this.y1)),this.translate(e-this.cx,t-this.cy)},set:function(e,t=null,a=null,i=null){if(null===t){const r=e;e=r.x1,t=r.y1,a=r.x2,i=r.y2}return this.cx=(e+a)/2,this.cy=(t+i)/2,this.x1=e,this.y1=t,this.x2=a,this.y2=i,this},equals:function(e,t=null,a=null,i=null){if(null===t){const r=e;e=r.x1,t=r.y1,a=r.x2,i=r.y2}return e==this.x1&&a==this.x2&&t==this.y1&&i==this.y2},contains:function(e,t=null,a=null,i=null){if(null===t){const r=e;e=r.x1,t=r.y1,a=r.x2,i=r.y2}return e==Math.max(this.x1,e)&&t==Math.max(this.y1,t)&&a==Math.min(this.x2,a)&&i==Math.min(this.y2,i)},setAsUnion:function(e,t=null,a=null,i=null){if(null===t){const r=e;e=r.x1,t=r.y1,a=r.x2,i=r.y2}return this.x1=Math.min(this.x1,e),this.y1=Math.min(this.y1,t),this.x2=Math.max(this.x2,a),this.y2=Math.max(this.y2,i),this},intersects:function(e,t=null,a=null,i=null){if(null===t){const r=e;e=r.x1,t=r.y1,a=r.x2,i=r.y2}let r=Math.max(this.x1,e),n=Math.max(this.y1,t),s=Math.min(this.x2,a),o=Math.min(this.y2,i);return Math.max(0,o-n)*Math.max(0,s-r)>0},setAsIntersection:function(e,t=null,a=null,i=null){if(null===t){const r=e;e=r.x1,t=r.y1,a=r.x2,i=r.y2}return this.x1=Math.max(this.x1,e),this.y1=Math.max(this.y1,t),this.x2=Math.min(this.x2,a),this.y2=Math.min(this.y2,i),Math.max(0,this.y2-this.y1)*Math.max(0,this.x2-this.x1)>0},resize:function(e,t,a=!1,i=!1){return 1==i&&(e*=this.x2-this.x1,t*=this.y2-this.y1),1==a?(this.x2=this.x1+e,this.y2=this.y1+t):(e/=2,t/=2,this.x1=this.cx-e,this.y1=this.cy-t,this.x2=this.cx+e,this.y2=this.cy+t),this},resizeBy:function(e,t,a=!1){return 1==a?(this.x2+=e,this.y2+=t):(e/=2,t/=2,this.x1-=e,this.y1-=t,this.x2+=e,this.y2+=t),this},width:function(){return this.x2-this.x1},height:function(){return this.y2-this.y1},ncx:function(){return(this.cx-this.x1)/(this.x2-this.x1)},ncy:function(){return(this.cy-this.y1)/(this.y2-this.y1)},isRight:function(){return this.x1<=this.x2&&this.y1<=this.y2},containsPoint:function(e,t,a=0){return this.x1-a<=e&&e<=this.x2+a&&this.y1-a<=t&&t<=this.y2+a},area:function(e){return e?this.isRight()?(this.y2-this.y1)*(this.x2-this.x1):0:(this.y2-this.y1)*(this.x2-this.x1)},floor:function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.floor(this.x2),this.y2=Math.floor(this.y2),this.cx=Math.floor(this.cx),this.cy=Math.floor(this.cy),this},ceil:function(){return this.x1=Math.ceil(this.x1),this.y1=Math.ceil(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this.cx=Math.ceil(this.cx),this.cy=Math.ceil(this.cy),this},toString:function(){return"("+this.x1.toFixed(2)+", "+this.y1.toFixed(2)+", "+this.x2.toFixed(2)+", "+this.y2.toFixed(2)+")"},flatten:function(){return[this.x1,this.y1,this.x2,this.y2]},unflatten:function(e){return this.set(e[0],e[1],e[2],e[3]),this}});
//!/class
//!namespace Rect
//!namespace Pool
$cac8b143592e7d73$export$2e2bcd8739ae039.createPool($75f7867f0ec445c4$var$Rect,4096,2048);var $75f7867f0ec445c4$export$2e2bcd8739ae039=$75f7867f0ec445c4$var$Rect,$3CL91=parcelRequire("3CL91");
//!class TFunction
const $94d55b5c9afc30f7$var$TFunction=$3CL91.Class.extend({className:"TFunction",t:null,y:null,f:null,__ctor:function(e=0){this.reset(e)},reset:function(e=0){return this.t=[0],this.y=[e],this.f=[null],this},copyFrom:function(e,t,a){if(this.t=[],this.y=[],this.f=[],null==t&&null==a){for(let t=0;t<e.t.length;t++)this.t.push(e.t[t]),this.y.push(e.y[t]),this.f.push(e.f[t]);return this}null==t&&(t=e.t[0]),null==a&&(a=e.t[e.t.length-1]),t<e.t[0]&&(t=e.t[0]);let i=e.find(t),r=e.find(a);if(null==i)return null;if(null==r)return null;e.t[i]!=t&&(this.set(t,e.getAt(t),e.f[i]),i++);for(let t=i;t<=r;t++)this.set(e.t[t],e.y[t],e.f[t]);if(e.t[r]!=a){let t=(a-e.t[r])/Math.ceil(Math.log(a-e.t[r])),i=this.t[this.t.length-1];for(t<=0&&(t=1),t=a-i;i!=a;)i+t>a&&(t=a-i),i+=t,this.set(float4(i),e.getAt(i),e.f[r])}return this},clone:function(e,t){return(new $94d55b5c9afc30f7$var$TFunction).copyFrom(this,e,t)},endTime:function(e=0){return this.t[this.t.length-1]+e},startTime:function(e=0){return this.t[0]+e},find:function(e){if(e<this.t[0])return null;const t=this.t.length;for(let a=1;a<t;a++)if(e<this.t[a])return a-1;return t-1},set:function(e,t,a=null){let i=this.find(e);return null!=i&&(this.t[i]==e?(this.y[i]=t,null!=a&&(this.f[i]=a)):(i++,this.t.splice(i,0,e),this.y.splice(i,0,t),this.f.splice(i,0,a)),!0)},get:function(){return this.y[this.y.length-1]},getAt:function(e){let t=this.find(e);if(null==t)return 0;let a=t+1;if(this.t[t]==e||a>=this.t.length||this.y[t]==this.y[a]||null==this.f[t])return this.y[t];if(null==this.f[t])return this.y[t];let i=e,r=this.t[t],n=this.t[a],s=this.y[t],o=this.y[a];return e=(i-r)/(n-r),(e=this.f[t](e))*o+(1-e)*s},integral:function(e=null,t=null,a=0){null==e&&(e=this.t[0]),null==t&&(t=this.t[this.t.length-1]),e<this.t[0]&&(e=this.t[0]);let i=1;if(e>t){let a;a=e,e=t,t=a,i=-1}let r=a;for(let a=e;a<t;){let e=this.find(a);if(null==e)return 0;let i=e+1,n=Math.max(this.t[e],a),s=Math.min(i<this.t.length?this.t[i]:t,t),o=this.getAt(n),l=s-n,c=this.getAt(s)-o;null==this.f[e]?r+=o*l:r+=.5*c*(s+n)-n*c+o*l,a+=l}return i*r},second_integral:function(e=null,t=null,a=0){null==e&&(e=this.t[0]),null==t&&(t=this.t[this.t.length-1]);let i=$94d55b5c9afc30f7$var$TFunction.Temp1.copyFrom(this,this.t[0],e).integrate(a).integral();return $94d55b5c9afc30f7$var$TFunction.Temp2.copyFrom(this,this.t[0],t).integrate(a).integral()-i},integrate:function(e=0){let t=[];t.push(e);for(let e=1;e<this.t.length;e++)t.push(t[e-1]+this.integral(this.t[e-1],this.t[e]));return this.y=t,this},accumulate:function(e=0){this.y[0]+=e;for(let e=1;e<this.t.length;e++)this.y[e]+=this.y[e-1];return this},chopLeft:function(e){return this.t.splice(0,e),this.f.splice(0,e),this.y.splice(0,e),this},chopRight:function(e){return this.t.splice(e+1,this.t.length-e-1),this.f.splice(e+1,this.f.length-e-1),this.y.splice(e+1,this.y.length-e-1),this},map:function(e){for(let t=0;t<this.y.length;t++)this.y[t]=e(this.y[t],this.t[t],t);return this},toString:function(e=0){let t="",a=10;const i=function(e,t,a){for(e=e.toString(),null==a&&(a=" "),a=a[0];e.length<t;)e+=a;return e};t+="\n",t+=i(" Time",a)+" "+i(" Value",a)+" "+i(" Integral",a)+"\n",t+=i("",a,"-")+" "+i("",a,"-")+" "+i("",a,"-")+"\n";for(let r=0;r<this.t.length;r++)t+=i(" "+float4(this.t[r]),a)+" "+i(" "+float4(this.y[r]),a)+" "+i(" "+float4(this.integral(this.t[0],this.t[r],e)),a)+"\n";return t}});$94d55b5c9afc30f7$var$TFunction.Temp1=new $94d55b5c9afc30f7$var$TFunction,$94d55b5c9afc30f7$var$TFunction.Temp2=new $94d55b5c9afc30f7$var$TFunction;var $94d55b5c9afc30f7$export$2e2bcd8739ae039=$94d55b5c9afc30f7$var$TFunction,$3CL91=parcelRequire("3CL91"),$3CL91=parcelRequire("3CL91");
//![import "../utils/recycler"]
//![import "./vec2"]
//!class Point2
const $6368899a9e534bce$var$Point2=$3CL91.Class.extend({className:"Point2",ux:0,uy:0,x:0,y:0,__ctor:function(e=null,t=null){return this.set(e,t)},downscale:function(){return this.x=downscale(this.ux),this.y=downscale(this.uy),this},clone:function(){return $6368899a9e534bce$var$Point2.Pool.alloc(this)},set:function(e,t=null,a=!1){return null===e?(e=0,t=0):null===t?$6368899a9e534bce$var$Point2.isInstance(e)?(t=e.uy,e=e.ux):(t=upscale(e.y),e=upscale(e.x)):!0!==a&&(e=upscale(e),t=upscale(t)),this.ux=e,this.uy=t,this.downscale(this)},setX:function(e){return this.ux=upscale(e),this.downscale(this)},setY:function(e){return this.uy=upscale(e),this.downscale(this)},zero:function(){return this.set(0,0)},isZero:function(){return 0==this.x&&0==this.y},equals:function(e,t=null){return null===t?$6368899a9e534bce$var$Point2.isInstance(e)?(t=e.y,e=e.x):(t=int(e.y),e=int(e.x)):(e=int(e),t=int(t)),this.x==e&&this.y==t},add:function(e,t=null,a=!1){return null===t?$6368899a9e534bce$var$Point2.isInstance(e)?(t=e.uy,e=e.ux):(t=upscale(e.y),e=upscale(e.x)):!0!==a&&(e=upscale(e),t=upscale(t)),this.ux+=e,this.uy+=t,this.downscale()},sub:function(e,t,a=!1){return null===t?$6368899a9e534bce$var$Point2.isInstance(e)?(t=e.uy,e=e.ux):(t=upscale(e.y),e=upscale(e.x)):!0!==a&&(e=upscale(e),t=upscale(t)),this.ux-=e,this.uy-=t,this.downscale()},toString:function(){return`(${this.x}, ${this.y})`}});
//!/class
//!namespace Point2
//!namespace Pool
$cac8b143592e7d73$export$2e2bcd8739ae039.createPool($6368899a9e534bce$var$Point2,2048,1024);var $6368899a9e534bce$export$2e2bcd8739ae039=$6368899a9e534bce$var$Point2;
//![import "../utils/recycler"]
//![import "./point2"]
//![import "./rect"]
//!class Bounds2
const $c7e41fee2cf6e3a0$var$Bounds2=$3CL91.Class.extend({className:"Bounds2",cx:0,cy:0,x1:0,y1:0,x2:0,y2:0,ucx:0,ucy:0,ux1:0,uy1:0,ux2:0,uy2:0,__ctor:function(e=null,t=null,a=null,i=null,r=!1){return null===e?(this.ux1=this.uy1=this.ux2=this.uy2=this.ucx=this.ucy=0,this.downscale()):null!==t&&null===a?this.set(0,0,0,0).resize(e,t):this.set(e,t,a,i,r)},downscale:function(){return this.x1=downscale(this.ux1),this.y1=downscale(this.uy1),this.x2=downscale(this.ux2),this.y2=downscale(this.uy2),this.cx=downscale(this.ucx),this.cy=downscale(this.ucy),this},trunc:function(){return this.ux1=upscale(this.x1),this.uy1=upscale(this.y1),this.ux2=upscale(this.x2),this.uy2=upscale(this.y2),this.ucx=upscale(this.cx),this.ucy=upscale(this.cy),this},clone:function(){return $c7e41fee2cf6e3a0$var$Bounds2.Pool.alloc(this.ux1,this.uy1,this.ux2,this.uy2,!0)},zero:function(){return this.ux1=0,this.uy1=0,this.ux2=0,this.uy2=0,this.ucx=0,this.ucy=0,this.downscale()},reset:function(){return this.ux1=null,this.uy1=null,this.ux2=null,this.uy2=null,this.ucx=null,this.ucy=null,this.x1=null,this.y1=null,this.x2=null,this.y2=null,this.cx=null,this.cy=null,this},translate:function(e,t=null,a=!1){return null===t?$6368899a9e534bce$export$2e2bcd8739ae039.isInstance(e)?(t=e.uy,e=e.ux):(t=upscale(e.y),e=upscale(e.x)):!0!==a&&(e=upscale(e),t=upscale(t)),this.ux1+=e,this.uy1+=t,this.ux2+=e,this.uy2+=t,this.ucx+=e,this.ucy+=t,this.downscale()},set:function(e,t=null,a=null,i=null,r=!1){return null===t?$c7e41fee2cf6e3a0$var$Bounds2.isInstance(e)?(i=e.uy2,a=e.ux2,t=e.uy1,e=e.ux1):(i=upscale(e.y2),a=upscale(e.x2),t=upscale(e.y1),e=upscale(e.x1)):!0!==r&&(e=upscale(e),t=upscale(t),a=upscale(a),i=upscale(i)),this.ux1=e,this.uy1=t,this.ux2=a,this.uy2=i,this.ucx=e+a>>1,this.ucy=t+i>>1,this.downscale()},add:function(e,t=null,a=null,i=null,r=!1){return null===t?$c7e41fee2cf6e3a0$var$Bounds2.isInstance(e)?(i=e.uy2,a=e.ux2,t=e.uy1,e=e.ux1):(i=upscale(e.y2),a=upscale(e.x2),t=upscale(e.y1),e=upscale(e.x1)):!0!==r&&(e=upscale(e),t=upscale(t),a=upscale(a),i=upscale(i)),this.ux1+=e,this.uy1+=t,this.ux2+=a,this.uy2+=i,this.ucx+=e+a>>1,this.ucy+=t+i>>1,this.downscale()},equals:function(e,t=null,a=null,i=null){return null===t?$c7e41fee2cf6e3a0$var$Bounds2.isInstance(e)?(i=e.y2,a=e.x2,t=e.y1,e=e.x1):(i=int(e.y2),a=int(e.x2),t=int(e.y1),e=int(e.x1)):(e=int(e),t=int(t),a=int(a),i=int(i)),e==this.x1&&a==this.x2&&t==this.y1&&i==this.y2},contains:function(e,t=null,a=null,i=null){return null===t?$c7e41fee2cf6e3a0$var$Bounds2.isInstance(e)?(i=e.y2,a=e.x2,t=e.y1,e=e.x1):(i=int(e.y2),a=int(e.x2),t=int(e.y1),e=int(e.x1)):(e=int(e),t=int(t),a=int(a),i=int(i)),e==Math.max(this.x1,e)&&t==Math.max(this.y1,t)&&a==Math.min(this.x2,a)&&i==Math.min(this.y2,i)},setAsUnion:function(e,t=null,a=null,i=null){if(null===t){if($c7e41fee2cf6e3a0$var$Bounds2.isInstance(e))return this.setAsUnion(e.ux1,e.uy1,!0),this.setAsUnion(e.ux2,e.uy2,!0),this;if($75f7867f0ec445c4$export$2e2bcd8739ae039.isInstance(e))return this.setAsUnion(e.x1,e.y1),this.setAsUnion(e.x2,e.y2),this;$6368899a9e534bce$export$2e2bcd8739ae039.isInstance(e)?(t=e.uy,e=e.ux):(t=upscale(e.y),e=upscale(e.x))}else{if(null!==i)return this.setAsUnion(e,t),this.setAsUnion(a,i),this;!0!==a&&(e=upscale(e),t=upscale(t))}return(null===this.ux1||e<this.ux1)&&(this.ux1=e),(null===this.uy1||t<this.uy1)&&(this.uy1=t),(null===this.ux2||e>this.ux2)&&(this.ux2=e),(null===this.uy2||t>this.uy2)&&(this.uy2=t),this.ucx=this.ux1+this.ux2>>1,this.ucy=this.uy1+this.uy2>>1,this.downscale()},intersects:function(e,t=null,a=null,i=null){null===t?$c7e41fee2cf6e3a0$var$Bounds2.isInstance(e)?(i=e.y2,a=e.x2,t=e.y1,e=e.x1):(i=int(e.y2),a=int(e.x2),t=int(e.y1),e=int(e.x1)):(e=int(e),t=int(t),a=int(a),i=int(i));let r=Math.max(this.x1,e),n=Math.max(this.y1,t),s=Math.min(this.x2,a),o=Math.min(this.y2,i);return Math.max(0,o-n)*Math.max(0,s-r)>0},setAsIntersection:function(e,t=null,a=null,i=null){return null===t?$c7e41fee2cf6e3a0$var$Bounds2.isInstance(e)?(i=e.y2,a=e.x2,t=e.y1,e=e.x1):(i=int(e.y2),a=int(e.x2),t=int(e.y1),e=int(e.x1)):(e=int(e),t=int(t),a=int(a),i=int(i)),this.ux1=upscale(Math.max(this.x1,e)),this.uy1=upscale(Math.max(this.y1,t)),this.ux2=upscale(Math.min(this.x2,a)),this.uy2=upscale(Math.min(this.y2,i)),this.ucx=this.ux1+this.ux2>>1,this.ucy=this.uy1+this.uy2>>1,this.downscale(),Math.max(0,this.uy2-this.uy1)*Math.max(0,this.ux2-this.ux1)>0},resize:function(e,t,a=!1){return e=null!==e?!0===e||upscale(e):this.ux2-this.ux1,t=null!==t?!0===t||upscale(t):this.uy2-this.uy1,!0===e?e=t*this.ratio():!0===t&&(t=e/this.ratio()),!0===a?(this.ux2=this.ux1+e,this.uy2=this.uy1+t,this.ucx=this.ux1+this.ux2>>1,this.ucy=this.uy1+this.uy2>>1):(e>>=1,t>>=1,this.ux1=this.ucx-e,this.uy1=this.ucy-t,this.ux2=this.ucx+e,this.uy2=this.ucy+t),this.downscale()},resizeBy:function(e,t,a=!1){return e=!0===e||upscale(e),t=!0===t||upscale(t),!0===e?e=t*this.ratio():!0===t&&(t=e/this.ratio()),!0===a?(this.ux2+=e,this.uy2+=t,this.ucx=this.ux1+this.ux2>>1,this.ucy=this.uy1+this.uy2>>1):(e>>=1,t>>=1,this.ux1-=e,this.uy1-=t,this.ux2+=e,this.uy2+=t),this.downscale()},width:function(){return this.x2-this.x1},height:function(){return this.y2-this.y1},ratio:function(){return(this.x2-this.x1)/(this.y2-this.y1)},isForward:function(){return this.ux1<=this.ux2&&this.uy1<=this.uy2},containsPoint:function(e,t,a=0){return e=upscale(e),t=upscale(t),a=upscale(a),this.ux1-a<=e&&e<=this.ux2+a&&this.uy1-a<=t&&t<=this.uy2+a},area:function(e=!1){return e?this.isForward()?(this.y2-this.y1)*(this.x2-this.x1):0:(this.y2-this.y1)*(this.x2-this.x1)},toString:function(){return"("+this.x1+", "+this.y1+", "+this.x2+", "+this.y2+")"},flatten:function(){return[this.ux1,this.uy1,this.ux2,this.uy2]},unflatten:function(e){return this.ux1=e[0],this.uy1=e[1],this.ux2=e[2],this.uy2=e[3],this.ucx=this.ux1+this.ux2>>1,this.ucy=this.uy1+this.uy2>>1,this.downscale()}});
//!/class
//!namespace Rect
//!namespace Pool
$cac8b143592e7d73$export$2e2bcd8739ae039.createPool($c7e41fee2cf6e3a0$var$Bounds2,8192,3072);var $c7e41fee2cf6e3a0$export$2e2bcd8739ae039=$c7e41fee2cf6e3a0$var$Bounds2;
//!namespace Easing
const $36e98efbc8017cce$var$Easing={//!namespace Linear
Linear:{IN:function(e){return e},OUT:function(e){return e},IN_OUT:function(e){return e}},
//!/namespace
//!namespace Back
Back:{k:1.70158,IN:function(e,t=null){return null===t&&(t=$36e98efbc8017cce$var$Easing.Back.k),e*e*((t+1)*e-t)},OUT:function(e,t=null){return 1-$36e98efbc8017cce$var$Easing.Back.IN(1-e,t)},IN_OUT:function(e,t=null){return e<.5?$36e98efbc8017cce$var$Easing.Back.IN(2*e,t)/2:$36e98efbc8017cce$var$Easing.Back.OUT(2*(e-.5),t)/2+.5}},
//!/namespace
//!namespace Bounce
Bounce:{getConst:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},IN:function(e){return 1-$36e98efbc8017cce$var$Easing.Bounce.getConst(1-e)},OUT:function(e){return $36e98efbc8017cce$var$Easing.Bounce.getConst(e)},IN_OUT:function(e){return e<.5?(1-$36e98efbc8017cce$var$Easing.Bounce.getConst(1-2*e))/2:$36e98efbc8017cce$var$Easing.Bounce.getConst(2*(e-.5))/2+.5}},
//!/namespace
//!namespace Circ
Circ:{IN:function(e){return 1-Math.sqrt(1-e*e)},OUT:function(e){return 1-$36e98efbc8017cce$var$Easing.Circ.IN(1-e)},IN_OUT:function(e){return e<.5?$36e98efbc8017cce$var$Easing.Circ.IN(2*e)/2:$36e98efbc8017cce$var$Easing.Circ.OUT(2*(e-.5))/2+.5}},
//!/namespace
//!namespace Cubic
Cubic:{IN:function(e){return e*e*e},OUT:function(e){return 1-$36e98efbc8017cce$var$Easing.Cubic.IN(1-e)},IN_OUT:function(e){return e<.5?$36e98efbc8017cce$var$Easing.Cubic.IN(2*e)/2:$36e98efbc8017cce$var$Easing.Cubic.OUT(2*(e-.5))/2+.5}},
//!/namespace
//!namespace Expo
Expo:{IN:function(e){return Math.pow(2,12*(e-1))},OUT:function(e){return 1-Math.pow(2,-12*e)},IN_OUT:function(e){return(e*=2)<1?Math.pow(2,12*(e-1))/2:(2-Math.pow(2,-12*(e-1)))/2}},
//!/namespace
//!namespace Power
Power:{IN:function(e,t=12){return Math.pow(e,t)},OUT:function(e,t=12){return 1-$36e98efbc8017cce$var$Easing.Power.IN(1-e,t)},IN_OUT:function(e,t=12){return e<.5?$36e98efbc8017cce$var$Easing.Power.IN(2*e,t)/2:$36e98efbc8017cce$var$Easing.Power.OUT(2*(e-.5),t)/2+.5}},
//!/namespace
//!namespace Quad
Quad:{IN:function(e){return e*e},OUT:function(e){return 1-$36e98efbc8017cce$var$Easing.Quad.IN(1-e)},IN_OUT:function(e){return e<.5?$36e98efbc8017cce$var$Easing.Quad.IN(2*e)/2:$36e98efbc8017cce$var$Easing.Quad.OUT(2*(e-.5))/2+.5}},
//!/namespace
//!namespace Quartic
Quartic:{IN:function(e){return e*e*e*e},OUT:function(e){return 1-$36e98efbc8017cce$var$Easing.Quartic.IN(1-e)},IN_OUT:function(e){return e<.5?$36e98efbc8017cce$var$Easing.Quartic.IN(2*e)/2:$36e98efbc8017cce$var$Easing.Quartic.OUT(2*(e-.5))/2+.5}},
//!/namespace
//!namespace Quintic
Quintic:{IN:function(e){return e*e*e*e*e},OUT:function(e){return 1-$36e98efbc8017cce$var$Easing.Quintic.IN(1-e)},IN_OUT:function(e){return e<.5?$36e98efbc8017cce$var$Easing.Quintic.IN(2*e)/2:$36e98efbc8017cce$var$Easing.Quintic.OUT(2*(e-.5))/2+.5}},
//!/namespace
//!namespace Sine
Sine:{IN:function(e){return 1-Math.sin(1.5708*(1-e))},OUT:function(e){return Math.sin(1.5708*e)},IN_OUT:function(e){return(Math.cos(3.1416*e)-1)/-2}},
//!/namespace
//!namespace Step
Step:{IN:function(e){return 1!=e?0:1},OUT:function(e){return 1!=e?0:1},IN_OUT:function(e){return 1!=e?0:1}}};var $36e98efbc8017cce$export$2e2bcd8739ae039=$36e98efbc8017cce$var$Easing,$3CL91=parcelRequire("3CL91"),$3CL91=parcelRequire("3CL91");
//![import "../utils/priority-queue"]
//!class Boot
const $3c0d7fe046574b0f$var$Boot={modules:new $fa388e5ba5a88cdf$export$2e2bcd8739ae039,register:function(e){return this.modules.add(e)},unregister:function(e){this.modules.remove(e),this.modules.cleanup()},startup:function(e=null){this.modules.forEachAsync(((e,t)=>{!1!==e.onStartup(t)&&t()}),e)},shutdown:function(e=null){this.modules.forEachAsyncRev(((e,t)=>{!1!==e.onShutdown(t)&&t()}),e)}};
//!/class
//!namespace Boot
//!interface Module
$3c0d7fe046574b0f$var$Boot.Module=$3CL91.Class.extend({className:"Module",priority:5,__ctor:function(){$3c0d7fe046574b0f$var$Boot.register(this)},__dtor:function(){$3c0d7fe046574b0f$var$Boot.unregister(this)},onStartup:function(e){},onShutdown:function(e){}});var//!/interface
//!/namespace
$3c0d7fe046574b0f$export$2e2bcd8739ae039=$3c0d7fe046574b0f$var$Boot;
//!class sys
const $577dad4304081d73$var$system={initialized:!1,screenWidth:0,screenHeight:0,renderer:null,time:0,dt:0,_timeout:null,_interval:null,_span:null,update:null,draw:null,onPaused:null,onResumed:null,options:{gl:!0,log:!1,antialias:!1,background:"#000000",orientation:"automatic",screenWidth:null,screenHeight:null,fps:144,minFps:24,preallocate:!1},init:function(e){return new Promise(((t,a)=>{if(this.initialized)return t();Object.assign(this.options,e),$fe89a08f3d52be1f$export$2e2bcd8739ae039.config({pixelated:!this.options.antialias,filter:this.options.antialias?"LINEAR":"NEAREST"}),$041013b7ee2c8fb5$export$2e2bcd8739ae039.init(this.options),$041013b7ee2c8fb5$export$2e2bcd8739ae039.updateQueueAdd({update:function(e){$577dad4304081d73$var$system.time=$041013b7ee2c8fb5$export$2e2bcd8739ae039.frameTime,$577dad4304081d73$var$system.dt=e,$577dad4304081d73$var$system._timeout.exec(e),$577dad4304081d73$var$system._interval.exec(e),$577dad4304081d73$var$system._span.exec(e),$577dad4304081d73$var$system.update.exec(e)}}),$041013b7ee2c8fb5$export$2e2bcd8739ae039.drawQueueAdd({draw:function(e){$577dad4304081d73$var$system.draw.exec(e)}}),$3c0d7fe046574b0f$export$2e2bcd8739ae039.startup((function(){$041013b7ee2c8fb5$export$2e2bcd8739ae039.start(),$577dad4304081d73$var$system.screenWidth=$041013b7ee2c8fb5$export$2e2bcd8739ae039.screenWidth,$577dad4304081d73$var$system.screenHeight=$041013b7ee2c8fb5$export$2e2bcd8739ae039.screenHeight,$577dad4304081d73$var$system.renderer=$041013b7ee2c8fb5$export$2e2bcd8739ae039.renderer,$577dad4304081d73$var$system._timeout=$4d8bfc31fa3d230f$export$2e2bcd8739ae039.Pool.alloc(),$577dad4304081d73$var$system._interval=$4d8bfc31fa3d230f$export$2e2bcd8739ae039.Pool.alloc(),$577dad4304081d73$var$system._span=$4d8bfc31fa3d230f$export$2e2bcd8739ae039.Pool.alloc(),$577dad4304081d73$var$system.update=$4d8bfc31fa3d230f$export$2e2bcd8739ae039.Pool.alloc(),$577dad4304081d73$var$system.draw=$4d8bfc31fa3d230f$export$2e2bcd8739ae039.Pool.alloc(),window.onblur=function(){$577dad4304081d73$var$system.pause(!0)},window.onfocus=function(){$577dad4304081d73$var$system.resume(!0)},$577dad4304081d73$var$system.initialized=!0,t()}))}))},pause:function(e=!1){null!==$577dad4304081d73$var$system.onPaused&&$577dad4304081d73$var$system.onPaused(e)},resume:function(e=!1){null!==$577dad4304081d73$var$system.onResumed&&$577dad4304081d73$var$system.onResumed(e)},timeout:function(e,t,a=null,i=null,r=null,n=null){return this._timeout.add(this._updateTimeout,e,t,a,i,r,n)},cancelTimeout:function(e){this._timeout.remove(e)},_updateTimeout:function(e,t,a,i,r,n,s){return this.arg0-=e,this.arg0>0||(a(i,r,n,s),!1)},interval:function(e,t,a=null,i=null,r=null){return this._interval.add(this._updateInterval,0,e,t,a,i,r)},cancelInterval:function(e){this._interval.remove(e)},_updateInterval:function(e,t,a,i,r,n,s){return this.arg0+=e,this.arg0<this.arg1||(this.arg0-=this.arg1,i(r,n,s))},span:function(e,t,a=null,i=null,r=null){return this._span.add(this._updateSpan,0,e,t,a,i,r)},cancelSpan:function(e){this._span.remove(e)},_updateSpan:function(e,t,a,i,r,n,s){return this.arg0+=e,this.arg0>this.arg1&&(e-=this.arg0-this.arg1,this.arg0=this.arg1),!1!==i(this.arg0/this.arg1,e,r,n,s)&&this.arg0!==this.arg1}};var $577dad4304081d73$export$2e2bcd8739ae039=$577dad4304081d73$var$system,$3CL91=parcelRequire("3CL91");let $df7b3efe39b649f3$var$_stamp=0;function $df7b3efe39b649f3$var$getStamp(){return $df7b3efe39b649f3$var$_stamp=$df7b3efe39b649f3$var$_stamp+1&2147483647,$df7b3efe39b649f3$var$_stamp}
//!class Block
const $df7b3efe39b649f3$var$Block=$3CL91.Class.extend({className:"Anim:Block",commands:null,isFirst:!0,current:!1,stamp:0,time:0,init:function(){return this.commands=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.reset(0),this},__dtor:function(){this.clear(),this.commands.free()},count:function(){return this.commands.length},add:function(e){return this.commands.push(e),!1===this.isFirst&&null===this.current&&(this.current=this.commands.bottom,this.stamp=$df7b3efe39b649f3$var$getStamp()),e},clone:function(){let e=$df7b3efe39b649f3$var$Block.alloc();for(let t=this.commands.top;null!==t;t=t.next)e.commands.push(t.value.clone());return e},clear:function(){return this.commands.clear(),this.reset(0),this},reset:function(e=0){return this.isFirst=!0,this.current=null,this.time=e,this.stamp=$df7b3efe39b649f3$var$getStamp(),this},restart:function(){return this.isFirst=!0,this.stamp=$df7b3efe39b649f3$var$getStamp(),this},isFinished:function(){return!0===this.isFirst&&(this.current=this.commands.top,this.isFirst=!1),null===this.current},update:function(e){for(;!this.isFinished();){let t=this.current.value.update(e,this);if(!0!==t)return t;this.current=this.current.next}return!0}});$cac8b143592e7d73$export$2e2bcd8739ae039.attachTo($df7b3efe39b649f3$var$Block,2048);var $df7b3efe39b649f3$export$2e2bcd8739ae039=$df7b3efe39b649f3$var$Block,$3CL91=parcelRequire("3CL91");
//!class Command
const $7252a2f0d16954cd$var$Command=$3CL91.Class.extend({className:"Anim:Command",op:null,started:!1,time:0,field:null,value:null,duration:0,_duration:0,count:0,_count:0,startValue:0,_startValue:0,endValue:0,_endValue:0,easing:null,_cur:null,_last:null,block:null,blocks:null,table:null,snd:null,fn:null,init:function(e,t){return this.op=e,this.started=!1,this.block=null,this.blocks=null,this.table=null,this.snd=null,this.fn=null,!1!==t&&e.init(this,!1),this},__dtor:function(){null!==this.block&&this.block.clear().free(),null!==this.blocks&&this.blocks.clear().free()},clone:function(){let e=$7252a2f0d16954cd$var$Command.alloc(this.op,!1);if(e.field=this.field,e.value=this.value,e.duration=this.duration,e.count=this.count,e.startValue=this.startValue,e.endValue=this.endValue,e.easing=this.easing,e.table=this.table,e.snd=this.snd,e.fn=this.fn,null!==this.block&&(e.block=this.block.clone()),null!==this.blocks){e.blocks=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc();for(let t=this.blocks.top;null!==t;t=t.next)e.blocks.push(t.value.clone())}return e},ready:function(){this.op.init(this,!0)},update:function(e,t){return this.op.update(e,t,this)}});$cac8b143592e7d73$export$2e2bcd8739ae039.attachTo($7252a2f0d16954cd$var$Command);var $7252a2f0d16954cd$export$2e2bcd8739ae039=$7252a2f0d16954cd$var$Command,$cd2db5a4897c8fd6$export$2e2bcd8739ae039={init:function(e,t=!1){if(!t)return e.block=$df7b3efe39b649f3$export$2e2bcd8739ae039.alloc(),void(e.blocks=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc());let a;for(;null!=(a=e.block.commands.shift());){let t=$df7b3efe39b649f3$export$2e2bcd8739ae039.alloc();t.add(a),e.blocks.push(t)}e.block.free(),e.block=null},update:function(e,t,a){if(!1===a.started){for(let e=a.blocks.top;null!==e;e=e.next)e.value.reset(t.time);a.started=!0}let i=t.time,r=0,n=0;for(let t=a.blocks.top;null!==t;t=t.next){let a=t.value.update(e);!0===a?r++:null===a&&n++,t.value.time>i&&(i=t.value.time)}return r+n==a.blocks.length&&(a.started=!1,t.time=i,!0)}},$b4d3731cd8fed05a$export$2e2bcd8739ae039={init:function(e,t=!1){t||(e.block=$df7b3efe39b649f3$export$2e2bcd8739ae039.alloc())},update:function(e,t,a){!1===a.started&&(a.block.reset(t.time),a.started=!0);let i=a.block.update(e);return!0!==i?i:(a.started=!1,t.time=a.block.time,!0)}},$8e7deb3b4664f615$export$2e2bcd8739ae039={init:function(e,t=!1){t||(e.block=$df7b3efe39b649f3$export$2e2bcd8739ae039.alloc())},update:function(e,t,a){!1===a.started&&(a.block.reset(t.time),a._count=a.count,a.started=!0);let i=a.block.update(e);return!0!==i?i:a._count<=1?(a.started=!1,t.time=a.block.time,!0):(a.block.restart(),a._count--,!1)}},$a8c94e89a300b635$export$2e2bcd8739ae039={init:function(e,t=!1){},update:function(e,t,a){return e.setValue(a.field,e.getValue(a.field,a.value)),!0}},$5e2ea7c2fca74706$export$2e2bcd8739ae039={init:function(e,t=!1){},update:function(e,t,a){return t.restart(),!0}},$3CL91=parcelRequire("3CL91"),$d30fbbca3dc6e914$export$2e2bcd8739ae039={init:function(e,t=!1){},update:function(e,t,a){return!1===a.started&&(a._duration="string"===$3CL91.Rinn.typeOf(a.duration)?e.getValue(a.duration):a.duration,a.started=!0),!(e.time<t.time+a._duration)&&(a.started=!1,t.time+=a._duration,!0)}},$3CL91=parcelRequire("3CL91"),$fd4753ee728f640d$export$2e2bcd8739ae039={init:function(e,t=!1){},update:function(e,t,a){!1===a.started&&(a._startValue=e.getValue(a.field,a.startValue),a._duration="string"===$3CL91.Rinn.typeOf(a.duration)?e.getValue(a.duration):a.duration,a.started=!0),a._endValue=e.getValue(a.field,a.endValue,a._startValue);let i=1;return e.time<t.time+a._duration&&(i=(e.time-t.time)/a._duration),a.easing&&1!=i?e.setValue(a.field,a.easing(i)*(a._endValue-a._startValue)+a._startValue):e.setValue(a.field,i*(a._endValue-a._startValue)+a._startValue),1==i&&(a.started=!1,t.time+=a._duration,!0)}},$3CL91=parcelRequire("3CL91"),$51108995344d7c47$export$2e2bcd8739ae039={init:function(e,t=!1){},update:function(e,t,a){!1===a.started&&(a._duration="string"===$3CL91.Rinn.typeOf(a.duration)?e.getValue(a.duration):a.duration,a._last=null,a.started=!0);let r=1;if(e.time<t.time+a._duration&&(r=(e.time-t.time)/a._duration),a.easing&&1!=r?a._cur=int(a.easing(r)*a.count):a._cur=int(r*a.count),a._cur!=a._last){let t=e.getValue(a.field);for(;;){if(int(Math.random()*(a.endValue-a.startValue+1))+a.startValue!=t)break}e.setValue(a.field,i),a._last=a._cur}return 1==r&&(a.started=!1,t.time+=a._duration,!0)}},$3CL91=parcelRequire("3CL91"),$5b070686dcbeb863$export$2e2bcd8739ae039={init:function(e,t=!1){if(!t)return;let a=[];for(let t=0;t<e.count;t++)a.push(t%(e.endValue-e.startValue+1)+e.startValue);for(let t=e.count>>2;t>0;t--){let t=int(Math.random()*e.count),i=int(Math.random()*e.count),r=a[i];a[i]=a[t],a[t]=r}e.table=a},update:function(e,t,a){!1===a.started&&(a._duration="string"===$3CL91.Rinn.typeOf(a.duration)?e.getValue(a.duration):a.duration,a.started=!0);let i,r=1;return e.time<t.time+a._duration&&(r=(e.time-t.time)/a._duration),i=a.easing&&1!=r?a.easing(r)*(a.count-1):r*(a.count-1),e.setValue(a.field,a.table[int((i+a.count)%a.count)]),1==r&&(a.started=!1,t.time+=a._duration,!0)}},$872de058ddd83b81$export$2e2bcd8739ae039={init:function(e,t=!1){},update:function(e,t,a){!1===a.started&&(a._last=e.time,a.started=!0,a.time=e.time);let i=e.time-a._last;return a._last=e.time,a.time+=i,!0!==a.fn(i,e.data,a,e)&&(a.started=!1,!0)}},$9523965bce7c4768$export$2e2bcd8739ae039={init:function(e,t=!1){},update:function(e,t,a){return a.snd.play(),!0}};
//!class Anim
const $87700f1592e85ac3$var$Anim=$3CL91.Class.extend({className:"Anim",initialData:null,blockStack:null,cmdStack:null,block:null,finishedCallback:null,finishedCallbackHandler:null,finishedCallbackContext:null,data:null,timeScale:1,time:0,paused:!1,finished:!1,running:!1,autoDispose:!1,__ctor:function(){return this.initialData={},this.data={},this.block=$df7b3efe39b649f3$export$2e2bcd8739ae039.alloc(),this.blockStack=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.cmdStack=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.running=!1,this.autoDispose=!1,this.finishedCallback=null,this.finishedCallbackHandler=null,this.finishedCallbackContext=null,this.reset()},__dtor:function(){this.block.free(),this.blockStack.clear().free(),this.cmdStack.clear().free(),null!==this.finishedCallbackHandler&&(this.finishedCallbackHandler.free(),this.finishedCallbackHandler=null),null!==this.finishedCallbackContext&&(this.finishedCallbackContext.free(),this.finishedCallbackContext=null)},copyTo:function(e){return e.clear(),dispose(e.block),e.block=this.block.clone(),e.initialData=this.initialData,e.reset()},clone:function(e=!1){let t=new $87700f1592e85ac3$var$Anim;return t.autoDispose=e,this.copyTo(t),t},onFinished:function(e){return this.finishedCallback=e,this},then:function(e,t=null){return e?(this.finishedCallback!==this.thenCallback&&(this.finishedCallback=this.thenCallback,null===this.finishedCallbackHandler?(this.finishedCallbackHandler=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.finishedCallbackContext=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc()):(this.finishedCallbackHandler.reset(),this.finishedCallbackContext.reset())),this.finishedCallbackHandler.push(e),this.finishedCallbackContext.push(t),this):this},thenCallback:function(e,t){if(!t.finishedCallbackHandler.length)return!1;let a=t.finishedCallbackContext.shift();return t.finishedCallbackHandler.shift()(t,a)},clear:function(){return this.blockStack.clear(),this.cmdStack.clear(),this.block.clear(),this.paused=!1,this.finished=!1,this.time=0,this.timeScale=1,null!==this.finishedCallbackHandler&&(this.finishedCallbackHandler.free(),this.finishedCallbackHandler=null),null!==this.finishedCallbackContext&&(this.finishedCallbackContext.free(),this.finishedCallbackContext=null),this.finishedCallback=null,this},reset:function(){return this.blockStack.clear(),this.cmdStack.clear(),this.block.reset(),this.paused=!1,this.finished=!1,this.time=0,this.timeScale=1,Object.assign(this.data,this.initialData),this},cleanup:function(){return this.blockStack.clear(),this.cmdStack.clear(),this.block.clear(),this.paused=!1,this.finished=!1,this.time=0,this.timeScale=1,this},initial:function(e=null){return null!==e&&(this.initialData=e),Object.assign(this.data,this.initialData),this},speed:function(e){return this.timeScale=e>0?e:1,this},output:function(e){return this.data=e,this},pause:function(){return this.paused||(this.paused=!0),this},resume:function(){return this.finished=!1,this.paused=!1,this.running||this.run(!1),this},run:function(e=!0){return this.running||(1==e&&this.reset(),$577dad4304081d73$export$2e2bcd8739ae039.update.add(this.update,this),this.running=!0),this},setValue:function(e,t){let a=this.data;if("string"!=typeof e)if("function"==typeof e)e(this,t);else{let i=0;for(;null!==a&&i<e.length-1;)a=a[e[i++]];a[e[i]]=t}else a[e]=t},getValue:function(e,t=null,a=null){let i=this.data;if("string"!=typeof e)if("function"==typeof e)i=e(this,null);else{let t=0;for(;null!==i&&t<e.length;)i=i[e[t++]]}else i=i[e];if(null===t&&(t=i),null===a&&(a=i),"string"==typeof t)switch(t[0]){case"+":t=a+Number(t.substr(1));break;case"-":t=a-Number(t.substr(1));break;default:t=Number(t)}else"function"==typeof t&&(t=t(i,a,this));return t},update:function(e,t=null){if(null===t&&(t=this),t.paused||t.block.isFinished())return t.running=!1,!1;if(t.time+=e*t.timeScale*$87700f1592e85ac3$var$Anim.timeScale,!0!==t.block.update(t))return!0;let a=t.finished,i=t.block.stamp,r=t.block;return t.finished=!0,a||null===t.finishedCallback||(!1===t.finishedCallback(t.data,t)&&(t.finishedCallback=null),t.block===r&&t.block.stamp==i)?(t.running=!1,t.autoDispose&&dispose(t),!1):(t.resume(),!0)},prepareFieldName:function(e){return"function"==typeof e?e:-1!=e.indexOf(".")?e.split("."):e},parallel:function(){let e=this.block.add($7252a2f0d16954cd$export$2e2bcd8739ae039.alloc($cd2db5a4897c8fd6$export$2e2bcd8739ae039));return this.blockStack.push(this.block),this.cmdStack.push(e),this.block=e.block,this},serial:function(){let e=this.block.add($7252a2f0d16954cd$export$2e2bcd8739ae039.alloc($b4d3731cd8fed05a$export$2e2bcd8739ae039));return this.blockStack.push(this.block),this.cmdStack.push(e),this.block=e.block,this},repeat:function(e){let t=this.block.add($7252a2f0d16954cd$export$2e2bcd8739ae039.alloc($8e7deb3b4664f615$export$2e2bcd8739ae039));return t.count=e,this.blockStack.push(this.block),this.cmdStack.push(t),this.block=t.block,this},end:function(){return this.cmdStack.pop().ready(),this.block=this.blockStack.pop(),this},set:function(e,t){let a=this.block.add($7252a2f0d16954cd$export$2e2bcd8739ae039.alloc($a8c94e89a300b635$export$2e2bcd8739ae039));return a.field=this.prepareFieldName(e),a.value=t,this},restart:function(){return this.block.add($7252a2f0d16954cd$export$2e2bcd8739ae039.alloc($5e2ea7c2fca74706$export$2e2bcd8739ae039)),this},wait:function(e){return this.block.add($7252a2f0d16954cd$export$2e2bcd8739ae039.alloc($d30fbbca3dc6e914$export$2e2bcd8739ae039)).duration=e,this},range:function(e,t,a,i,r=null){let n=this.block.add($7252a2f0d16954cd$export$2e2bcd8739ae039.alloc($fd4753ee728f640d$export$2e2bcd8739ae039));return n.field=this.prepareFieldName(e),n.duration=t,n.startValue=a,n.endValue=i,n.easing=r,this},rangeTo:function(e,t,a,i=null){let r=this.block.add($7252a2f0d16954cd$export$2e2bcd8739ae039.alloc($fd4753ee728f640d$export$2e2bcd8739ae039));return r.field=this.prepareFieldName(e),r.duration=t,r.startValue=null,r.endValue=a,r.easing=i,this},rand:function(e,t,a,i,r,n=null){let s=this.block.add($7252a2f0d16954cd$export$2e2bcd8739ae039.alloc($51108995344d7c47$export$2e2bcd8739ae039));return s.field=this.prepareFieldName(e),s.duration=t,s.count=a,s.startValue=i,s.endValue=r,s.easing=n,this},randt:function(e,t,a,i,r,n){let s=this.block.add($7252a2f0d16954cd$export$2e2bcd8739ae039.alloc($5b070686dcbeb863$export$2e2bcd8739ae039));return s.field=this.prepareFieldName(e),s.duration=t,s.count=a,s.startValue=i,s.endValue=r,s.easing=n,s.ready(),this},play:function(e){return this.block.add($7252a2f0d16954cd$export$2e2bcd8739ae039.alloc($9523965bce7c4768$export$2e2bcd8739ae039)).snd=e,this},exec:function(e){return this.block.add($7252a2f0d16954cd$export$2e2bcd8739ae039.alloc($872de058ddd83b81$export$2e2bcd8739ae039)).fn=e,this},_bounds_x1:function(e,t){if(null===t)return e.data.bounds.x1;e.data.translate(int(t)-e.data.bounds.x1,0)},_bounds_y1:function(e,t){if(null===t)return e.data.bounds.y1;e.data.translate(0,int(t)-e.data.bounds.y1)},setX:function(e){return this.set(this._bounds_x1,e)},setY:function(e){return this.set(this._bounds_y1,e)},position:function(e,t){return this.set(this._bounds_x1,e).set(this._bounds_y1,t)},translateX:function(e,t,a){return this.range(this._bounds_x1,e,null,(t<0?"-":"+")+Math.abs(t),a)},translateY:function(e,t,a){return this.range(this._bounds_y1,e,null,(t<0?"-":"+")+Math.abs(t),a)},translate:function(e,t,a,i,r=null){return this.parallel().range(this._bounds_x1,e,null,(t<0?"-":"+")+Math.abs(t),i).range(this._bounds_y1,e,null,(a<0?"-":"+")+Math.abs(a),r||i).end()},moveTo:function(e,t,a,i=null,r=null){return this.parallel().range(this._bounds_x1,e,null,t,i).range(this._bounds_y1,e,null,a,r||i).end()},moveX:function(e,t,a=null){return this.range(this._bounds_x1,e,null,t,a)},moveY:function(e,t,a=null){return this.range(this._bounds_y1,e,null,t,a)},scaleX:function(e,t,a){return this.range("sx",e,null,t,a)},scaleY:function(e,t,a){return this.range("sy",e,null,t,a)},scale:function(e,t,a,i,r=null){return this.parallel().range("sx",e,null,t,i).range("sy",e,null,a,r||i).end()},rotate:function(e,t,a){return this.range("angle",e,null,(t<0?"-":"+")+Math.abs(t),a)}});$87700f1592e85ac3$var$Anim.timeScale=1,$87700f1592e85ac3$var$Anim.speed=function(e){$87700f1592e85ac3$var$Anim.timeScale=e>0?e:1},$cac8b143592e7d73$export$2e2bcd8739ae039.createPool($87700f1592e85ac3$var$Anim,2048);var $87700f1592e85ac3$export$2e2bcd8739ae039=$87700f1592e85ac3$var$Anim,$3CL91=parcelRequire("3CL91");
//![import "../math/bounds2"]
//![import "../utils/handler"]
//!class GridElement
const $7fb91ad676a8d6b3$var$GridElement=$3CL91.Class.extend({className:"GridElement",id:null,bounds:null,flags:0,data:null,ext:null,container:null,_grid_remove_node:null,remover:null,__ctor:function(e,t,a,i){this.bounds=$c7e41fee2cf6e3a0$export$2e2bcd8739ae039.Pool.alloc(),this.bounds.translate(e,t),this.bounds.resize(a,i,!0),this.flags=$7fb91ad676a8d6b3$var$GridElement.ALIVE|$7fb91ad676a8d6b3$var$GridElement.VISIBLE|$7fb91ad676a8d6b3$var$GridElement.DIRTY|$7fb91ad676a8d6b3$var$GridElement.DEPTH_FLAG,this.data=null,this.ext=null,this.remover=$4d8bfc31fa3d230f$export$2e2bcd8739ae039.Pool.alloc(this)},__dtor:function(){this.alive(!1),null!==this.data&&(dispose(this.data),this.data=null),this.remover.exec(),this.remover.free(),this.bounds.free()},setId:function(e){return this.id=e,this},setFlags:function(e){return this.flags|=e,this},clearFlags:function(e){return this.flags&=~e,this},getFlags:function(e,t=null){return null===t?(this.flags&e)===e:(this.flags&e)===t},setData:function(e){return this.data=e,null!==this.data&&(this.data.host=this),this},getData:function(){return this.data},setExt:function(e){return this.ext=e,this},getExt:function(){return this.ext},exec:function(e,t=null,a=null,i=null,r=null,n=null,s=null,o=null,l=null,c=null,h=null){return!(null===this.ext||!this.ext.hasOwnProperty(e))&&this.ext[e](this,t,a,i,r,n,s,o,l,c,h)},visible:function(e=null,t=!1){return null===e?!!(this.flags&$7fb91ad676a8d6b3$var$GridElement.VISIBLE):(!t&&this.flags&$7fb91ad676a8d6b3$var$GridElement.VISIBLE_LOCK||(this.flags&=~$7fb91ad676a8d6b3$var$GridElement.VISIBLE,e&&(this.flags|=$7fb91ad676a8d6b3$var$GridElement.VISIBLE)),this)},visibleLock:function(e=null){return null===e?!!(this.flags&$7fb91ad676a8d6b3$var$GridElement.VISIBLE_LOCK):(this.flags&=~$7fb91ad676a8d6b3$var$GridElement.VISIBLE_LOCK,e&&(this.flags|=$7fb91ad676a8d6b3$var$GridElement.VISIBLE_LOCK),this)},alive:function(e=null){return null===e?!!(this.flags&$7fb91ad676a8d6b3$var$GridElement.ALIVE):(this.flags&=~$7fb91ad676a8d6b3$var$GridElement.ALIVE,e&&(this.flags|=$7fb91ad676a8d6b3$var$GridElement.ALIVE),this)},dirty:function(e=null){return null===e?!!(this.flags&$7fb91ad676a8d6b3$var$GridElement.DIRTY):(this.flags&=~$7fb91ad676a8d6b3$var$GridElement.DIRTY,e&&(this.flags|=$7fb91ad676a8d6b3$var$GridElement.DIRTY),this)},depthFlagEnabled:function(e=null){return null===e?!!(this.flags&$7fb91ad676a8d6b3$var$GridElement.DEPTH_FLAG_ENABLED):(this.flags&=~$7fb91ad676a8d6b3$var$GridElement.DEPTH_FLAG_ENABLED,e&&(this.flags|=$7fb91ad676a8d6b3$var$GridElement.DEPTH_FLAG_ENABLED),this)},depthFlag:function(e=null){return null===e?!!(this.flags&$7fb91ad676a8d6b3$var$GridElement.DEPTH_FLAG):(this.flags&=~$7fb91ad676a8d6b3$var$GridElement.DEPTH_FLAG,e&&(this.flags|=$7fb91ad676a8d6b3$var$GridElement.DEPTH_FLAG),this)},remove:function(){return this.remover.exec(),this},sync:function(){return null!==this.container&&this.getFlags($7fb91ad676a8d6b3$var$GridElement.ALIVE|$7fb91ad676a8d6b3$var$GridElement.DIRTY)?(this.container.sync(this),this):this},resize:function(e,t){return this.flags|=$7fb91ad676a8d6b3$var$GridElement.DIRTY,this.bounds.resize(e,t,!0),this},resizeBy:function(e,t){return this.flags|=$7fb91ad676a8d6b3$var$GridElement.DIRTY,this.bounds.resizeBy(e,t,!0),this},translate:function(e,t,a=!1){return this.flags|=$7fb91ad676a8d6b3$var$GridElement.DIRTY,this.bounds.translate(e,t,a),this},setPosition:function(e,t=!1){return!1===t&&(t=e.y,e=e.x),this.translate(null!==e?upscale(e)-this.bounds.ux1:0,null!==t?upscale(t)-this.bounds.uy1:0,!0)}});$7fb91ad676a8d6b3$var$GridElement.ALIVE=1,$7fb91ad676a8d6b3$var$GridElement.VISIBLE=2,$7fb91ad676a8d6b3$var$GridElement.VISIBLE_LOCK=4,$7fb91ad676a8d6b3$var$GridElement.DIRTY=8,$7fb91ad676a8d6b3$var$GridElement.DEPTH_FLAG_ENABLED=16,$7fb91ad676a8d6b3$var$GridElement.DEPTH_FLAG=32,$7fb91ad676a8d6b3$var$GridElement.WRAP_EXTENTS=64,$7fb91ad676a8d6b3$var$GridElement.USERDEF=256,$7fb91ad676a8d6b3$var$GridElement.LAST_FLAG=128,$7fb91ad676a8d6b3$var$GridElement.allocFlag=function(){let e=$7fb91ad676a8d6b3$var$GridElement.LAST_FLAG;if(1073741824===e)throw new Error("allocFlag: out of bit space to allocate another flag");return e<<=1,$7fb91ad676a8d6b3$var$GridElement.LAST_FLAG=e,e};var $7fb91ad676a8d6b3$export$2e2bcd8739ae039=$7fb91ad676a8d6b3$var$GridElement,$3CL91=parcelRequire("3CL91");
//![import "./grid-element"]
//![import "../utils/list"]
//!class Grid
const $776748689202dbe3$var$Grid=$3CL91.Class.extend({className:"Grid",grid:null,count:0,offsx:0,offsy:0,kx:0,ky:0,stride:0,verifyIntersection:!0,__ctor:function(e,t,a,i=null){e=1<<Math.ceil(Math.log2(e)),t=1<<Math.ceil(Math.log2(t)),this.offsx=e>>1,this.offsy=t>>1,null===i&&(i=a),a=Math.floor(Math.log2(a)),i=Math.floor(Math.log2(i)),this.kx=a,this.ky=i;let r=e>>a,n=t>>i;r||(a=Math.log2(e),r=1),n||(i=Math.log2(t),n=1),this.grid=new Array(r*n).fill(null),this.stride=r},__dtor:function(){this.clear(),this.grid=null},clear:function(){for(let e=0;e<this.grid.length;e++){if(null===this.grid[e])continue;let t;for(;null!==(t=this.grid[e].shift());)t.remover.remove(this._remove,this),t.container=null,dispose(t);this.grid[e].free(),this.grid[e]=null}this.count=0},reset:function(){for(let e=0;e<this.grid.length;e++){if(null===this.grid[e])continue;let t;for(;null!==(t=this.grid[e].shift());)t.remover.remove(this._remove,this),t.container=null;this.grid[e].free(),this.grid[e]=null}this.count=0},add:function(e){if(!$7fb91ad676a8d6b3$export$2e2bcd8739ae039.isInstance(e))throw new Error("argument must be a GridElement");let t=int(e.bounds.y1+this.offsy>>this.ky)*this.stride+int(e.bounds.x1+this.offsx>>this.kx);return!(t<0||t>=this.grid.length)&&(null===this.grid[t]&&(this.grid[t]=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc()),this.grid[t].push(e),this.count++,e.container=this,e._grid_remove_node=e.remover.add(this._remove,this,t,this.grid[t].bottom),!0)},_remove:function(e,t,a,i){return t.grid[a].remove(i),t.count--,e.container=null,!1},remove:function(e){return e.remover.execc(this._grid_remove_node),e},sync:function(e){e.clearFlags($7fb91ad676a8d6b3$export$2e2bcd8739ae039.DIRTY);let t=e._grid_remove_node,a=int(e.bounds.y1+this.offsy>>this.ky)*this.stride+int(e.bounds.x1+this.offsx>>this.kx);return a<0||a>=this.grid.length?(e.remover.execc(t),!1):(t.arg1===a||(this.grid[t.arg1].remove(t.arg2),null===this.grid[a]&&(this.grid[a]=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc()),this.grid[a].push(e),t.arg1=a,t.arg2=this.grid[a].bottom),!0)},forEachInRegion:function(e,t,a,i,r){let n=(e.y1+this.offsy-(1<<this.ky-1)>>this.ky)*this.stride,s=(e.y2+this.offsy+(1<<this.ky-1)>>this.ky)*this.stride,o=e.x1+this.offsx-(1<<this.kx-1)>>this.kx,l=e.x2+this.offsx+(1<<this.kx-1)>>this.kx,c=this.grid.length-1;n<0&&(n=0),s<0&&(s=0),o<0&&(o=0),l<0&&(l=0),n>c&&(n=c),s>c&&(s=c),o>c&&(o=c),l>c&&(l=c);for(let h=n;h<=s;h+=this.stride)for(let f=o;f<=l;f++){let u=h+f;if(!(u>c||null===this.grid[u]))for(let c=this.grid[u].top;c;c=c.next)if(c.value.getFlags(t,a)&&(!this.verifyIntersection||!(h<=n+1||f<=o+1||h>=s-1||f>=l-1)||c.value.bounds.intersects(e))&&!1===i(c.value,r))return}},selectInRegion:function(e,t,a){let i=(e.y1+this.offsy-(1<<this.ky-1)>>this.ky)*this.stride,r=(e.y2+this.offsy+(1<<this.ky-1)>>this.ky)*this.stride,n=e.x1+this.offsx-(1<<this.kx-1)>>this.kx,s=e.x2+this.offsx+(1<<this.kx-1)>>this.kx,o=this.grid.length-1;i<0&&(i=0),r<0&&(r=0),n<0&&(n=0),s<0&&(s=0),i>o&&(i=o),r>o&&(r=o),n>o&&(n=o),s>o&&(s=o);let l=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc();for(let c=i;c<=r;c+=this.stride)for(let h=n;h<=s;h++){let f=c+h;if(!(f>o||null===this.grid[f]))for(let o=this.grid[f].top;o;o=o.next)o.value.getFlags(t,a)&&(this.verifyIntersection&&(c<=i+1||h<=n+1||c>=r-1||h>=s-1)&&!o.value.bounds.intersects(e)||l.push(o.value))}return l},countInRegion:function(e,t,a){let i=(e.y1+this.offsy-(1<<this.ky-1)>>this.ky)*this.stride,r=(e.y2+this.offsy+(1<<this.ky-1)>>this.ky)*this.stride,n=e.x1+this.offsx-(1<<this.kx-1)>>this.kx,s=e.x2+this.offsx+(1<<this.kx-1)>>this.kx,o=this.grid.length-1;i<0&&(i=0),r<0&&(r=0),n<0&&(n=0),s<0&&(s=0),i>o&&(i=o),r>o&&(r=o),n>o&&(n=o),s>o&&(s=o);let l=0;for(let c=i;c<=r;c+=this.stride)for(let h=n;h<=s;h++){let f=c+h;if(!(f>o||null===this.grid[f]))for(let o=this.grid[f].top;o;o=o.next)o.value.getFlags(t,a)&&(this.verifyIntersection&&(c<=i+1||h<=n+1||c>=r-1||h>=s-1)&&!o.value.bounds.intersects(e)||l++)}return l},selectFirst:function(e,t,a){let i=(e.y1+this.offsy-(1<<this.ky-1)>>this.ky)*this.stride,r=(e.y2+this.offsy+(1<<this.ky-1)>>this.ky)*this.stride,n=e.x1+this.offsx-(1<<this.kx-1)>>this.kx,s=e.x2+this.offsx+(1<<this.kx-1)>>this.kx,o=this.grid.length-1;i<0&&(i=0),r<0&&(r=0),n<0&&(n=0),s<0&&(s=0),i>o&&(i=o),r>o&&(r=o),n>o&&(n=o),s>o&&(s=o);for(let l=i;l<=r;l+=this.stride)for(let c=n;c<=s;c++){let h=l+c;if(!(h>o||null===this.grid[h]))for(let o=this.grid[h].top;o;o=o.next)if(o.value.getFlags(t,a)&&(!this.verifyIntersection||!(l<=i+1||c<=n+1||l>=r-1||c>=s-1)||o.value.bounds.intersects(e)))return o.value}return null}});var $776748689202dbe3$export$2e2bcd8739ae039=$776748689202dbe3$var$Grid,$3CL91=parcelRequire("3CL91"),$3CL91=parcelRequire("3CL91");
//!class Container
const $f40c750fc020de04$var$Container=$3CL91.Class.extend({className:"Container",viewportBounds:null,width:0,height:0,zvalue:0,scene:null,flags:0,g:null,elementCount:0,drawCount:0,ldraw:null,__ctor:function(e=32768,t=32768){this.width=e,this.height=t,this.flags=$f40c750fc020de04$var$Container.VISIBLE|$f40c750fc020de04$var$Container.DEPTH_FLAG,this.ldraw=$4d8bfc31fa3d230f$export$2e2bcd8739ae039.Pool.alloc(this)},__dtor:function(){this.ldraw.free()},visible:function(e=null){return null===e?!!(this.flags&$f40c750fc020de04$var$Container.VISIBLE):(this.flags&=~$f40c750fc020de04$var$Container.VISIBLE,e&&(this.flags|=$f40c750fc020de04$var$Container.VISIBLE),this)},depthFlag:function(e=null){return null===e?!!(this.flags&$f40c750fc020de04$var$Container.DEPTH_FLAG):(this.flags&=~$f40c750fc020de04$var$Container.DEPTH_FLAG,e&&(this.flags|=$f40c750fc020de04$var$Container.DEPTH_FLAG),this)},setViewportBounds:function(e){return this.viewportBounds=e,this},drawElement:function(e,t){return t.drawCount++,e.draw(t.g)},syncZ:function(e){e.__zvalue=this.zvalue+(e._zvalue+e.bounds.y2&262143)},sync:function(e){throw new Error("Container::sync not implemented")},clear:function(){throw new Error("Container::clear not implemented")},reset:function(){throw new Error("Container::reset not implemented")},add:function(e){throw new Error("Container::add not implemented")},remove:function(e){throw new Error("Container::remove not implemented")},draw:function(e){if(!this.visible())return;let t=e.pushDepthFlag(this.flags&$f40c750fc020de04$var$Container.DEPTH_FLAG);e.zvalue=this.zvalue,this.drawCount=0,this.g=e,this.render(),this.ldraw.exec(e),t&&e.popDepthFlag()},render:function(){throw new Error("Container::render not implemented")}});$f40c750fc020de04$var$Container.VISIBLE=1,$f40c750fc020de04$var$Container.DEPTH_FLAG=2;var $f40c750fc020de04$export$2e2bcd8739ae039=$f40c750fc020de04$var$Container,$3CL91=parcelRequire("3CL91");
//![import "../math/point2"]
//![import "../math/bounds2"]
//![import "../math/rect"]
//![import "../system/canvas"]
//!class Viewport
const $d4defdc7111e0d4b$var$Viewport=$3CL91.Class.extend({className:"Viewport",width:0,initialWidth:0,height:0,initialHeight:0,sx:0,sy:0,x:0,y:0,centerRatioX:0,centerRatioY:0,offset:null,container:null,focusFactorX:0,focusFactorY:0,focusRect:null,focusOffsX:0,focusOffsY:0,focusAxisX:!0,focusAxisY:!0,flags:0,scale:1,globalScale:1,bounds:null,padding:null,focusBounds:null,screenBounds:null,tmpPoint:null,__ctor:function(e,t,a,i,r,n){this.focusFactorX=.4,this.focusFactorY=.4,this.focusRect=null,this.sx=e,this.sy=t,this.width=this.initialWidth=a,this.height=this.initialHeight=i,this.x=0,this.y=0,this.bounds=$c7e41fee2cf6e3a0$export$2e2bcd8739ae039.Pool.alloc(),this.padding=null,this.focusBounds=$c7e41fee2cf6e3a0$export$2e2bcd8739ae039.Pool.alloc(),this.screenBounds=$c7e41fee2cf6e3a0$export$2e2bcd8739ae039.Pool.alloc(),this.container=$c7e41fee2cf6e3a0$export$2e2bcd8739ae039.Pool.alloc(),this.offset=$6368899a9e534bce$export$2e2bcd8739ae039.Pool.alloc(),this.flags=$d4defdc7111e0d4b$var$Viewport.ENABLED,this.tmpPoint=$6368899a9e534bce$export$2e2bcd8739ae039.Pool.alloc(),this.setContainerBounds(-r>>1,-n>>1,r>>1,n>>1),this.updateScreenBounds(),this.updateBounds()},__dtor:function(){this.bounds.free(),this.focusBounds.free(),this.screenBounds.free(),this.container.free(),this.tmpPoint.free(),null!==this.padding&&this.padding.free()},enabled:function(e=null){return null===e?!!(this.flags&$d4defdc7111e0d4b$var$Viewport.ENABLED):(this.flags&=~$d4defdc7111e0d4b$var$Viewport.ENABLED,e&&(this.flags|=$d4defdc7111e0d4b$var$Viewport.ENABLED),this)},topLeft:function(e=null){return null===e?!!(this.flags&$d4defdc7111e0d4b$var$Viewport.TOP_LEFT):(this.flags&=~$d4defdc7111e0d4b$var$Viewport.TOP_LEFT,e&&(this.flags|=$d4defdc7111e0d4b$var$Viewport.TOP_LEFT),this)},setContainerBounds:function(e,t=null,a=null,i=null){return null===t&&(i=e.y2,a=e.x2,t=e.y1,e=e.x1),this.width=this.initialWidth,this.height=this.initialHeight,this.width>a-e&&(this.width=a-e),this.height>i-t&&(this.height=i-t),this.container.set(e,t,a,i),this},setPadding:function(e,t=null,a=null,i=null){return null===this.padding&&(this.padding=$c7e41fee2cf6e3a0$export$2e2bcd8739ae039.Pool.alloc()),null===t&&(a=i=e,e=t=-e),this.padding.set(e,t,a,i),this},updateBounds:function(e=!1){let t,a,i,r,n,s,o,l;t=this.width>>1,a=this.height>>1,i=t/this.scale,r=a/this.scale,n=this.x-i+this.offset.x,s=this.y-r+this.offset.y,o=this.x+i+this.offset.x,l=this.y+r+this.offset.y,e&&(n<this.container.x1?this.offset.setX(this.container.x1-this.x+i):o>this.container.x2&&this.offset.setX(this.container.x2-this.x-i),s<this.container.y1?this.offset.setY(this.container.y1-this.y+r):l>this.container.y2&&this.offset.setY(this.container.y2-this.y-r),n=this.x-i+this.offset.x,s=this.y-r+this.offset.y,o=this.x+i+this.offset.x,l=this.y+r+this.offset.y),this.bounds.set(n,s,o,l),null!==this.padding&&this.bounds.add(this.padding),this.focusBounds.set(this.x-(this.focusFactorX*t+this.centerRatioX*t)/this.scale,this.y-(this.focusFactorY*a+this.centerRatioY*a)/this.scale,this.x+(this.focusFactorX*t+this.centerRatioX*t)/this.scale,this.y+(this.focusFactorY*a+this.centerRatioY*a)/this.scale)},updateScreenBounds:function(){this.screenBounds.set(this.sx,this.sy,this.sx+this.width,this.sy+this.height)},resize:function(e,t){return this.width=this.initialWidth=e??this.width,this.height=this.initialHeight=t??this.height,this.updateScreenBounds(),this.updateBounds(),this},resizeBy:function(e,t){return this.width+=e,this.height+=t,this.initialWidth=this.width,this.initialHeight=this.height,this.updateScreenBounds(),this.updateBounds(),this},setPosition:function(e,t){return this.x=e??this.x,this.y=t??this.y,this.offset.set(0,0),this.updateBounds(),this},setOffsets:function(e,t){return this.offset.set(e,t),this.updateBounds(),this},setScale:function(e){return this.scale=e,this.updateBounds(),this},getScale:function(){return this.scale},setGlobalScale:function(e){return this.globalScale=e,this},getGlobalScale:function(){return this.globalScale},setCenter:function(e,t){return this.centerRatioX=e,this.centerRatioY=t,this},translate:function(e,t,a=!1){return this.offset.add(e,t),this.updateBounds(a),this},setScreenPosition:function(e,t){return this.sx=e,this.sy=t,this.updateScreenBounds(),this},getX:function(e=!1){return this.x+(e?0:this.offset.x)},getY:function(e=!1){return this.y+(e?0:this.offset.y)},getOffsetX:function(){return this.offset.x},getOffsetY:function(){return this.offset.y},getWidth:function(){return this.width},getHeight:function(){return this.height},focusX:function(e,t=null,a=null){null===a&&(a=this.focusFactorX),null===t&&(t=e);let i=this.width>>1,r=this.x-int((a*i+this.centerRatioX*i)/this.scale),n=this.x+int((a*i+this.centerRatioX*i)/this.scale);r==n&&(e=t=e+t>>1);let s=this.x;return e<r?s+=e-r:t>n&&(s+=t-n),r=s-i,n=s+i,r<this.container.x1&&(s=this.container.x1+i),n>this.container.x2&&(s=this.container.x2-i),this.x=s,this},focusY:function(e,t=null,a=null){null===a&&(a=this.focusFactorY),null===t&&(t=e);let i=this.height>>1,r=this.y-int((a*i+this.centerRatioY*i)/this.scale),n=this.y+int((a*i+this.centerRatioY*i)/this.scale);r==n&&(e=t=e+t>>1);let s=this.y;return e<r?s+=e-r:t>n&&(s+=t-n),r=s-i,n=s+i,r<this.container.y1&&(s=this.container.y1+i),n>this.container.y2&&(s=this.container.y2-i),this.y=s,this},update:function(e=0){null!==this.focusRect&&(this.focusAxisX&&this.focusX(this.focusRect.x1+this.focusOffsX,this.focusRect.x2+this.focusOffsX),this.focusAxisY&&this.focusY(this.focusRect.y1+this.focusOffsY,this.focusRect.y2+this.focusOffsY),this.updateBounds())},updateForced:function(e=0){null!==this.focusRect&&(this.focusX(this.focusRect.x1+this.focusOffsX,this.focusRect.x2+this.focusOffsX),this.focusY(this.focusRect.y1+this.focusOffsY,this.focusRect.y2+this.focusOffsY),this.updateBounds())},setFocusRect:function(e,t=0,a=0){return this.focusRect=e,this.focusOffsX=t,this.focusOffsY=a,this.update(0),this},setFocusOffsets:function(e,t){return this.focusOffsX=e,this.focusOffsY=t,this},setFocusAxes:function(e,t){return this.focusAxisX=e,this.focusAxisY=t,this},setFocusFactor:function(e,t){return this.focusFactorX=e,this.focusFactorY=void 0===t?e:t,this},applyClip:function(e){e.clip(this.screenBounds.x1,this.screenBounds.y1,this.screenBounds.width(),this.screenBounds.height())},applyTransform:function(e){this.flags&$d4defdc7111e0d4b$var$Viewport.TOP_LEFT?e.translate(this.screenBounds.x1,this.screenBounds.y1):e.translate(this.screenBounds.cx,this.screenBounds.cy),1!=this.scale&&e.scale(this.scale,this.scale),1!=this.globalScale&&e.scale(this.globalScale,this.globalScale),this.flags&$d4defdc7111e0d4b$var$Viewport.TOP_LEFT?e.translate(-this.bounds.x1,-this.bounds.y1):e.translate(-this.bounds.cx,-this.bounds.cy),e.updateTransform()},toWorldSpace:function(e,t=null,a=!1){let i,r;return null!==t&&!0!==t||(a=!0===t,t=e.y,e=e.x),this.flags&$d4defdc7111e0d4b$var$Viewport.TOP_LEFT?(i=this.screenBounds.x1,r=this.screenBounds.y1,a?(e=(e-int(i))/this.scale+int(this.bounds.x1),t=(t-int(r))/this.scale+int(this.bounds.y1)):(e=(e-i)/this.scale+this.bounds.x1,t=(t-r)/this.scale+this.bounds.y1)):(i=this.screenBounds.cx,r=this.screenBounds.cy,a?(e=(e-int(i))/this.scale+int(this.bounds.cx),t=(t-int(r))/this.scale+int(this.bounds.cy)):(e=(e-i)/this.scale+this.bounds.cx,t=(t-r)/this.scale+this.bounds.cy)),this.tmpPoint.set(e,t)},toScreenSpace:function(e,t=null,a=!1){let i,r;return null!==t&&!0!==t||(a=!0===t,t=e.y,e=e.x),this.flags&$d4defdc7111e0d4b$var$Viewport.TOP_LEFT?(i=this.screenBounds.x1,r=this.screenBounds.y1,a?(e=(e-int(this.bounds.x1))*this.scale+int(i),t=(t-int(this.bounds.y1))*this.scale+int(r)):(e=(e-this.bounds.x1)*this.scale+i,t=(t-this.bounds.y1)*this.scale+r)):(i=this.screenBounds.cx,r=this.screenBounds.cy,a?(e=(e-int(this.bounds.cx))*this.scale+int(i),t=(t-int(this.bounds.cy))*this.scale+int(r)):(e=(e-this.bounds.cx)*this.scale+i,t=(t-this.bounds.cy)*this.scale+r)),this.tmpPoint.set(e,t)}});$d4defdc7111e0d4b$var$Viewport.ENABLED=1,$d4defdc7111e0d4b$var$Viewport.TOP_LEFT=2;var $d4defdc7111e0d4b$export$2e2bcd8739ae039=$d4defdc7111e0d4b$var$Viewport;
//![import "./grid-element"]
//![import "../system/globals"]
//![import "../utils/recycler"]
//![import "../system/system"]
//![import "../system/canvas"]
//![import "../system/shader-program"]
//!class Element extends GridElement
const $254bd1369df89714$var$Element=$7fb91ad676a8d6b3$export$2e2bcd8739ae039.extend({className:"Element",group:null,img:null,debugBounds:!1,_zvalue:0,__zvalue:0,_alpha:1,_shaderProgram:null,_uniformSetter:null,render:null,__ctor:function(e,t,a=null,i=null,r=null){null===a&&(a=i=0),null===i&&(a=(r=a).width,i=r.height),this._super.GridElement.__ctor(e,t,a,i),this.img=null!==r?r.getDrawable():r,this.group=null,this.debugBounds=!1,this._zvalue=0,this.__zvalue=0,this._alpha=1,this._shaderProgram=null,this._uniformSetter=null,this.render=null},__dtor:function(){null!==this.img&&(dispose(this.img),this.img=null),this._super.GridElement.__dtor()},destroyLater:function(){this.alive()&&(null!==this.container?this.container.scene.disposeLater(this):dispose(this))},debug:function(e=null){return null===e?this.debugBounds:(this.debugBounds=0===e||e,this)},root:function(){let e=this;for(;null!==e.group;)e=e.group;return e},alpha:function(e=null){return null===e?this._alpha:(this._alpha=e,this)},zvalue:function(e=null){return null===e?this._zvalue:(this._zvalue=e,this)},shaderProgram:function(e=!1){return!1===e?this._shaderProgram:("string"==typeof e&&(e=$00b4569a92b7ec96$export$2e2bcd8739ae039.get(e)),this._shaderProgram=e,this)},uniformSetter:function(e){return this._uniformSetter=e,this},draw:function(e){if(!(this._alpha<=0)){if(null!==this.img||null!==this.render){let t=null!==this._shaderProgram&&e.pushShaderProgram(this._shaderProgram),a=!!this.depthFlagEnabled()&&e.pushDepthFlag(this.depthFlag());null!==this._shaderProgram&&null!==this._uniformSetter&&null!==e.gl&&this._uniformSetter(e.getShaderProgram(),this,e.gl),e.zvalue=this.__zvalue,1!=this._alpha&&(e.pushAlpha(),e.alpha(this._alpha)),null!==this.render?this.render(e,this,this.img):this.img.render(e,this),a&&e.popDepthFlag(),t&&e.popShaderProgram(),1!=this._alpha&&e.popAlpha()}if($f2e6a81a3fe74b9a$export$2e2bcd8739ae039.debugBounds||this.debugBounds){let t=e.getMatrix();(e=$041013b7ee2c8fb5$export$2e2bcd8739ae039.displayBuffer2).pushMatrix(),e.loadMatrix(t),e.fillStyle($254bd1369df89714$var$Element.getDebugColor(this.debugBounds)),e.fillRect(this.bounds.x1,this.bounds.y1,this.bounds.width(),this.bounds.height()),e.popMatrix()}}},renderWith:function(e){return this.render=e??null,this}});$254bd1369df89714$var$Element.debugColors=["rgba(0,255,255,0.35)","rgba(255,255,0,0.35)","rgba(255,0,255,0.35)","rgba(255,255,255,0.35)","rgba(255,0,0,0.35)","rgba(0,255,0,0.35)","rgba(0,0,255,0.35)","rgba(128,128,128,0.35)"],$254bd1369df89714$var$Element.getDebugColor=function(e){return!0!==e&&!1!==e||(e=0),$254bd1369df89714$var$Element.debugColors[7&~~e]},
//!/class
//!namespace Element
//!namespace Pool
$cac8b143592e7d73$export$2e2bcd8739ae039.createPool($254bd1369df89714$var$Element);var $254bd1369df89714$export$2e2bcd8739ae039=$254bd1369df89714$var$Element;
//![import "./element"]
//![import "../utils/list"]
//![import "../math/point2"]
//![import "../utils/recycler"]
const $3e41f12d32855284$var$tempPoint=$6368899a9e534bce$export$2e2bcd8739ae039.Pool.alloc(),$3e41f12d32855284$var$Group=$254bd1369df89714$export$2e2bcd8739ae039.extend({className:"Group",children:null,ref:null,__ctor:function(e=null){this._super.Element.__ctor(0,0,0,0),this.children=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.bounds.reset(),this.ref=$6368899a9e534bce$export$2e2bcd8739ae039.Pool.alloc(),this.setId(e)},__dtor:function(){this.clear(),this.children.free(),this.ref.free(),this._super.Element.__dtor()},destroyLater:function(){if(!this.alive())return;let e;for(;null!=(e=this.children.shift());)e.remover.remove(this._remove,this),e.group=null,e.destroyLater();this._super.Element.destroyLater()},clear:function(){let e;for(;null!=(e=this.children.shift());)e.remover.remove(this._remove,this),e.group=null,dispose(e);return this},reset:function(){let e;for(;null!=(e=this.children.shift());)e.remover.remove(this._remove,this),e.group=null;return this},wrapExtents:function(e=null){return null===e?!!(this.flags&$7fb91ad676a8d6b3$export$2e2bcd8739ae039.WRAP_EXTENTS):(this.flags&=~$7fb91ad676a8d6b3$export$2e2bcd8739ae039.WRAP_EXTENTS,e&&(this.flags|=$7fb91ad676a8d6b3$export$2e2bcd8739ae039.WRAP_EXTENTS),this)},addChild:function(e,t=!1){if(!e)return e;let a=null===this.bounds.x1;return(a||this.flags&$7fb91ad676a8d6b3$export$2e2bcd8739ae039.WRAP_EXTENTS)&&((a||e.bounds.x1<this.bounds.x1)&&this.ltranslate(e.bounds.x1-this.bounds.x1,0),(a||e.bounds.y1<this.bounds.y1)&&this.ltranslate(0,e.bounds.y1-this.bounds.y1),(a||e.bounds.x2>this.bounds.x2)&&this.resizeBy(e.bounds.x2-this.bounds.x2,0),(a||e.bounds.y2>this.bounds.y2)&&this.resizeBy(0,e.bounds.y2-this.bounds.y2)),this.children.push(e),null!==e.id&&(this[e.id]=e),!0===t&&e.translate(this.bounds.x1,this.bounds.y1),e.group=this,e.remover.add(this._remove,this,this.children.bottom),e},getChild:function(e){return this[e]||null},_remove:function(e,t,a){return t.children.remove(a),e.group=null,null!==e.id&&(t[e.id]=null),!1},removeChild:function(e){return e&&e.group===this?(e.remover.execf(this._remove,this),e):e},sync:function(){for(let e=this.children.top;e;e=e.next)e.value.sync();return this._super.Element.sync()},ltranslate:function(e,t,a=!1){return this._super.Element.translate(e,t,a)},translate:function(e,t,a=!1){let i=this.bounds.x1,r=this.bounds.y1;this._super.Element.translate(e,t,a),this.ref.add(e,t,a),i=this.bounds.x1-i,r=this.bounds.y1-r;for(let e=this.children.top;e;e=e.next)e.value.translate(i,r);return this},getOffsets:function(e,t,a=!1){$3e41f12d32855284$var$tempPoint.set(this.bounds.ux1,this.bounds.uy1,!0);let i=$3e41f12d32855284$var$tempPoint.x,r=$3e41f12d32855284$var$tempPoint.y;return $3e41f12d32855284$var$tempPoint.add(e,t,a),i=$3e41f12d32855284$var$tempPoint.x-i,r=$3e41f12d32855284$var$tempPoint.y-r,$3e41f12d32855284$var$tempPoint.set(i,r),$3e41f12d32855284$var$tempPoint.x-=e,$3e41f12d32855284$var$tempPoint.y-=t,$3e41f12d32855284$var$tempPoint},setFlags:function(e){for(let t=this.children.top;t;t=t.next)t.value.setFlags(e);return this._super.Element.setFlags(e)},clearFlags:function(e){for(let t=this.children.top;t;t=t.next)t.value.clearFlags(e);return this._super.Element.clearFlags(e)},visible:function(e=null,t=!1){if(null===e)return this._super.Element.visible();for(let a=this.children.top;a;a=a.next)a.value.visible(e,t);return this._super.Element.visible(e,t)},alpha:function(e=null){if(null===e)return this._super.Element.alpha();for(let t=this.children.top;t;t=t.next)t.value.alpha(e);return this._super.Element.alpha(e)}});
//!class Group extends Element
//!/class
//!namespace Group
//!namespace Pool
$cac8b143592e7d73$export$2e2bcd8739ae039.createPool($3e41f12d32855284$var$Group);var $3e41f12d32855284$export$2e2bcd8739ae039=$3e41f12d32855284$var$Group;
//![import "./container"]
//![import "./viewport"]
//![import "./group"]
//![import "../math/bounds2"]
//![import "../utils/list"]
//![import "../utils/handler"]
//![import "../system/globals"]
//!class Scene
const $5ab7719ddef2fb4d$var$Scene=$3CL91.Class.extend({className:"Scene",minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,containers:null,viewports:null,viewportBounds:null,groupList:null,groups:null,disposalQueue:null,fupdater:null,updater:null,synchronizer:null,lupdater:null,destroyer:null,dt:0,flags:0,drawCount:0,scene:null,zvalue:null,name:null,__ctor:function(e,t=null){this.containers=[],this.zvalue=(3&e)<<22,this.name=null!==t?t:"SCENE_"+e,this.viewports=[],this.viewportBounds=$c7e41fee2cf6e3a0$export$2e2bcd8739ae039.Pool.alloc(),this.groupList=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.groups={},this.disposalQueue=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.fupdater=$4d8bfc31fa3d230f$export$2e2bcd8739ae039.Pool.alloc(this),this.updater=$4d8bfc31fa3d230f$export$2e2bcd8739ae039.Pool.alloc(this),this.synchronizer=$4d8bfc31fa3d230f$export$2e2bcd8739ae039.Pool.alloc(this),this.lupdater=$4d8bfc31fa3d230f$export$2e2bcd8739ae039.Pool.alloc(this),this.destroyer=$4d8bfc31fa3d230f$export$2e2bcd8739ae039.Pool.alloc(this),this.flags=$5ab7719ddef2fb4d$var$Scene.VISIBLE,this.scene=this},__dtor:function(){let e;for(this.disposeQueued(),this.disposalQueue.free(),this.destroyer.exec(),this.destroyer.free(),this.fupdater.free(),this.updater.free(),this.synchronizer.free(),this.lupdater.free();null!==(e=this.groupList.shift());)e.remover.remove(this._remove,this),e.container=null,dispose(e);for(e=0;e<this.containers.length;e++)this.containers[e]&&(this.containers[e].scene=null,dispose(this.containers[e]),this.containers[e]=null);for(e=0;e<this.viewports.length;e++)this.viewports[e]&&(dispose(this.viewports[e]),this.viewports[e]=null);this.viewportBounds.free(),this.groupList.free()},clear:function(){let e;for(this.disposeQueued();null!==(e=this.groupList.shift());)e.remover.remove(this._remove,this),e.container=null,dispose(e);for(e=0;e<this.containers.length;e++)this.containers[e]&&this.containers[e].clear()},visible:function(e=null){return null===e?!!(this.flags&$5ab7719ddef2fb4d$var$Scene.VISIBLE):(this.flags&=~$5ab7719ddef2fb4d$var$Scene.VISIBLE,e&&(this.flags|=$5ab7719ddef2fb4d$var$Scene.VISIBLE),this)},setContainer:function(e,t){if(e<0)return this;if(e&=15,null===t)return this.containers[e].scene=null,this.containers[e]=null,this;if(!$f40c750fc020de04$export$2e2bcd8739ae039.isInstance(t))throw new Error("Scene: Unable to set container at index "+e+": argument is not a Container");return(null===this.minWidth||t.width<this.minWidth)&&(this.minWidth=t.width),(null===this.minHeight||t.height<this.minHeight)&&(this.minHeight=t.height),(null===this.maxWidth||t.width>this.maxWidth)&&(this.maxWidth=t.width),(null===this.maxHeight||t.height>this.maxHeight)&&(this.maxHeight=t.height),t.scene=this,t.zvalue=this.zvalue+(e<<18),this.containers[e]=t,this},getContainer:function(e){return e<0||e>=this.containers.length?null:this.containers[e]},setViewport:function(e,t){if(e<0)return this;if(null!==t&&!$d4defdc7111e0d4b$export$2e2bcd8739ae039.isInstance(t))throw new Error("Scene: Unable to set viewport at index "+e+": argument is not a Viewport.");return this.viewports[e]=t,this},getViewport:function(e){return e<0||e>=this.viewports.length?null:this.viewports[e]},disposeLater:function(e){e.alive()&&(this.disposalQueue.push(e),e.alive(!1))},disposeQueued:function(){let e;for(;null!==(e=this.disposalQueue.shift());)dispose(e)},addGroup:function(e){if(!$3e41f12d32855284$export$2e2bcd8739ae039.isInstance(e))throw new Error("argument must be a Group");return this.groupList.push(e),null!==e.id&&(this.groups[e.id]=e),e.container=this,e.remover.add(this._removeGroup,this,this.groupList.bottom),!0},_removeGroup:function(e,t,a){return e.container=null,t.groupList.remove(a),null!==e.id&&(t.groups[e.id]=null),!1},removeGroup:function(e){return e.remover.execf(this._remove,this),e},sync:function(e){return!0},draw:function(e){if(this.visible()){if(this.drawCount=0,this.viewports.length)for(let t=0;t<this.viewports.length;t++){let a=this.viewports[t];a&&a.enabled()&&($f2e6a81a3fe74b9a$export$2e2bcd8739ae039.viewport=a,e.pushClip(),e.pushMatrix(),a.applyClip(e),a.applyTransform(e),this.viewportBounds.set(a.bounds),this.drawContainers(e,this.viewportBounds),e.popMatrix(),e.popClip())}else this.drawContainers(e,null);$70a42a4582ac5be9$export$2e2bcd8739ae039.enabled&&($70a42a4582ac5be9$export$2e2bcd8739ae039.vars[this.name]=this.drawCount)}},drawContainers:function(e,t){try{for(let a=0;a<this.containers.length;a++)this.containers[a]&&(this.containers[a].setViewportBounds(t),this.containers[a].draw(e),this.drawCount+=this.containers[a].drawCount)}catch(e){if("FRAME_END"!==e.message)throw e}},updateViewports:function(){for(let e=0;e<this.viewports.length;e++)this.viewports[e]&&this.viewports[e].update(this.dt)},update:function(e){this.dt=e,this.fupdater.exec(),this.updater.exec(),this.disposeQueued(),this.synchronizer.exec(),this.updateViewports(),this.lupdater.exec()}});$5ab7719ddef2fb4d$var$Scene.VISIBLE=1;var $5ab7719ddef2fb4d$export$2e2bcd8739ae039=$5ab7719ddef2fb4d$var$Scene,$3CL91=parcelRequire("3CL91");
//![import "../utils/list"]
//![import "./element"]
//!class Updater
const $4bca4ca5248f01b3$var$Updater=$3CL91.Class.extend({className:"Updater",scene:null,list:null,__update:null,__context:null,__preupdate:null,__postupdate:null,__ctor:function(e,t=null,a=null){this.list=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.scene=e,this.__update=t,this.__context=a,this.__preupdate=null,this.__postupdate=null,this.scene.updater.add(this._update,this),this.scene.synchronizer.add(this._sync,this),this.scene.destroyer.add(this._destroy,this)},__dtor:function(){let e;for(this.scene.updater.remove(this._update,this),this.scene.synchronizer.remove(this._sync,this),this.scene.destroyer.remove(this._destroy,this);null!==(e=this.list.shift());)e.remover.remove(this._remove,this);this.list.free()},_destroy:function(e,t){dispose(t)},reset:function(){for(;null!==(i=this.list.shift());)i.remover.remove(this._remove,this);return this},clear:function(){for(;null!==(i=this.list.shift());)i.remover.remove(this._remove,this),dispose(i);return this},preUpdate:function(e){return this.__preupdate=e,this},postUpdate:function(e){return this.__postupdate=e,this},add:function(e){if(!$254bd1369df89714$export$2e2bcd8739ae039.isInstance(e))throw new Error("argument must be of type: Element");return this.list.push(e),e.remover.add(this._remove,this,this.list.bottom),e},_remove:function(e,t,a){return t.list.remove(a),!1},remove:function(e){return e.remover.execf(this._remove,this),e},_sync:function(e,t){for(let e=t.list.top;e;e=e.next)e.value.sync()},_update:function(e,t){t.update(e.dt)},update:function(e){if(null!==this.__preupdate&&this.__preupdate(this.list,e,this.__context),null!==this.__update){let t=null;for(let a=this.list.top;a;a=t)t=a.next,!1===this.__update(a.value,e,this.__context)&&this.remove(a.value)}null!==this.__postupdate&&this.__postupdate(this.list,e,this.__context)}});var $4bca4ca5248f01b3$export$2e2bcd8739ae039=$4bca4ca5248f01b3$var$Updater,//![import "./container"]
//![import "./grid-element"]
//![import "./element"]
//![import "../utils/list"]
//!class SimpleContainer extends Container
$6c15c283d8e64b60$export$2e2bcd8739ae039=$f40c750fc020de04$export$2e2bcd8739ae039.extend({className:"SimpleContainer",list:null,__ctor:function(e=0,t=0){this._super.Container.__ctor(e,t),this.list=$c73414f3aa8cd9da$export$2e2bcd8739ae039.Pool.alloc(),this.depthFlag(!1)},__dtor:function(){this.clear(),this.list.free(),this._super.Container.__dtor()},sync:function(e){return this.syncZ(e),!0},clear:function(){let e;for(;null!==(e=this.list.shift());)e.remover.remove(this._remove,this),e.container=null,dispose(e);this.elementCount=0},reset:function(){let e;for(;null!==(e=this.list.shift());)e.remover.remove(this._remove,this),e.container=null;this.elementCount=0},add:function(e){if(!$254bd1369df89714$export$2e2bcd8739ae039.isInstance(e))throw new Error("argument must be an Element");return this.list.push(e),this.elementCount++,e.container=this,e.remover.add(this._remove,this,this.list.bottom),this.syncZ(e),e},_remove:function(e,t,a){return t.list.remove(a),t.elementCount--,e.container=null,!1},remove:function(e){return e.remover.execf(this._remove,this),e},render:function(){let e=$7fb91ad676a8d6b3$export$2e2bcd8739ae039.ALIVE|$7fb91ad676a8d6b3$export$2e2bcd8739ae039.VISIBLE;for(let t=this.list.top;t&&(!t.value.getFlags(e)||!1!==this.drawElement(t.value,this));t=t.next);}}),//![import "./container"]
//![import "./grid"]
//![import "./grid-element"]
//![import "./element"]
//![import "../system/globals"]
//![import "../system/system"]
//!class GridContainer extends Container
$406b7fe2d31108f7$export$2e2bcd8739ae039=$f40c750fc020de04$export$2e2bcd8739ae039.extend({className:"GridContainer",grid:null,debugBounds:!1,__ctor:function(e=32768,t=32768,a=64,i=null){this._super.Container.__ctor(e,t),this.grid=new $776748689202dbe3$export$2e2bcd8739ae039(e,t,a,i)},__dtor:function(){this.clear(),this._super.Container.__dtor()},sync:function(e){return this.syncZ(e),this.grid.sync(e)},clear:function(){this.grid.clear()},reset:function(){this.grid.reset()},add:function(e){if(!$254bd1369df89714$export$2e2bcd8739ae039.isInstance(e))throw new Error("argument must be an Element");return this.grid.add(e)?(e.container=this,this.elementCount=this.grid.count,this.syncZ(e),e):null},remove:function(e){return this.grid.remove(e),this.elementCount=this.grid.count,e},render:function(){if(this.grid.forEachInRegion(this.viewportBounds,$7fb91ad676a8d6b3$export$2e2bcd8739ae039.ALIVE|$7fb91ad676a8d6b3$export$2e2bcd8739ae039.VISIBLE,$7fb91ad676a8d6b3$export$2e2bcd8739ae039.ALIVE|$7fb91ad676a8d6b3$export$2e2bcd8739ae039.VISIBLE,this.drawElement,this),!this.debugBounds||null===this.viewportBounds)return;let e=$041013b7ee2c8fb5$export$2e2bcd8739ae039.displayBuffer2;e.pushMatrix(),e.loadMatrix(this.g.getMatrix());let t=(this.viewportBounds.y1+this.grid.offsy-(1<<this.grid.ky-1)>>this.grid.ky)*this.grid.stride,a=(this.viewportBounds.y2+this.grid.offsy+(1<<this.grid.ky-1)>>this.grid.ky)*this.grid.stride,i=this.viewportBounds.x1+this.grid.offsx-(1<<this.grid.kx-1)>>this.grid.kx,r=this.viewportBounds.x2+this.grid.offsx+(1<<this.grid.kx-1)>>this.grid.kx;t=(int(t/this.grid.stride)<<this.grid.ky)-this.grid.offsy,a=(int(a/this.grid.stride)<<this.grid.ky)-this.grid.offsy+(1<<this.grid.ky),i=(i<<this.grid.kx)-this.grid.offsx,r=(r<<this.grid.kx)-this.grid.offsx+(1<<this.grid.kx),e.fillStyle("rgba(255,0,0,0.2)"),e.fillRect(i,t,r-i+1,a-t+1),t=this.viewportBounds.y1,a=this.viewportBounds.y2,i=this.viewportBounds.x1,r=this.viewportBounds.x2,e.lineWidth(1/$041013b7ee2c8fb5$export$2e2bcd8739ae039.canvasScaleFactor),e.strokeStyle("#fff"),e.strokeRect(i,t,r-i+1,a-t+1),e.lineWidth(1/$041013b7ee2c8fb5$export$2e2bcd8739ae039.canvasScaleFactor),e.strokeStyle("#008");for(let t=$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.viewport.container.y1+this.grid.offsy;t<$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.viewport.container.y2+this.grid.offsy;t+=1<<this.grid.ky)for(let a=$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.viewport.container.x1+this.grid.offsx;a<$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.viewport.container.x2+this.grid.offsx;a+=1<<this.grid.kx)e.strokeRect(a-this.grid.offsx,t-this.grid.offsy,1<<this.grid.kx,1<<this.grid.ky);e.popMatrix()},forEachInRegion:function(e,t,a,i,r){this.grid.forEachInRegion(e,t,a,i,r)},selectInRegion:function(e,t,a){return this.grid.selectInRegion(e,t,a)},countInRegion:function(e,t,a){return this.grid.countInRegion(e,t,a)},selectFirst:function(e,t,a){return this.grid.selectFirst(e,t,a)}});
//![import "./element"]
//![import "../system/system"]
//![import "../utils/recycler"]
//!class Mask extends Element
const $ca4d09a0a1f9f59b$var$Mask=$254bd1369df89714$export$2e2bcd8739ae039.extend({className:"Mask",type:0,__ctor:function(e,t,a,i,r){this._super.Element.__ctor(t,a,i,r),this.type=e},draw:function(e){if(!$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.debugMasks&&!this.debugBounds)return;let t=e.getMatrix();(e=$041013b7ee2c8fb5$export$2e2bcd8739ae039.displayBuffer2).pushMatrix(),e.loadMatrix(t),e.fillStyle($254bd1369df89714$export$2e2bcd8739ae039.getDebugColor(this.debugBounds)),e.fillRect(this.bounds.x1,this.bounds.y1,this.bounds.width(),this.bounds.height()),e.popMatrix()}});
//!/class
//!namespace Mask
//!namespace Pool
$cac8b143592e7d73$export$2e2bcd8739ae039.createPool($ca4d09a0a1f9f59b$var$Mask);var $ca4d09a0a1f9f59b$export$2e2bcd8739ae039=$ca4d09a0a1f9f59b$var$Mask;
//![import "./element"]
//![import "../utils/recycler"]
//!class Label extends Element
const $9543ee6c8181f3e5$var$Label=$254bd1369df89714$export$2e2bcd8739ae039.extend({className:"Label",sx:0,sy:0,text:null,font:null,_dirty:!1,textWidth:null,textHeight:null,_align:-1,_valign:-1,textOffsetX:null,textOffsetY:null,__ctor:function(e,t,a,i){this._super.Element.__ctor(this.sx=e,this.sy=t,1,1),this.text=null,this.font=a,this._align=-1,this._valign=-1,this.renderWith(this.renderText),this.setText(i)},align:function(e){return this._align===e?this:(this._align=e,this.textOffsetX=null,this.update())},valign:function(e){return this._valign===e?this:(this._valign=e,this.textOffsetY=null,this.update())},setText:function(e){return this.text===e?this:(this.text=e,this._dirty=!0,this.update())},setFont:function(e){return this.font===e?this:(this.font=e,this._dirty=!0,this.update())},update:function(){return!0===this._dirty&&(this.textOffsetX=null,this.textOffsetY=null,this.textWidth=this.font.measureWidth(this.text),this.textHeight=this.font.measureHeight(this.text),this._dirty=!1),null===this.textOffsetX&&(this._align<0?this.textOffsetX=0:0===this._align?this.textOffsetX=-this.textWidth>>1:this.textOffsetX=-this.textWidth,this.bounds.translate(-this.bounds.x1+this.sx+this.textOffsetX,0),this.bounds.resize(this.textWidth,null,!0)),null===this.textOffsetY&&(this._valign<0?this.textOffsetY=0:0===this._valign?this.textOffsetY=-this.textHeight>>1:this.textOffsetY=-this.textHeight,this.bounds.translate(0,-this.bounds.y1+this.sy+this.textOffsetY),this.bounds.resize(null,this.textHeight,!0)),this},translate:function(e,t,a=!1){return this.sx+=!0===a?downscale(e):e,this.sy+=!0===a?downscale(t):t,this._super.Element.translate(e,t,a)},renderText:function(e,t,a){t.font.drawText(e,t.bounds.x1,t.bounds.y1,t.text)}});
//!/class
//!namespace Label
//!namespace Pool
$cac8b143592e7d73$export$2e2bcd8739ae039.createPool($9543ee6c8181f3e5$var$Label);var $9543ee6c8181f3e5$export$2e2bcd8739ae039=$9543ee6c8181f3e5$var$Label,//![import "../utils/priority-queue"]
//![import "./boot"]
//![import "../system/system"]
//!namespace KeyboardHandler
//!type Handler =
//!/type
//!/namespace
//!class KeyboardHandler
$8a7c3aa5e6841159$export$2e2bcd8739ae039=$3c0d7fe046574b0f$export$2e2bcd8739ae039.Module.create({handlers:null,__ctor:function(){const e=this;this._super.Module.__ctor(),this.handlers=new $fa388e5ba5a88cdf$export$2e2bcd8739ae039,this._callOnKeyboardEvent=function(t){return e.callOnKeyboardEvent(t)}},register:function(e){try{this.handlers.add(e),"init"in e&&e.init()}catch(e){throw new Error("KeyboardHandler (register): "+e.message)}return e},unregister:function(e){try{this.handlers.remove(e),this.handlers.cleanup()}catch(e){throw new Error("KeyboardHandler (unregister): "+e.message)}},callOnKeyboardEvent:function(e){return e.onKeyboardEvent(this._action,this._keyCode,this._keyState)},onStartup:function(){$041013b7ee2c8fb5$export$2e2bcd8739ae039.onKeyboardEvent=(e,t,a)=>{this._action=e,this._keyCode=t,this._keyState=a,this.handlers.forEach(this._callOnKeyboardEvent)}},onShutdown:function(){$041013b7ee2c8fb5$export$2e2bcd8739ae039.onKeyboardEvent=null}}),//![import "../utils/priority-queue"]
//![import "./boot"]
//![import "../system/system"]
//!namespace PointerHandler
//!type Handler =
//!/type
//!/namespace
//!class PointerHandler
$0e65125930c826b8$export$2e2bcd8739ae039=$3c0d7fe046574b0f$export$2e2bcd8739ae039.Module.create({handlers:null,__ctor:function(){const e=this;this._super.Module.__ctor(),this.handlers=new $fa388e5ba5a88cdf$export$2e2bcd8739ae039,this._callOnPointerEvent=function(t){return e.callOnPointerEvent(t)}},register:function(e){try{this.handlers.add(e),"init"in e&&e.init()}catch(e){throw new Error("PointerHandler (register): "+e.message)}return e},unregister:function(e){try{this.handlers.remove(e),this.handlers.cleanup()}catch(e){throw new Error("PointerHandler (unregister): "+e.message)}},callOnPointerEvent:function(e){return e.onPointerEvent(this._action,this._p,this._pointers)},onStartup:function(){$041013b7ee2c8fb5$export$2e2bcd8739ae039.onPointerEvent=(e,t,a)=>{this._action=e,this._p=t,this._pointers=a,this.handlers.forEach(this._callOnPointerEvent)}},onShutdown:function(){$041013b7ee2c8fb5$export$2e2bcd8739ae039.onPointerEvent=null}});
//![import "./keyboard-handler"]
//![import "./pointer-handler"]
//![import "../system/system"]
//!namespace ScreenControls
//!type Handler =
//!/type
//!/namespace
//!class ScreenControls
const $482cc68f8af5a1d2$var$ScreenControls={priority:5,Handler:$4d8bfc31fa3d230f$export$2e2bcd8739ae039,list:[],hoverFlag:!1,zindexFlag:!1,lastFrame:0,add:function(e){-1===this.list.indexOf(e)&&this.list.push(e)},remove:function(e){let t=this.list.indexOf(e);-1!==t&&this.list.splice(t,1)},hover:function(e=null){if(null===e)return this.hoverFlag;this.hoverFlag=e},zindex:function(e=null){if(null===e)return this.zindexFlag;this.zindexFlag=e},findTarget:function(e,t,a=null){if(this.zindexFlag&&this.lastFrame!=$041013b7ee2c8fb5$export$2e2bcd8739ae039.frameNumber){let e=this.list[0].zindex;for(let t of this.list){if(t.zindex>e){this.list=this.list.sort(((e,t)=>t.zindex-e.zindex));break}e=t.zindex}this.lastFrame=$041013b7ee2c8fb5$export$2e2bcd8739ae039.frameNumber}for(let i=0;i<this.list.length;i++)if(this.list[i]&&(null===a||!1!==a(this.list[i]))&&this.list[i].containsPoint(e,t))return this.list[i];return null},filterHover:function(e){return"hover"in e},onPointerEvent:function(e,t,a){let i=!0,r=null;switch(e){case $041013b7ee2c8fb5$export$2e2bcd8739ae039.PointerEventType.POINTER_DOWN:null!=t._ref&&(r=t._ref,t._ref=null,r.pointerDeactivate(t)),r=this.findTarget(t.x,t.y),null!=r&&((t._ref=r).pointerActivate(t),i=!1);break;case $041013b7ee2c8fb5$export$2e2bcd8739ae039.PointerEventType.POINTER_DRAG_START:null!=t._ref&&(i=!1);break;case $041013b7ee2c8fb5$export$2e2bcd8739ae039.PointerEventType.POINTER_DRAG_MOVE:this.hoverFlag&&(null!=t._refh?t._refh.containsPoint(t.x,t.y)||(r=t._refh,t._refh=null,r.hover(!1,t),r=this.findTarget(t.x,t.y,this.filterHover),null!=r&&(t._refh=r).hover(!0,t)):(r=this.findTarget(t.x,t.y,this.filterHover),null!=r&&(t._refh=r).hover(!0,t))),null!=t._ref?t._ref.containsPoint(t.x,t.y)||1==t._ref.focusLock?(t._ref.pointerUpdate(t.x,t.y,t),i=!1):(r=t._ref,t._ref=null,r.pointerDeactivate(t),r=this.findTarget(t.x,t.y),null!=r&&((t._ref=r).pointerActivate(t),i=!1)):(r=this.findTarget(t.x,t.y),null!=r&&((t._ref=r).pointerActivate(t),i=!1));break;case $041013b7ee2c8fb5$export$2e2bcd8739ae039.PointerEventType.POINTER_MOVE:if(this.hoverFlag&&(null!=t._refh?t._refh.containsPoint(t.x,t.y)||(r=t._refh,t._refh=null,r.hover(!1,t),r=this.findTarget(t.x,t.y,this.filterHover),null!=r&&(t._refh=r).hover(!0,t)):(r=this.findTarget(t.x,t.y,this.filterHover),null!=r&&(t._refh=r).hover(!0,t))),null==t._ref)break;t._ref.containsPoint(t.x,t.y)||1==t._ref.focusLock?(t._ref.pointerUpdate(t.x,t.y,t),i=!1):(r=t._ref,t._ref=null,r.pointerDeactivate(t));break;case $041013b7ee2c8fb5$export$2e2bcd8739ae039.PointerEventType.POINTER_DRAG_STOP:null!=t._ref&&(i=!1);break;case $041013b7ee2c8fb5$export$2e2bcd8739ae039.PointerEventType.POINTER_UP:null!=t._ref&&(r=t._ref,t._ref=null,r.pointerDeactivate(t),i=!1)}return i},onKeyboardEvent:function(e,t,a){switch(e){case $041013b7ee2c8fb5$export$2e2bcd8739ae039.KeyboardEventType.KEY_DOWN:for(let e=0;e<this.list.length&&(!this.list[e]||!this.list[e].keyboardEvents||!1!==this.list[e].keyDown(t,a));e++);break;case $041013b7ee2c8fb5$export$2e2bcd8739ae039.KeyboardEventType.KEY_UP:for(let e=0;e<this.list.length&&(!this.list[e]||!this.list[e].keyboardEvents||!1!==this.list[e].keyUp(t,a));e++);}return!0}};
//!/class
$0e65125930c826b8$export$2e2bcd8739ae039.register($482cc68f8af5a1d2$var$ScreenControls),$8a7c3aa5e6841159$export$2e2bcd8739ae039.register($482cc68f8af5a1d2$var$ScreenControls);var $482cc68f8af5a1d2$export$2e2bcd8739ae039=$482cc68f8af5a1d2$var$ScreenControls,//![import "./group.js"]
//![import "./mask.js"]
//![import "./screen-controls.js"]
//!class Button extends Group
$6e6eb1db0e5ead92$export$2e2bcd8739ae039=$3e41f12d32855284$export$2e2bcd8739ae039.extend({focusLock:!1,keyboardEvents:!0,isPressed:!1,wasPressed:!1,unpressedImg:null,pressedImg:null,keyCode:null,hitbox:null,_onButtonDown:null,_onButtonUp:null,_onTap:null,_onChange:null,__ctor:function(e,t,a,i=null,r=null){this._super.Group.__ctor(),this.unpressedImg=i,this.pressedImg=r??i,this.hitbox=null;let n=$ca4d09a0a1f9f59b$export$2e2bcd8739ae039.Pool.alloc(0,t,a,this.unpressedImg?this.unpressedImg.width:16,this.unpressedImg?this.unpressedImg.height:16).visible(!1).visibleLock(!0).debug(2);this.addChild(n),e.add(n),e.add(this),this.hitbox=n,this._onButtonDown=null,this._onButtonUp=null,this._onTap=null,this._onChange=this._default_onChange,this.reset(),$482cc68f8af5a1d2$export$2e2bcd8739ae039.add(this)},__dtor:function(){this._super.Group.__dtor(),$482cc68f8af5a1d2$export$2e2bcd8739ae039.remove(this)},resize:function(e,t){return this._super.Group.resize(e,t),null!==this.hitbox&&this.hitbox.resize(e,t),this},resizeBy:function(e,t){return this._super.Group.resizeBy(e,t),null!==this.hitbox&&this.hitbox.resizeBy(e,t),this},setImage:function(e,t=null){return this.unpressedImg=e,this.pressedImg=t||e,this.reset(),this},setKeyCode:function(e){return this.keyCode=e,this},reset:function(){return this.img=this.unpressedImg,this._onChange(this.isPressed=!1,this.wasPressed=!1,this),this},pointerUpdate:function(e,t,a){},setStatus:function(e){return this.isPressed===e||(this.updateStatus(e),this.img=this.isPressed?this.pressedImg:this.unpressedImg,this._onChange(this.isPressed,this.wasPressed,this)),this},updateStatus:function(e=null){return this.wasPressed=this.isPressed,this.isPressed=null===e?this.isPressed:e,this},pointerActivate:function(e){this.setStatus(!0)},pointerDeactivate:function(e){this.setStatus(!1)},containsPoint:function(e,t){return!(!this.visible()||this.alpha()<=0)&&this.hitbox.bounds.containsPoint(e,t)},_default_onChange:function(e,t,a){e!==t&&(e&&this._onButtonDown?this._onButtonDown():!e&&this._onButtonUp&&this._onButtonUp()),!e&&t&&this._onTap&&this._onTap()},keyDown:function(e,t){if(e===this.keyCode)return this.pointerActivate(),!1},keyUp:function(e,t){if(e===this.keyCode)return this.pointerDeactivate(),!1},onChange:function(e){return this._onChange=null===e?this._default_onChange:e,this},onButtonDown:function(e=!0){if(!0!==e)return this._onButtonDown=e,this;this._onButtonDown&&this._onButtonDown()},onButtonUp:function(e=!0){if(!0!==e)return this._onButtonUp=e,this;this._onButtonUp&&this._onButtonUp()},onTap:function(e=!0){if(!0!==e)return this._onTap=e,this;this._onTap&&this._onTap()}}),//![import "./group"]
//![import "./mask"]
//![import "./screen-controls"]
//![import "../system/keycode"]
//!class Stick extends Group
$5d97cf48c80e8356$export$2e2bcd8739ae039=$3e41f12d32855284$export$2e2bcd8739ae039.extend({focusLock:!0,keyboardEvents:!0,isPressed:!1,wasPressed:!1,unpressedImg:null,pressedImg:null,unpressedImgInner:null,pressedImgInner:null,angleSteps:0,radiusSteps:0,refX:null,refY:null,rdirx:0,rdiry:0,dirx:0,diry:0,magnitude:0,angle:0,frdirx:0,frdiry:0,fdirx:0,fdiry:0,fmagnitude:0,fangle:0,dispx:0,dispy:0,radius:0,maxRadius:0,deadZoneX:0,deadZoneY:0,hitbox:0,_onChange:null,__ctor:function(e,t,a,i,r,n,s=null,o=null){this._super.Group.__ctor(),this.unpressedImg=r,this.pressedImg=s||r,this.unpressedImgInner=n,this.pressedImgInner=o||n,this.maxRadius=i,this.deadZoneX=0,this.deadZoneY=0,this.hitbox=$ca4d09a0a1f9f59b$export$2e2bcd8739ae039.Pool.alloc(0,t,a,(this.unpressedImg??this.unpressedImgInner).width,(this.unpressedImg??this.unpressedImgInner).height).visible(!1).visibleLock(!0).debug(2),this.addChild(this.hitbox),e.add(this.hitbox),e.add(this),this._onChange=null,this.renderWith(this.renderStick),$482cc68f8af5a1d2$export$2e2bcd8739ae039.add(this)},__dtor:function(){this._super.Group.__dtor(),$482cc68f8af5a1d2$export$2e2bcd8739ae039.remove(this)},setImage:function(e,t=null){return this.unpressedImg=e,this.pressedImg=t||e,this},setImageInner:function(e,t=null){return this.unpressedImgInner=e,this.pressedImgInner=t||e,this},setAngleSteps:function(e){return this.angleSteps=e,this},setRadiusSteps:function(e){return this.radiusSteps=e,this},setDeadZone:function(e,t){return this.deadZoneX=e,this.deadZoneY=t,this},reset:function(){return this.dispx=0,this.dispy=0,this.rdirx=0,this.rdiry=0,this.dirx=0,this.diry=0,this.magnitude=0,this._onChange&&this._onChange(this.dirx,this.diry,this.magnitude,this.angle,this),this},renderStick:function(e,t,a){t.isPressed?(t.pressedImg&&t.pressedImg.draw(e,t.bounds.x1,t.bounds.y1),t.pressedImgInner&&t.pressedImgInner.draw(e,t.bounds.x1+t.dispx,t.bounds.y1+t.dispy)):(t.unpressedImg&&t.unpressedImg.draw(e,t.bounds.x1,t.bounds.y1),t.unpressedImgInner&&t.unpressedImgInner.draw(e,t.bounds.x1,t.bounds.y1))},pointerUpdate:function(e,t){let a,i;if(a=e-this.refX,i=t-this.refY,this.angle=Math.atan2(-i,a),this.radius=Math.sqrt(a*a+i*i),this.radius>this.maxRadius&&(this.radius=this.maxRadius),this.angleSteps){let e=2*Math.PI/this.angleSteps;this.angle=int((this.angle+Math.PI+e/2)/e)*e-Math.PI}if(this.radiusSteps){let e=this.maxRadius/this.radiusSteps;this.radius=int((this.radius+e/2)/e)*e}this.rdirx=Math.min(1,Math.max(a/this.maxRadius,-1)),this.rdiry=Math.min(1,Math.max(i/this.maxRadius,-1)),this.dispx=this.radius*Math.cos(this.angle),this.dispy=this.radius*-Math.sin(this.angle),this.radius>0?(this.dirx=this.dispx/this.radius,this.diry=this.dispy/this.radius,this.magnitude=this.radius/this.maxRadius):(this.dirx=0,this.diry=0,this.magnitude=0),Math.abs(this.rdirx)<this.deadZoneX&&(this.rdirx=0,this.dirx=0),Math.abs(this.rdiry)<this.deadZoneY&&(this.rdiry=0,this.diry=0),this._onChange&&this._onChange(this.dirx,this.diry,this.magnitude,this.angle,this)},pointerActivate:function(e){this.wasPressed=this.isPressed,this.isPressed=1,this.refX=e.x,this.refY=e.y,this.pointerUpdate(e.x,e.y)},pointerDeactivate:function(e){this.wasPressed=this.isPressed,this.isPressed=0,this.reset()},containsPoint:function(e,t){return!(!this.visible()||this.alpha()<=0)&&this.hitbox.bounds.containsPoint(e,t)},setDirection:function(e,t,a=.1,i=.1){return Math.abs(e)<a&&(e=0),Math.abs(t)<i&&(t=0),this.wasPressed=this.isPressed,this.isPressed=0==e&&0==t?0:1,this.pointerUpdate(this.bounds.cx+e*this.maxRadius,this.bounds.cy+t*this.maxRadius),!1},freezeState:function(e=!1){return this.frdirx=e?0!=this.rdirx?this.rdirx:this.frdirx:this.rdirx,this.frdiry=e?0!=this.rdiry?this.rdiry:this.frdiry:this.rdiry,this.fdirx=e?0!=this.dirx?this.dirx:this.fdirx:this.dirx,this.fdiry=e?0!=this.diry?this.diry:this.fdiry:this.diry,this.fmagnitude=e?0!=this.magnitude?this.magnitude:this.fmagnitude:this.magnitude,this.fangle=e?0!=this.angle?this.angle:this.fangle:this.angle,this},keyDown:function(e,t){let a=0,i=0;if(!0===t[$87a32fa215803424$export$2e2bcd8739ae039.UP]&&(i=-this.maxRadius),!0===t[$87a32fa215803424$export$2e2bcd8739ae039.LEFT]&&(a=-this.maxRadius),!0===t[$87a32fa215803424$export$2e2bcd8739ae039.DOWN]&&(i=this.maxRadius),!0===t[$87a32fa215803424$export$2e2bcd8739ae039.RIGHT]&&(a=this.maxRadius),e===$87a32fa215803424$export$2e2bcd8739ae039.UP||e===$87a32fa215803424$export$2e2bcd8739ae039.LEFT||e===$87a32fa215803424$export$2e2bcd8739ae039.DOWN||e===$87a32fa215803424$export$2e2bcd8739ae039.RIGHT)return a=this.bounds.cx+a,i=this.bounds.cy+i,this.wasPressed=this.isPressed,this.isPressed=1,this.pointerUpdate(a,i),!1},keyUp:function(e,t){let a=0,i=0;if(!0===t[$87a32fa215803424$export$2e2bcd8739ae039.UP]&&(i=-this.maxRadius),!0===t[$87a32fa215803424$export$2e2bcd8739ae039.LEFT]&&(a=-this.maxRadius),!0===t[$87a32fa215803424$export$2e2bcd8739ae039.DOWN]&&(i=this.maxRadius),!0===t[$87a32fa215803424$export$2e2bcd8739ae039.RIGHT]&&(a=this.maxRadius),e===$87a32fa215803424$export$2e2bcd8739ae039.UP||e===$87a32fa215803424$export$2e2bcd8739ae039.LEFT||e===$87a32fa215803424$export$2e2bcd8739ae039.DOWN||e===$87a32fa215803424$export$2e2bcd8739ae039.RIGHT)return this.pointerUpdate(this.bounds.cx+a,this.bounds.cy+i),0===a&&0===i&&(this.wasPressed=this.isPressed,this.isPressed=0),!1},onChange:function(e){return this._onChange=e,this}}),$3c88906e521b9e55$exports={};$parcel$export($3c88906e521b9e55$exports,"sys",(()=>$3c88906e521b9e55$export$773cc7fa6f8304c3)),$parcel$export($3c88906e521b9e55$exports,"world",(()=>$3c88906e521b9e55$export$f965ae91e38a1274)),$parcel$export($3c88906e521b9e55$exports,"r",(()=>$3c88906e521b9e55$export$43caf9889c228507)),$parcel$export($3c88906e521b9e55$exports,"res",(()=>$3c88906e521b9e55$export$a79e2b3ea5d10ee0)),$parcel$export($3c88906e521b9e55$exports,"input",(()=>$3c88906e521b9e55$export$b7e3ae3d7c15e42e)),$parcel$export($3c88906e521b9e55$exports,"collider",(()=>$3c88906e521b9e55$export$5fa227701309b621));
//!/**
//! * 	World system allows to manage scenes, containers, viewports and display elements.
//! */
//!class world
const $0c291afd56aedbbe$var$world={SCENE_MAIN:0,SCENE_HUD:1,LAYER_BG0:0,LAYER_BG1:1,LAYER_BG2:2,LAYER_BG3:3,LAYER_BG4:4,LAYER_MAIN:5,LAYER_FG0:6,LAYER_FG1:7,LAYER_FG2:8,LAYER_FG3:9,LAYER_FG4:10,LAYER_MASK:11,LAYER_HUD_BG0:0,LAYER_HUD_BG1:1,LAYER_HUD_BG2:2,LAYER_HUD_MAIN:3,LAYER_HUD_FG0:4,LAYER_HUD_FG1:5,LAYER_HUD_FG2:6,_scenes:[],activeScene:null,_viewports:[],activeViewport:null,activeContainer:null,activeGroup:null,lastGroup:null,lastElement:null,bounds:$c7e41fee2cf6e3a0$export$2e2bcd8739ae039.Pool.alloc(),init:function(e=32768,t=32768,a=null,i=null){0===this._scenes.length&&(null===a&&(a=Math.max(e,t)/512),a<16&&(a=16),null!==i&&i<16&&(i=16),this.bounds.zero().resize(e,t),this.createScene($0c291afd56aedbbe$var$world.SCENE_MAIN,"SCENE_MAIN"),this.setContainer($0c291afd56aedbbe$var$world.LAYER_BG0,new $406b7fe2d31108f7$export$2e2bcd8739ae039(e,t,a,i)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_BG1,new $406b7fe2d31108f7$export$2e2bcd8739ae039(e,t,a,i)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_BG2,new $406b7fe2d31108f7$export$2e2bcd8739ae039(e,t,a,i)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_BG3,new $406b7fe2d31108f7$export$2e2bcd8739ae039(e,t,a,i)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_BG4,new $406b7fe2d31108f7$export$2e2bcd8739ae039(e,t,a,i)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_MAIN,new $406b7fe2d31108f7$export$2e2bcd8739ae039(e,t,a,i)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_FG0,new $406b7fe2d31108f7$export$2e2bcd8739ae039(e,t,a,i)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_FG1,new $406b7fe2d31108f7$export$2e2bcd8739ae039(e,t,a,i)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_FG2,new $406b7fe2d31108f7$export$2e2bcd8739ae039(e,t,a,i)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_FG3,new $406b7fe2d31108f7$export$2e2bcd8739ae039(e,t,a,i)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_FG4,new $406b7fe2d31108f7$export$2e2bcd8739ae039(e,t,a,i)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_MASK,new $406b7fe2d31108f7$export$2e2bcd8739ae039(e,t,a,i)),this.getContainer($0c291afd56aedbbe$var$world.LAYER_MASK).visible(!1),this.createViewport(0),this.createScene($0c291afd56aedbbe$var$world.SCENE_HUD,"SCENE_HUD"),this.setContainer($0c291afd56aedbbe$var$world.LAYER_HUD_BG0,new $6c15c283d8e64b60$export$2e2bcd8739ae039($577dad4304081d73$export$2e2bcd8739ae039.screenWidth,$577dad4304081d73$export$2e2bcd8739ae039.screenHeight)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_HUD_BG1,new $6c15c283d8e64b60$export$2e2bcd8739ae039($577dad4304081d73$export$2e2bcd8739ae039.screenWidth,$577dad4304081d73$export$2e2bcd8739ae039.screenHeight)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_HUD_BG2,new $6c15c283d8e64b60$export$2e2bcd8739ae039($577dad4304081d73$export$2e2bcd8739ae039.screenWidth,$577dad4304081d73$export$2e2bcd8739ae039.screenHeight)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_HUD_MAIN,new $6c15c283d8e64b60$export$2e2bcd8739ae039($577dad4304081d73$export$2e2bcd8739ae039.screenWidth,$577dad4304081d73$export$2e2bcd8739ae039.screenHeight)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_HUD_FG0,new $6c15c283d8e64b60$export$2e2bcd8739ae039($577dad4304081d73$export$2e2bcd8739ae039.screenWidth,$577dad4304081d73$export$2e2bcd8739ae039.screenHeight)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_HUD_FG1,new $6c15c283d8e64b60$export$2e2bcd8739ae039($577dad4304081d73$export$2e2bcd8739ae039.screenWidth,$577dad4304081d73$export$2e2bcd8739ae039.screenHeight)),this.setContainer($0c291afd56aedbbe$var$world.LAYER_HUD_FG2,new $6c15c283d8e64b60$export$2e2bcd8739ae039($577dad4304081d73$export$2e2bcd8739ae039.screenWidth,$577dad4304081d73$export$2e2bcd8739ae039.screenHeight)))},createScene:function(e,t=null){return this._scenes[e]&&($041013b7ee2c8fb5$export$2e2bcd8739ae039.queueRemove(this._scenes[e]),$parcel$global.dispose(this._scenes[e])),this._scenes[e]=new $5ab7719ddef2fb4d$export$2e2bcd8739ae039(e,t),$041013b7ee2c8fb5$export$2e2bcd8739ae039.queueAdd(this._scenes[e]),this.selectScene(e),this._scenes[e]},getScene:function(e=null){return null===e?this.activeScene:e<0||e>=this._scenes.length?null:this._scenes[e]},selectScene:function(e){return!(e<0||e>=this._scenes.length||!this._scenes[e])&&(this.activeScene=this._scenes[e],this.activeContainer=null,!0)},createViewport:function(e){if(null===this.activeScene)throw new Error("createViewport: use `selectScene` first to select the active scene.");this._viewports[e]&&($parcel$global.dispose(this._viewports[e]),this.activeScene.setViewport(e,null)),this._viewports[e]=new $d4defdc7111e0d4b$export$2e2bcd8739ae039(0,0,$577dad4304081d73$export$2e2bcd8739ae039.screenWidth,$577dad4304081d73$export$2e2bcd8739ae039.screenHeight,this.activeScene.maxWidth,this.activeScene.maxHeight),this.activeScene.setViewport(e,this._viewports[e]),this.selectViewport(e)},getViewport:function(e=null){return null===e?this.activeViewport:e<0||e>=this._viewports.length?null:this._viewports[e]},selectViewport:function(e){return!(e<0||e>=this._viewports.length||!this._viewports[e])&&(this.activeViewport=this._viewports[e],!0)},setContainer:function(e,t){if(null===this.activeScene)throw new Error("setContainer: use `selectScene` first to select the active scene.");return this.activeScene.setContainer(e,t),t},getContainer:function(e=null,t=!1){if(null===e){if(null===this.activeContainer&&t)throw new Error("getContainer: container index not specified and default container not set.");return this.activeContainer}if(null===this.activeScene)throw new Error("getContainer: use `selectScene` first to select the active scene.");let a=this.activeScene.getContainer(e);if(null===a&&t)throw new Error("getContainer: container index out of bounds.");return a},selectContainer:function(e){return this.activeContainer=this.getContainer(e,!0),null!==this.activeContainer},showMasks:function(e,t=!0){$0c291afd56aedbbe$var$world.getScene($0c291afd56aedbbe$var$world.SCENE_MAIN).getContainer($0c291afd56aedbbe$var$world.LAYER_MASK).visible(e),$f2e6a81a3fe74b9a$export$2e2bcd8739ae039.debugMasks=t},createGroup:function(e=null){if(null===this.activeScene)throw new Error("createGroup: use selectScene first to select the active scene.");return this.activeGroup=$3e41f12d32855284$export$2e2bcd8739ae039.Pool.alloc(e),this.activeScene.addGroup(this.activeGroup),this.activeGroup},endGroup:function(e=null,t=null){return null!==e&&null!==t&&this.activeGroup.translate(e,t),this.lastGroup=this.activeGroup,this.activeGroup=null,this.lastGroup.sync()},createElement:function(e,t,a,i=null,r=null){"string"!=typeof e&&(r=i,i=a,a=t,t=e,e=null);let n=this.getContainer(r),s=$254bd1369df89714$export$2e2bcd8739ae039.Pool.alloc(t,a,i);return n.add(s.setId(e)),null!==this.activeGroup&&this.activeGroup.addChild(s),this.lastElement=s,s},createMask:function(e,t,a=null,i=null,r=null,n=null,s=null){let o=this.getContainer(s||$0c291afd56aedbbe$var$world.LAYER_MASK);if(null===a){if(null===this.activeGroup)throw new Error("createMask: create a group first to use default masks.");a=this.activeGroup.bounds.x1,i=this.activeGroup.bounds.y1,r=this.activeGroup.bounds.width(),n=this.activeGroup.bounds.height()}let l=$ca4d09a0a1f9f59b$export$2e2bcd8739ae039.Pool.alloc(t,a,i,r,n);return o.add(l.setId(e)),null!==this.activeGroup&&this.activeGroup.addChild(l),l},createLabel:function(e,t,a,i,r,n=null){"string"!=typeof e&&(n=r,r=i,i=a,a=t,t=e,e=null);let s=this.getContainer(n),o=$9543ee6c8181f3e5$export$2e2bcd8739ae039.Pool.alloc(t,a,i,r);return s.add(o.setId(e)),null!==this.activeGroup&&this.activeGroup.addChild(o),this.lastElement=o,o},createUpdater:function(e=null,t=null){if(null===this.activeScene)throw new Error("createUpdater: use selectScene first to select the active scene.");return new $4bca4ca5248f01b3$export$2e2bcd8739ae039(this.activeScene,e,t)}};var//!/class
$0c291afd56aedbbe$export$2e2bcd8739ae039=$0c291afd56aedbbe$var$world;
//!/**
//! * Registered resources. Initially these are resource descriptors, but after a call to `res.load` these will be fully loaded resources.
//! */
const $6b5a44b2ae07d0f3$var$r={};var $6b5a44b2ae07d0f3$export$2e2bcd8739ae039=$6b5a44b2ae07d0f3$var$r;
//!namespace res
//!type AnimationResource =
//!/type
//!type SpritesheetResource =
//!/type
//!/namespace
//!class res
const $187e6cadde24f89b$var$res={config:function(e){$fe89a08f3d52be1f$export$2e2bcd8739ae039.config(e)},load:function(e=null){return new Promise((function(t,a){$fe89a08f3d52be1f$export$2e2bcd8739ae039.load($6b5a44b2ae07d0f3$export$2e2bcd8739ae039,(function(t,a,i,r){e&&e(i,r)}),(function(){t()}))}))},get:function(e){if(!$6b5a44b2ae07d0f3$export$2e2bcd8739ae039.hasOwnProperty(e))throw new Error("Resource not found: "+e);return $6b5a44b2ae07d0f3$export$2e2bcd8739ae039[e]},__resIdMustNotExist:function(e){if($6b5a44b2ae07d0f3$export$2e2bcd8739ae039.hasOwnProperty(e))throw new Error("Resource identifier `"+e+"` is already in use")},color:function(e,t,a,i){return this.__resIdMustNotExist(e),$6b5a44b2ae07d0f3$export$2e2bcd8739ae039[e]={type:"object",wrapper:"Custom",color:t,width:a,height:i}},custom:function(e,t,a,i,r=null){return this.__resIdMustNotExist(e),$6b5a44b2ae07d0f3$export$2e2bcd8739ae039[e]={type:"object",wrapper:"Custom",width:t,height:a,draw:i,...r}},image:function(e,t,a=null){return this.__resIdMustNotExist(e),$6b5a44b2ae07d0f3$export$2e2bcd8739ae039[e]={type:"image",wrapper:"Drawable",src:t,...a}},images:function(e,t,a,i=null,r=null,n=null,s=null){return this.__resIdMustNotExist(e),$6b5a44b2ae07d0f3$export$2e2bcd8739ae039[e]={type:"images",wrapper:"Spritesheet",src:t,count:a,width:i,height:r,config:{frameWidth:i,frameHeight:r,...n},...s}},spritesheet:function(e,t,a,i,r=0,n=null,s=null){return this.__resIdMustNotExist(e),$6b5a44b2ae07d0f3$export$2e2bcd8739ae039[e]={type:"image",wrapper:"Spritesheet",src:t,config:{frameWidth:a,frameHeight:i,numFrames:"number"==typeof r?r:0,coords:"number"==typeof r?null:r,...n},...s,frame:function(e,t,a,i){return this.config.coords||(this.config.coords=[]),this.config.coords.push([e,t,a,i]),this}}},animation:function(e,t,a,i,r=null,n=null,s=null){return this.__resIdMustNotExist(e),$6b5a44b2ae07d0f3$export$2e2bcd8739ae039[e]={type:"image",wrapper:"SpritesheetAnimation",src:t,config:{frameWidth:a,frameHeight:i,numFrames:r,...n},anim:{def:null,fps:15,seq:{},trans:{}},...s,fps:function(e){return this.anim.fps=e,this},seq:function(e,t,a,i=null){return this.anim.seq[e]={loop:t,group:a},null!==i&&(this.anim.seq[e].fps=i),this},trans:function(e,t,a){return e in this.anim.trans||(this.anim.trans[e]={}),this.anim.trans[e][t]=a,this},def:function(e){return this.anim.def=e,this}}},spritefont:function(e,t,a,i,r,n=null,s=null){return this.__resIdMustNotExist(e),$6b5a44b2ae07d0f3$export$2e2bcd8739ae039[e]={type:"image",wrapper:"SpriteFont",src:t,font:{charWidth:a,charHeight:i,charset:r,...n},...s}},json:function(e,t,a=null){return this.__resIdMustNotExist(e),$6b5a44b2ae07d0f3$export$2e2bcd8739ae039[e]={type:"json",src:t,...a}},data:function(e,t,a=null){return this.__resIdMustNotExist(e),$6b5a44b2ae07d0f3$export$2e2bcd8739ae039[e]={type:"data",src:t,...a}},text:function(e,t,a=null){return this.__resIdMustNotExist(e),$6b5a44b2ae07d0f3$export$2e2bcd8739ae039[e]={type:"text",src:t,...a}},sfx:function(e,t,a=null){return this.__resIdMustNotExist(e),$6b5a44b2ae07d0f3$export$2e2bcd8739ae039[e]={type:"audio",wrapper:"Sound",src:t,track:"sfx",...a}},sfxm:function(e,t,a,i="sequential"){return this.__resIdMustNotExist(e),$6b5a44b2ae07d0f3$export$2e2bcd8739ae039[e]={type:"audios",wrapper:"SoundArray",src:t,count:a,track:"sfx",mode:i}},music:function(e,t){return this.__resIdMustNotExist(e),$6b5a44b2ae07d0f3$export$2e2bcd8739ae039[e]={type:"audio",wrapper:"Sound",src:t,track:"music"}}};var $187e6cadde24f89b$export$2e2bcd8739ae039=$187e6cadde24f89b$var$res,$3CL91=parcelRequire("3CL91");
//![import '../flow/stick.js']
//![import '../flow/button.js']
//!class Gamepad
const $7e05eb29a72f8b10$var$Gamepad=$3CL91.Class.extend({sticks:null,buttons:null,scene:null,container:null,_visible:!0,group:null,__ctor:function(e,t){this.sticks={},this.buttons={},this.scene=e,this.layer=e.getContainer(t),this.group=$3e41f12d32855284$export$2e2bcd8739ae039.Pool.alloc()},addStick:function(e,t,a,i,r,n=0){0==n&&(n=i.width-r.width);let s=new $5d97cf48c80e8356$export$2e2bcd8739ae039(this.layer,t,a,n,i,r);return this.sticks[e]=s,this[e]=s,this.group.addChild(s),s},addButton:function(e,t,a,i=null,r=null){let n=new $6e6eb1db0e5ead92$export$2e2bcd8739ae039(this.layer,t,a,i,r);return this.buttons[e]=n,this[e]=n,this.group.addChild(n),n},visible:function(e=null){if(null===e)return this._visible;this._visible=e;for(let t in this.sticks)this.sticks[t].visible(e);for(let t in this.buttons)this.buttons[t].visible(e);return this},showMasks:function(e){for(let t in this.sticks)this.sticks[t].hitbox.visible(e,!0);for(let t in this.buttons)this.buttons[t].hitbox.visible(e,!0);return this}});var//!/class
$7e05eb29a72f8b10$export$2e2bcd8739ae039=$7e05eb29a72f8b10$var$Gamepad;
//!namespace input
//!/namespace
//!class input
const $577f6e5b2363ecac$var$input={_gamepads:[],activeGamepad:null,lastButton:null,lastStick:null,cursor:{_enabled:null,_handler:null,_element:null,pointer:null,element:function(e=!1){return!1===e?this._element:(this._element=e,this)},native:function(e){e||"none"===$577dad4304081d73$export$2e2bcd8739ae039.renderer.elem.style.cursor?e&&"none"===$577dad4304081d73$export$2e2bcd8739ae039.renderer.elem.style.cursor&&$577dad4304081d73$export$2e2bcd8739ae039.renderer.elem.style.removeProperty("cursor"):$577dad4304081d73$export$2e2bcd8739ae039.renderer.elem.style.cursor="none"},enabled:function(e=null){return null===e?this._enabled:(this._enabled===e||(this._enabled=e,!0===e?(null!==this._element&&($577dad4304081d73$export$2e2bcd8739ae039.renderer.elem.style.cursor="none"),$0e65125930c826b8$export$2e2bcd8739ae039.register(this.pointerHandler)):($577dad4304081d73$export$2e2bcd8739ae039.renderer.elem.style.removeProperty("cursor"),$0e65125930c826b8$export$2e2bcd8739ae039.unregister(this.pointerHandler))),this)},handler:function(e){return this._handler=e,this},pointerHandler:{priority:50,onPointerEvent:function(e,t,a){$577f6e5b2363ecac$var$input.cursor._enabled&&($577f6e5b2363ecac$var$input.cursor.pointer=t,null!==$577f6e5b2363ecac$var$input.cursor._element&&$577f6e5b2363ecac$var$input.cursor._element.setPosition(t.x,t.y),null!==$577f6e5b2363ecac$var$input.cursor._handler&&$577f6e5b2363ecac$var$input.cursor._handler(e,t))}}},pointer:{_handler:null,context:null,init:function(){null===this._handler&&(this._handler=$4d8bfc31fa3d230f$export$2e2bcd8739ae039.Pool.alloc(),this.context={action:null,pointer:null,pointers:null},$0e65125930c826b8$export$2e2bcd8739ae039.register(this))},onPointerEvent:function(e,t,a){this.context.action=e,this.context.pointer=t,this.context.pointers=a,this._handler.exec(this.context)},add:function(e,t=null,a=null,i=null){return null===this._handler&&this.init(),this._handler.add(this._handler_callback,e,t,a,i)},remove:function(e){hthis._handler.remove(e)},_handler_callback:function(e,t,a,i,r){return t(e.action,e.pointer,a,i,r)}},
//!};
keyboard:{_handler:null,context:null,init:function(){null===this._handler&&(this._handler=$4d8bfc31fa3d230f$export$2e2bcd8739ae039.Pool.alloc(),this.context={action:null,keyCode:null,keybState:null},$8a7c3aa5e6841159$export$2e2bcd8739ae039.register(this))},onKeyboardEvent:function(e,t,a){this.context.action=e,this.context.keyCode=t,this.context.keybState=a,this._handler.exec(this.context)},add:function(e,t=null,a=null,i=null){return null===this._handler&&this.init(),this._handler.add(this._handler_callback,e,t,a,i)},remove:function(e){this._handler.remove(e)},_handler_callback:function(e,t,a,i,r){return t(e.action,e.keyCode,e.keybState,a,i,r)}},
//!};
createGamepad:function(e,t=null){return t=null!==t?t:$0c291afd56aedbbe$export$2e2bcd8739ae039.LAYER_HUD_MAIN,$0c291afd56aedbbe$export$2e2bcd8739ae039.selectScene($0c291afd56aedbbe$export$2e2bcd8739ae039.SCENE_HUD),$0c291afd56aedbbe$export$2e2bcd8739ae039.selectContainer(t),this._gamepads[e]=new $7e05eb29a72f8b10$export$2e2bcd8739ae039($0c291afd56aedbbe$export$2e2bcd8739ae039.activeScene,t),this.selectGamepad(e),this.activeGamepad},getGamepad:function(e){return e<0||e>=this._gamepads.length?null:this._gamepads[e]||null},selectGamepad:function(e){return this.activeGamepad=this.getGamepad(e),!0},debugGamepad:function(e,t){if(null!==e)this._gamepads[e].debug(t);else for(let e=0;e<this._gamepads.length;e++)this._gamepads[e]&&this.debugGamepad(e,t)},stick:function(e,t,a,i,r,n=0){if(null===this.activeGamepad)throw new Error("input.addStick: use input.selectGamepad first to select the active gamepad.");return this.lastStick=this.activeGamepad.addStick(e,t,a,i,r,n)},button:function(e,t,a,i=null,r=null){if(null===this.activeGamepad)throw new Error("input.addButton: use input.selectGamepad first to select the active gamepad.");return this.lastButton=this.activeGamepad.addButton(e,t,a,i,r)}};var//!/class
$577f6e5b2363ecac$export$2e2bcd8739ae039=$577f6e5b2363ecac$var$input;const $ed3307f835533332$var$SUPER_TYPE_MASK=4294963200,$ed3307f835533332$var$collider={FLAG_EXCLUDE:$7fb91ad676a8d6b3$export$2e2bcd8739ae039.allocFlag(),contactRules:{},truncationRules:{},scene:null,maskLayer:null,fupdater:null,lupdater:null,flagsAnd:0,flagsValue:0,state:{contact:$c7e41fee2cf6e3a0$export$2e2bcd8739ae039.Pool.alloc(),flags:0,dx:0,dy:0,bounds:$c7e41fee2cf6e3a0$export$2e2bcd8739ae039.Pool.alloc(),x:new Array(32).fill(0),y:new Array(32).fill(0),v0x:new Array(32).fill(0),v0y:new Array(32).fill(0),v1x:new Array(32).fill(0),v1y:new Array(32).fill(0),v2x:new Array(32).fill(0),v2y:new Array(32).fill(0),count:0,target:0,v0:0,w0:0,delta0:0,v1:0,w1:0,delta1:0,w2:0,t_dx:0,t_dy:0},enable:function(e=null,t=null){this.scene=$0c291afd56aedbbe$export$2e2bcd8739ae039.getScene(e||$0c291afd56aedbbe$export$2e2bcd8739ae039.SCENE_MAIN),this.maskLayer=this.scene.getContainer(t||$0c291afd56aedbbe$export$2e2bcd8739ae039.LAYER_MASK),this.flagsAnd=$7fb91ad676a8d6b3$export$2e2bcd8739ae039.ALIVE|$7fb91ad676a8d6b3$export$2e2bcd8739ae039.VISIBLE|$ed3307f835533332$var$collider.FLAG_EXCLUDE,this.flagsValue=$7fb91ad676a8d6b3$export$2e2bcd8739ae039.ALIVE|$7fb91ad676a8d6b3$export$2e2bcd8739ae039.VISIBLE,this.scene.fupdater.add(this.firstUpdate,this),this.scene.lupdater.add(this.lastUpdate,this),this.fupdater=$4d8bfc31fa3d230f$export$2e2bcd8739ae039.Pool.alloc(this),this.lupdater=$4d8bfc31fa3d230f$export$2e2bcd8739ae039.Pool.alloc(this)},disable:function(){this.scene.fupdater.remove(this.update,this),this.maskLayer=null,this.fupdater.free(),this.lupdater.free()},firstUpdate:function(e,t){t.fupdater.exec()},lastUpdate:function(e,t){t.lupdater.exec()},later:{run:function(e,t,a,i,r){$ed3307f835533332$var$collider.fupdater.add(this._run,e,t,a,i,r)},setVisible:function(e,t){$ed3307f835533332$var$collider.fupdater.add(this._setVisible,e,t)},setValue:function(e,t,a){$ed3307f835533332$var$collider.fupdater.add(this._setValue,e,t,a)},setFlags:function(e,t){$ed3307f835533332$var$collider.fupdater.add(this._setFlags,e,t)},clearFlags:function(e,t){$ed3307f835533332$var$collider.fupdater.add(this._clearFlags,e,t)},_run:function(e,t,a,i,r,n){return a(e,t,i,r,n),!1},_setVisible:function(e,t,a){return t.visible(a),!1},_setValue:function(e,t,a,i){return t[a]=i,!1},_setFlags:function(e,t,a){return t.setFlags(a),!1},_clearFlags:function(e,t,a){return t.clearFlags(a),!1}},
//!}
contact:function(e,t,a,i=null){return e in this.contactRules||(this.contactRules[e]={}),this.contactRules[e][t]={callback:a,context:i},this},truncate:function(e,t,a=null,i=null){return e in this.truncationRules||(this.truncationRules[e]={}),this.truncationRules[e][t]={callback:a,context:i},this},getContactFlags:function(e,t){this.state.contact.set(e).setAsIntersection(t);let a=this.state.contact;return this.state.flags=0,this.state.numFlags=0,a.x1==t.x1&&(this.state.flags|=$ed3307f835533332$var$collider.Contact.LEFT,this.state.numFlags++),a.x2==t.x2&&(this.state.flags|=$ed3307f835533332$var$collider.Contact.RIGHT,this.state.numFlags++),a.y1==t.y1&&(this.state.flags|=$ed3307f835533332$var$collider.Contact.TOP,this.state.numFlags++),a.y2==t.y2&&(this.state.flags|=$ed3307f835533332$var$collider.Contact.BOTTOM,this.state.numFlags++),this.state.flags},calc:function(e,t,a,i,r,n){let s=this.state.count,o=null,l=0;if(t>0)for(let e=0;e<s;e++)!i[e]||!r[e]||a[e]<0||((null===o||a[e]>o)&&(o=a[e]),r[e]=n[e]=0,l+=i[e]);else for(let e=0;e<s;e++)!i[e]||!r[e]||a[e]>0||((null===o||a[e]<o)&&(o=a[e]),r[e]=n[e]=0,l+=i[e]);null===o&&(o=0),e?(this.state.v0=l,this.state.w0=Math.abs(o),this.state.delta0=o):(this.state.v1=l,this.state.w1=Math.abs(o),this.state.delta1=o)},attemptSelect:function(e){this.state.v1+this.state.v0===this.state.target&&(null===this.state.w2||this.state.w1+this.state.w0<this.state.w2)&&(this.state.w2=this.state.w1+this.state.w0,e?(this.state.t_dx=this.state.delta0,this.state.t_dy=this.state.delta1):(this.state.t_dx=this.state.delta1,this.state.t_dy=this.state.delta0))},load0:function(){let e=this.state.count;for(let t=0;t<e;t++)this.state.v1x[t]=this.state.v0x[t],this.state.v1y[t]=this.state.v0y[t]},save1:function(){let e=this.state.count;for(let t=0;t<e;t++)this.state.v2x[t]=this.state.v1x[t],this.state.v2y[t]=this.state.v1y[t]},load1:function(){let e=this.state.count;for(let t=0;t<e;t++)this.state.v1x[t]=this.state.v2x[t],this.state.v1y[t]=this.state.v2y[t]},resolveXpos:function(e=!1){if(this.calc(e,1,this.state.x,this.state.v0x,this.state.v1x,this.state.v1y),e)return!0;this.save1(),this.resolveYpos(!0)&&this.attemptSelect(!1),this.load1(),this.resolveYneg(!0)&&this.attemptSelect(!1),this.load0()},resolveXneg:function(e=!1){if(this.calc(e,-1,this.state.x,this.state.v0x,this.state.v1x,this.state.v1y),e)return!0;this.save1(),this.resolveYpos(!0)&&this.attemptSelect(!1),this.load1(),this.resolveYneg(!0)&&this.attemptSelect(!1),this.load0()},resolveYpos:function(e=!1){if(this.calc(e,1,this.state.y,this.state.v0y,this.state.v1y,this.state.v1x),e)return!0;this.save1(),this.resolveXpos(!0)&&this.attemptSelect(!0),this.load1(),this.resolveXneg(!0)&&this.attemptSelect(!0),this.load0()},resolveYneg:function(e=!1){if(this.calc(e,-1,this.state.y,this.state.v0y,this.state.v1y,this.state.v1x),e)return!0;this.save1(),this.resolveXpos(!0)&&this.attemptSelect(!0),this.load1(),this.resolveXneg(!0)&&this.attemptSelect(!0),this.load0()},commit:function(){this.state.group.alive()&&(this.state.group.translate(this.state.dx,this.state.dy),this.state.group.clearFlags($ed3307f835533332$var$collider.FLAG_EXCLUDE))},translate:function(e,t=null,a=0,i=0){if("number"==typeof t&&(i=a,a=t,t=null),!e)return;if(t||(t=e.group),!t.alive()||!e.alive())return;if(this.state.mask=e,this.state.group=t,this.state.dx=downscalef(upscale(a)),this.state.dy=downscalef(upscale(i)),!this.maskLayer||!e.visible())return this.commit();let r=this.truncationRules[e.type];if(!r&&(r=this.truncationRules[e.type&$ed3307f835533332$var$SUPER_TYPE_MASK],!r))return this.commit(),this.scan(e,t);this.state.offs=t.getOffsets(this.state.dx,this.state.dy),this.state.bounds.set(e.bounds).translate(this.state.offs.x+this.state.dx,this.state.offs.y+this.state.dy),t.setFlags($ed3307f835533332$var$collider.FLAG_EXCLUDE);let n=this.maskLayer.selectInRegion(this.state.bounds,this.flagsAnd,this.flagsValue);if(0===n.length)return n.free(),this.commit();let s=0,o=0;for(;;){let t=n.shift();if(null===t)break;let a=r[t.type];if(!a&&(a=r[t.type&$ed3307f835533332$var$SUPER_TYPE_MASK],!a))continue;if(!1===a.callback||null!==a.callback&&!0!==a.callback&&!a.callback(e,t,a.context))continue;let i=Math.min(this.state.bounds.x2,t.bounds.x2)-Math.max(this.state.bounds.x1,t.bounds.x1),l=Math.min(this.state.bounds.y2,t.bounds.y2)-Math.max(this.state.bounds.y1,t.bounds.y1);this.state.v0x[s]=0,this.state.v0y[s]=0,Math.min(this.state.bounds.width(),t.bounds.width())!=i&&(this.state.x[s]=absmin(this.state.bounds.x2-t.bounds.x1,this.state.bounds.x1-t.bounds.x2),this.state.v0x[s]=1),Math.min(this.state.bounds.height(),t.bounds.height())!=l&&(this.state.y[s]=absmin(this.state.bounds.y2-t.bounds.y1,this.state.bounds.y1-t.bounds.y2),this.state.v0y[s]=1);let c=this.state.v0x[s]+this.state.v0y[s];o+=c,c>1&&(this.state.v0x[s]=c,this.state.v0y[s]=c),this.state.v1x[s]=this.state.v0x[s],this.state.v1y[s]=this.state.v0y[s],s++}if(n.free(),0==o)return this.commit(),this.scan(e,t);if(this.state.target=o,this.state.count=s,this.state.w2=null,this.resolveXpos(),this.resolveXneg(),this.resolveYpos(),this.resolveYneg(),null!==this.state.w2){let t=this.contactRules[e.type];if(t||(t=this.contactRules[e.type&$ed3307f835533332$var$SUPER_TYPE_MASK]),t){for(this.state.bounds.set(e.bounds).translate(this.state.offs.x+this.state.dx-.5*this.state.t_dx,this.state.offs.y+this.state.dy-.5*this.state.t_dy),n=this.maskLayer.selectInRegion(this.state.bounds,this.flagsAnd,this.flagsValue);e.alive();){let a=n.shift();if(null===a)break;if(!a.alive())continue;let i=t[a.type];(i||(i=t[a.type&$ed3307f835533332$var$SUPER_TYPE_MASK],i))&&i.callback(e,a,i.context)}n.free()}this.state.dx-=this.state.t_dx,this.state.dy-=this.state.t_dy}this.commit()},scan:function(e,t=null){if(t||(t=e.group),!t||!t.alive()||!e.alive())return;if(this.state.mask=e,this.state.group=t,!this.maskLayer||!e.visible())return;let a=this.contactRules[e.type];if(a||(a=this.contactRules[e.type&$ed3307f835533332$var$SUPER_TYPE_MASK]),!a)return;t.setFlags($ed3307f835533332$var$collider.FLAG_EXCLUDE);let i=this.maskLayer.selectInRegion(e.bounds,this.flagsAnd,this.flagsValue);for(t.clearFlags($ed3307f835533332$var$collider.FLAG_EXCLUDE);e.alive();){let t=i.shift();if(null===t)break;if(!t.alive())continue;let r=a[t.type];(r||(r=a[t.type&$ed3307f835533332$var$SUPER_TYPE_MASK],r))&&r.callback(e,t,r.context)}i.free()},
//!/class
//!namespace collider
//!enum Contact
Contact:{
//!LEFT
LEFT:1,
//!RIGHT
RIGHT:2,
//!HORIZONTAL
HORIZONTAL:3,
//!TOP
TOP:4,
//!BOTTOM
BOTTOM:8,
//!VERTICAL
VERTICAL:12}};
//!class collider
var//!/enum
//!/namespace
$ed3307f835533332$export$2e2bcd8739ae039=$ed3307f835533332$var$collider;const $3c88906e521b9e55$export$773cc7fa6f8304c3=$577dad4304081d73$export$2e2bcd8739ae039,$3c88906e521b9e55$export$f965ae91e38a1274=$0c291afd56aedbbe$export$2e2bcd8739ae039,$3c88906e521b9e55$export$43caf9889c228507=$6b5a44b2ae07d0f3$export$2e2bcd8739ae039,$3c88906e521b9e55$export$a79e2b3ea5d10ee0=$187e6cadde24f89b$export$2e2bcd8739ae039,$3c88906e521b9e55$export$b7e3ae3d7c15e42e=$577f6e5b2363ecac$export$2e2bcd8739ae039,$3c88906e521b9e55$export$5fa227701309b621=$ed3307f835533332$export$2e2bcd8739ae039,$5eaf60761b941187$export$4c85e640eb41c31b=$3CL91.Class,$5eaf60761b941187$export$19342e026b58ebb7=$3CL91.Schema,$5eaf60761b941187$export$14416b8d99d47caa=$3CL91.Template,$5eaf60761b941187$export$816be348776d53c1=$f2e6a81a3fe74b9a$export$2e2bcd8739ae039,$5eaf60761b941187$export$7c09191825db112d=$8056ec6610d6f975$export$2e2bcd8739ae039,$5eaf60761b941187$export$c1b1a45ed915aad9=$3d37cfb473d35ef0$export$2e2bcd8739ae039,$5eaf60761b941187$export$e1dae5660003ffa7=$041013b7ee2c8fb5$export$2e2bcd8739ae039,$5eaf60761b941187$export$c57e9b2d8b9e4de=$445264d030762d7a$export$2e2bcd8739ae039,$5eaf60761b941187$export$a92776769f460054=$42e4702e58ec5fce$export$2e2bcd8739ae039,$5eaf60761b941187$export$e9e0d96f49f57c33=$87a32fa215803424$export$2e2bcd8739ae039,$5eaf60761b941187$export$8d01c972ee8b14a9=$ea6ab44f7f06a4a9$export$2e2bcd8739ae039,$5eaf60761b941187$export$7c4f444dab5ed59=$66e5219664536ce1$export$2e2bcd8739ae039,$5eaf60761b941187$export$ce30dbb46644d06c=$70a42a4582ac5be9$export$2e2bcd8739ae039,$5eaf60761b941187$export$462bb059fed9d9e5=$70b12fe29b3755e8$export$2e2bcd8739ae039,$5eaf60761b941187$export$cb01d642ebc0a347=$00b4569a92b7ec96$export$2e2bcd8739ae039,$5eaf60761b941187$export$eff95f126aa67cfb=$0f93bc736e8cef65$export$2e2bcd8739ae039,$5eaf60761b941187$export$5431306cf43de24a=$c5d53d63ad830c04$export$2e2bcd8739ae039,$5eaf60761b941187$export$573ab5fe783d8aac=$fb16f2790102e0ed$exports,$5eaf60761b941187$export$e9a269813a6315a4=$fe89a08f3d52be1f$export$2e2bcd8739ae039,$5eaf60761b941187$export$85990f0f98a390bb=$90fa62f30432a965$export$2e2bcd8739ae039,$5eaf60761b941187$export$fe264c04f294fd15=$cac8b143592e7d73$export$2e2bcd8739ae039,$5eaf60761b941187$export$1034c64782e66715=$a220fff115a0570f$export$2e2bcd8739ae039,$5eaf60761b941187$export$54c2e3dc7acea9f5=$c73414f3aa8cd9da$export$2e2bcd8739ae039,$5eaf60761b941187$export$8fbd1ac8e83536df=$fa388e5ba5a88cdf$export$2e2bcd8739ae039,$5eaf60761b941187$export$a428cd33b25d5283=$4d8bfc31fa3d230f$export$2e2bcd8739ae039,$5eaf60761b941187$export$5b12bf1653c0dd85=$ffcd6f0a38d315dc$export$2e2bcd8739ae039,$5eaf60761b941187$export$c79fc6492f3af13d=$75f7867f0ec445c4$export$2e2bcd8739ae039,$5eaf60761b941187$export$ac4bca90992eed1=$21edd9058bfa8ef7$export$2e2bcd8739ae039,$5eaf60761b941187$export$c9b44e90c5031de0=$94d55b5c9afc30f7$export$2e2bcd8739ae039,$5eaf60761b941187$export$3dc3622b48e72adc=$c7e41fee2cf6e3a0$export$2e2bcd8739ae039,$5eaf60761b941187$export$79f93ddd76e66d40=$6368899a9e534bce$export$2e2bcd8739ae039,$5eaf60761b941187$export$cea96571ebbff9dd=$36e98efbc8017cce$export$2e2bcd8739ae039,$5eaf60761b941187$export$deefd61317ad2797=$87700f1592e85ac3$export$2e2bcd8739ae039,$5eaf60761b941187$export$5a2130c936f86fb8=$3c0d7fe046574b0f$export$2e2bcd8739ae039,$5eaf60761b941187$export$cfb3877ce19bb838=$7fb91ad676a8d6b3$export$2e2bcd8739ae039,$5eaf60761b941187$export$ef2184bd89960b14=$776748689202dbe3$export$2e2bcd8739ae039,$5eaf60761b941187$export$38af1803e3442a7f=$5ab7719ddef2fb4d$export$2e2bcd8739ae039,$5eaf60761b941187$export$d5c6c08dc2d3ca7=$d4defdc7111e0d4b$export$2e2bcd8739ae039,$5eaf60761b941187$export$3386beb5bc3bfa=$4bca4ca5248f01b3$export$2e2bcd8739ae039,$5eaf60761b941187$export$42a852a2b6b56249=$f40c750fc020de04$export$2e2bcd8739ae039,$5eaf60761b941187$export$eeaa45a7d92663a6=$6c15c283d8e64b60$export$2e2bcd8739ae039,$5eaf60761b941187$export$cc55614734af2d87=$406b7fe2d31108f7$export$2e2bcd8739ae039,$5eaf60761b941187$export$eb2fcfdbd7ba97d4=$3e41f12d32855284$export$2e2bcd8739ae039,$5eaf60761b941187$export$f35845279390eafd=$0752c36c8a8a94fd$export$2e2bcd8739ae039,$5eaf60761b941187$export$db77ccec0bb4ccac=$254bd1369df89714$export$2e2bcd8739ae039,$5eaf60761b941187$export$991dcf7284de63d=$ca4d09a0a1f9f59b$export$2e2bcd8739ae039,$5eaf60761b941187$export$b04be29aa201d4f5=$9543ee6c8181f3e5$export$2e2bcd8739ae039,$5eaf60761b941187$export$474b8119f9aaf6a9=$8a7c3aa5e6841159$export$2e2bcd8739ae039,$5eaf60761b941187$export$63d5558963a08ef6=$0e65125930c826b8$export$2e2bcd8739ae039,$5eaf60761b941187$export$f9b7ad1c9b000a93=$482cc68f8af5a1d2$export$2e2bcd8739ae039,$5eaf60761b941187$export$353f5b6fc5456de1=$6e6eb1db0e5ead92$export$2e2bcd8739ae039,$5eaf60761b941187$export$85a6520672683043=$5d97cf48c80e8356$export$2e2bcd8739ae039;var $5eaf60761b941187$export$2e2bcd8739ae039=$3c88906e521b9e55$exports;
//!export default fxl;
$parcel$global.froxel={Class:$5eaf60761b941187$export$4c85e640eb41c31b,Schema:$5eaf60761b941187$export$19342e026b58ebb7,Template:$5eaf60761b941187$export$14416b8d99d47caa,globals:$5eaf60761b941187$export$816be348776d53c1,glx:$5eaf60761b941187$export$7c09191825db112d,glsl:$5eaf60761b941187$export$c1b1a45ed915aad9,System:$5eaf60761b941187$export$e1dae5660003ffa7,Timer:$5eaf60761b941187$export$c57e9b2d8b9e4de,Random:$5eaf60761b941187$export$a92776769f460054,KeyCode:$5eaf60761b941187$export$e9e0d96f49f57c33,Canvas:$5eaf60761b941187$export$8d01c972ee8b14a9,Perf:$5eaf60761b941187$export$7c4f444dab5ed59,Log:$5eaf60761b941187$export$ce30dbb46644d06c,Shader:$5eaf60761b941187$export$462bb059fed9d9e5,ShaderProgram:$5eaf60761b941187$export$cb01d642ebc0a347,Framebuffer:$5eaf60761b941187$export$eff95f126aa67cfb,Texture:$5eaf60761b941187$export$5431306cf43de24a,Wrappers:$5eaf60761b941187$export$573ab5fe783d8aac,Resources:$5eaf60761b941187$export$e9a269813a6315a4,Sound:$5eaf60761b941187$export$85990f0f98a390bb,Recycler:$5eaf60761b941187$export$fe264c04f294fd15,Linkable:$5eaf60761b941187$export$1034c64782e66715,List:$5eaf60761b941187$export$54c2e3dc7acea9f5,PriorityQueue:$5eaf60761b941187$export$8fbd1ac8e83536df,Handler:$5eaf60761b941187$export$a428cd33b25d5283,Matrix:$5eaf60761b941187$export$5b12bf1653c0dd85,Rect:$5eaf60761b941187$export$c79fc6492f3af13d,Vec2:$5eaf60761b941187$export$ac4bca90992eed1,TFunction:$5eaf60761b941187$export$c9b44e90c5031de0,Bounds2:$5eaf60761b941187$export$3dc3622b48e72adc,Point2:$5eaf60761b941187$export$79f93ddd76e66d40,Easing:$5eaf60761b941187$export$cea96571ebbff9dd,Anim:$5eaf60761b941187$export$deefd61317ad2797,Boot:$5eaf60761b941187$export$5a2130c936f86fb8,GridElement:$5eaf60761b941187$export$cfb3877ce19bb838,Grid:$5eaf60761b941187$export$ef2184bd89960b14,Scene:$5eaf60761b941187$export$38af1803e3442a7f,Viewport:$5eaf60761b941187$export$d5c6c08dc2d3ca7,Updater:$5eaf60761b941187$export$3386beb5bc3bfa,Container:$5eaf60761b941187$export$42a852a2b6b56249,SimpleContainer:$5eaf60761b941187$export$eeaa45a7d92663a6,GridContainer:$5eaf60761b941187$export$cc55614734af2d87,Group:$5eaf60761b941187$export$eb2fcfdbd7ba97d4,Drawable:$5eaf60761b941187$export$f35845279390eafd,Element:$5eaf60761b941187$export$db77ccec0bb4ccac,Mask:$5eaf60761b941187$export$991dcf7284de63d,Label:$5eaf60761b941187$export$b04be29aa201d4f5,KeyboardHandler:$5eaf60761b941187$export$474b8119f9aaf6a9,PointerHandler:$5eaf60761b941187$export$63d5558963a08ef6,ScreenControls:$5eaf60761b941187$export$f9b7ad1c9b000a93,Button:$5eaf60761b941187$export$353f5b6fc5456de1,Stick:$5eaf60761b941187$export$85a6520672683043,fxl:$3c88906e521b9e55$exports};
//# sourceMappingURL=froxel.js.map
